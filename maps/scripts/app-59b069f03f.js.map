{"version":3,"sources":["scripts/app.js"],"names":["angular","module","PlantillaController","UtilFormly","Message","Storage","$stateParams","$location","$log","$mdSidenav","DataService","restUrl","Panel","ArrayUtil","backUrl","Documento","inicializarPlantilla","vm","id_plantilla","implicados","items","newItem","newTemplate","data","nombre","get","then","respuesta","datos","abreviacion","form_model","fromJson","plantilla_valor","transformGet","plantilla","i","length","type","existe_datosGenerales","existe_certificacionComprometido","actualizarPagina","total","existe_documento","togglePalette","ev","log","toggle","vistaPrevia","form_previo","dataToView","isObject","clearModel","vista_previa","guardarPlantilla","xplantilla_valor","copy","k","indexOf","toJson","_usuario_creacion","cuenta","id","generarAbreviacion","isDefined","Error","resp","sub_arr","max_num","pun","abc","xabc","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","rows","count","split","num","row","id_plantilla_formly","post","show","tipoMensaje","mensaje","path","_usuario_modificacion","put","error","push","elements","j","fieldGroup","getConfigItem","startCallback","index","item","notvisualize","init_index","endCallback","to_index","mover","to_index_l","val","element","to_item_fg","to_item_fg_num_cols","to_data_fg","dropCallback","template","drop_layout","init_index_l","tipo","mensajeError","insert","validation","name","message","startLayoutCallback","index_l","item_fg","data_fg","endLayoutCallback","dropLayoutCallback","elementAttributes","funcionAgregar","openEditItem","$mdOpenMenu","event","ik","init","opciones","templateOptions","options","value","Array","prototype","apply","this","arguments","splice","template_cite","to","tipoMembrete","url_img","editItem","i_l","xdata","xitem","isUndefined","shift","unshift","concat","removeItem","cancelEditItem","model","openMenu","config","clickOutsideToClose","escapeToClose","controller","PanelItemController","templateUrl","$scope","$mdPanel","mdPanelRef","xeditItem","closePanel","xremoveItem","xcancelEditItem","close","destroy","vmp","input_valid","validaciones","titulos","datosGenerales","inputt","editorTexto","documentosRelacionados","titulo","subtitulo","parrafo","lista","layout","vacio","input","radio","select","select_multiple","textarea","checkbox","datepicker","slider","switch","chips","cajachica","certificacionComprometido","listaContactos","calendario","pattern","verPdf","sizeObj","formu_prueba","$error","showPdf","recursiveShowError","getUser","idPlantilla","$inject","DocumentoController","Modal","ExpirationTime","iniciar","enviarEjecutandose","id_documento","getSession","cargarPlantilla","sw_enviado","verificarZonaHoraria","load","initAutoSave","guardar","resultado","setSession","sw_rechazado","estado","disableForm","form_actual","flujo","via_actual","para","via","offset","es_zona_horaria_bolivia","doc","Date","getTimezoneOffset","abrirDialogError","copearDocumento","confirm","model_actual","contacto","pl","nombre_plantilla","observaciones","verificar","valido","first_name","last_name","sw_es_respuesta","documento_padre","sw_grupo","grupo","docs_grupo","verDocumento","id_doc","showPdfId","agregarFlujo","documento","enviar","key","arr","id_usuario","reverse","transformarModel","arch","sw_location","sw","enviado","es_respuesta","save","removeSession","guardarDocumento","formu","toUpperCase","enviarMultiple","DialogErrorController","$mdDialog","vmd","cerrar","cancel","volverAtras","firmar","DialogFirmadorController","Util","DemofiService","verificarTokenConectado","iniciando","listTokens","response","iniciado","demofi_ejecutandose","tokens","token_conectado","autenticar","mostrar_progress","autenticando","login","pin","respLogin","finalizado","boton_autenticar_habilitado","autenticado","listCertificates","respCert","certificados","certificado_seleccionado","undefined","verificarServidor","cancelar","html","pdf","flag_html","show_pdf","esDispositivoMovil","loadCanvas","pdf_buffer","verObservaciones","observacion","idDocumento","RolController","DialogRolController","$timeout","obtenerMenus","id_rol","menus","rol_menus","fid_menu","id_menu","checked","registrarRol","datosEnviar","rol","descripcion","peso","menus_nuevos","existe","_fecha_creacion","_fecha_modificacion","hide","click","estados","usuario","url","fields","dialogController","MenuController","VistaPdfController","$sce","datos_enviar","cite","respuestaPdf","esDocumentoExterno","verHtml","mostrarPdf","showPdfx","PlantillasController","nuevaPlantilla","irPlantilla","pEvento","pIdentificador","estadoSw","permission","create","update","delete","buttons","tooltip","icon","onclick","buttonAgregar","MonitoreoController","charColors","$window","$filter","chart","graficos","cod","labelChart","tipoChart","grafico","mes","fecha_actual","getMonth","meses","docsContables","tipoInformePago","anio","getFullYear","limite_inferior","anios","aniosContables","limite_superior","limite_inferior_contable","anioContable","usuarios","gestiones","gestionActual","gestion","reiniciarChart","busqueda","ordenInverso","ordenarPor","consultarPresupuesto","consultarDocumentosUsuarioEstados","fechaInicial","fechaFinal","consultarDocumentosPendientes","consultarComprometido","consultarPagado","consultarReporteContable","labels","datasets","label","backgroundColor","bg","amarillo","borderColor","bo","borderWidth","verde","azul","reiniciar","page","page_cant","page_text","page_tot","refrescarChart","headers","title","mostrar","map","comprometido","parseFloat","replace","inicial","modificado","numero","isNaN","pagado","saldo","vigente","tipoInforme","datosConsulta","documentos","generarNombre","cabeceraPresupuesto","cabecera","filasPresupuesto","filas","nuevo","mostrarOcultar","columna","pendientes","nombres","apellidos","ENVIADO","RECHAZADO","DERIVADO","monto","generarPDF","presupuesto","orientation","DialogPDFController","url_get","global","relacionado","no_relacionado","actualizar","paginar","acc","Math","ceil","date","y","m","ImpresionController","verProgreso","showProgressAll","impresionMultiple","evento","DialogImpresionMultiple","obtenerDocumento","warning","documentoAImprimir","queryExtra","multiple","FirmarController","$q","FirmaticService","Loading","obtenerNumeroSeleccionados","cantidad","habilitarBotonFirma","obtenerDocumentos","obtenidos","noObtenidos","promesas","Promise","resolve","arrayBufferToBase64","base64","errorObtener","all","reject","guardarDocumentosFirmados","guardado","noGuardado","nombreDocumento","docDic","respGuardado","firmarDocumentos","verificacion","configLoad","documentosParaFirmar","verificarSeleccionados","control","seleccionados","firmados","guardados","verificarEstado","respEstado","activo","cambiar","respVerificar","esVirtual","respDocumentos","nroDocumento","firmarPdf","respuestaFirma","status","files","respGuardados","success","selected","firmado","buffer","defer","binary","bytes","Uint8Array","len","byteLength","String","fromCharCode","btoa","promise","habilitarSeleccion","estadoOpciones","v","t","obtenerSeleccionados","EnCursoController","DocumentosController","Datetime","irDocumento","nuevoDocumento","DialogEscojerPlantilla","iniciarDialog","urlBase","plantillas_disponibles","plantilla_seleccionada","elegir","es_jefe","key_item","opcion","NUEVO","CERRADO","DEFAULT","ContactosController","DialogContactoController","registrarContacto","otroEditar","tipo_entidad","otro_tipo","id_contacto","respContacto","obtenerTiposEntidad","respTipos","tiposEntidad","otro","habilitarOtro","departamentos","departamento","order","AprobacionController","respuestaDocumento","fecha","format","pRespuesta","isMobile","dc","isString","es_derivar","es_para","accion","usuario_proveido","aprobar","text","sw_crear","mensajeLoad","usuario_derivar","_usuario_seleccionado","derivar","_plantilla_seleccionada","observar","observado_por","destino","openSelect","currentTarget","next","children","show_select","crear","p","alert","VirtualController","SideNavFactory","$auth","BreadcrumbFactory","usuariosVirtuales","seleccionar","respVirtual","user","menu","roles","max","forEach","setUser","setMenu","getMenu","route","getMenuOption","setParent","setCurrent","$sidenav","find","removeClass","addClass","parent","prev","setToken","token","fadeOut","obtenerVirtuales","UsuariosController","Syncronizar","DialogUsuarioController","$mdConstant","rolesEnviar","virtuales","flagEditar","rolesAsignados","usuario_rol","itemGlobal","indiceGlobal","valor","indice","procesado","enUso","dispItem","objTemp","cargo","libre","titular","idProcesado","usoItem","fid_usuario_virtual","id_virtual","unidades","registrarUsuario","oficinas","id_oficina","fid_unidad","contrasena","numero_documento","email","LoginController","activate","localStorage","getItem","username","password","it","DialogRecuperarController","recuperar","iniciarSesion","ruta","setItem","codigo","location","href","err","irAVerificar","destroySession","abrirDialog","ProfileController","getColor","userColor","getName","getEmail","getInitial","firstName","getData","datetimeLiteral","getEsJefe","abrirEditar","swEditarCuenta","ca","nombre_usuario","editarCuenta","usuario_enviar","apellido_paterno","swPut","contrasena_nueva","contrasena_confirm","verificarContrasena","user_set","apellido_materno","date_joined","editarConfiguracion","conf_enviar","id_conf_notificacion","cancelarEditar","CiteController","sc","$watch","newValue","style","height","abrirSelector","mostrarContacto","cerrarSelector","buscarContacto","tempContactos","contactos","contador","vector","buscarObj","EncabezadoController","iniciarController","xu","u","xde","xpara","xvia","fd","form_nuevo","on","stopPropagation","usuarios_check","usuarios_jefes","newUser","el","moverUsuario","dir","nom","show_para","show_via","show_de","buscar_para","buscar_via","buscar_de","show_doc","closeSelectDoc","buscar_doc","xdocs","documentosAnular","DatosGeneralesController","push_gral","push_jefe","ConCopiaArchivoController","cadena","str","res","minDate","maxDate","actualizarLimites","diasAntes","diasDespues","fechaActualMin","fechaActualMax","setDate","getDate","filterBookings","bookedDates","toString","CajaChicaController","monto_total","calcularTotal","buscarPartidas","texto","isFloat","toFixed","toFloat","string","test","obtenerSaldo","showALert","cargarPartidas","ids_comprometidos","id_comprometido","pago_multiple","hasOwnProperty","buscar","doc_seleccionado","partida","Object","keys","buscarDocumentos","addRow","button","par_seleccionado","deleteRow","time","icons","info","icono","archivos","elegirPdf","onLoadModel","afiles","f","filetype","limpiarPdf","redondear","x","a","round","pow","ci","archivo","language","cabeceras","Content-Type","urlFirma","urlFirmatic","axios","respFirma","errorFirma","errorEstado","service","$http","$compile","openModal","solicitudes","size","w","h","outerHeight","screenY","outerWidth","screenX","open","url_demofi","req","callRequest","pinToken","sign","solicitudFirma","aliasParaFirmar","dataSend","nombre_archivo","codigo_archivo","pdf_base64","alias","logout","VerificarController","datosDocumento","respPost","esMovil","irInicio","currentNavItem","selectedIndex","min","previous","MainController","VisorImagenesController","FileUploader","DialogImagenController","eliminarImagen","pArchivo","imagenes","imagenesEliminar","mostrarImagen","component","controllerAs","bindings","ancho","alto","eliminar","linkTooltipController","createTooltip","new_html","directive","scope","restrict","link","elm","attrs","$td","append","$card","mouseover","css","mouseout","root","factory","define","amd","$","SimpleModule","simpleHotkeys","simpleUploader","exports","require","jQuery","simple","hotkeys","uploader","AlignmentButton","BlockquoteButton","BoldButton","Button","Clipboard","CodeButton","CodePopover","ColorButton","FontScaleButton","Formatter","HrButton","ImageButton","ImagePopover","IndentButton","Indentation","InputManager","ItalicButton","Keystroke","LinkButton","LinkPopover","ListButton","OrderListButton","OutdentButton","Popover","Selection","Simditor","StrikethroughButton","TableButton","TitleButton","Toolbar","UnderlineButton","UndoManager","extend","child","ctor","constructor","hasProp","call","__super__","l","slice","superClass","pluginName","_range","_startNodes","_endNodes","_containerNode","_nodes","_blockNodes","_rootNodes","_init","editor","_module","_selection","document","getSelection","_this","e","reset","getRangeAt","clear","removeAllRanges","_error","range","ffOrIE","addRange","util","browser","firefox","msie","inputManager","focused","body","focus","rangeCount","startNodes","startContainer","parentsUntil","endNodes","collapsed","endContainer","containerNode","commonAncestorContainer","nodes","first","is","each","node","$endNode","$node","$nodes","endIndex","sharedIndex","startIndex","eq","last","contents","merge","unique","blockNodes","filter","isBlockNode","rootNodes","$parent","rangeAtEndOf","afterLastNode","beforeLastNode","endNode","endNodeLength","lastNodeIsBr","result","getNodeLength","endOffset","contains","addBack","n","$lastChild","beforeLastbr","isLastNode","nodeType","nodeValue","rangeAtStartOf","startNode","startOffset","insertNode","setRangeAfter","setEndAfter","collapse","setRangeBefore","setEndBefore","setRangeAtStartOf","setEnd","setRangeAtEndOf","$lastNode","lastChild","lastChildLength","lastText","nodeLength","charAt","isEmptyNode","phBr","deleteRangeContents","atEndOfBody","atStartOfBody","endRange","startRange","cloneRange","empty","setStart","deleteContents","breakBlockEl","$el","setStartBefore","before","extractContents","endCaret","startCaret","_selectionSaved","restore","createRange","remove","opts","allowedTags","allowedAttributes","allowedStyles","_allowedTags","_allowedAttributes","img","code","_allowedStyles","h1","h2","h3","h4","decorate","trigger","undecorate","clone","autolink","$link","findLinkNode","lastIndex","linkNodes","match","re","replaceEls","subStr","uri","$parentNode","closest","exec","substring","createTextNode","replaceWith","blockNode","len1","ref","ref1","cleanNode","insertBefore","recursive","$blockEls","$childImg","$p","attr","isDecoration","textNode","isDecoratedNode","join","blockEl","unwrap","hasClass","tagName","toLowerCase","makeArray","attributes","removeAttr","_cleanNodeStyles","tr","pair","styleStr","styles","trim","clearHtml","lineBreak","container","beautify","$contents","uselessP","invalid","_modifierKeys","_arrowKeys","selectAllKey","submitKey","throttledValueChanged","throttle","params","setTimeout","throttledSelectionChanged","triggerEvent","clipboard","pasting","_selectionTimer","clearTimeout","selection","$rootBlocks","lastCaretPosition","formatter","formatted","insertAfter","support","onselectionchange","proxy","_onKeyDown","_onKeyPress","_onKeyUp","_onMouseUp","_onFocus","_onBlur","_onDrop","_onInput","add","preventDefault","modify","os","mac","$children","firstBlock","lastBlock","$blockEl","undoManager","caretPosition","triggerHandler","sync","currentState","caret","respondTo","keystroke","which","metaKey","oninput","appendTo","_keystrokeHandlers","_initKeystrokeHandlers","handler","aliases","base","keyNameMap","Node","ELEMENT_NODE","titleEnterHandler","safari","$br","shiftKey","webkit","$prevBlockEl","$rootBlock","isWebkit","$cloneNode","listEl","newBlockEl","newListEl","nextAll","after","breakNode","setStartAfter","$closestBlock","$childList","$newLi","$prevChildList","$prevNode","$textNode","isFF","nodeName","$newNode","codeStr","$firstChild","_index","_capacity","_startPosition","_endPosition","redoShortcut","undoShortcut","_stack","win","undo","redo","throttledPushState","_pushUndoState","src","resetCaretPosition","startPosition","_getPosition","endPosition","start","state","hidePopover","innerHTML","_getNodeOffset","merging","isNumeric","TEXT_NODE","position","prevNode","previousSibling","_getNodeByPosition","childNodes","appendChild","end","console","warn","version","navigator","appVersion","linux","unix","mobile","chrome","edge","ie","ref2","ref3","ref4","ua","userAgent","mozilla","reflow","offsetHeight","isMac","ctrlKey","RegExp","dataURLtoBlob","dataURL","BlobBuilder","arrayBuffer","bb","blobArray","byteString","hasArrayBufferViewSupport","hasBlobConstructor","intArray","mimeString","supportBlob","window","Blob","Boolean","WebKitBlobBuilder","MozBlobBuilder","MSBlobBuilder","atob","ArrayBuffer","decodeURIComponent","charCodeAt","getBlob","func","wait","args","ctx","rtn","throttled","timeoutID","delta","formatHTML","cursor","indentString","lastMatch","level","repeatString","inArray","isStartTag","isEndTag","toolbar","toolbarFloat","toolbarHidden","toolbarFloatOffset","_tpl","wrapper","separator","floatInitialized","initToolbarFloat","toolbarHeight","isArray","_render","list","width","left","placeholderEl","bottomEdge","scrollTop","topEdge","top","prependTo","findButton","addButton","btn","tabIndent","codeButton","active","indent","isBackward","$blockNodes","$endNodes","$startNodes","include","r","outdentBlock","indentBlock","$nextTd","$nextTr","$parentLi","$pre","$tr","marginLeft","indentText","parseInt","indentWidth","selectNode","$prevTd","$prevTr","outdentText","pasteImage","cleanPaste","_pasteBin","_processPasteByClipboardApi","_getPasteContent","pasteContent","_processPasteContent","_pasteInBlockEl","_pastePlainText","imageFile","pasteItem","uploadOpt","originalEvent","clipboardData","getAsFile","upload","callback","ul","$img","blob","insertPosition","lastLine","len2","len3","len4","line","lines","o","q","pop","connect","placeholder","defaultImage","form","uploadOpts","setValue","_placeholder","execCommand","results","blur","getValue","cloneBody","emptyP","firstP","lastP","popover","off","removeData","i18n","zh-CN","blockquote","bold","color","coloredText","hr","image","externalImage","uploadImage","uploadFailed","uploadError","imageUrl","imageSize","imageAlt","restoreImageSize","uploading","outdent","italic","linkText","linkUrl","linkTarget","openLinkInCurrentWindow","openLinkInNewWindow","removeLink","ol","strikethrough","table","insertRowAbove","insertRowBelow","deleteColumn","insertColumnLeft","insertColumnRight","deleteTable","normalText","underline","alignment","alignCenter","alignLeft","alignRight","selectLanguage","fontScale","fontScaleXLarge","fontScaleLarge","fontScaleNormal","fontScaleSmall","fontScaleXSmall","paintRow","paintCell","dissolveRow","dissolveCell","addBorder","removeBorder","listDisc","listCircle","listSquare","listDecimal","listDecimal0","listUpperRoman","listLowerRoman","listUpperAlpha","listLowerAlpha","listGreek","toggleList","en-US","alignJustify","_t","menuWrapper","menuItem","htmlTag","disableTag","disabled","needFocus","shortcut","tag","render","exceed","noFocus","param","toggleClass","siblings","right","command","editorActive","setActive","setDisabled","mousedown","_status","iconClassOf","setIcon","renderMenu","$menuBtnEl","$menuItemEl","menuEl","data-param","_disableStatus","_activeStatus","target","_initLabelWidth","$fields","_labelWidth","field","$field","$label","$target","refresh","editorOffset","maxLeft","targetH","targetOffset","$rootNodes","replaceAll","sizeMap","x-large","large","small","x-small","$scales","$span","fontSize","queryCommandState","hex","rgb","getComputedStyle","getPropertyValue","_convertRgbToHex","selectNodeContents","rgbToHex","g","b","componentToHex","c","$list","anotherType","li","$li","OrderListStyleButton","createMenu","editMenu","$ol","clearCache","nodeCache","pre","_checkMode","cloneContents","inlineMode","$code","lang","wrapInner","_inlineCommand","_blockCommand","resultNodes","$option","langs","codeLanguages","selectEl","$newBlock","txtNode","one","urlEl","textEl","tpl","unlinkEl","selectTarget","imageButton","$masks","mask","$mask","file","_initUploader","$uploadItem","$input","createInput","uploadProgress","accept","inline","createImage","readImageFile","obj","loadImage","srcEl","prop","loaded","percent","img_path","msg","parseJSON","file_path","xhr","statusText","responseText","positionMask","imgOffset","wrapperOffset","Image","onload","data-image-size","isFunction","onerror","widthEl","heightEl","altEl","_loadImage","_resizeImg","inputEl","_restoreImg","alt","$uploadBtn","onlySetVal","indentation","$hr","$nextBlock","td","col","th","_initShortcuts","$container","_tdNav","direction","$anotherTr","action","anotherTag","parentTag","_nextRow","_prevRow","initResize","$table","$colgroup","$resizeHandle","$wrapper","cant_td","max_td","$trr","$col","refreshTableWidth","class","contenteditable","pageX","$handle","$leftCol","$leftTd","$rightCol","$rightTd","minWidth","startHandleLeft","startLeftWidth","startRightWidth","startX","tableWidth","deltaX","leftWidth","rightWidth","wrap","createTable","$trs","prevAll","colNum","rowNum","$tbody","cols","tam","_changeCellTag","cell","$cell","$newTr","insertRow","cellTag","prepend","deleteCol","$newTd","noOtherCol","noOtherRow","insertCol","$newCol","$block","text-align","align","photo","visible","getVisible","setVisible","SidenavDirective","SidenavController","existUser","random","debounce","timer","context","buildDelayedToggler","navID","debug","toggleLeft","send","submenu","exist","bindToController","elem","slideUp","$this","slideToggle","SelectDateController","initDays","initMonths","initYears","ngModel","isDate","day","month","year","days","months","now","years","yearIni","yearEnd","oldValue","ngDisabled","ngRequired","ngLabel","PaletteFormlyController","addItem","elementos","expanded","acmeNavbar","NavbarController","profile","settings","getFirstName","fullscreen","cambiarUsuario","MenuCardController","titleTable","constant","simditorConfig","locale","content","iElm","iAttrs","contentEditable","changed","DocumentoIdentidadController","fecha_nacimiento","persona","complemento","nro_documento","tipo_documento","isDisabled","search","loading","tipos","onlyCi","CrudTableController","$state","getFields","seleccionando","existeSeleccionado","estadoModificado","getId","fieldsData","seleccionarTodos","prevent","getItems","openDialog","dataGrid","parseSave","saveAll","dataSave","promises","savePromise","edit","deleteItem","filterItem","column","done","answer","eventSave","query","onlyFields","estadoChecks","busqueda_estado","searchPro","tipo_busqueda","campo_seleccionado","check_fechas","fecha_inicio","subtractDays","fecha_final","addDays","setHours","filterItems","cont","filterFields","addPropertiesFormly","formly","xfield","arrindex","required","object","fkeys","addOptionSelected","optionSelected","setFormly","setHeaders","editable","types","getKeys","permissions","condiciones","searchField","fks","array","toType","lengthOptions","getFkData","formatDate","formatTime","orderItem","pos","print","PdfController","showFilter","removeFilter","$dirty","$setPristine","buttonEvent","bookmark","limit","sw_cite","current","read","limitOptions","rowSelection","multiSelect","autoSelect","decapitate","largeEditDialog","boundaryLinks","limitSelect","pageSelect","idShow","informacionBienes","rojo","celeste","lila","naranja","options_default","scales","yAxes","ticks","beginAtZero","xAxes","autoSkip","legend","boxWidth","tooltips","mode","bar","canvas","xchart","Chart","helper","FileReader","CanvasRenderingContext2D","extension","pUrl","lastIndexOf","$eval","ngMostrarThumb","getContext","drawImage","isFile","File","isImage","onLoadFile","onLoadImage","ngThumb","reader","readAsDataURL","CargadorArchivosController","fotosEliminar","queue","formatos","permitidos","filters","fn","clickUp","esImagen","anchoMiniatura","altoMiniatura","soloImagenes","maxArchivosPermitidos","getParent","getCurrent","BreadcrumbController","UtilFormlyFactory","parse","templates","$submitted","$setTouched","new_model","clearElem","filterDates","lista_templates","lista_valores","fg","clase","className","changeElement","grow","messages","idx","([a-zA-Zñáéíóú]+ ?)+","\\d+","([a-zA-Z0-9ñáéíóú]+ ?)+","^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$","^(0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]$","listToForm","nro_columnas","columnas","nro_filas","formulario","layout-gt-sm","layout-align-gt-sm","deshabilitar","todoMayuscula","onkeyup","onKeyup","validacion","expressionProperties","load_templates","labelProp","valueProp","vertical","showItem","step","discrete","secondaryPlaceholder","deleteButtonLabel","deleteHint","mTop","mBot","labelw","labelRef","de","encabezado","ccArchivo","labelCite","labelFecha","numeracionPagina","tipoHoja","labelx","num-cols","layout-align","UtilFactory","$injector","nano","isJson","truncate","stripHTML","getParams","defaultValue","second","popup","write","tmpl_print","$document","fullscreenElement","mozFullScreenElement","webkitFullscreenElement","msFullscreenElement","exitFullscreen","msExitFullscreen","mozCancelFullScreen","webkitExitFullscreen","documentElement","requestFullscreen","msRequestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","Element","ALLOW_KEYBOARD_INPUT","serialize","json","serializeToJson","limpiar","pages","idCanvasContainer","renderPage","viewport","getViewport","scale","createElement","renderContext","canvasContext","querySelector","renderPages","pdfDoc","numPages","getPage","PDFJS","workerSrc","disableWorker","getDocument","StorageFactory","appName","existSession","removeUser","getToken","$local","set","$session","sessionStorage","RouteValidatorFactory","$rootScope","$on","onStateChangeStart","toState","toParams","fromState","existeUsuario","rutaPermitida","tienePermiso","stopAutoSave","ruta_destino","submenu_rutas","plantillas","/plantillas","/plantilla/:idPlantilla","/usuario","/elegir","/rol","/menu","/documentos","/documento/:idDocumento","aprobacion","/aprobacion","progreso","/progreso","impresion","/impresion","en_curso","/en_curso","/firmar","monitoreo","/monitoreo","/contactos","PanelFactory","newPanelPosition","relativeTo","addPanelPosition","xPosition","ALIGN_END","yPosition","BELOW","absolute","center","default_template","attachTo","PanelController","panelClass","locals","openFrom","focusOnOpen","targetEvent","FormlyConfigFactory","formlyConfig","setType","ModalFactory","DialogController","$alert","htmlContent","ariaLabel","ok","$confirm","textContent","MessageFactory","$mdToast","timeout","typeIcon","EXITO","ERROR","ADVERTENCIA","INFORMACION","messageDefault","titleDefault","typeClass","ToastController","hideDelay","LoadingFactory","dataLocal","tiposDic","HttpInterceptorFactory","request","flag","base64Encode","cur","byteNum","digits","DocumentoFactory","new_url","absUrl","sw_url","abrirDialogPDF","firmas","showProgress","setAttrs","DialogProgreso","fecha_mos","dateLiteral","hora_mos","bg_color","ExpirationTimeFactory","$interval","fac","interval","getExpirationTime","autoSaveInterval","getPayload","tiempo","stopInterval","funcionGuardar","refreshToken","sw_inactive","ArrayUtilFactory","regex","fromIndex","toIndex","arr2","attrib","sw_obj","DatetimeFactory","pDate","dateMonth","getPrevDateMonth","convert","isValid","getTime","isLessThan","milliseconds","isLessThanDays","isGreaterThan","isGreaterThanDays","diff","date2","date1","setFormatDate","timeLiteral","txt","floor","hours","minutes","getSeconds","d","standar","monthLiteral","dayslong","getDay","getHours","getMinutes","daysBetweenTwoDates","weeks","hoursBetweenTwoDates","isYesterday","minutesBetweenTwoDates","seconds","secondsBetweenTwoDates","betweenTwoDates","s","abs","parseDate","parseDateDjango","AuthInterceptor","interceptor","requestError","when","responseError","rejection","$httpProvider","interceptors","msgError","putWithFiles","patch","postWithFiles","method","responseType","fileURL","URL","createObjectURL","trustAsResourceUrl","parseError","detail","non_field_errors","xcad","campo","error500","error404","error403","error401","errorConnection","option","ThemeConfig","$mdThemingProvider","theme","primaryPalette","accentPalette","runBlock","PageNoLogin","RouteValidator","MyFormlyConfig","paths","exitFullScreen","$toasts","keyCode","addEventListener","mozFullScreen","run","routerConfig","$stateProvider","$urlRouterProvider","otherwise","moment","$logProvider","$authProvider","authUrl","$mdDateLocaleProvider","$mdAriaProvider","debugEnabled","disableWarnings","loginUrl","tokenName","tokenPrefix","storageType","dateString","toDate","NaN","defaults","$templateCache"],"mappings":"CAAA,WACE,YAEAA,SACGC,OAAO,OACN,aACA,YACA,aACA,gBACA,iBACA,aACA,WACA,oBACA,oBACA,WACA,mBACA,cACA,4BACA,aAKN,WAEE,YAOA,SAASC,GAAqBC,EAAYC,EAASC,EAASC,EAAcC,EAAWC,EAAMC,EAAYC,EAAaC,EAASC,EAAOC,EAAWC,EAAUC,GA4CvJ,QAASC,KACmB,GAAnBC,EAAGC,cAEJD,EAAGE,cACHF,EAAGG,OAAUC,EAAQlB,EAAWmB,YAAY,UAC5CL,EAAGM,MAAUpB,EAAWmB,YAAY,SACpCL,EAAGO,OAAS,mBAEZd,EAAYe,IAAId,EAAU,qCAAuCM,EAAGC,cACnEQ,KAAK,SAAUC,GACZV,EAAGO,OAASG,EAAUC,MAAMJ,OAC5BP,EAAGY,YAAcF,EAAUC,MAAMC,YACjCZ,EAAGa,WAAa9B,QAAQ+B,SAASJ,EAAUC,MAAMI,iBACjDf,EAAGG,MAAQa,EAAajC,QAAQ+B,SAASJ,EAAUC,MAAMM,YACzDjB,EAAGM,KAAOvB,QAAQ+B,SAASJ,EAAUC,MAAMM,UAC3C,KAAK,GAAIC,GAAI,EAAGA,EAAIlB,EAAGM,KAAKa,OAAQD,IACX,kBAAjBlB,EAAGM,KAAKY,GAAGE,OAAyBpB,EAAGqB,uBAAwB,GAC9C,6BAAjBrB,EAAGM,KAAKY,GAAGE,OAAoCpB,EAAGsB,kCAAmC,EAG7F,OADAC,GAAiBvB,EAAGM,KAAK,IAClBb,EAAYe,IAAId,EAAU,2CAA2CM,EAAGY,eAElFH,KAAK,SAAUC,GACTA,EAAUC,MAAMa,MAAM,IACrBxB,EAAGyB,kBAAmB,KAMtC,QAASC,GAAcC,GACnBpC,EAAKqC,IAAI,mBAAmBD,GAC5BnC,EAAW,SAASqC,SAGxB,QAASC,KACL9B,EAAG+B,YAAc7C,EAAW8C,WAAWhC,EAAGM,MAEtCvB,QAAQkD,SAASjC,EAAGa,cAAab,EAAGa,WAAa3B,EAAWgD,WAAWlC,EAAGM,KAAMN,EAAGa,aACvFb,EAAGmC,cAAe,EAGtB,QAASC,KACL,GACIxB,GADAyB,EAAmBtD,QAAQuD,KAAKtC,EAAGa,WAEvC,IAAGb,EAAGO,OAAO,CACT,IAAK,GAAIgC,KAAKF,GACPE,EAAEC,QAAQ,qBAAwBD,EAAEC,QAAQ,uBACpCH,GAAiBE,GACE,IAArBF,EAAiBE,UACfF,GAAiBE,EAIhC,IAAItB,IACAV,OAAQP,EAAGO,OACXU,UAAWlC,QAAQ0D,OAAOzC,EAAGM,MAC7BS,gBAAiBhC,QAAQ0D,OAAOJ,GAChCK,kBAAmBC,EAAOC,GAG9BhC,GAAeZ,EAAG,iBAAmBA,EAAGY,YAAcd,EAAU+C,mBAAmB7C,EAAGO,QAEtFd,EAAYe,IAAId,EAAQ,iDAAiDkB,GACxEH,KAAK,SAAUC,GAEZ,GAAGA,GAAa3B,QAAQ+D,UAAUpC,EAAUC,OACxC,MAAOD,GAAUC,KAEjB,MAAM,IAAIoC,OAAM,mBAEvBtC,KAAK,SAAUuC,GACZ,GAGIC,GAASC,EAASC,EAHlBC,GAAO,GAAI,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,KACxIC,GAASC,EAAI,EAAGC,EAAI,EAAGC,EAAI,EAAGC,EAAI,EAAGC,EAAI,EAAGC,EAAI,EAAGC,EAAI,EAAGC,EAAI,EAAGC,EAAI,EAAGC,EAAI,GAAIC,EAAI,GAAIC,EAAI,GAAIC,EAAI,GAAIC,EAAI,GAAIC,EAAI,GAAIC,EAAI,GAAIC,EAAI,GAAIC,EAAI,GAAIC,EAAI,GAAIC,EAAI,GAAIC,EAAI,GAAIC,EAAI,GAAIC,EAAI,GAAIC,EAAI,GAAIC,EAAI,GAAIC,EAAI,GAKhN,IAFA7B,KACAC,GAAM,EACHH,EAAKgC,KAAKC,MAAM,CACfhC,EAAUD,EAAKgC,KAAKA,KAAK,GAAGpE,YAAYsE,MAAM,KAC9ChC,EAAUG,EAAKJ,EAAQ,GACvB,KAAK,GAAI/B,GAAI,EAAGA,EAAI8B,EAAKgC,KAAKA,KAAK7D,OAAQD,IACvC+B,EAAUD,EAAKgC,KAAKA,KAAK9D,GAAGN,YAAYsE,MAAM,KAC9ClC,EAAKgC,KAAKA,KAAK9D,GAAGiE,IAAMlC,EAAQ,GAC5BI,EAAKJ,EAAQ,IAAMC,IACnBA,EAAUG,EAAKJ,EAAQ,KACvBD,EAAKgC,KAAKA,KAAK9D,GAAGN,aAAaZ,EAAGY,cAClCuC,GAAM,EAGdD,KACAtC,GAAa,IAAIwC,EAAIF,GAGrBlD,EAAGC,aAAa,GAAK+C,EAAKoC,IAAIJ,KAAK,IAAMhC,EAAKoC,IAAIJ,KAAK,GAAGK,qBAAqBrF,EAAGC,eAClFW,EAAcZ,EAAGY,aAEjBZ,EAAGC,aAAa,GAAKkD,IACrBvC,EAAcZ,EAAGY,aAEA,GAAjBZ,EAAGC,cAAmBiD,OAA+B,GAAhBF,EAAKoC,IAAIH,QAC9CrE,GAAe,MACnBK,EAAUL,YAAcA,EAED,GAAnBZ,EAAGC,cAEHgB,EAAUyB,kBAAoBC,EAAOC,GACrCnD,EAAY6F,KAAK5F,EAAU,oCAAqCuB,GAC/DR,KAAK,SAAUC,GACZvB,EAAQoG,KAAK7E,EAAU8E,YAAa9E,EAAU+E,SAC9CnG,EAAUoG,KAAK,kBAInBzE,EAAU0E,sBAAwBhD,EAAOC,GACzCnD,EAAYmG,IAAIlG,EAAU,qCAAuCM,EAAGC,aAAcgB,GACjFR,KAAK,SAAUC,GACZvB,EAAQoG,KAAK7E,EAAU8E,YAAa9E,EAAU+E,SAC9CnG,EAAUoG,KAAK,uBAM3BvG,GAAQ0G,MAAM,oCAKtB,QAAS7E,GAAaV,GAElB,IAAK,GADDH,MACKe,EAAI,EAAGA,EAAIZ,EAAKa,OAAQD,IAC7B,GAAmB,WAAfZ,EAAKY,GAAGE,KACRjB,EAAM2F,KAAK1F,EAAQE,EAAKY,SACtB,CAEF,IAAK,GADD6E,MACKC,EAAI,EAAGA,EAAI1F,EAAKY,GAAG+E,WAAW9E,OAAQ6E,IAC3CD,EAASD,KAAK1F,EAASlB,EAAWgH,cAAc5F,EAAKY,GAAG+E,WAAWD,KAEvE1F,GAAKY,GAAG+E,WAAaF,EACrB5F,EAAM2F,KAAK1F,EAAQE,EAAKY,KAGhC,MAAOf,GA4BX,QAASgG,GAAcC,EAAOC,GAG1BA,EAAKC,cAAe,EACpBC,EAAaH,EAKjB,QAASI,KAEU,OAAXC,GAEIF,EAAaE,GAAWA,IAC5B7G,EAAU8G,MAAO1G,EAAGG,MAAOoG,EAAYE,GACvC7G,EAAU8G,MAAO1G,EAAGM,KAAMiG,EAAYE,SAC/BzG,GAAGG,MAAMsG,GAAUH,aAC1BC,EAAa,KACbE,EAAW,OAEM,OAAbE,EAI+C,WAA3C3G,EAAGG,MAAMoG,GAAYK,IAAIC,QAAQ,GAAGzF,KAChC0F,EAAW3F,OAAS4F,GACG,GAAnBD,EAAW3F,SAAYwF,EAAa,GACxC/G,EAAU8G,MAAO1G,EAAGG,MAAOoG,EAAYI,EAAYG,GACnDlH,EAAU8G,MAAO1G,EAAGM,KAAMiG,EAAYI,EAAYK,SAC3CF,GAAWH,GAAYL,qBAEvBtG,GAAGG,MAAMoG,GAAYD,aAC5BnH,EAAQ0G,MAAM,yCAGX7F,GAAGG,MAAMoG,GAAYD,aAC5BnH,EAAQ0G,MAAM,8DAGX7F,GAAGG,MAAMoG,GAAYD,aAEhCC,EAAa,KACbI,EAAa,MASrB,QAASM,GAAab,EAAOc,GACzB,GAAIC,EA+BAA,GAAc,MA7Bd,IAAgB,MAAZZ,GAAkC,MAAda,EAAoB,CAExC,GAAIC,GAAOH,CACX,KACI,GAAII,GAAe,4CACrB,IAAItH,EAAGqB,uBAAiC,kBAARgG,EAC9B,KAAMtE,OAAMuE,EAAeD,EAE7B,IAAIrH,EAAGsB,kCAA4C,6BAAR+F,EACzC,KAAMtE,OAAMuE,EAAeD,EAGjB,mBAARA,IAA0BrH,EAAGqB,uBAAwB,GAC7C,6BAARgG,IAAqCrH,EAAGsB,kCAAmC,GAC/E4F,EAAWhI,EAAWmB,YAAYgH,EAClC,IAAIhB,GAAOjG,EAAQ8G,EACC,IAAhBlH,EAAGM,KAAKa,SAAYiF,EAAQ,GAChCxG,EAAU2H,OAAQvH,EAAGG,MAAOiG,EAAOC,GACnCzG,EAAU2H,OAAQvH,EAAGM,KAAM8F,EAAOlH,EAAWgH,cAAcgB,UACpDlH,GAAGM,KAAK8F,GAAOoB,WACtB,MAAO3B,GACW,SAAdA,EAAM4B,MAAiBtI,EAAQ0G,MAAMA,EAAM6B,cAKjDjB,GAAWL,EAavB,QAASuB,GAAoBvB,EAAOC,EAAMuB,GAGtCvB,EAAKC,cAAe,EACpBc,EAAehB,EACfyB,EAAU7H,EAAGG,MAAMyH,GAAShB,IAAIC,QAAQ,GAAGZ,WAC3C6B,EAAU9H,EAAGM,KAAKsH,GAAS3B,WAO/B,QAAS8B,KACY,OAAbpB,GACIG,IAAae,GAETT,EAAeT,GAAaA,IAChC/G,EAAU8G,MAAOmB,EAAST,EAAcT,GACxC/G,EAAU8G,MAAOoB,EAASV,EAAcT,SACjCkB,GAAQlB,GAAYL,eAGJ,GAAnBQ,EAAW3F,SAAYwF,EAAa,GACxC/G,EAAU8G,MAAOmB,EAAST,EAAcT,EAAYG,GACpDlH,EAAU8G,MAAOoB,EAASV,EAAcT,EAAYK,SAC7CF,GAAWH,GAAYL,cAElCc,EAAe,KACfT,EAAa,OAEE,OAAXF,GAEA7G,EAAU8G,MAAOmB,EAAST,EAAcX,EAAUzG,EAAGG,OACrDP,EAAU8G,MAAOoB,EAASV,EAAcX,EAAUzG,EAAGM,YAC9CN,GAAGG,MAAMsG,GAAUH,oBAEnBuB,GAAQT,GAAcd,aAEjCc,EAAe,KACfX,EAAW,MAUnB,QAASuB,GAAmB5B,EAAOc,EAAUU,GAQzC,GAJAT,GAAc,EACdL,EAAa9G,EAAGG,MAAMyH,GAAShB,IAAIC,QAAQ,GAAGZ,WAC9Ce,EAAahH,EAAGM,KAAKsH,GAAS3B,WAC9Bc,EAAsB/G,EAAGG,MAAMyH,GAAShB,IAAIC,QAAQ,GAAGoB,kBAAkB,YACrD,MAAhBb,GAAsC,MAAdb,EAAoB,CAE5C,GAAIc,GAAOH,CACXA,GAAWhI,EAAWmB,YAAYgH,EAClC,IAAIhB,GAAOjG,EAAQ8G,EACT,WAANG,EACIP,EAAW3F,OAAS4F,GACE,GAAnBD,EAAW3F,SAAWiF,EAAQ,GACjCxG,EAAU2H,OAAQT,EAAaV,EAAOC,GACtCzG,EAAU2H,OAAQP,EAAYZ,EAAOlH,EAAWgH,cAAcgB,UACvDF,GAAWZ,GAAOoB,YAEzBrI,EAAQ0G,MAAM,iCAGlB1G,EAAQ0G,MAAM,2DAGlBc,GAAaP,EAQrB,QAAS8B,GAAeb,GACpB,IACI,GAAIrH,EAAGqB,uBAAiC,kBAARgG,EAC5B,KAAMtE,OAAM,6CAA+CsE,EAE/D,IAAIrH,EAAGsB,kCAA4C,6BAAR+F,EACvC,KAAMtE,OAAM,6CAA+CsE,EAGtD,mBAANA,IAAwBrH,EAAGqB,uBAAwB,GAC7C,6BAANgG,IAAmCrH,EAAGsB,kCAAmC,EAC5E,IAAI4F,GAAWhI,EAAWmB,YAAYgH,GAClChB,EAAOjG,EAAQ8G,EACnBlH,GAAGG,MAAM2F,KAAMO,GACfrG,EAAGM,KAAKwF,KAAM5G,EAAWgH,cAAcgB,UAChClH,GAAGM,KAAKN,EAAGM,KAAKa,OAAO,GAAGqG,WACnC,MAAO3B,GACa,SAAdA,EAAM4B,MAAiBtI,EAAQ0G,MAAMA,EAAM6B,UAYvD,QAASS,GAAa9B,EAAM+B,EAAaC,GACrC,GAAIC,EAGJ,IAFGvJ,QAAQ+D,UAAUsF,IAAcA,EAAYC,GAC/ChC,EAAKkC,KAAOrJ,EAAWgH,cAAcG,EAAKO,IAAIC,QAAQ,IACvB,SAA5BR,EAAKO,IAAIC,QAAQ,GAAGzF,MAA+C,UAA5BiF,EAAKO,IAAIC,QAAQ,GAAGzF,KAAiB,CAC3EiF,EAAKO,IAAIC,QAAQ,GAAG2B,WACpB,KAAKF,IAAMjC,GAAKO,IAAIC,QAAQ,GAAG4B,gBAAgBC,QAC3CrC,EAAKO,IAAIC,QAAQ,GAAG2B,SAAS1C,KAAKO,EAAKO,IAAIC,QAAQ,GAAG4B,gBAAgBC,QAAQJ,GAAIK,MAEtFtC,GAAKO,IAAIC,QAAQ,GAAG2B,SAAS1C,KAAO,WAChC8C,MAAMC,UAAU/C,KAAKgD,MAAMC,KAAMC,WACjC3C,EAAKO,IAAIC,QAAQ,GAAG4B,gBAAgBC,QAAQ5C,MACxC6C,MAAOK,UAAU,GACjBpG,GAAIoG,UAAU,MAGtB3C,EAAKO,IAAIC,QAAQ,GAAG2B,SAASS,OAAS,WAClCL,MAAMC,UAAUI,OAAOH,MAAMC,KAAMC,WACnC3C,EAAKO,IAAIC,QAAQ,GAAG4B,gBAAgBC,QAAQO,OAAOD,UAAU,GAAGA,UAAU,KAGlF,GAA+B,SAA5B3C,EAAKO,IAAIC,QAAQ,GAAGzF,KAAgB,CACnCiF,EAAKO,IAAIC,QAAQ,GAAG2B,WACpB,KAAKF,IAAMjC,GAAKO,IAAIC,QAAQ,GAAG4B,gBAAgBC,QAC3CrC,EAAKO,IAAIC,QAAQ,GAAG2B,SAAS1C,KAAKO,EAAKO,IAAIC,QAAQ,GAAG4B,gBAAgBC,QAAQJ,GAElFjC,GAAKO,IAAIC,QAAQ,GAAG2B,SAAS1C,KAAO,WAChC8C,MAAMC,UAAU/C,KAAKgD,MAAMC,KAAMC,WACjC3C,EAAKO,IAAIC,QAAQ,GAAG4B,gBAAgBC,QAAQ5C,KAAMkD,UAAU,KAEhE3C,EAAKO,IAAIC,QAAQ,GAAG2B,SAASS,OAAS,WAClCL,MAAMC,UAAUI,OAAOH,MAAMC,KAAMC,WACnC3C,EAAKO,IAAIC,QAAQ,GAAG4B,gBAAgBC,QAAQO,OAAOD,UAAU,GAAGA,UAAU,MAKtF,QAASzH,GAAiB2H,GACtB,GAAIC,GAAKD,EAAcT,eACvB,QAAQU,EAAGC,cACP,IAAK,eACDpJ,EAAGqJ,QAAU,IACjB,MACA,KAAK,UACDrJ,EAAGqJ,QAAUxJ,EAAQ,qBACzB,MACA,SACIG,EAAGqJ,QAAU,MAWzB,QAASC,GAASjD,EAAMnF,EAAGqI,GACvB,GAAIC,GAAOC,CAEX,IAAG1K,QAAQ2K,YAAYH,GAAK,CAWxB,GATAC,EAAQxJ,EAAGG,MAAM8I,OAAO/H,EAAGlB,EAAGM,KAAKa,QACnCqI,EAAMG,QAENF,EAAQrJ,IACRqJ,EAAM7C,IAAIC,QAAQf,KAAK5G,EAAWgH,cAAcG,EAAKO,IAAIC,QAAQ,KACjE2C,EAAMI,QAAQH,GACdzJ,EAAGG,MAAQH,EAAGG,MAAM0J,OAAOL,GAE3BxJ,EAAGM,KAAKY,GAAKhC,EAAWgH,cAAcG,EAAKO,IAAIC,QAAQ,IACnC,UAAjB7G,EAAGM,KAAKY,GAAGE,KAAe,CAGzB,IAAK,GADD2E,MACKC,EAAI,EAAGA,EAAIhG,EAAGM,KAAKY,GAAG+E,WAAW9E,OAAQ6E,IAC9CD,EAASD,KAAK5G,EAAWgH,cAAclG,EAAGM,KAAKY,GAAG+E,WAAWD,GAAGY,IAAIC,QAAQ,WACrEd,GAASA,EAAS5E,OAAO,GAAGqG,UAEvCxH,GAAGM,KAAKY,GAAG+E,WAAaF,QAErB/F,GAAGM,KAAKY,GAAGsG,WACE,QAAjBxH,EAAGM,KAAKY,GAAGE,MAAcG,EAAiBvB,EAAGM,KAAKY,QAGrDsI,GAAQxJ,EAAGG,MAAMoJ,GAAK3C,IAAIC,QAAQ,GAAGZ,WAAWgD,OAAO/H,EAAGlB,EAAGM,KAAKiJ,GAAKtD,WAAW9E,QAClFqI,EAAMG,QAENF,EAAQrJ,IACRqJ,EAAM7C,IAAIC,QAAQf,KAAK5G,EAAWgH,cAAcG,EAAKO,IAAIC,QAAQ,KACjE2C,EAAMI,QAAQH,GACdzJ,EAAGG,MAAMoJ,GAAK3C,IAAIC,QAAQ,GAAGZ,WAAajG,EAAGG,MAAMoJ,GAAK3C,IAAIC,QAAQ,GAAGZ,WAAW4D,OAAOL,GAEzFxJ,EAAGM,KAAKiJ,GAAKtD,WAAW/E,GAAKhC,EAAWgH,cAAcG,EAAKO,IAAIC,QAAQ,UAChE7G,GAAGM,KAAKiJ,GAAKtD,WAAW/E,GAAGsG,WACE,QAAjCxH,EAAGM,KAAKiJ,GAAKtD,WAAW/E,GAAGE,MAAcG,EAAiBvB,EAAGM,KAAKiJ,GAAKtD,WAAW/E,IAW7F,QAAS4I,GAAWzD,EAAMnF,EAAGqI,GACtBxK,QAAQ2K,YAAYH,IAEE,kBAAjBvJ,EAAGM,KAAKY,GAAGE,OACXpB,EAAGqB,uBAAwB,GACV,6BAAjBrB,EAAGM,KAAKY,GAAGE,OACXpB,EAAGsB,kCAAmC,GAC1CtB,EAAGG,MAAM8I,OAAO/H,EAAG,GACnBlB,EAAGM,KAAK2I,OAAO/H,EAAG,KAGmB,kBAAjClB,EAAGM,KAAKiJ,GAAKtD,WAAW/E,GAAGE,OAC3BpB,EAAGqB,uBAAwB,GACR,6BAAnBrB,EAAGM,KAAKY,GAAGE,OACXpB,EAAGsB,kCAAmC,GAC1CtB,EAAGG,MAAMoJ,GAAK3C,IAAIC,QAAQ,GAAGZ,WAAWgD,OAAO/H,EAAG,GAClDlB,EAAGM,KAAKiJ,GAAKtD,WAAWgD,OAAO/H,EAAG,IAQ1C,QAAS6I,GAAe1D,GACpBA,EAAKO,IAAIC,QAAQ8C,QACjBtD,EAAKO,IAAIC,QAAQf,KAAKO,EAAKkC,MAO/B,QAASnI,GAAQ8G,GACb,OAASN,KAAMC,QAAS,GAAaK,MAAiB8C,UAAYzB,SAGtE,QAAS0B,GAAS5D,EAAMgC,EAAOjC,EAAOwB,GAClC,GAAItH,IACA+F,KAAMA,EACND,MAAOA,EACPwB,QAASA,GAGTsC,GACA7B,MAAOA,EACP/H,KAAMA,EACN6J,qBAAqB,EACrBC,eAAc,EACdC,YAAa,SAAU,WAAY,OAAQ,aAAaC,GACxDC,YAAa,oEAEjB5K,GAAM4F,KAAK2E,GAGf,QAASI,GAAoBE,EAAQC,EAAUnK,EAAMoK,GAiDjD,QAASC,KACL3K,EAAGsJ,SAAShJ,EAAK+F,KAAM/F,EAAK8F,MAAO9F,EAAKsH,SACxCgD,IAEJ,QAASC,KACL7K,EAAG8J,WAAWxJ,EAAK+F,KAAM/F,EAAK8F,MAAO9F,EAAKsH,SAC1CgD,IAEJ,QAASE,KAGL9K,EAAG+J,eAAezJ,EAAK+F,MACvBuE,IAEJ,QAASA,KACLF,GAAcA,EAAWK,QAAQtK,KAAK,WAAaiK,EAAWM,YA/DlE,GAAIC,GAAMT,CACVS,GAAI5E,KAAO/F,EAAK+F,KAChB4E,EAAIC,YAAc,KAClBD,EAAIE,aAAe,KACnBF,EAAIG,SACAC,eAAgB,kBAChBC,OAAQ,SACRC,YAAa,kBACbC,uBAAwB,0BACxBC,OAAQ,SACRC,UAAW,YACXC,QAAS,UACTC,MAAO,QACPC,OAAQ,aACRC,MAAO,UACPC,MAAO,kBACPC,MAAO,kBACPC,OAAQ,mBACRC,gBAAiB,qBACjBC,SAAU,gBACVC,SAAU,WACVC,WAAY,aACZC,OAAQ,aACRC,SAAQ,cACRC,MAAO,iBACPC,UAAW,aACXC,0BAA2B,6BAC3BC,eAAgB,qBAChBC,WAAY,iBAIhB3B,EAAIN,UAAYA,EAChBM,EAAIJ,YAAcA,EAClBI,EAAIH,gBAAkBA,EAGtB9K,EAAGmI,aAAa8C,EAAI5E,MACpB4E,EAAIE,eACE1D,KAAM,UAAWoF,QAAS,KAC1BpF,KAAM,aAAcoF,QAAS,yBAC7BpF,KAAM,eAAgBoF,QAAS,SAC/BpF,KAAM,kBAAmBoF,QAAS,4BAClCpF,KAAM,aAAcoF,QAAS,wCAC7BpF,KAAM,QAASoF,QAAS,4KAuBlC,QAASC,KAC2C,GAA5C5N,EAAW6N,QAAQ/M,EAAGgN,aAAaC,QACnCnN,EAAUoN,QAAQnO,QAAQ0D,OAAOzC,EAAGM,MAAOvB,QAAQ0D,OAAOzC,EAAGa,YAAa,UAE1E3B,EAAWiO,mBAAmBnN,EAAGgN,aAAaC,QA7oBtD,GAAIjN,GAAK+I,KAELxC,EAAa,KACbE,EAAW,KAEXW,EAAe,KACfT,EAAa,KACbQ,GAAc,EACdU,EAAU,KACVC,EAAU,KACVhB,EAAa,KACbE,EAAa,KACbD,EAAsB,KAEtBpE,EAASvD,EAAQgO,SACrBpN,GAAGC,aAAeZ,EAAagO,YAC/BrN,EAAGa,cACHb,EAAGG,SACHH,EAAGM,QACHN,EAAGyB,kBAAmB,EACtBzB,EAAGqB,uBAAwB,EAC3BrB,EAAGsB,kCAAmC,EACtCtB,EAAGqJ,QAAU,KAGbrJ,EAAGkI,eAAiBA,EACpBlI,EAAGsJ,SAAWA,EACdtJ,EAAG8J,WAAaA,EAChB9J,EAAGmI,aAAeA,EAClBnI,EAAG+J,eAAiBA,EACpB/J,EAAGiH,aAAeA,EAClBjH,EAAGwG,YAAcA,EACjBxG,EAAGmG,cAAgBA,EACnBnG,EAAGgI,mBAAqBA,EACxBhI,EAAG+H,kBAAoBA,EACvB/H,EAAG2H,oBAAsBA,EACzB3H,EAAGoC,iBAAmBA,EACtBpC,EAAG8B,YAAcA,EACjB9B,EAAG8M,OAASA,EACZ9M,EAAGiK,SAAWA,EACdjK,EAAG0B,cAAgBA,EAEnB3B,IAhDFd,EAAoBqO,SAAW,aAAc,UAAW,UAAW,eAAgB,YAAa,OAAQ,aAAc,cAAe,UAAW,QAAS,YAAa,UAAW,aAAjLvO,QACGC,OAAO,OACPqL,WAAW,sBAAuBpL,MAwpBvC,WACE,YAOA,SAASsO,GAAoB9N,EAAaC,EAAS8N,EAAOrO,EAASD,EAAYE,EAASC,EAAcC,EAAWO,EAASF,EAAOG,EAAW2N,GA0B1I,QAASC,KACP1N,EAAG2N,mBAAmB,EACC,GAAjB3N,EAAG4N,aAE0B,MAA1BxO,EAAQyO,WAAW,OAClBC,EAAgB1O,EAAQyO,WAAW,OACnC7N,EAAG+N,YAAa,EAChBC,IACAhO,EAAGiO,MAAO,EACVR,EAAeS,aAAaC,GAAS,GACrChP,EAAQoG,KAAK,cAAe,gFACzBjG,EAAUoG,KAAK,cAGtBjG,EAAYe,IAAId,EAAU,8BAA8BM,EAAG4N,cAC1DnN,KAAK,SAAU2N,GASZ,GARAhP,EAAQiP,WAAW,KAAMD,EAAUzN,OAChCyN,EAAUzN,MAAM+B,mBAAmBC,EAAOC,IACzCtD,EAAUoG,KAAK,cACnBoI,EAAgBM,EAAUzN,OAAO,GACjCX,EAAGsO,aAAwC,aAAxBF,EAAUzN,MAAM4N,OACnCvO,EAAG+N,WAAuC,SAAxBK,EAAUzN,MAAM4N,SAAoBvO,EAAGsO,aAEzDpP,EAAWsP,YAAYxO,EAAGyO,YAAazO,EAAG+N,YACvC/N,EAAG+N,WAAW,CACb,GAAIW,IACAC,WAAYP,EAAUzN,MAAMgO,WAC5BC,KAAM7P,QAAQ+B,SAASsN,EAAUzN,MAAMiO,MACvCC,IAAK9P,QAAQ+B,SAASsN,EAAUzN,MAAMkO,KAE1CzP,GAAQiP,WAAW,YAAYK,GAEnCjB,EAAeS,aAAaC,EAASnO,EAAG+N,YACxC5O,EAAQoG,KAAK,cAAe,+EAC5ByI,IACAhO,EAAGiO,MAAO,IAItB,QAASD,KAGP,IAAK,GAF+Bc,GAAhCC,GAA0B,EAC1BzO,EAAOvB,QAAQ+B,SAASd,EAAGgP,IAAI/N,WAC1BC,EAAI,EAAGA,EAAIZ,EAAKa,OAAQD,IAAK,CACpC,GAAkB,UAAdZ,EAAKY,GAAGE,KACR,IAAK,GAAI4E,GAAI,EAAGA,EAAI1F,EAAKY,GAAG+E,WAAW9E,OAAQ6E,IACH,cAAtChG,EAAGyO,YAAYvN,GAAG+E,WAAWD,GAAG5E,OAClC0N,GAAS,GAAIG,OAAOC,oBACpBH,EAAmC,KAARD,OAIL,cAAxB9O,EAAGyO,YAAYvN,GAAGE,OACpB0N,GAAS,GAAIG,OAAOC,oBACpBH,EAAmC,KAARD,EAG/B,KAAKC,EAAyB,MAG3BA,GAA4B/O,EAAG+N,YAAYoB,EAAiB,YAGnE,QAASC,KACL5B,EAAM6B,QAAQ,gEAAiE,WAC3E,GAAIrF,GAAQjL,QAAQuD,KAAKtC,EAAGsP,oBACrBtF,GAAM,UAETA,EAAM,qBAAuBA,EAAM,oBAAoBuF,gBAChDvF,GAAM,oBAAoBuF,QAGrC,IAAIC,IACAjP,OAAQP,EAAGgP,IAAIS,iBACfA,iBAAkBzP,EAAGgP,IAAIS,iBACzB7O,YAAaZ,EAAGgP,IAAIpO,YACpBK,UAAWjB,EAAGgP,IAAI/N,UAClBF,gBAAiBhC,QAAQ0D,OAAOuH,GAChC0F,cAAe,MAIfC,GACFpP,OAAQiP,EAAGjP,OACXK,YAAa4O,EAAG5O,YAChBK,UAAWuO,EAAGvO,UAGhBxB,GAAY6F,KAAK5F,EAAU,8CAA+CiQ,GACzElP,KAAK,QAASC,GAAWA,GACrBA,EAAUC,MAAMiP,UAAW,GAC5BxQ,EAAQiP,WAAW,KAAKmB,GACxBlQ,EAAUoG,KAAK,gBAGfvG,EAAQoG,KAAK,QAAS,6FAMlC,QAASuI,GAAgB0B,EAAIxF,GAEzBhK,EAAGsP,aAAoC,MAApBE,EAAGzO,mBAA6BhC,QAAQ+B,SAAS0O,EAAGzO,iBACpEiJ,EACChK,EAAGyO,YAAcvP,EAAW8C,WAAWjD,QAAQ+B,SAAS0O,EAAGvO,WAAYjB,EAAGsP,cAE1EtP,EAAGyO,YAAcvP,EAAW8C,WAAWjD,QAAQ+B,SAAS0O,EAAGvO,YAE/DM,EAAiBvB,EAAGyO,YAAY,IAEhCzO,EAAGgP,IAAIzO,OAAS,EAASiP,EAAGjP,OAASiP,EAAGjP,OAAO,MAAMoC,EAAOkN,WAAW,IAAIlN,EAAOmN,UAClF9P,EAAGgP,IAAIS,iBAAmB,EAASD,EAAGC,iBAAmBD,EAAGjP,OAC5DP,EAAGgP,IAAIpO,YAAc4O,EAAG5O,YACxBZ,EAAGgP,IAAI/N,UAAYuO,EAAGvO,UACtBjB,EAAGgP,IAAIU,cAAgB,EAASF,EAAGE,cAAgB,KACnD1P,EAAG+P,gBAAkBP,EAAGQ,kBAAmB,EACxChQ,EAAG+P,kBACF/P,EAAGgP,IAAIgB,gBAAkBR,EAAGQ,iBAGhChQ,EAAGiQ,SAAWT,EAAGU,QAAS,EACvBlQ,EAAGiQ,UAEFxQ,EAAYe,IAAId,EAAU,uIAAuI8P,EAAGU,OACnKzP,KAAK,SAAU2N,GACZpO,EAAGmQ,WAAa/B,EAAUzN,MAAMyN,YAM5C,QAASgC,GAAaC,GAAUvQ,EAAUwQ,UAAUD,GAAQ,GAE5D,QAAS9O,GAAiB2H,GACtB,GAAIC,GAAKD,EAAcT,iBAAmB,cAC1C,QAAQU,EAAGC,cACP,IAAK,eACDpJ,EAAGqJ,QAAU,IACjB,MACA,KAAK,UACDrJ,EAAGqJ,QAAUxJ,EAAQ,uBAKjC,QAAS0Q,GAAaC,EAAWC,GAC7B,GAAGA,EAAO,CACN,GAAIlO,GAAGmO,EAAKC,EAAKzP,CAOjB,KANAqB,EAAImO,EAAM,OACVF,EAAUjO,GAAKxD,QAAQ0D,QAAQzC,EAAGsP,aAAa,oBAAoBoB,GAAKE,aAExErO,EAAImO,EAAM,MACVC,EAAM3Q,EAAGsP,aAAa,oBAAoBoB,OAC1CF,EAAUjO,MACLrB,EAAI,EAAGA,EAAIyP,EAAIxP,OAAQD,IACxBsP,EAAUjO,GAAGuD,KAAK6K,EAAIzP,GAAG0P,WAO7B,KALAJ,EAAUjO,GAAKxD,QAAQ0D,OAAO+N,EAAUjO,GAAGsO,WAE3CtO,EAAImO,EAAM,KACVC,EAAM3Q,EAAGsP,aAAa,oBAAoBoB,GAC1CF,EAAUjO,MACLrB,EAAI,EAAGA,EAAIyP,EAAIxP,OAAQD,IACxBsP,EAAUjO,GAAGuD,KAAK6K,EAAIzP,GAAG0P,WAE7BJ,GAAUjO,GAAKxD,QAAQ0D,OAAO+N,EAAUjO,IAExCA,EAAI,aAAemO,EAAM,MACzBF,EAAUjO,GAAKvC,EAAGsP,aAAa,oBAAoBoB,IAG3D,QAASI,GAAiB9G,GAGtB,IADA,GAAW+G,GAAP7P,EAAI,EACDA,QACH6P,EAAO/G,EAAM,WAAW9I,IACrBnC,QAAQ2K,YAAYqH,KACpBhS,QAAQ2K,YAAYqH,EAAK5P,UACxB6I,EAAM,WAAW9I,IAAM6P,IAE3B7P,GAEJ,OAAOnC,SAAQ0D,OAAOuH,GAG1B,QAASmE,GAAQsC,EAAQO,GACvB,KAAGhR,EAAG2N,mBAAqB,GAA3B,CAGA,GAAI6C,IACAjQ,OAAQP,EAAGgP,IAAIzO,OACfkP,iBAAkBzP,EAAGgP,IAAIS,iBACzB7O,YAAaZ,EAAGgP,IAAIpO,YACpBK,UAAWjB,EAAGgP,IAAI/N,UAClBF,gBAAiB+P,EAAiB/R,QAAQuD,KAAKtC,EAAGsP,eAGnDtP,GAAG+P,kBACJS,EAAUR,gBAAkBhQ,EAAGgP,IAAIgB,iBAGhChQ,EAAG+N,YAAYwC,EAAaC,EAAWC,GAEtB,GAAjBzQ,EAAG4N,aACJ4C,EAAU9N,kBAAoBC,EAAOC,IAErC4N,EAAU7K,sBAAwBhD,EAAOC,GACzC4N,EAAU5N,GAAK5C,EAAG4N,cAEtB4C,EAAUS,IACNR,OAAQA,EACRS,QAASlR,EAAG+N,WACZoD,aAAcnR,EAAG+P,iBAGrBtQ,EAAY2R,KAAM1R,EAAQ,8BAA+B8Q,GACxD/P,KAAK,SAAUC,GACRsQ,EAIsB,GAAjBhR,EAAG4N,cAAiBtO,EAAUoG,KAAK,aAAahF,EAAUC,MAAMiN,eAHrEzO,EAAQoG,KAAK7E,EAAU8E,YAAa9E,EAAU+E,SAC9CnG,EAAUoG,KAAK,cACftG,EAAQiS,cAAc,OAE1BrR,EAAG2N,mBAAmB,KAI5B,QAAS2D,GAAiBb,GACxBzQ,EAAG2N,oBAAsB,EAEpB8C,EACwC,GAArCvR,EAAW6N,QAAQ/M,EAAGuR,MAAMtE,QAC5BkB,EAAQsC,IAEVvR,EAAWiO,mBAAmBnN,EAAGuR,MAAMtE,QACvC9N,EAAQoG,KAAK,QAAS,uEAAuEiM,eAC7FrC,EAAiB,SACjBnP,EAAG2N,mBAAmB,GAIxBQ,IAMN,QAASsD,KACL,KAAIzR,EAAG2N,mBAAqB,GAA5B,CAGA,GAAI6C,IACFjQ,OAAQP,EAAGgP,IAAIzO,OACfkP,iBAAkBzP,EAAGgP,IAAIS,iBACzB7O,YAAaZ,EAAGgP,IAAIpO,YACpBK,UAAWjB,EAAGgP,IAAI/N,UAClBF,gBAAiB+P,EAAiB/R,QAAQuD,KAAKtC,EAAGsP,eAGhDtP,GAAG+P,kBACLS,EAAUR,gBAAkBhQ,EAAGgP,IAAIgB,iBAGhChQ,EAAG+N,YAAYwC,EAAaC,GAAW,GAErB,GAAnBxQ,EAAG4N,aACL4C,EAAU9N,kBAAoBC,EAAOC,IAErC4N,EAAU7K,sBAAwBhD,EAAOC,GACzC4N,EAAU5N,GAAK5C,EAAG4N,cAEpB4C,EAAUS,IACRR,QAAQ,EACRS,QAASlR,EAAG+N,WACZoD,aAAcnR,EAAG+P,iBAGnBtQ,EAAY2R,KAAK1R,EAAU,8BAA+B8Q,GACzD/P,KAAK,SAAUC,GAMW,GAAnBV,EAAG4N,cAAmBtO,EAAUoG,KAAK,aAAehF,EAAUC,MAAMiN,cACxE5N,EAAG2N,mBAAqB,KAKhC,QAASwB,GAAiB9H,GACxB,GAAI6C,IACF5J,KAAM+G,EACNkD,YAAa,qEACbF,YAAa,OAAQ,SAAU,YAAaqH,GAE9ClE,GAAMjI,KAAK2E,GAGb,QAASwH,GAAsBpR,EAAMkK,EAAQmH,GAC3C,GAAIC,GAAMpH,CACVoH,GAAItR,MAAM+G,KAAK/G,GAEfsR,EAAIC,OAAQ,WACVF,EAAUG,UAId,QAASC,KACLzS,EAAUoG,KAAK,cAGnB,QAAS5D,KACoC,GAArC5C,EAAW6N,QAAQ/M,EAAGuR,MAAMtE,QAC5BnN,EAAUoN,QAAQlN,EAAGgP,IAAI/N,UAAWlC,QAAQ0D,OAAOzC,EAAGsP,cAAetP,EAAGgP,IAAIzO,SAE5EpB,EAAQoG,KAAK,cAAe,6EAC5BrG,EAAWiO,mBAAmBnN,EAAGuR,MAAMtE,SAI/C,QAAS+E,KACL,GAAI9H,IACA5J,KAAM,GACNiK,YAAa,6CACbF,YAAa,OAAQ,SAAU,YAAa,OAAQ,gBAAiB4H,GAEzEzE,GAAMjI,KAAK2E,GAGf,QAAS+H,GAAyB3R,EAAMkK,EAAQmH,EAAWO,EAAMC,GA6C7D,QAASC,KACDR,EAAIS,aAAc,IAClBT,EAAIS,WAAY,EAChBF,EAAcG,aACb7R,KAAM,SAAU8R,GAEbX,EAAIS,WAAY,EAChBT,EAAIY,UAAW,EACfZ,EAAIa,qBAAsB,EAC1Bb,EAAIc,OAASH,EAAS5R,MACtBiR,EAAIe,gBAAkBJ,EAAS5R,MAAMQ,OAAS,IAPlDgR,SASQ,WAEJP,EAAIS,WAAY,EAChBT,EAAIY,UAAW,EACfZ,EAAIe,iBAAkB,EACtBf,EAAIa,qBAAsB,KAWtC,QAASG,KACLhB,EAAIiB,kBAAmB,EACvBjB,EAAIkB,cAAe,EAGnBX,EAAcY,MAAMnB,EAAIoB,KACvBvS,KAAK,SAAUwS,GAEZrB,EAAIiB,kBAAmB,EACvBjB,EAAIkB,cAAe,EACfG,EAAUC,cAAe,IACzBtB,EAAIuB,6BAA8B,EAElCvB,EAAIwB,aAAc,EAElBjB,EAAckB,mBACb5S,KAAK,SAAU6S,GACZ1B,EAAI2B,aAAeD,EAAS3S,MACxBiR,EAAI2B,aAAa,KACjB3B,EAAI4B,yBAA2B5B,EAAI2B,aAAa,SAdhEpB,SAmBQ,WAEJP,EAAIiB,kBAAmB,EACvBjB,EAAIkB,cAAe,EACnBlB,EAAIoB,IAAMS,OACV7B,EAAIwB,aAAc,EAClBxB,EAAIuB,6BAA8B,IAM1C,QAASO,KACLvB,EAAcuB,oBAGlB,QAASC,KACLhC,EAAUG,SAjHd,GAAIF,GAAMpH,CACVoH,GAAItR,QAGJsR,EAAIY,UAAW,EACfZ,EAAIoB,IAAMS,OACV7B,EAAIc,UACJd,EAAI2B,gBAEJ3B,EAAIY,UAAW,EACfZ,EAAIS,WAAY,EAChBT,EAAI4B,yBAA2BC,OAE/B7B,EAAIwB,aAAc,EAClBxB,EAAIkB,cAAe,EAEnBlB,EAAIa,qBAAsB,EAC1Bb,EAAIe,iBAAkB,EACtBf,EAAIuB,6BAA8B,EAClCvB,EAAIiB,kBAAmB,EAGvBjB,EAAItR,KAAKsT,KAAKtT,EAAKsT,KACnBhC,EAAItR,KAAKuT,IAAIvT,EAAKuT,IAClBjC,EAAItR,KAAKwT,WAAU,EACnBlC,EAAItR,KAAKyT,UAAUzT,EAAK0T,mBACpB1T,EAAK0T,oBACL9B,EAAK+B,WAAW3T,EAAK4T,WAAY,oBAUrCtC,EAAIQ,wBAA0BA,EAC9BR,EAAIgB,WAAaA,EACjBhB,EAAI+B,SAAWA,EACf/B,EAAI8B,kBAAoBA,EAExBtB,IA4EJ,QAAS+B,GAAiB9L,GACtB,GAAI/H,IACA8T,YAAapU,EAAGgP,IAAIU,eAAiB,yBAErCxF,GACA7B,MAAOA,EACP/H,KAAMA,EACN+J,YAAa,SAAU,OAAQ,aAAaC,GAC5CC,YAAa,2EAEjB5K,GAAM4F,KAAK2E,GAGf,QAASI,GAAoBE,EAAQlK,EAAMoK,GAOvC,QAASE,KACLF,GAAcA,EAAWK,QAAQtK,KAAK,WAAaiK,EAAWM,YAPlE,GAAIC,GAAMT,CACVS,GAAImJ,YAAc9T,EAAK8T,YAGvBnJ,EAAIL,WAAaA,EA3erB,GAAI5K,GAAK+I,KACLpG,EAASvD,EAAQgO,SAErBpN,GAAG4N,aAAevO,EAAagV,YAC/BrU,EAAGiO,MAAO,EACVjO,EAAGsP,gBACHtP,EAAGyO,eACHzO,EAAGgP,OACHhP,EAAG+N,YAAa,EAChB/N,EAAGsO,cAAe,EAClBtO,EAAGqJ,QAAU,KAGbrJ,EAAG8N,gBAAkBA,EACrB9N,EAAGsR,iBAAmBA,EACtBtR,EAAGyR,eAAiBA,EACpBzR,EAAG8B,YAAcA,EACjB9B,EAAGgS,OAASA,EACZhS,EAAG+R,YAAcA,EACjB/R,EAAGmU,iBAAmBA,EACtBnU,EAAGoQ,aAAeA,EAClBpQ,EAAGoP,gBAAkBA,EAErB1B,IA5BFH,EAAoBD,SAAW,cAAe,UAAW,QAAS,UAAW,aAAc,UAAW,eAAgB,YAAa,UAAW,QAAS,YAAa,kBADpKvO,QACGC,OAAO,OACPqL,WAAW,sBAAuBkD,MA0fvC,WACE,YAOA,SAAS+G,GAAc5U,EAASN,GAa9B,QAASmV,GAAoBjU,EAAMnB,EAASqL,EAAQmH,EAAWlS,EAAaC,EAAS8U,GAajF,QAASC,KACF7C,EAAItR,KAAKoU,OACRjV,EAAYe,IAAId,EAAQ,2CACvBe,KAAK,SAASC,GAGX,MAFAkR,GAAI+C,MAAQjU,EAAUC,MAAMyN,UAErB3O,EAAYe,IAAId,EAAQ,iBAAiBkS,EAAItR,KAAKoU,OAAO,WAEnEjU,KAAK,SAASC,GACXkR,EAAIgD,UAAYlU,EAAUC,KAE1B,KAAK,GAAIO,GAAI,EAAGA,EAAI0Q,EAAIgD,UAAUzT,OAAQD,IACtC,IAAK,GAAI8E,GAAI,EAAGA,EAAI4L,EAAI+C,MAAMxT,OAAQ6E,IAC/B4L,EAAIgD,UAAU1T,GAAG2T,UAAYjD,EAAI+C,MAAM3O,GAAG8O,UACzClD,EAAI+C,MAAM3O,GAAG+O,QAAsC,UAA3BnD,EAAIgD,UAAU1T,GAAGqN,OACzCvI,EAAI4L,EAAI+C,MAAMxT,UAO9B1B,EAAYe,IAAId,EAAQ,2CACvBe,KAAK,SAASC,GACXkR,EAAI+C,MAAQjU,EAAUC,MAAMyN,YAMxC,QAAS4G,KACL,GAAIC,IACAC,KACIR,OAAQ9C,EAAItR,KAAKoU,OACjBnU,OAAQqR,EAAItR,KAAKC,OACjB4U,YAAavD,EAAItR,KAAK6U,YACtBC,KAAMxD,EAAItR,KAAK8U,KACf7G,OAAQqD,EAAItR,KAAKiO,QAErBoG,SAGJ,IAAI/C,EAAItR,KAAKoU,OAAQ,CACjBO,EAAYC,IAAIvP,sBAAwBhD,EAAOC,GAC/CqS,EAAYI,eACZ,KAAK,GAAInU,GAAI,EAAGA,EAAI0Q,EAAI+C,MAAMxT,OAAQD,IAAK,CAEvC,IAAK,GADDoU,IAAS,EACJtP,EAAI,EAAGA,EAAI4L,EAAIgD,UAAUzT,OAAQ6E,IACnC4L,EAAI+C,MAAMzT,GAAG4T,SAAWlD,EAAIgD,UAAU5O,GAAG6O,WAGxCjD,EAAIgD,UAAU5O,GAAGuI,OAAUqD,EAAI+C,MAAMzT,GAAG,QAAU,SAAW,WAC7D0Q,EAAIgD,UAAU5O,GAAGL,sBAAwBhD,EAAOC,SACzCgP,GAAIgD,UAAU5O,GAAGuP,sBACjB3D,GAAIgD,UAAU5O,GAAGwP,oBACxBP,EAAYN,MAAM7O,KAAK/G,QAAQ+B,SAAS/B,QAAQ0D,OAAOmP,EAAIgD,UAAU5O,MACrEsP,GAAS,EACTtP,EAAI4L,EAAIgD,UAAUzT,SAGtBmU,GAAU1D,EAAI+C,MAAMzT,GAAG6T,SACvBE,EAAYI,aAAavP,KAAK8L,EAAI+C,MAAMzT,GAAG4T,SAInDrV,EAAYmG,IAAIlG,EAAQ,iBAAiBkS,EAAItR,KAAKoU,OAAO,QAASO,GACjExU,KAAK,SAAUC,GACZvB,EAAQoG,KAAK7E,EAAU8E,YAAY9E,EAAU+E,SAC7CkM,EAAU8D,OACVjB,EAAS,WACLzV,QAAQ8H,QAAQ,0BAA0B6O,SAC3C,WAEN,CAGD,IAFAT,EAAYC,IAAIxS,kBAAoBC,EAAOC,GAEtC1B,EAAI,EAAGA,EAAI0Q,EAAI+C,MAAMxT,OAAQD,IAC3B0Q,EAAI+C,MAAMzT,GAAG6T,SACZE,EAAYN,MAAM7O,KAAK8L,EAAI+C,MAAMzT,GAAG4T,QAG5CrV,GAAY6F,KAAK5F,EAAQ,uBAAwBuV,GAChDxU,KAAK,SAAUC,GACZvB,EAAQoG,KAAK7E,EAAU8E,YAAY9E,EAAU+E,SAC7CkM,EAAU8D,OACVjB,EAAS,WACLzV,QAAQ8H,QAAQ,0BAA0B6O,SAC3C,QAKf,QAAS7D,KACLF,EAAUG,SAzGd,GAAIF,GAAMpH,CAEVoH,GAAIC,OAASA,EACbD,EAAIoD,aAAeA,EACnBpD,EAAItR,KAAOA,EACXsR,EAAI+D,UAAY/S,GAAG,SAAU6E,KAAM,WAAW7E,GAAG,WAAY6E,KAAM,aAI9DmK,EAAItR,KAAKoU,SAAQ9C,EAAItR,KAAKiV,gBAAkB,GAAItG,OACrD2C,EAAItR,KAAKkV,oBAAsB,GAAIvG,MACnCwF,IAxBJ,GAAIzU,GAAK+I,KAELpG,EAAOvD,EAAQgO,SACnBpN,GAAG4V,QAAUjT,EAAOC,GAGpB5C,EAAG6V,IAAMnW,EAAQ,iBACjBM,EAAG8V,QAAU,SAAS,SAAS,cAAc,OAAO,SAAS,kBAAkB,uBAC/E9V,EAAGyL,OAAS,QACZzL,EAAG+V,kBAAoB,OAAQ,UAAW,SAAU,YAAa,cAAe,UAAW,WAAYxB,GACvGvU,EAAGkH,SAAW,4CAdhBoN,EAAchH,SAAW,UAAW,WAFpCvO,QACGC,OAAO,OACPqL,WAAW,gBAAiBiK,MAkIjC,WACE,YAOE,SAAS0B,GAAe5W,EAASM,GAE7B,GAAIM,GAAG+I,IAEP/I,GAAG6V,IAAMnW,EAAU,kBACnBM,EAAG8V,QACC,UACA,iBACA,SACA,cACA,QACA,OACA,QACA,SACA,kBACA,uBAGJ9V,EAAGyL,OAAS,OAEZ,IAAI9I,GAAOvD,EAAQgO,SACnBpN,GAAG4V,QAAUjT,EAAOC,GAvBxBoT,EAAe1I,SAAW,UAAW,WAHvCvO,QACGC,OAAO,OACPqL,WAAW,iBAAkB2L,MA6BlC,WACE,YAOA,SAASC,GAAmBzL,EAAQ/K,EAAaC,EAASN,EAAS8W,EAAM5W,EAAWQ,EAAWoS,GAC3F,GAAIlS,GAAK+I,KACLoN,EAAe/W,EAAQyO,WAAW,eAErB,OAAdsI,EAAoB7W,EAAUoG,KAAK,eAElCjG,EAAYoU,IAAInU,EAAQ,kCAAkC0W,KAAMD,EAAa5V,SAC5EE,KAAK,SAAU4V,GACVA,IACFF,EAAatC,IAAMwC,EAAaR,IAChCM,EAAajC,WAAamC,EAAa/V,KAGvCN,EAAG4T,KAAKuC,EAAavC,KACrB5T,EAAG6T,IAAIsC,EAAatC,IACpB7T,EAAG8T,WAAU,EACTqC,EAAaG,qBAAoBtW,EAAG8T,WAAU,GAClD9T,EAAG+T,UAAUoC,EAAanC,mBACrBmC,EAAanC,oBAChB9B,EAAK+B,WAAWkC,EAAajC,WAAY,oBAG3ClU,EAAGuW,QAAU,WAAYvW,EAAG8T,WAAU,GACtC9T,EAAG8M,OAAS,WAAY9M,EAAG8T,WAAU,GACrC9T,EAAGiO,MAAO,KAIlBzD,EAAOgM,WAAa,SAAU5T,EAAIqO,GAAQA,EAAInR,EAAU2W,SAAS7T,GAAU9C,EAAUwQ,UAAU1N,GAAI,IA7BvGqT,EAAmB3I,SAAW,SAAU,cAAe,UAAW,UAAW,OAAQ,YAAa,YAAa,QAJ/GvO,QACGC,OAAO,OACPqL,WAAW,qBAAsB4L,MAmCtC,WACE,YAQA,SAASS,GAAqBhX,EAASN,EAASE,GAiC9C,QAASqX,GAAetO,GAASuO,EAAYvO,EAAO,GAEpD,QAASuO,GAAYC,EAASC,GAC5BxX,EAAUoG,KAAK,aAAeoR,GAnChC,GAAI9W,GAAK+I,IACT/I,GAAGyL,OAAS,wBACZzL,EAAG6V,IAAMnW,EAAU,oCACnB,IAAIiD,GAASvD,EAAQgO,SACrBpN,GAAG4V,QAAQjT,EAAOC,GAClB5C,EAAG+W,UAAS,EACZ/W,EAAGgX,YACDC,QAAO,EACPC,QAAO,EACPC,UAAO,GAETnX,EAAG8V,QACD,sBACA,SACA,cACA,SACA,kBACA,uBAGF9V,EAAGoX,UAECC,QAAS,SACTC,KAAM,UACNC,QAASX,IAGb5W,EAAGwX,eACCH,QAAS,SACTC,KAAM,MACNC,QAASZ,GAhCfD,EAAqBpJ,SAAW,UAAW,UAAW,aALtDvO,QACGC,OAAO,OACPqL,WAAW,uBAAwBqM,MA8CxC,WACE,YAOA,SAASe,GAAoBC,EAAYjY,EAAaC,EAAS8N,EAAOmK,EAASC,EAAS9X,GA4BtF,QAAS4N,KACP1N,EAAG6X,SAEH7X,EAAG8X,WACCC,IAAK,EAAGxX,OAAQ,iCAAkCyX,WAAY,oBAAqBC,UAAW,SAI9FF,IAAK,EAAGxX,OAAQ,cAAeyX,WAAY,cAAeC,UAAW,gBACrEF,IAAK,EAAGxX,OAAQ,kCAAmCyX,WAAY,UAAWC,UAAW,YACrFF,IAAK,EAAGxX,OAAQ,oCAAqCyX,WAAY,aAAcC,UAAW,eAC1FF,IAAK,EAAGxX,OAAQ,eAAgByX,WAAY,eAAgBC,UAAW,iBACvEF,IAAK,EAAGxX,OAAQ,SAAUyX,WAAY,SAAUC,UAAW,WAC3DF,IAAK,EAAGxX,OAAQ,mBAAoByX,WAAY,mBAAoBC,UAAW,oBAEnFjY,EAAGkY,QAAUlY,EAAG8X,SAAS,GACzB9X,EAAGmY,IAAMC,EAAaC,WACtBrY,EAAGsY,OAAS,QAAS,UAAW,QAAS,QAAS,OAAQ,QAAS,QAAS,SAAU,aAAc,UAAW,YAAa,aAC5HtY,EAAGuY,eAAiB,OAAQ,MAAO,YACnCvY,EAAGwY,gBAAkB,EACrBxY,EAAGyY,KAAOL,EAAaM,cAAgBC,EACvC3Y,EAAG4Y,SACH5Y,EAAG6Y,iBACH,KAAK,GAAI3X,GAAIyX,EAAkB,EAAGzX,EAAI4X,EAAiB5X,IAAKlB,EAAG4Y,MAAM9S,KAAK5E,EAAI,EAC9E,KAAK,GAAI8E,GAAI+S,EAA2B,EAAG/S,EAAIoS,EAAaM,cAAe1S,IAAKhG,EAAG6Y,eAAe/S,KAAKE,EAAI,EAE3GhG,GAAGgZ,aAAehZ,EAAG6Y,eAAe1X,OAAQ,EAC5C1B,EAAYe,IAAId,EAAU,8FACvBe,KAAK,SAAUC,GACdV,EAAGiZ,SAAWvY,EAAUC,MAAMyN,UAC9BpO,EAAG4V,QAAU5V,EAAGiZ,SAAS,GAAGrI,aAGhCnR,EAAYe,IAAId,EAAU,yBACvBe,KAAK,SAAUC,GACdV,EAAGkZ,UAAYxY,EAAUC,MACzBX,EAAGmZ,cAAgBnZ,EAAGyY,KAAOE,EAC7B3Y,EAAGoZ,QAAU,IAInB,QAASC,KACPrZ,EAAGsZ,YACHtZ,EAAGuZ,cAAe,EAClBvZ,EAAG6X,MAAMxQ,KAAOrH,EAAGkY,QAAQD,UAC3BjY,EAAGoZ,QAAU,EACS,gBAAlBpZ,EAAG6X,MAAMxQ,MACXrH,EAAGwZ,WAAa,cAChBC,EAAqBzZ,EAAGmZ,cAAgBnZ,EAAGoZ,UAChB,YAAlBpZ,EAAG6X,MAAMxQ,MAClBrH,EAAGwZ,WAAa,UAChBE,EAAkC1Z,EAAG2Z,aAAc3Z,EAAG4Z,aAC3B,eAAlB5Z,EAAG6X,MAAMxQ,MAClBrH,EAAGwZ,WAAa,UAChBK,KAC2B,iBAAlB7Z,EAAG6X,MAAMxQ,MAClBrH,EAAGwZ,WAAa,cAChBM,EAAsB9Z,EAAGmZ,cAAgBnZ,EAAGoZ,UACjB,WAAlBpZ,EAAG6X,MAAMxQ,MAClBrH,EAAGwZ,WAAa,cAChBO,EAAgB/Z,EAAGmZ,cAAgBnZ,EAAGoZ,UACX,oBAAlBpZ,EAAG6X,MAAMxQ,MAClBrH,EAAGwZ,WAAa,QAChBQ,EAAyBha,EAAGwY,gBAAiBxY,EAAGgZ,gBAGhDhZ,EAAG6X,MAAMlX,OACPsZ,UACAC,WAEIC,MAAOna,EAAGkY,QAAQF,WAAa,UAC/B1X,QACA8Z,gBAAiB1C,EAAW2C,GAAGC,SAC/BC,YAAa7C,EAAW8C,GAAGF,SAC3BG,YAAa,IAGbN,MAAOna,EAAGkY,QAAQF,WAAa,iBAC/B1X,QACA8Z,gBAAiB1C,EAAW2C,GAAGK,MAC/BH,YAAa7C,EAAW8C,GAAGE,MAC3BD,YAAa,IAGbN,MAAOna,EAAGkY,QAAQF,WAAa,iBAC/B1X,QACA8Z,gBAAiB1C,EAAW2C,GAAGM,KAC/BJ,YAAa7C,EAAW8C,GAAGG,KAC3BF,YAAa,KAInBza,EAAG6X,MAAM+C,WAAa5a,EAAG6X,MAAM+C,UAC/B5a,EAAG6a,KAAO,EACV7a,EAAG8a,UAAY,GACf9a,EAAG+a,UAAY,KAAO/a,EAAG6a,KAAO,GAAK7a,EAAG8a,UAAY,GAAK,IAAO9a,EAAG6a,KAAO7a,EAAG8a,UAC7E9a,EAAGgb,SAAW,EACdC,KAIJ,QAASxB,GAAqBL,GAC5B3Z,EAAYe,IAAId,EAAU,8BAAgC0Z,GACzD3Y,KAAK,SAAUC,GACdV,EAAGkb,UACCzT,KAAM,SAAU0T,MAAO,SAAUC,SAAS,IAC1C3T,KAAM,cAAe0T,MAAO,cAAeC,SAAS,IACpD3T,KAAM,UAAW0T,MAAO,UAAWC,SAAS,IAC5C3T,KAAM,eAAgB0T,MAAO,eAAgBC,SAAS,IACtD3T,KAAM,SAAU0T,MAAO,SAAUC,SAAS,IAC1C3T,KAAM,aAAc0T,MAAO,aAAcC,SAAS,IAClD3T,KAAM,UAAW0T,MAAO,UAAWC,SAAS,IAC5C3T,KAAM,QAAS0T,MAAO,QAASC,SAAS,IAE5Cpb,EAAGG,SACHO,EAAUC,MAAM0a,IAAI,SAAUhV,GAC5BrG,EAAGG,MAAM2F,MACPwV,aAAc1D,EAAQ,UAAU2D,WAAWlV,EAAKiV,cAAe,GAAGE,QAAQ,KAAM,IAAIA,QAAQ,IAAK,KACjGrG,YAAiC,MAApB9O,EAAK8O,YAAsB,IAAM9O,EAAK8O,YACnDsG,QAAS7D,EAAQ,UAAU2D,WAAWlV,EAAKoV,SAAU,GAAGD,QAAQ,KAAM,IAAIA,QAAQ,IAAK,KACvFE,WAAY9D,EAAQ,UAAU2D,WAAWlV,EAAKqV,YAAa,GAAGF,QAAQ,KAAM,IAAIA,QAAQ,IAAK,KAC7FG,OAASC,MAAMvV,EAAKsV,QAA8FtV,EAAKsV,OAAzF/D,EAAQ,UAAU2D,WAAWlV,EAAKsV,QAAS,GAAGH,QAAQ,KAAM,IAAIA,QAAQ,IAAK,KAC3GK,OAAQjE,EAAQ,UAAU2D,WAAWlV,EAAKwV,QAAS,GAAGL,QAAQ,KAAM,IAAIA,QAAQ,IAAK,KACrFM,MAAOlE,EAAQ,UAAU2D,WAAWlV,EAAKyV,OAAQ,GAAGN,QAAQ,KAAM,IAAIA,QAAQ,IAAK,KACnFO,QAASnE,EAAQ,UAAU2D,WAAWlV,EAAK0V,SAAU,GAAGP,QAAQ,KAAM,IAAIA,QAAQ,IAAK,WAM/F,QAASxB,GAAyBgC,EAAa5C,GAC7C,GAAI6C,IACFD,YAAahc,EAAGuY,cAAcyD,GAC9B5C,QAASpZ,EAAG6Y,eAAeO,GAG7B3Z,GAAY6F,KAAK5F,EAAU,qBAAsBuc,GAChDxb,KAAK,SAAUC,GACdV,EAAGkb,UACCzT,KAAM,OAAQ0T,MAAO,OAAQC,SAAS,IACtC3T,KAAM,UAAW0T,MAAO,UAAWC,SAAS,IAC5C3T,KAAM,MAAO0T,MAAO,OAAQC,SAAS,IACrC3T,KAAM,UAAW0T,MAAO,UAAWC,SAAS,IAEhDpb,EAAGG,MAAQO,EAAUC,MAAMub,aAI/B,QAASC,KACP,GAAI5b,GAAS,WAAaP,EAAGuY,cAAcvY,EAAGwY,gBAC9C,OAAOjY,GAGT,QAAS6b,KAEP,IAAK,GADDC,MACKnb,EAAI,EAAGA,EAAIlB,EAAGkb,QAAQ/Z,OAAQD,IACjClB,EAAGkb,QAAQha,GAAGka,SAASiB,EAASvW,KAAK9F,EAAGkb,QAAQha,GAAGia,MAEzD,OAAOkB,GAGT,QAASC,KAeP,MAdAtc,GAAGuc,SACHvc,EAAGG,MAAMkb,IAAI,SAAUhV,GAErB,IAAK,GADDmW,MACKtb,EAAI,EAAGA,EAAIlB,EAAGkb,QAAQ/Z,OAAQD,IACjClB,EAAGkb,QAAQha,GAAGka,UACXQ,MAAMvV,EAAKrG,EAAGkb,QAAQha,GAAGuG,OAG5B+U,EAAMxc,EAAGkb,QAAQha,GAAGuG,MAAQpB,EAAKrG,EAAGkb,QAAQha,GAAGuG,MAF/C+U,EAAMxc,EAAGkb,QAAQha,GAAGuG,MAAQmQ,EAAQ,UAAUvR,EAAKrG,EAAGkb,QAAQha,GAAGuG,MAAO,GAM9EzH,GAAGuc,MAAMzW,KAAK0W,KAETxc,EAAGuc,MAGZ,QAASE,GAAeC,GACtB,IAAK,GAAIxb,GAAI,EAAGA,EAAIlB,EAAGkb,QAAQ/Z,OAAQD,IACrC,GAAIlB,EAAGkb,QAAQha,GAAGuG,OAASiV,EAAS,MAAO1c,GAAGkb,QAAQha,GAAGka,OAE3D,QAAO,EAGT,QAAS1B,GAAkCC,EAAcC,GACvDna,EAAYe,IAAId,EAAU,kCAAoCia,EAAe,gBAAkBC,GAC9FnZ,KAAK,SAAUC,GACdV,EAAG2V,QAAUjV,EAAUC,QAI3B,QAASkZ,KACPpa,EAAYe,IAAId,EAAU,wBACzBe,KAAK,SAAUC,GACdV,EAAG2c,cACHjc,EAAUC,MAAM,GAAG0a,IAAI,SAAUhV,GAC/BrG,EAAG2c,WAAW7W,MACZ8W,QAASvW,EAAKuW,QACdC,UAAWxW,EAAKwW,UAChBC,QAASzW,EAAKyW,QACdC,UAAW1W,EAAK0W,UAChBC,SAAU3W,EAAK2W,SACfxb,MAAQ6E,EAAKyW,QAAUzW,EAAK0W,UAAY1W,EAAK2W,eAMrD,QAASlD,GAAsBV,GAC7B3Z,EAAYe,IAAId,EAAU,oCAAsC0Z,GAC7D3Y,KAAK,SAAUC,GACdV,EAAGsb,gBACH5a,EAAUC,MAAM0a,IAAI,SAAUhV,GAC5BrG,EAAGsb,aAAaxV,MACdyP,gBAAiBqC,EAAQ,QAAQvR,EAAKkP,gBAAiB,cACvDa,KAAM/P,EAAK+P,KACXjB,YAAiC,MAApB9O,EAAK8O,YAAsB,IAAM9O,EAAK8O,YACnDvH,aAAcvH,EAAKuH,aACnBqP,MAAOrF,EAAQ,UAAU2D,WAAWlV,EAAK4W,OAAQ,GAAGzB,QAAQ,KAAM,IAAIA,QAAQ,IAAK,KACnFG,OAAQtV,EAAKsV,aAMvB,QAAS5B,GAAgBX,GACrB3Z,EAAYe,IAAId,EAAU,8BAAgC0Z,GACzD3Y,KAAK,SAAUC,GACZV,EAAG6b,UACHnb,EAAUC,MAAM0a,IAAI,SAAUhV,GAC9BrG,EAAG6b,OAAO/V,MACNyP,gBAAiBqC,EAAQ,QAAQvR,EAAKkP,gBAAiB,cACvDa,KAAM/P,EAAK+P,KACXjB,YAAiC,MAApB9O,EAAK8O,YAAsB,IAAM9O,EAAK8O,YACnDvH,aAAcvH,EAAKuH,aACnBqP,MAAOrF,EAAQ,UAAU2D,WAAWlV,EAAK4W,OAAQ,GAAGzB,QAAQ,KAAM,IAAIA,QAAQ,IAAK,KACnFG,OAAQtV,EAAKsV,aAMzB,QAAS7Z,GAAYgV,GACnBhX,EAAUwQ,UAAUwG,GAGtB,QAASoG,KACP,GAAIC,KACJA,GAAYd,SAAWD,IACvBe,EAAYZ,MAAQD,IACpBa,EAAY/D,QAAUpZ,EAAGyY,KAAOE,CAChC,IAAI1D,IACFjG,OAEFiG,GAAYjB,mBAAqBjV,QAAQ+D,UAAU6U,EAAQyF,aAC3D3d,EAAYoU,IAAInU,EAAU,kBAAmByd,GAC1C1c,KAAK,SAAUC,GACduU,EAAYpB,IAAMnT,EAAUmV,IAC5BZ,EAAYf,WAAaxT,EAAUJ,IACnC,IAAI4J,IACF5J,KAAM2U,EACN1K,YAAa,mEACbF,YAAa,OAAQ,SAAU,YAAa,OAAQgT,GAEtD7P,GAAMjI,KAAK2E,KAIjB,QAASmT,GAAoB/c,EAAMkK,EAAQmH,EAAWO,GACpD,GAAIN,GAAMpH,CACVoH,GAAItR,QACJsR,EAAItR,KAAKsT,KAAOtT,EAAKsT,KACrBhC,EAAItR,KAAKuT,IAAMvT,EAAKuT,IACpBjC,EAAItR,KAAKwT,WAAY,EACrBlC,EAAItR,KAAKyT,UAAYzT,EAAK0T,mBACtB1T,EAAK0T,oBACP9B,EAAK+B,WAAW3T,EAAK4T,WAAY,oBASnCtC,EAAIC,OAAS,WACXF,EAAUG,UAEZF,EAAI2E,QAAU,WACZ3E,EAAItR,KAAKwT,WAAY,GAEvBlC,EAAI9E,OAAS,WACX8E,EAAItR,KAAKwT,WAAY,GAIzB,QAASmH,KAGP,GAFAjb,EAAGsZ,YACHtZ,EAAGuZ,cAAe,EACI,gBAAlBvZ,EAAG6X,MAAMxQ,KACXrH,EAAGwZ,WAAa,cAChBC,EAAqBzZ,EAAGmZ,cAAgBnZ,EAAGoZ,aACtC,IAAsB,YAAlBpZ,EAAG6X,MAAMxQ,KAClBrH,EAAGwZ,WAAa,UAChBE,EAAkC1Z,EAAG2Z,aAAc3Z,EAAG4Z,gBACjD,IAAsB,eAAlB5Z,EAAG6X,MAAMxQ,KAClBrH,EAAGwZ,WAAa,UAChBK,QACK,IAAsB,iBAAlB7Z,EAAG6X,MAAMxQ,KAClBrH,EAAGwZ,WAAa,cAChBM,EAAsB9Z,EAAGmZ,cAAgBnZ,EAAGoZ,aACvC,IAAsB,WAAlBpZ,EAAG6X,MAAMxQ,KAClBrH,EAAGwZ,WAAa,cAChBO,EAAgB/Z,EAAGmZ,cAAgBnZ,EAAGoZ,aACjC,IAAsB,oBAAlBpZ,EAAG6X,MAAMxQ,KAClBrH,EAAGwZ,WAAa,OAChBQ,EAAyBha,EAAGwY,gBAAiBxY,EAAGgZ,kBAC3C,CACL,GAAIP,GAAOzY,EAAGyY,KAAOE,EACnBR,EAAMnY,EAAGmY,IAAM,EAEbmF,GACF5d,EAAU,0BAA4B+Y,EAAO,QAAUN,EACvDzY,EAAU,2BAA6B+Y,EAAO,QAAUN,EAAM,SAAWnY,EAAG6a,KAC5Enb,EAAU,6BAA+B+Y,EAAO,QAAUN,EAAM,SAAWnY,EAAG6a,KAC9Enb,EAAU,aAAeM,EAAG4V,QAAU,oBAAsB6C,EAAO,QAAUN,EAE/E1Y,GAAYe,IAAI8c,EAAQtd,EAAGkY,QAAQH,MAClCtX,KAAK,SAAUC,GACdV,EAAG6X,MAAMlX,MAAMsZ,OAASvZ,EAAUC,MAAMic,QACxC5c,EAAG6X,MAAMlX,MAAMuZ,SAAS,GAAG5Z,KAAOI,EAAUC,MAAM4c,OAClDvd,EAAG6X,MAAMlX,MAAMuZ,SAAS,GAAG5Z,KAAOI,EAAUC,MAAM6c,YAClDxd,EAAG6X,MAAMlX,MAAMuZ,SAAS,GAAG5Z,KAAOI,EAAUC,MAAM8c,eAClDzd,EAAG6X,MAAM6F,YAAc1d,EAAG6X,MAAM6F,WAChC1d,EAAGgb,SAAWta,EAAUC,MAAMa,SAKpC,QAASmc,GAAQC,GACJ,MAAPA,IACF5d,EAAG6a,KAAO,GACD,KAAP+C,GACF5d,EAAG6a,OACM,KAAP+C,GACF5d,EAAG6a,OACM,MAAP+C,IACF5d,EAAG6a,KAAOgD,KAAKC,KAAK9d,EAAGgb,SAAWhb,EAAG8a,YACvC9a,EAAG+a,UAAY,KAAO/a,EAAG6a,KAAO,GAAK7a,EAAG8a,UAAY,GAAK,KAAS9a,EAAG6a,KAAO7a,EAAG8a,UAAa9a,EAAGgb,SAAYhb,EAAGgb,SAAWhb,EAAG6a,KAAO7a,EAAG8a,WACtIG,IA1XF,GAAIjb,GAAK+I,KACPqP,EAAe,GAAInJ,MACnB0J,EAAkB,KAClBI,EAA2B,KAC3BD,EAAkB,IAGpBpL,KACA2L,IACArZ,EAAGib,eAAiBA,EACpBjb,EAAGqZ,eAAiBA,EACpBrZ,EAAG2d,QAAUA,EACb3d,EAAGyc,eAAiBA,EACpBzc,EAAGkd,WAAaA,CAChB,IAAIa,GAAO,GAAI9O,MACb+O,EAAID,EAAKrF,cACTuF,EAAIF,EAAK1F,UACXrY,GAAG2Z,aAAe,GAAI1K,MAAK+O,EAAGC,EAAG,GACjCje,EAAG4Z,WAAa,GAAI3K,MACpBjP,EAAGoc,oBAAsBA,EACzBpc,EAAGmc,cAAgBA,EACnBnc,EAAGsc,iBAAmBA,EACtBtc,EAAG8Z,sBAAwBA,EAC3B9Z,EAAG+Z,gBAAkBA,EACrB/Z,EAAG8B,YAAcA,EACjB9B,EAAGsZ,YAzBL7B,EAAoBnK,SAAW,aAAc,cAAe,UAAW,QAAS,UAAW,UAAW,aANtGvO,QACGC,OAAO,OACPqL,WAAW,sBAAuBoN,MAoYvC,WACE,YAOA,SAASyG,GAAoBxe,EAASN,EAASU,EAAW0N,GA8CxD,QAAS2Q,GAAYtH,EAASC,GAC5BhX,EAAUse,gBAAgBvH,EAASC,GAGrC,QAAShV,GAAY+U,EAASC,GAC5BhX,EAAUwQ,UAAUwG,GAGtB,QAASuH,GAAkBC,GACzB,GAAIpU,IACF7B,MAAOiW,EACP/T,YAAa,8DACbF,YAAa,SAAU,YAAa,cAAe,UAAW,UAAWkU,GAE3E/Q,GAAMjI,KAAK2E,GAGb,QAASqU,GAAwB/T,EAAQmH,EAAWlS,EAAaN,EAASO,GAQxE,QAAS8e,KACP,MAAIzf,SAAQ2K,YAAYkI,EAAIwE,OAAmB,IAAVxE,EAAIwE,SACvCjX,GAAQsf,QAAQ,uCAIlBhf,GAAYoU,IAAInU,EAAU;AAA+B0W,KAAMxE,EAAIwE,OAClE3V,KAAK,SAAU4V,GACVA,IACFzE,EAAI8M,mBAAqBrI,KAH7B5W,SAMO,cAUT,QAASqS,KAEPH,EAAUG,SA/BZ,GAAIF,GAAMpH,CACVoH,GAAI4M,iBAAmBA,EACvB5M,EAAIE,OAASA,EAjEf,GAAI9R,GAAK+I,IACT/I,GAAGyL,OAAS,sBACZzL,EAAG6V,IAAMnW,EAAU,6BACnB,IAAIiD,GAASvD,EAAQgO,SACrBpN,GAAG4V,QAAUjT,EAAOC,GAEpB5C,EAAG2e,YACCpQ,OAAQ,6BAGZvO,EAAGgX,YACCC,QAAQ,EACRC,QAAQ,EACRC,UAAQ,GAGZnX,EAAG8V,QACD,eACA,SACA,mBACA,QACA,UACA,wBACA,kBACA,uBAGF9V,EAAGoX,UAECC,QAAS,MACTC,KAAM,iBACNC,QAASzV,IAGTuV,QAAS,gBACTC,KAAM,WACNC,QAAS4G,IAGbne,EAAG4e,UACDvH,QAAS,qBACTC,KAAM,QACNC,QAAS8G,GAzCbH,EAAoB5Q,SAAW,UAAW,UAAW,YAAa,SAPlEvO,QACGC,OAAO,OACPqL,WAAW,sBAAuB6T,MA2GvC,WACE,YAOA,SAASW,GAAiBnf,EAASN,EAASU,EAAW0N,EAAOsR,EAAIrf,EAAasf,EAAiBpH,EAASxY,EAAS6f,EAASxK,GAwDzH,QAASyK,GAA2BC,GAClClf,EAAGmf,oBAAsBD,EAQ3B,QAASpd,GAAY+U,EAASC,GAC5BhX,EAAUwQ,UAAUwG,GAQtB,QAASqH,GAAYtH,EAASC,GAC5BhX,EAAUse,gBAAgBvH,EAASC,GAIrC,QAASsI,GAAkBxT,GACzB,GAAIlL,IACF2e,aACAC,gBAEEC,EAAW3T,EAAMyP,IAAI,SAAUhV,GACjC,MAAO,IAAImZ,SAAQ,SAAUC,GAC3B,MAAOhgB,GAAYoU,IAAInU,EAAU,oBAC7B0W,KAAM/P,EAAK9F,OACXqN,aAAcvH,EAAKuH,eAEpBnN,KAAK,SAAU4V,GACd,IAAKA,IAAiBA,EAAa/V,KAAM,KAAMyC,OAAM,kCACrD,OAAO2c,GAAoBrJ,EAAa/V,QAEzCG,KAAK,SAAUkf,GAMd,MALAjf,GAAU2e,UAAUvZ,MAClB6Z,OAAQ,+BAAiCA,EACzClY,KAAMpB,EAAKuH,aAAe,SAGrB6R,MAdJhgB,SAgBE,SAAUmgB,GAMf,MAJAlf,GAAU4e,YAAYxZ,MACpB0K,UAAWnK,EAAK9F,OAChBsF,MAAO+Z,IAEFH,SAOf,OAAOD,SAAQK,IAAIN,GAChB9e,KAAK,WACJ,MAAO+e,SAAQC,QAAQ/e,KAFpB8e,SAIE,SAAU3Z,GAEf,MAAO2Z,SAAQM,OAAOja,KAG5B,QAASka,GAA0BnU,GACjC,GAAIlL,IACFc,MAAOoK,EAAMzK,QAAU,EACvB6e,YACAC,eAEEV,EAAW3T,EAAMyP,IAAI,SAAShV,GAChC,MAAO,IAAImZ,SAAQ,SAAUC,GAC3B,GAAIS,GAAkB7Z,EAAKoB,IAC3B,OAAI1I,SAAQ2K,YAAY1J,EAAGmgB,OAAOD,KAChCxf,EAAUuf,WAAWna,KAAKoa,EAAgB1E,QAAQ,OAAQ,KACnDiE,KAEFhgB,EAAY6F,KAAK5F,EAAU,sBAChCigB,OAAQtZ,EAAKsZ,OACb/R,aAAc5N,EAAGmgB,OAAOD,KAEzBzf,KAAK,SAAU2f,GACd,GAAgC,UAA7BA,EAAa5a,YAAyB,KAAMzC,OAAMqd,EAAa3a,QAElE,OADA/E,GAAUsf,SAASla,KAAKoa,GACjBT,MAPFhgB,SASA,WAEL,MADAiB,GAAUuf,WAAWna,KAAKO,EAAKoB,MACxBgY,SAMb,OAAOD,SAAQK,IAAIN,GAClB9e,KAAK,WACJ,MAAO+e,SAAQC,QAAQ/e,KAFlB8e,SAIA,SAAS3Z,GAGd,MAAO2Z,SAAQM,OAAOja,KAI1B,QAASwa,KACP,GAAIC,MACAC,GACFjgB,MACEmF,QAAS,0BACT4B,KAAM,QAGV2X,GAAQzZ,KAAKgb,EACb,IAAIC,GAAuBxgB,EAAGygB,uBAAuBzgB,EAAGG,MAAMG,MAC1DogB,GACFC,cAAeH,EAAqBrf,OACpCke,UAAW,EACXuB,SAAU,EACVC,UAAW,EAGb9B,GAAgB+B,kBACfrgB,KAAK,SAAUsgB,GACd,GAAGA,EAAWC,UAAW,EAAO,KAAMje,OAAMge,EAAWtb,QAKvD,OAJAuZ,GAAQiC,SACNxb,QAAS,4BACT4B,KAAM,YAED5H,EAAYe,IAAId,EAAU,iCAElCe,KAAK,SAAUygB,GAEd,MADIniB,SAAQ+D,UAAUoe,EAAcvgB,MAAMwgB,YAAcD,EAAcvgB,MAAMwgB,YAAWb,EAAeY,EAAcvgB,OAC7Gye,EAAkBoB,KAE1B/f,KAAK,SAAU2gB,GACd,IAAIA,EAAgB,KAAMre,OAAM,qCAChC,IAAwC,KAApCqe,EAAe/B,UAAUle,OAAc,KAAM4B,OAAM,qCACvD2d,GAAQrB,UAAY+B,EAAe/B,UAAUle,QAAU,EACvD6d,EAAQiC,SACNxb,QAAS,0BACT4B,KAAM,QAER,IAAIga,GAAe1e,EAAOqM,GAE1B,OAD8B,IAA1BsR,EAAaa,YAAmBE,EAAef,EAAae,cACzDtC,EAAgBuC,UAAUF,EAAe/B,UAAWgC,KAE5D5gB,KAAK,SAAU8gB,GAEd,IAAKA,GAA4C,MAA1BA,EAAeC,OACpC,KAAMze,OAAM,oFAOd,OALAic,GAAQiC,SACNxb,QAAS,oCACT4B,KAAM,YAERqZ,EAAQE,SAAWW,EAAejhB,KAAKmhB,MAAMtgB,QAAU,EAChD4e,EAA0BwB,EAAejhB,KAAKmhB,SAEtDhhB,KAAK,SAAUihB,GACd,GAAqC,IAAlCA,EAAc1B,SAAS7e,QAAgBuf,EAAQC,cAAcxf,OAAS,EAAI,KAAM4B,OAAM,iCACzF2d,GAAQG,UAAYa,EAAc1B,SAAS7e,QAAU,EAElDuf,EAAQC,gBAAkBD,EAAQG,UACnC1hB,EAAQwiB,QAAQjB,EAAQC,cAAc,mDAItCxhB,EAAQoG,KAAK,cAAc,MAAMmb,EAAQC,cAAc,gBAAgBD,EAAQE,SAAS,mBAAmBF,EAAQG,WAGrH7B,EAAQnN,SACR2C,EAAS,WACPzV,QAAQ8H,QAAQ,0BAA0B6O,YAnD9CqJ,SAsDO,SAAUlZ,GACf1G,EAAQ0G,MAAMA,EAAM6B,SACpBsX,EAAQnN,WAKZ,QAAS4O,GAAuBvE,GAC9B,GAAIxb,KAUJ,OATAV,GAAGmgB,UACHjE,EAAWb,IAAI,SAAU7K,GACG,MAAtBA,EAAUoR,UAAoBpR,EAAUoR,WAC1CpR,EAAUqR,SAAU,EACpBnhB,EAAUoF,KAAK0K,GACfxQ,EAAGmgB,OAAO3P,EAAU5C,aAAa,QAAU4C,EAAU5C,gBAIlDlN,EAMT,QAASgf,GAAoBoC,GAK3B,IAAK,GAJDC,GAAQjD,EAAGiD,QACXC,EAAS,GACTC,EAAQ,GAAIC,YAAWJ,GACvBK,EAAMF,EAAMG,WACPlhB,EAAI,EAAGA,EAAIihB,EAAKjhB,IACvB8gB,GAAUK,OAAOC,aAAaL,EAAM/gB,GAGtC,OADA6gB,GAAMtC,QAAQ9H,EAAQ4K,KAAKP,IACpBD,EAAMS,QA3Qf,GAAIxiB,GAAK+I,KACLpG,EAASvD,EAAQgO,SACrBpN,GAAG2C,OAASA,EACZ3C,EAAG4V,QAAUjT,EAAOC,GACpB5C,EAAGyL,OAAS,gCACZzL,EAAG6V,IAAMnW,EAAU,mBACnBM,EAAGqgB,iBAAmBA,EACtBrgB,EAAGG,SACHH,EAAGyiB,oBAAqB,EAExBziB,EAAGgX,YACDC,QAAQ,EACRC,QAAQ,EACRC,UAAQ,GAGVnX,EAAG8V,QACD,eACA,SACA,mBACA,SACA,QACA,kBACA,uBAGF9V,EAAG0iB,iBACCC,EAAE,QAASC,EAAE,YAGjB5iB,EAAGoX,UAECC,QAAS,MACTC,KAAM,iBACNC,QAASzV,IAGTuV,QAAS,gBACTC,KAAM,WACNC,QAAS4G,IAGbne,EAAGmf,qBAAsB,EACzBnf,EAAG6iB,qBAAqB5D,EACxBjf,EAAGygB,uBAAyBA,EAC5BzgB,EAAG0f,oBAAsBA,EACzB1f,EAAGof,kBAAoBA,EACvBpf,EAAG+f,0BAA4BA,EAC/B/f,EAAGmgB,UA/CLtB,EAAiBvR,SAAW,UAAW,UAAW,YAAa,QAAS,KAAM,cAAe,kBAAmB,UAAW,UAAW,UAAW,YARjJvO,QACCC,OAAO,OACPqL,WAAW,mBAAoBwU,MAsRlC,WACE,YAOA,SAASiE,GAAkBpjB,EAASN,EAASU,GAqCzC,QAASgC,GAAY+U,EAASC,GAC1BhX,EAAUwQ,UAAUwG,GAExB,QAASqH,GAAYtH,EAASC,GAC1BhX,EAAUse,gBAAgBvH,EAASC,GAvCvC,GAAI9W,GAAK+I,KACLpG,EAASvD,EAAQgO,SACrBpN,GAAG4V,QAAUjT,EAAOC,GACpB5C,EAAGyL,OAAS,sBACZzL,EAAG6V,IAAMnW,EAAU,8BAA8BiD,EAAOC,GAAG,WAE3D5C,EAAGgX,YACCC,QAAQ,EACRC,QAAQ,EACRC,UAAQ,GAGZnX,EAAG8V,QACC,eACA,SACA,mBACA,SACA,QACA,kBACA,uBAGJ9V,EAAGoX,UAECC,QAAS,MACTC,KAAM,iBACNC,QAASzV,IAGPuV,QAAS,gBACTC,KAAM,WACNC,QAAS4G,IA7BnB2E,EAAkBxV,SAAW,UAAW,UAAW,aATnDvO,QACGC,OAAO,OACPqL,WAAW,oBAAqByY,MAkDrC,WACE,YAOA,SAASC,GAAqBtjB,EAAaC,EAASN,EAAS4jB,EAAU1jB,EAAWkO,EAAO1N,GA6DvF,QAASmjB,GAAYpM,EAASC,GAC1BrX,EAAYe,IAAId,EAAQ,4CAA4CoX,EAAe,6BAClFrW,KAAK,SAAUC,GACTA,EAAUC,MAAMyN,UAAU,GAAG1L,mBAAmBC,EAAOC,GACtDtD,EAAUoG,KAAK,aAAeoR,GAE9BhX,EAAUwQ,UAAUwG,KAGhC,QAASqH,GAAYtH,EAASC,GAC1BhX,EAAUse,gBAAgBvH,EAASC,GAGvC,QAASoM,GAAerM,GACpB,GAAI3M,IACA7B,MAAOwO,EACPtM,YAAa,gEACbF,YAAa,SAAS,YAAY,cAAc,UAAU,UAAW,UAAW8Y,GAEpF3V,GAAMjI,KAAK2E,GAGf,QAASiZ,GAAwB3Y,EAAQmH,EAAWlS,EAAaN,EAASO,EAASN,GAQ/E,QAASgkB,KACL3jB,EAAYe,IAAId,EAAUkS,EAAIyR,SAC7B5iB,KAAK,SAAUH,GACZsR,EAAI0R,uBAAyBhjB,EAAKK,MAAMyN,UACxCwD,EAAI2R,uBAAyBjjB,EAAKK,MAAMyN,UAAU,GAAG/I,sBAI7D,QAASme,KACL/jB,EAAYe,IAAId,EAAU,qCAAqCkS,EAAI2R,wBAClE9iB,KAAK,SAAUH,GACZlB,EAAQiP,WAAW,KAAM/N,EAAKK,OAC9BrB,EAAUoG,KAAK,eACfiM,EAAUG,WApBlB,GAAIF,GAAMpH,CAEVoH,GAAI4R,OAASA,EACb5R,EAAIyR,QAAU,yHAEdD,IAxFJ,GAAIpjB,GAAK+I,IACT/I,GAAGyL,OAAS,uBACZ,IAAI9I,GAASvD,EAAQgO,SAErBpN,GAAG4V,QAAQjT,EAAOC,GAClB5C,EAAG6V,IAAMnW,EAAU,8BAA8BiD,EAAOC,GAAG,kBAC3D5C,EAAGgX,YACDC,QAAO,EACPC,QAAO,EACPC,UAAO,GAETnX,EAAG8V,QACD,eACA,SACA,mBACA,QACA,SACA,UACA,kBACA,uBAGF9V,EAAG0iB,iBACGC,EAAE,QAASC,EAAE,UACbD,EAAE,QAASC,EAAE,UACbD,EAAE,QAASC,EAAE,YACbD,EAAE,QAASC,EAAE,YACbD,EAAE,QAASC,EAAE,aACbD,EAAE,SAAUC,EAAE,WACdD,EAAE,WAAYC,EAAE,aAEnBjgB,EAAO8gB,UACNzjB,EAAG0iB,eAAe5c,MAAQ6c,EAAE,SAAUC,EAAE,WACxC5iB,EAAG0iB,eAAe5c,MAAQ6c,EAAE,UAAWC,EAAE,aAG7C5iB,EAAGoX,UAEGwH,UAAU,EACV8E,SAAU,SACVC,QACEC,OAAWvM,QAAS,SAAUC,KAAM,UAAWC,QAAS0L,GACxDnG,SAAazF,QAAS,SAAUC,KAAM,UAAWC,QAAS0L,GAC1DY,SAAaxM,QAAS,SAAUC,KAAM,UAAWC,QAAS0L,GAC1DjG,UAAc3F,QAAS,SAAUC,KAAM,UAAWC,QAAS0L,GAC3Da,SAAazM,QAAS,MAAOC,KAAM,iBAAkBC,QAAS0L,MAI9D5L,QAAS,gBACTC,KAAM,WACNC,QAAS4G,IAGjBne,EAAGwX,eACCH,QAAS,SACTC,KAAM,MACNC,QAAS2L,GArDfH,EAAqBzV,SAAW,cAAe,UAAW,UAAW,WAAY,YAAa,QAAS,aAVvGvO,QACGC,OAAO,OACPqL,WAAW,uBAAwB0Y,MAmHxC,WACE,YAQA,SAASgB,GAAoBrkB,EAASN,GAyBpC,QAAS4kB,GAAyB1jB,EAAMnB,EAASqL,EAAQmH,EAAWlS,EAAaC,EAAS8U,GAgCxF,QAASyP,KACP,GAAIhP,GAAcrD,EAAItR,IAEA,IAAlBsR,EAAIsS,aACNjP,EAAYkP,aAAelP,EAAYmP,WAGtCxS,EAAItR,KAAK+jB,YACV5kB,EAAYmG,IAAIlG,EAAU,6BAA+BkS,EAAItR,KAAK+jB,YAAapP,GAC9ExU,KAAK,SAAU6jB,GACdnlB,EAAQoG,KAAK+e,EAAa9e,YAAa8e,EAAa7e,SACpDkM,EAAU8D,OACVjB,EAAS,WACPzV,QAAQ8H,QAAQ,0BAA0B6O,SACzC,OAKLjW,EAAY6F,KAAK5F,EAAQ,4BAA6BuV,GACrDxU,KAAK,SAAU6jB,GACdnlB,EAAQoG,KAAK+e,EAAa9e,YAAa8e,EAAa7e,SACpDkM,EAAU8D,OACVjB,EAAS,WACPzV,QAAQ8H,QAAQ,0BAA0B6O,SACzC,OAKT,QAAS6O,KACP9kB,EAAYe,IAAId,EAAU,2CACzBe,KAAK,SAAU+jB,GACd5S,EAAI6S,aAAeD,EAAU7jB,MAC7BiR,EAAI6S,aAAa3e,MAAMqe,aAAa,WAAYO,MAAK,MAKzD,QAASC,GAActe,GACjBtH,QAAQ+D,UAAUuD,EAAKqe,OAAsB,GAAbre,EAAKqe,KACvC9S,EAAIsS,YAAa,EAGjBtS,EAAIsS,YAAa,EAKrB,QAASrS,KACPF,EAAUG,SAjFZ,GAAIF,GAAMpH,CAEVoH,GAAI2S,oBAAsBA,EAC1B3S,EAAIC,OAASA,EACbD,EAAIqS,kBAAoBA,EACxBrS,EAAI+S,cAAgBA,EACpB/S,EAAItR,KAAOA,EACXsR,EAAInG,OAAS,SACbmG,EAAIsS,YAAa,EACjBtS,EAAIgT,gBACAhiB,GAAI,OAAQ6E,KAAM,SAClB7E,GAAI,aAAc6E,KAAM,eACxB7E,GAAI,aAAc6E,KAAM,eACxB7E,GAAI,SAAU6E,KAAM,WACpB7E,GAAI,QAAS6E,KAAM,UACnB7E,GAAI,QAAS6E,KAAM,UACnB7E,GAAI,SAAU6E,KAAM,WACpB7E,GAAI,aAAc6E,KAAM,eACxB7E,GAAI,SAAU6E,KAAM,WAExBmK,EAAI+D,UACA/S,GAAI,SAAU6E,KAAM,WACpB7E,GAAI,WAAY6E,KAAM,aAEC,MAAxBmK,EAAItR,KAAK+jB,cACVzS,EAAInG,OAAS,UACbmG,EAAItR,KAAKiO,OAAS,SAClBqD,EAAItR,KAAKukB,aAAe,UAE1BjT,EAAI2S,sBAtDN,GAAIvkB,GAAK+I,KACLpG,EAASvD,EAAQgO,SACrBpN,GAAG4V,QAAUjT,EAAOC,GAEpB5C,EAAGyL,OAAS,uBACZzL,EAAG6V,IAAMnW,EAAU,6BACnBM,EAAG8V,QACD,cACA,QACA,UACA,YACA,UACA,eACA,SACA,kBACA,uBAEF9V,EAAGgX,YACDG,UAAQ,GAGVnX,EAAG8kB,MAAO,SACV9kB,EAAG+V,kBAAoB,OAAQ,UAAW,SAAU,YAAa,cAAe,UAAW,WAAYiO,GACvGhkB,EAAGkH,SAAW,+DAnBhB6c,EAAoBzW,SAAW,UAAW,WAX1CvO,QACCC,OAAO,OACPqL,WAAW,sBAAuB0Z,MAsHrC,WACE,YAOA,SAASgB,GAAqBtlB,EAAaC,EAASG,EAAST,EAASE,EAAWkO,EAAOtO,EAAY8jB,EAAUljB,EAAWkf,GAwDvH,QAASiE,GAAYpM,EAASC,GAC1BrX,EAAYe,IAAId,EAAQ,4CAA4CoX,EAAe,6BAClFrW,KAAK,SAAUC,GACTA,EAAUC,MAAMyN,UAAU,GAAG1L,mBAAmBC,EAAOC,GACtDtD,EAAUoG,KAAK,aAAeoR,GAE9BhX,EAAUwQ,UAAUwG,KAIhC,QAASqH,GAAYtH,EAASC,GAC1BhX,EAAUse,gBAAgBvH,EAASC,GAGvC,QAAShV,GAAY+U,EAASC,GAC5B,GAAI7B,IAAejG,OACnBiG,GAAYjG,MACZ,IAAI1O,EACJb,GAAYe,IAAId,EAAU,8BAA8BoX,GACvDrW,KAAK,SAAUukB,GAEd1kB,EAAO0kB,EAEP/P,EAAY3F,aAAevQ,QAAQ+B,SAASR,EAAKK,MAAMI,gBACvD,IAAIiJ,GAAQiL,EAAY3F,YACpBtF,GAAM,WAAaA,EAAM,UAAUib,QACvCjb,EAAM,UAAUib,MAAQjC,EAASkC,OAAOlb,EAAM,UAAUib,MAAO,sBAC/DhQ,EAAYxG,YAAcvP,EAAW8C,WAAWjD,QAAQ+B,SAASR,EAAKK,MAAMM,WAAYgU,EAAY3F,cACpG2F,EAAYjG,IAAIzO,OAASD,EAAKK,MAAMJ,OACpC0U,EAAYjG,IAAI/N,UAAYX,EAAKK,MAAMM,YAKxCR,KAAK,WACJ,MAAOhB,GAAY6F,KAAK5F,EAAS,qCAAqCuV,KAEvExU,KAAK,SAAU0kB,GAGd,MAFAlQ,IAAgBrB,KAAMuR,EAAWxkB,MAAMiT,KAAMrT,OAAQ4kB,EAAWxkB,MAAMJ,QACtE0U,EAAYjB,mBAAqBlU,EAAUslB,WACpC3lB,EAAYoU,IAAInU,EAAQ,kCAAkC0W,KAAMnB,EAAY1U,WAEpFE,KAAK,SAAUC,GACd,GAAIA,EAAJ,CACAuU,EAAYpB,IAAMnT,EAAUmV,IAC5BZ,EAAYf,WAAaxT,EAAUJ,IACnC,IAAI4J,IACF5J,MAAQsC,GAAGtC,EAAKK,MAAMiN,aAAcyX,GAAI/kB,EAAKK,MAAOgC,OAAQA,EAAQkR,IAAKoB,GACzE1K,YAAa,yDACbF,YAAa,OAAQ,SAAU,YAAa,cAAe,UAAW,WAAY,UAAW,WAAY,YAAa,UAAW,OAAQgT,GAE3I7P,GAAMjI,KAAK2E,MAMf,QAASmT,GAAoB/c,EAAMkK,EAAQmH,EAAWlS,EAAaC,EAAS8U,EAAUpV,EAAS4jB,EAAUljB,EAAWX,EAAS+S,GA4BzH,QAASxE,KACD3O,QAAQumB,SAAS1T,EAAItR,KAAK+kB,GAAGzW,QAC7BgD,EAAItR,KAAK+kB,GAAGzW,KAAO7P,QAAQ+B,SAAS8Q,EAAItR,KAAK+kB,GAAGzW,OAEpDgD,EAAItR,KAAKilB,WAAkC,YAApB3T,EAAItR,KAAK+kB,GAAG9W,OACnCqD,EAAItR,KAAKklB,QAAW5T,EAAItR,KAAK+kB,GAAGzW,KAAKpM,QAAQlC,EAAKqC,OAAOC,UAAYgP,EAAItR,KAAKilB,WAC9E3T,EAAItR,KAAKyP,gBAAkB6B,EAAItR,KAAK+kB,GAAGnV,QAAS,EAC7C0B,EAAItR,KAAKyP,iBAERtQ,EAAYe,IAAId,EAAU,uIAAuIkS,EAAItR,KAAK+kB,GAAGnV,OAC5KzP,KAAK,SAAU2N,GACZwD,EAAItR,KAAK6P,WAAa/B,EAAUzN,MAAMyN,YAG1C9N,EAAKuT,IAAIG,oBACT9B,EAAK+B,WAAW3T,EAAKuT,IAAIK,WAAY,oBAGzCzU,EAAYe,IAAId,EAAU,qBAAqBkS,EAAItR,KAAK+kB,GAAG3iB,mBAC1DjC,KAAK,SAAUC,GAGZ,GAFAkR,EAAItR,KAAKsc,QAAWlc,EAAUC,MAAMic,QACpChL,EAAItR,KAAKuc,UAAanc,EAAUC,MAAMkc,UACnCjL,EAAItR,KAAKklB,SAAW5T,EAAItR,KAAKilB,WAC5B,MAAO9lB,GAAYe,IAAId,EAAU,qBAAqBiD,EAAOC,GAAG,kBAGvEnC,KAAK,SAAUC,GAKZ,GAJGA,IACCkR,EAAItR,KAAKmlB,OAAO,WAChB7T,EAAItR,KAAK2Y,SAAWvY,EAAUC,MAAMyN,WAErCwD,EAAItR,KAAKilB,YAAc3T,EAAItR,KAAKklB,QAC/B,MAAO/lB,GAAYe,IAAId,EAAU,4HAGxCe,KAAK,SAAUC,GACTA,IACCkR,EAAItR,KAAKgjB,uBAAyB5iB,EAAUC,MAAMyN,aAIvDwD,EAAItR,KAAKilB,YACR9lB,EAAYe,IAAId,EAAU,kBAAkBkS,EAAItR,KAAK+kB,GAAGzX,aAAa,WACpEnN,KAAK,SAAU2N,GACZwD,EAAItR,KAAKolB,iBAAmBtX,EAAUzN,MAAMic,QAAQ,IAAIxO,EAAUzN,MAAMkc,YAMpF,QAAS8I,GAAQC,GACb,GAAIjlB,IAAUiV,QAASjT,EAAOC,IAC1BijB,EAAiB,SAAND,EACXE,EAAc,WACflU,GAAItR,KAAKklB,UAER7kB,EAAMolB,gBAAkBnU,EAAItR,KAAK0lB,sBACxB,WAANJ,IACCA,EAAO,mBACPE,EAAc,2BACdnlB,EAAMslB,SAAU,GAEX,WAANL,IACCA,EAAO,oBACPE,EAAc,2BACdnlB,EAAM+O,cAAgBkC,EAAItR,KAAKoP,cAC/B/O,EAAMslB,SAAU,GAEjBJ,IACCD,EAAO,kCACPjlB,EAAMolB,gBAAkBplB,EAAMiV,QAC9BjV,EAAM+O,cAAgB,GACtB/O,EAAMslB,SAAU,IAGxBzY,EAAM6B,QAAQ,8BAA8BuW,EAAK,IAAK,WAClD,GAAIrF,IACAjgB,MACImF,QAASqgB,EACTze,KAAM,QAGd2X,GAAQzZ,KAAKgb,GACbvB,EAAQiC,SAAS5Z,KAAK,SACtB5H,EAAYmG,IAAKlG,EAAQ,8BAA8BY,EAAKsC,GAAG,WAAYjC,GAC1EF,KAAK,SAAUC,GACZvB,EAAQoG,KAAK7E,EAAU8E,YAAa9E,EAAU+E,SAC1CogB,GACFpmB,EAAYe,IAAId,EAAU,qCAAqCkS,EAAItR,KAAK4lB,wBAAwB7gB,qBAC/F5E,KAAK,SAAUC,GACdA,EAAUC,MAAMqP,gBAAkB1P,EAAKsC,GACvClC,EAAUC,MAAMuP,MAAQ5P,EAAK+kB,GAAGnV,MAChC9Q,EAAQiP,WAAW,KAAM3N,EAAUC,OACnCrB,EAAUoG,KAAK,eACfiM,EAAUG,SACVkN,EAAQnN,WAEZ2C,EAAS,WAAYzV,QAAQ8H,QAAQ,0BAA0B6O,UAC/D7D,MAEI2C,EAAS,WAAYzV,QAAQ8H,QAAQ,0BAA0B6O,UAC/D7D,IACAmN,EAAQnN,cAMxB,QAASsU,KACL,GAAIxlB,IACAiV,QAASjT,EAAOC,GAChB8M,cAAekC,EAAItR,KAAKoP,cACxB0W,cAAezjB,EAAOkN,WAAW,IAAIlN,EAAOmN,UAGhDtC,GAAM6B,QAAQ,uCAAwC,WACpD5P,EAAYmG,IAAKlG,EAAQ,8BAA8BY,EAAKsC,GAAG,YAAajC,GAC3EF,KAAK,SAAUC,GACdvB,EAAQoG,KAAK7E,EAAU8E,YAAa9E,EAAU+E,SAC9C+O,EAAS,WAAYzV,QAAQ8H,QAAQ,0BAA0B6O,UAC/D7D,QAKR,QAASoU,KACLzY,EAAM6B,QAAQ,sCAAuC,WACjD,GAAI1O,IACAiV,QAASjT,EAAOC,GAChByjB,QAASzU,EAAItR,KAAK0lB,sBAClBtW,cAAekC,EAAItR,KAAKoP,cAE5BjQ,GAAYmG,IAAKlG,EAAQ,8BAA8BY,EAAKsC,GAAG,WAAYjC,GAC1EF,KAAK,SAAUC,GACZvB,EAAQoG,KAAK7E,EAAU8E,YAAa9E,EAAU+E,SAC9C+O,EAAS,WAAYzV,QAAQ8H,QAAQ,0BAA0B6O,UAC/D7D,QAKZ,QAASyU,GAAW3kB,GAChB5C,QAAQ8H,QAAQlF,EAAG4kB,eAAeC,OAAOC,WAAW,GAAG/Q,QACvD9D,EAAItR,KAAKomB,aAAc,EAG3B,QAASC,GAAMC,GACXnnB,EAAYe,IAAId,EAAQ,+CAA+CY,EAAKsC,IAC3EnC,KAAK,SAAUC,GACZ,GAA0B,GAAvBA,EAAUC,MAAMa,MACdzC,QAAQ+D,UAAU8jB,IAAMA,EACzBjB,EAAQ,SAGRnY,EAAM6B,QAAQ,oCAAoCuC,EAAItR,KAAK4lB,wBAAwB3lB,OAAO,IAAK,WAC7Fd,EAAYe,IAAId,EAAU,qCAAqCkS,EAAItR,KAAK4lB,wBAAwB7gB,qBAC/F5E,KAAK,SAAUC,GACZA,EAAUC,MAAMqP,gBAAkB1P,EAAKsC,GACvClC,EAAUC,MAAMuP,MAAQ5P,EAAK+kB,GAAGnV,MAChC9Q,EAAQiP,WAAW,KAAM3N,EAAUC,OACnCrB,EAAUoG,KAAK,eACfiM,EAAUG,WAEdD,UAMF,CACA,GAAI7C,GAAMtO,EAAUC,MAAMyN,UAAU,GAChCwF,EAAO,EACXA,IAAO,wCACPA,GAAO,uDACPA,GAAO,WAAW5E,EAAIzO,OAAO,QAC7BqT,GAAO,sBAAsB5E,EAAIS,iBAAiB,QAClDmE,GAAO,WAAW5E,EAAIT,OAAO,QAC7BqF,GAAO,sBAAsBoP,EAASkC,OAAOlW,EAAIuG,iBAAiB,QAClE/H,EAAMqZ,MAAMjT,GACZtU,EAAUoG,KAAK,iBAU3B,QAAS0K,GAAaC,GAAUvQ,EAAUwQ,UAAUD,GAAQ,GAC5D,QAASwB,KAAUF,EAAUG,SAzN7B,GAAIF,GAAMpH,CACVoH,GAAItR,QACJsR,EAAItR,KAAK+kB,GAAG/kB,EAAK+kB,GACjBzT,EAAItR,KAAKoP,cACTkC,EAAItR,KAAKomB,aAAc,EACvB9U,EAAItR,KAAK2U,YAAY3U,EAAK+kB,GAAGpQ,YAE7BrD,EAAItR,KAAKsT,KAAKtT,EAAKuT,IAAID,KACvBhC,EAAItR,KAAKuT,IAAIvT,EAAKuT,IAAIA,IACtBjC,EAAItR,KAAKwT,WAAU,EACnBlC,EAAItR,KAAKyT,UAAUzT,EAAKuT,IAAIG,mBAG5BpC,EAAIC,OAASA,EACbD,EAAI+T,QAAUA,EACd/T,EAAIuU,SAAWA,EACfvU,EAAIqU,QAAUA,EACdrU,EAAI0U,WAAaA,EACjB1U,EAAI+U,MAAQA,EACZ/U,EAAIxB,aAAeA,EAEnBwB,EAAI4E,WAAa,SAAU5T,EAAIqO,GAAQA,EAAInR,EAAU2W,SAAS7T,GAAU9C,EAAUwQ,UAAU1N,GAAI,IAChGgP,EAAI2E,QAAQ,WAAY3E,EAAItR,KAAKwT,WAAU,GAC3ClC,EAAI9E,OAAO,WAAY8E,EAAItR,KAAKwT,WAAU,GAE1CpG,IAzIJ,GAAI1N,GAAK+I,IACT/I,GAAGyL,OAAS,uBACZ,IAAI9I,GAASvD,EAAQgO,SACrBpN,GAAG4V,QAAQjT,EAAOC,GAClB5C,EAAG6V,IAAMnW,EAAU,8BAA8BiD,EAAOC,GAAG,SAG3D5C,EAAG8B,YAAcA,EAEjB9B,EAAGgX,YACDC,QAAO,EACPC,QAAO,EACPC,UAAO,GAGTnX,EAAG0iB,iBAAoBC,EAAE,QAASC,EAAE,aAAcD,EAAE,QAASC,EAAE,cAC5DjgB,EAAO8gB,SACNzjB,EAAG0iB,eAAe5c,MAAO6c,EAAE,QAASC,EAAE,YAG1C5iB,EAAG8V,QACD,eACA,SACA,mBACA,QACA,SACA,kBACA,uBAGF9V,EAAGoX,UAECwH,UAAU,EACV8E,SAAU,SACVC,QACE5G,WACE1F,QAAS,SACTC,KAAM,UACNC,QAAS0L,GAEXa,SACEzM,QAAS,MACTC,KAAM,iBACNC,QAASzV,MAKXuV,QAAS,gBACTC,KAAM,WACNC,QAAS4G,IA7CjB4G,EAAqBzX,SAAW,cAAe,UAAW,UAAW,UAAW,YAAa,QAAS,aAAc,WAAY,YAAa,WAZ7IvO,QACGC,OAAO,OACPqL,WAAW,uBAAwB0a,MAoVxC,WACE,YAOA,SAAS+B,GAAkBxnB,EAAWH,EAASM,EAAaC,EAASqnB,EAAgBtZ,EAAgBrO,EAAS4f,EAASxK,EAAUwS,EAAO9U,EAAM+U,GAE5I,GAAIjnB,GAAK+I,IACT/I,GAAGknB,qBAEHlnB,EAAGmnB,YAAc,SAAU9gB,GACzB2Y,EAAQzZ,MACNjF,MACEmF,QAAS,0BACT4B,KAAM,aAIV5H,EAAYe,IAAId,EAAU,6BAA+B2G,EAAKuK,YAC7DnQ,KAAK,SAAU2mB,GAEd,GAAGroB,QAAQ2K,YAAY0d,GACrB,KAAMrkB,OAAM,iCAEd,IAAIskB,GAAOD,EAAYzmB,MAAM0mB,KACzBC,EAAOF,EAAYzmB,MAAM2mB,KACzBC,EAAQH,EAAYzmB,MAAM4mB,MAC1B7hB,EAAOtG,EAAQyO,WAAW,OAE9B,IADAwZ,EAAK5D,SAAU,EACJ,MAAR/d,EAAe,CAChB,GAAI8hB,GAAM,EACVD,GAAME,QAAQ,SAASphB,GACjBA,EAAK6O,IAAIE,KAAOoS,GAAyB,IAAlBnhB,EAAK6O,IAAIE,OAAYoS,EAAMnhB,EAAK6O,IAAIE,MACxC,QAAnB/O,EAAK6O,IAAI3U,SAAmB8mB,EAAK5D,SAAU,KAEjD/d,GAAQ,aAAc,aAAc,YAAa,aAAc,cAAc8hB,GAM/E,GAJAT,EAAeW,QAAQL,GACvBjoB,EAAQsoB,QAAQL,GAChBN,EAAeY,QAAQL,EAAKA,MAC5BloB,EAAQiP,WAAW,OAAQ0Y,EAAea,WACvCliB,EAAM,CACP,GAAImiB,GAAQniB,EAAK8V,QAAQ,IAAK,IAC1BX,EAAO3I,EAAK4V,cAAc1oB,EAAQyO,WAAW,QAASga,EAC1DZ,GAAkBc,UAAUlN,EAAK,IACjCoM,EAAkBe,WAAWnN,EAAK,IAEpCrG,EAAS,WACP,GAAIyT,GAAWlpB,QAAQ8H,QAAQ,WAC/BohB,GAASC,KAAK,mBAAmBC,YAAY,UAC7CF,EAASC,KAAK,oBAAoBzS,OAClCwS,EAASC,KAAK,6BAA+BL,EAAQ,MACpDO,SAAS,UAAUC,SAASA,SAASC,OAAO5S,UAE/CsR,EAAMuB,SAASnB,EAAYzmB,MAAM6nB,OACjChU,EAAS/G,EAAelF,OAAQ,KAChCxJ,QAAQ8H,QAAQ,yBAAyBqhB,KAAK,YAAYO,UAC1DjU,EAASlV,EAAUoG,KAAKA,GAAQA,EAAKlD,QAAQ,aAAiBkD,EAAO,KAAM,KAC3E8O,EAASwK,EAAQnN,SAAU,OAxC7BpS,SA0CO,WACLN,EAAQoG,KAAK,QAAS,qCAI1BvF,EAAG0oB,iBAAmB,WACpBjpB,EAAYe,IAAId,EAAU,qBACzBe,KAAK,SAAU2mB,GACd,MAAIroB,SAAQ2K,YAAY0d,OACtB9nB,GAAUoG,KAAK,eAGjBvG,EAAQoG,KAAK6hB,EAAY5hB,YAAa4hB,EAAY3hB,cAClDzF,EAAGknB,kBAAoBE,EAAYzmB,MAAMyN,cAP3C3O,SASO,WACLN,EAAQoG,KAAK,QAAS,+CAG1BvF,EAAG0oB,mBAlEL5B,EAAkBxZ,SAAW,YAAa,UAAW,cAAe,UAAW,iBAAkB,iBAAkB,UAAW,UAAW,WAAY,QAAS,OAAQ,qBAbtKvO,QACCC,OAAO,OACPqL,WAAW,oBAAqByc,MAiFnC,WACI,YAQA,SAAS6B,GAAmBjpB,EAAS8N,EAAO/N,EAAayS,EAAM/S,EAASC,EAASG,GAuB7E,QAASqpB,GAAYjnB,GACjBpC,EAAKqC,IAAI,eAAgBD,GAG7B,QAASknB,GAAwBvoB,EAAMnB,EAASqL,EAAOse,EAAYnX,EAAUnE,EAAM/N,EAAYC,EAAQ8U,GAerG,QAAS4O,KACP,GAAImE,MACAwB,KACAC,IACJvpB,GAAYe,IAAId,EAAQ,iBACvBe,KAAK,SAAS8R,GAEb,GADAgV,EAAMhV,EAAS5R,MAAMyN,UAClB6a,EAAW,CACZ,GAAIC,GAAe5oB,EAAK6oB,WACxB5B,GAAME,QAAQ,SAAS2B,EAAWC,GAChC,GAAInU,IACFR,OAAO0U,EAAW1U,OAClBnU,OAAO6oB,EAAW7oB,OAClB+oB,OAAM,EAGW,OAAhBJ,GAAwBA,EAAe/nB,OAAO,EAC/C+nB,EAAezB,QAAQ,SAASphB,EAAKkjB,GAChCH,EAAW1U,QAAQrO,EAAK6O,IAAIR,SAAQQ,EAAIoU,OAAM,GAC9CC,GAAQL,EAAe/nB,OAAO,IAC/B4nB,EAAYjjB,KAAKoP,GACdmU,GAAc9B,EAAMpmB,OAAO,IAAGyQ,EAAItR,KAAKinB,MAAMwB,MAIpDnX,EAAItR,KAAKinB,MAAQA,QAOrBA,GAAME,QAAQ,SAASphB,EAAKkjB,GAE1B,GAAIrU,IACFR,OAAOrO,EAAKqO,OACZnU,OAAO8F,EAAK9F,OACZ+oB,OAAM,EAERP,GAAYjjB,KAAKoP,GACdqU,GAAQhC,EAAMpmB,OAAO,IAAGyQ,EAAItR,KAAKinB,MAAMwB,OAMhDtpB,EAAYe,IAAId,EAAU,2BACzBe,KAAK,SAAU8R,GACVxT,QAAQ2K,YAAY6I,EAAS5R,MAAMyN,aAAY4a,MACnDA,EAAYzW,EAAS5R,MAAMyN,SAC3B,IAAIob,KAEJ,IAAIP,GAAcA,KAAe,EAE/B,YADArX,EAAItR,KAAK0oB,UAAYA,EAIvB,IAAIS,GAAQ7X,EAAItR,KAAK0oB,aACrBA,GAAUvB,QAAQ,SAAUiC,GAC1B,GAAIC,IACF/Y,WAAY8Y,EAAS9Y,WACrBgZ,MAAOF,EAASE,MAChBhN,QAAS8M,EAAS9M,QAClBiN,MAAOH,EAASG,MAChBP,OAAO,EACPQ,QAASJ,EAASI,QAED,IAAhBL,EAAMtoB,QACPqoB,EAAU1jB,KAAK6jB,EAEjB,IAAII,KACJN,GAAMhC,QAAQ,SAAUuC,GAClBN,EAAS9Y,YAAcoZ,EAAQC,sBACjCF,EAAYjkB,KAAK4jB,EAAS9Y,YAC1B+Y,EAAQO,WAAaF,EAAQE,WACN,UAAlBF,EAAQzb,QACXob,EAAQE,OAAQ,EAChBF,EAAQL,OAAQ,GAGhBK,EAAQL,OAAQ,EAGlBE,EAAU1jB,KAAK6jB,MAIhBI,EAAYvnB,QAAQknB,EAAS9Y,kBAAqB6Y,EAAMtoB,OAAS,GAClEqoB,EAAU1jB,KAAK6jB,KAInB/X,EAAItR,KAAK0oB,UAAYQ,IAIvB/pB,EAAYe,IAAId,EAAQ,wDACvBe,KAAK,SAAUC,GACZkR,EAAItR,KAAK6pB,SAAWzpB,EAAUC,MAAMyN,YAK1C,QAASyD,KACPF,EAAUG,SAIZ,QAASsY,KAEP,GAAI7C,KACJ,KAAI,GAAIrmB,KAAK0Q,GAAItR,KAAKinB,MACQ,GAAzB3V,EAAItR,KAAKinB,MAAMrmB,GAAGooB,OAAa/B,EAAMzhB,KAAK8L,EAAItR,KAAKinB,MAAMrmB,GAAGwT,OAEjE,IAAI2V,KACJ,KAAI,GAAIrkB,KAAK4L,GAAItR,KAAK+pB,SAEW,GAA5BzY,EAAItR,KAAK+pB,SAASrkB,GAAGsjB,OAAae,EAASvkB,KAAK8L,EAAItR,KAAK+pB,SAASrkB,GAAGskB,WAG1E,IAAI1U,IACFA,QAAQhE,EAAItR,KAAKsV,QACjB2U,WAAW3Y,EAAItR,KAAKiqB,WACpBC,WAAW,IACXC,iBAAiB7Y,EAAItR,KAAKmqB,iBAC1B7N,QAAQhL,EAAItR,KAAKsc,QACjBC,UAAUjL,EAAItR,KAAKuc,UACnB+M,MAAMhY,EAAItR,KAAKspB,MACfc,MAAM9Y,EAAItR,KAAKoqB,MACfnc,OAAOqD,EAAItR,KAAKiO,OAChBgZ,MAAMA,EACN8C,SAASA,EACTrB,UAAWpX,EAAItR,KAAK0oB,UAInBC,IACDrT,EAAQhF,WAAWgB,EAAItR,KAAKsQ,WAC5BgF,EAAQjQ,sBAAsBhD,EAAOC,GACrCgT,EAAQJ,oBAAoB,GAAIvG,QAGhC2G,EAAQlT,kBAAkBC,EAAOC,GACjCgT,EAAQL,gBAAiB,GAAItG,OAG5Bga,EACDxpB,EAAYmG,IAAIlG,EAAQ,qBAAqBkW,EAAQhF,WAAYgF,GAChEnV,KAAK,SAASC,GAEbvB,EAAQwiB,UACMlO,QAAX/S,IACDiR,EAAU8D,OAEVjB,EAAS,WACPzV,QAAQ8H,QAAQ,0BAA0B6O,SAC1C,QAMNjW,EAAY6F,KAAK5F,EAAQ,oBAAqBkW,GAC7CnV,KAAK,SAASC,GAEbvB,EAAQwiB,UACMlO,QAAX/S,IACDiR,EAAU8D,OACVjB,EAAS,WACPzV,QAAQ8H,QAAQ,0BAA0B6O,SAC1C,QAvLV,GAAI9D,GAAIpH,CAERoH,GAAItR,KAAOA,EAEXsR,EAAIC,OAASA,EACbD,EAAIwY,iBAAmBA,CAIvB,IAAInB,KAAY3oB,EAAK,UACrB8iB,KAtCF,GAAIpjB,GAAK+I,IAET/I,GAAGmb,MAAQ,WACXnb,EAAG6V,IAAMnW,EAAU,qBACnBM,EAAG8V,QAAU,aAAa,UAAU,mBAAmB,UAAU,YAAY,QAAQ,QAAQ,SAAS,kBAAkB,uBACxH9V,EAAG+V,kBAAqB,OAAQ,UAAW,SAAU,cAAe,YAAa,QAAS,cAAe,UAAW,WAAY8S,GAChI7oB,EAAGkH,SAAW,gDACd,IAAIvE,GAAOvD,EAAQgO,SACnBpN,GAAG4V,QAAQjT,EAAOC,GAElB5C,EAAGgX,YACDC,QAAO,EACPC,QAAO,EACPC,UAAO,GAGTnX,EAAGwX,eACCH,QAAS,uCACTC,KAAM,SACNC,QAASqR,GAZjBD,EAAmBrb,SAAW,UAAW,QAAS,cAAe,OAAQ,UAAW,UAAW,QAd/FvO,QACCC,OAAO,OACPqL,WAAW,qBAAqBse,MAuOrC,WACI,YAOA,SAASgC,GAAgB3D,EAAO1nB,EAAWH,EAAS4nB,EAAgB3nB,EAASoV,EAAUtC,EAAM+U,EAAmBtP,EAASqL,EAAUrR,EAAWnE,EAAOC,EAAgB5N,EAASJ,GAU1K,QAASmrB,KACL7rB,QAAQ8H,QAAQ,QAAQuhB,SAAS,YACjCrpB,QAAQ8H,QAAQ,QAAQshB,YAAY,aAES,MAAzCxQ,EAAQkT,aAAaC,QAAQ,UAA6DrX,QAAzCkE,EAAQkT,aAAaC,QAAQ,WAC9E3rB,EAAQ0G,MAAM8R,EAAQkT,aAAaC,QAAQ,UAC3CnT,EAAQkT,aAAa/gB,WAAW,UAIxC,QAASiJ,KACLiU,EAAMjU,OACFgY,SAAU/qB,EAAG+qB,SACbC,SAAUhrB,EAAGgrB,WAEhBvqB,KAAK,SAAS8R,GACX,GAAI8U,GAAO9U,EAASjS,KAAKK,MAAM0mB,KAC3BC,EAAO/U,EAASjS,KAAKK,MAAM2mB,KAC3BC,EAAQhV,EAASjS,KAAKK,MAAM4mB,KAEhCxoB,SAAQ8H,QAAQ,QAAQshB,YAAY,YACpCppB,QAAQ8H,QAAQ,QAAQuhB,SAAS,YAEjC,IAAI1iB,GAAOtG,EAAQyO,WAAW,OAE9B,IADAwZ,EAAK5D,SAAQ,EACJ,MAAN/d,EAAW,CACV,GAAI8hB,GAAM,EACVD,GAAME,QAAQ,SAAUwD,GACjBA,EAAG/V,IAAIE,KAAKoS,GAAqB,IAAdyD,EAAG/V,IAAIE,OAAWoS,EAAMyD,EAAG/V,IAAIE,MACnC,QAAf6V,EAAG/V,IAAI3U,SAAgB8mB,EAAK5D,SAAQ,KAE3C/d,GAAQ,aAAa,aAAa,aAAc,YAAa,aAAc,cAAc8hB,GAa7F,GATAT,EAAeW,QAAQL,GACvBjoB,EAAQsoB,QAAQL,GAIhBN,EAAeY,QAAQL,GACvBloB,EAAQiP,WAAW,OAAQ0Y,EAAea,WAGtCliB,EAAM,CACN,GAAImiB,GAAQniB,EAAK8V,QAAQ,IAAK,IAG1BX,EAAO3I,EAAK4V,cAAc1oB,EAAQyO,WAAW,QAASga,EAC1DZ,GAAkBc,UAAUlN,EAAK,IACjCoM,EAAkBe,WAAWnN,EAAK,IAGlCrG,EAAS,WACL,GAAIyT,GAAWlpB,QAAQ8H,QAAQ,WAC/BohB,GAASC,KAAK,mBAAmBC,YAAY,UAC7CF,EAASC,KAAK,oBAAoBzS,OAClCwS,EAASC,KAAK,6BAA+BL,EAAQ,MAC5CO,SAAS,UAAUC,SAASA,SAASC,OAAO5S,UAI7DjI,EAAelF,OAEfxJ,QAAQ8H,QAAQ,yBAAyBqhB,KAAK,YAAYO,UAG1DnpB,EAAUoG,KAAKA,GAAQA,EAAKlD,QAAQ,aAAgBkD,EAAO,OAxD/DshB,SA2DO,SAASnhB,GACQ,KAAhBA,EAAM2b,QAAiC,KAAhB3b,EAAM2b,QAC7BriB,EAAQ0G,MAAM,gDAEC,KAAhBA,EAAM2b,QACLriB,EAAQoG,KAAKM,EAAMvF,KAAKkF,YAAYK,EAAMvF,KAAKmF,SAG/CI,EAAM2b,YACNriB,EAAQ0G,MAAM,6BAoB1B,QAASqlB,GAA0B1gB,EAAOmH,EAAWlS,EAAaN,EAASO,GACzE,GAAIkS,GAAIpH,CACRoH,GAAIgE,QAAQ,KACZhE,EAAI8Y,MAAM,KACV9Y,EAAI6Y,iBAAiB,KAGrB7Y,EAAIuZ,UAAU,WAEZ,GAAIlW,IACFW,QAAQhE,EAAIgE,QACZ8U,MAAM9Y,EAAI8Y,MACVD,iBAAiB7Y,EAAI6Y,iBAGvBhrB,GAAYmG,IAAIlG,EAAQ,uBAAwBuV,GAC/CxU,KAAK,SAAS0kB,GACbhmB,EAAQoG,KAAK4f,EAAW3f,YAAY2f,EAAW1f,SAC/CmM,EAAIC,YAIRD,EAAIC,OAAQ,WACVF,EAAUG,UAIhB,QAASsZ,KACL,GAAIC,GAAQrrB,EAAGH,QAAU,QACzBJ,GAAYe,IAAI6qB,GACf5qB,KAAK,SAAS8R,GACTA,IACFoF,EAAQkT,aAAaS,QAAQ,eAAgB/Y,EAAS5R,MAAM4qB,QAC5D5T,EAAQ6T,SAASC,KAAOlZ,EAAS5R,MAAMkV,OAJ3CpW,SAQK,SAAUisB,GACfvsB,EAAQ0G,MAAM6lB,KAIlB,QAASC,KACLrsB,EAAUoG,KAAK,aAtJjB,GAAI1F,GAAK+I,IACT/I,GAAG+S,MAAQA,EACX/S,EAAGorB,cAAeA,EAClBprB,EAAG2rB,aAAcA,EACjB3rB,EAAGH,QAAUA,EACbT,EAAQwsB,iBACRhB,IAuFA5qB,EAAG6rB,YAAa,SAAShV,GAEvB,GAAI3M,IACF7B,MAAOwO,EACPsE,MAAO,uBACP5Q,YAAa,gDACbF,YAAa,SAAS,YAAY,cAAc,UAAU,UAAW6gB,GAEvE1d,GAAMjI,KAAK2E,IA7FjBygB,EAAgBrd,SAAW,QAAS,YAAa,UAAW,iBAAkB,UAAW,WAAY,OAAQ,oBAAqB,UAAW,WAAY,YAAa,QAAS,iBAAkB,UAAW,eAf5MvO,QACCC,OAAO,OACPqL,WAAW,kBAAmBsgB,MAiKnC,WACC,YAOA,SAASmB,GAAkB1sB,EAAS2nB,EAAgB/D,EAAUvjB,EAAaC,EAASP,GACnF,GAAIa,GAAK+I,IAET/I,GAAG+rB,SAAW,WACb,MAAOhF,GAAeiF,WAGvBhsB,EAAGisB,QAAU,WACZ,GAAI5E,GAAON,EAAe3Z,SAC1B,OAAOia,GAAKxX,WAAa,IAAMwX,EAAKvX,WAGrC9P,EAAGksB,SAAW,WACb,MAAOnF,GAAe3Z,UAAUsd,OAGjC1qB,EAAGmsB,WAAa,WACf,GAAIC,GAAYrF,EAAe3Z,UAAUyC,UACzC,OAAOuc,GAAUjrB,OAASirB,EAAU,GAAG5a,cAAgB,KAGxDxR,EAAGqsB,QAAU,SAAU3b,GAEtB,GAAI/H,GAAQoe,EAAe3Z,UAAUsD,EACrC,QAAK,aAAc,eAAelO,QAAQkO,OAClCsS,EAASsJ,gBAAgB,GAAIrd,MAAKtG,IAGnCA,GAGR3I,EAAGusB,UAAY,WACd,MAAOxF,GAAe3Z,UAAUqW,UAAW,GAG5CzjB,EAAGwsB,YAAc,SAAU5O,GAClB,yBAALA,EACFne,EAAYe,IAAId,EAAU,6HAA6HM,EAAGqsB,QAAQ,OACjK5rB,KAAK,SAAUC,GACfV,EAAGysB,eAAiB7O,EACpB5d,EAAG0sB,GAAKhsB,EAAUC,MAAMyN,UAAU,GAClCpO,EAAG0sB,GAAGhC,MAAQ1qB,EAAGksB,aAIlBzsB,EAAYe,IAAId,EAAU,qBAAsBM,EAAGqsB,QAAQ,OAC1D5rB,KAAK,SAAUC,GACZA,EAAUC,QAEZX,EAAGyqB,iBAAmB/pB,EAAUC,MAAM8pB,iBACtCzqB,EAAG2sB,eAAiBjsB,EAAUC,MAAMiV,QACpC5V,EAAG0qB,MAAQhqB,EAAUC,MAAM+pB,MAC3B1qB,EAAG4c,QAAUlc,EAAUC,MAAMic,QAC7B5c,EAAG6c,UAAYnc,EAAUC,MAAMkc,UACrB,iBAAPe,IACF5d,EAAGwqB,WAAa9pB,EAAUC,MAAM6pB,YAEjCxqB,EAAGysB,eAAiB7O,MAKxB5d,EAAG4sB,aAAe,WACjB,GAAIC,IACHjc,WAAY5Q,EAAGqsB,QAAQ,MACvB5B,iBAAkBzqB,EAAGyqB,iBACrB7U,QAAS5V,EAAG2sB,eACZjC,MAAO1qB,EAAG0qB,MACV9N,QAAS5c,EAAG4c,QACZkQ,iBAAkB9sB,EAAG6c,UACrBlX,sBAAuB3F,EAAGqsB,QAAQ,OAE/BU,GAAQ,CACa,kBAArB/sB,EAAGysB,eACNI,EAAerC,WAAaxqB,EAAGwqB,WACD,qBAArBxqB,EAAGysB,iBACTzsB,EAAGgtB,mBAAqBhtB,EAAGitB,qBAC7B9tB,EAAQ0G,MAAM,oEACdknB,GAAQ,GAETF,EAAeK,oBAAsBltB,EAAGwqB,WACxCqC,EAAerC,WAAaxqB,EAAGgtB,kBAE7BD,GACFttB,EAAYmG,IAAIlG,EAAU,qBAAqBM,EAAGqsB,QAAQ,MAAOQ,GAChEpsB,KAAK,SAAUC,GACf,GAAGA,EAAUC,MAAM,CAElBX,EAAGyqB,iBAAmB,KACtBzqB,EAAG2sB,eAAiB,KACpB3sB,EAAG0qB,MAAQ,KACX1qB,EAAG4c,QAAU,KACb5c,EAAG6c,UAAY,KAEf7c,EAAGwqB,WAAa,KAChBxqB,EAAGgtB,iBAAmB,KACtBhtB,EAAGitB,mBAAqB,IACxB,IAAIE,IACHvqB,GAAIlC,EAAUC,MAAMiQ,WACpBma,SAAUrqB,EAAUC,MAAMiV,QAC1B/F,WAAYnP,EAAUC,MAAMic,QAC5B9M,UAAWpP,EAAUC,MAAMmsB,iBAAiB,IAAIpsB,EAAUC,MAAMysB,iBAChExD,MAAOlpB,EAAUC,MAAMipB,MACvB5a,IAAKtO,EAAUC,MAAM8pB,iBACrBC,MAAOhqB,EAAUC,MAAM+pB,MACvB2C,YAAa3sB,EAAUC,MAAM4U,gBAG9BwR,GAAeW,QAAQyF,GACvB/tB,EAAQsoB,QAAQyF,GAChBntB,EAAGysB,eAAiB,KACpBttB,EAAQoG,KAAK7E,EAAU8E,YAAa9E,EAAU+E,aAKlDzF,EAAGstB,oBAAsB,WACxB,GAAIC,GAAcxuB,QAAQuD,KAAKtC,EAAG0sB,GAClCjtB,GAAYmG,IAAIlG,EAAU,kCAAkC6tB,EAAYC,qBAAsBD,GAC7F9sB,KAAK,SAAUC,GACfvB,EAAQoG,KAAK7E,EAAU8E,YAAa9E,EAAU+E,SAC9CzF,EAAGysB,eAAiB,QAKtBzsB,EAAGytB,eAAiB,WACnBztB,EAAGyqB,iBAAmB,KACtBzqB,EAAG2sB,eAAiB,KACpB3sB,EAAG0qB,MAAQ,KACX1qB,EAAG4c,QAAU,KACb5c,EAAG6c,UAAY,KAEf7c,EAAGwqB,WAAa,KAChBxqB,EAAGgtB,iBAAmB,KACtBhtB,EAAGitB,mBAAqB,KAExBjtB,EAAGysB,eAAe,MA9HpBX,EAAkBxe,SAAW,UAAW,iBAAkB,WAAY,cAAe,UAAW,WAhBhGvO,QACCC,OAAO,OACPqL,WAAW,oBAAqByhB,MAkJlC,WACE,YAOA,SAAS4B,GAAeljB,GAClB,GAAIxK,GAAK+I,KACL4kB,EAAKnjB,CACTmjB,GAAG3tB,GAAKA,EACR2tB,EAAGC,OAAO,YAAa,SAAUC,GACzBA,EAAS,EAAIF,EAAGxkB,GAAG2kB,MAAMC,OAAS,MAC7BF,EAAS,GAAKF,EAAGxkB,GAAG2kB,MAAMC,OAAS,OACpCJ,EAAGxkB,GAAG2kB,QAAOH,EAAGxkB,GAAG2kB,MAAMC,OAASJ,EAAGxkB,GAAG4kB,OAAO,QAKjEL,EAAepgB,SAAW,UAjB1BvO,QACGC,OAAO,OACPqL,WAAW,oBAAqBqjB,MAerC,WACE,YAOA,SAAS/gB,GAAenC,EAAQ/K,EAAaC,EAASE,GAwCpD,QAASouB,GAAc1P,EAAQlD,GAE7B,OADArc,QAAQ8H,QAAQyX,EAAOiI,eAAe8B,SAAS7B,OAAOC,WAAW,GAAG/Q,QAC5D0F,GACN,IAAK,WAAYpb,EAAGiuB,iBAAkB,GAI1C,QAASC,KACPluB,EAAGmuB,eAAiB,GACpBnuB,EAAGiuB,iBAAkB,EAhDvB,GAEIG,GAFApuB,EAAK+I,KACL4kB,EAAKnjB,CAGTmjB,GAAG3tB,GAAKA,EACRA,EAAGmuB,eAAiB,GACpBnuB,EAAGiuB,iBAAkB,EACrBjuB,EAAGquB,aAEHruB,EAAGguB,cAAgBA,EACnBhuB,EAAGkuB,eAAiBA,EAChBnvB,QAAQ2K,YAAYikB,EAAG3jB,MAAM2jB,EAAGjlB,QAAQgI,QAAOid,EAAG3jB,MAAM2jB,EAAGjlB,QAAQgI,SACnE3R,QAAQ2K,YAAYikB,EAAG3jB,MAAM2jB,EAAGjlB,QAAQgI,KAAK9E,SAAQ+hB,EAAG3jB,MAAM2jB,EAAGjlB,QAAQgI,KAAK9E,UAElF+hB,EAAGC,OAAO,oBAAqB,WAC7B,GAAIU,GACAC,IAIJ,KAHAvuB,EAAGquB,aACHD,EAAgBT,EAAG3jB,MAAM2jB,EAAGjlB,QAAQgI,KAAK9E,UAEpC0iB,EAAW,EAAGA,EAAWF,EAAcjtB,OAAQmtB,IAClDtuB,EAAGquB,UAAUvoB,KAAKsoB,EAAcE,GAGV,KAArBtuB,EAAGmuB,gBACJ1uB,EAAYe,IAAId,EAAU,qCAAqCM,EAAGmuB,gBACjE1tB,KAAK,SAAUC,GAGd,IAFAV,EAAGquB,aACHE,EAAS7tB,EAAUC,MAAMyN,UACpBkgB,EAAW,EAAGA,EAAWF,EAAeE,IAAatuB,EAAGquB,UAAUvoB,KAAKsoB,EAAcE,GAC1F,KAAKA,EAAW,EAAGA,EAAWC,EAAOptB,OAAQmtB,IACvC1uB,EAAU4uB,UAAUJ,EAAe,cAAeG,EAAOD,GAAUjK,cACrErkB,EAAGquB,UAAUvoB,KAAKyoB,EAAOD,QApBrC3hB,EAAeW,SAAW,SAAU,cAAe,UAAW,aAlB9DvO,QACCC,OAAO,OACPqL,WAAW,6BAA8BsC,MAyD5C,WACE,YAOA,SAAS8hB,GAAqBjkB,EAAQ/K,EAAaC,EAAS8U,EAAUpV,EAAS4jB,EAAUpjB,GAmBvF,QAAS8uB,KACL,GAAIC,GAAIC,EAAG1tB,EAAGyP,EAAKke,EAAKC,EAAOC,EAAMC,EACjCC,EAAalwB,QAAQ2K,YAAYikB,EAAG3jB,MAAM2jB,EAAGjlB,QAAQgI,KAczD,IAZAie,GACI/d,WAAYjO,EAAOC,GACnBga,QAASja,EAAOkN,WAChBgN,UAAWla,EAAOmN,UAClB8Z,MAAOjnB,EAAOinB,OAIlB7qB,QAAQ8H,QAAQ,0BAA0BqoB,GAAG,UAAW,SAASvtB,GAC7DA,EAAGwtB,oBAGJF,EACCtB,EAAG3jB,MAAM2jB,EAAGjlB,QAAQgI,QACpBid,EAAG3jB,MAAM2jB,EAAGjlB,QAAQgI,KAAK,IAASie,OASlC,IANAG,EAAQnB,EAAG3jB,MAAM2jB,EAAGjlB,QAAQgI,KAAK,OAAYE,eAC7Cie,EAAMlB,EAAG3jB,MAAM2jB,EAAGjlB,QAAQgI,KAAK,KAAUE,eACzCme,EAAOpB,EAAG3jB,MAAM2jB,EAAGjlB,QAAQgI,KAAK,MAAWE,eAC3C5Q,EAAGovB,kBACHJ,EAAK5vB,EAAQyO,WAAW,aAEjB,MAAJmhB,EAAS,CACR,GAAGjwB,QAAQ+D,UAAUksB,EAAGngB,KACpB,IAAK3N,EAAI,EAAGA,EAAI8tB,EAAGngB,IAAI1N,OAAQD,IACxB8tB,EAAGngB,IAAI3N,KAAK8tB,EAAGrgB,aAClB3O,EAAGovB,eAAeJ,EAAGngB,IAAI3N,KAAM,EAGpCysB,GAAG3jB,MAAM,WAAa2jB,EAAG3jB,MAAM,UAAU,OACxChK,EAAGovB,eAAeJ,EAAGpgB,KAAK,KAAM,GAI5CnP,EAAYe,IAAId,EAAU,0BACzBe,KAAK,SAAU2N,GAKZ,GAJApO,EAAGiZ,YACHjZ,EAAGqvB,kBACH1e,EAAMvC,EAAUzN,MAEbsuB,EACC,IAAK/tB,EAAI,EAAGA,EAAIyP,EAAIxP,OAAQD,IACxB0tB,EAAIU,EAAQ3e,EAAIzP,IAChBlB,EAAGiZ,SAASnT,KAAO6oB,EAAG/d,YAAYge,EAAEhe,WAAa+d,EAAKC,GACtD5uB,EAAGqvB,eAAevpB,KAAK8oB,OAG3B,KAAK1tB,EAAI,EAAGA,EAAIyP,EAAIxP,OAAQD,IACxB0tB,EAAIU,EAAQ3e,EAAIzP,IACb4tB,GAASlvB,EAAU4uB,UAAUM,EAAO,aAAcF,EAAEhe,aACnD5Q,EAAGqvB,eAAevpB,KAAKlG,EAAU4uB,UAAUM,EAAO,aAAcF,EAAEhe,YAAY,IAC9E5Q,EAAGiZ,SAASnT,KAAK8oB,IACZG,GAAQnvB,EAAU4uB,UAAUO,EAAM,aAAcH,EAAEhe,aACvD5Q,EAAGqvB,eAAevpB,KAAKlG,EAAU4uB,UAAUO,EAAM,aAAcH,EAAEhe,YAAY,IAC7E5Q,EAAGiZ,SAASnT,KAAK8oB,IACZhvB,EAAU4uB,UAAUK,EAAK,aAAcD,EAAEhe,YAC9C5Q,EAAGiZ,SAASnT,KAAKlG,EAAU4uB,UAAUK,EAAK,aAAcD,EAAEhe,YAAY,KAEtE5Q,EAAGqvB,eAAevpB,KAAK8oB,GACvB5uB,EAAGiZ,SAASnT,KAAK8oB,MAOrC,QAASU,GAAQC,GACb,OACI3e,WAAY2e,EAAG3e,WACfgM,QAAS2S,EAAG3S,QACZC,UAAW0S,EAAG1S,UACd+M,MAAO2F,EAAG3F,OAIlB,QAAS4F,GAAappB,EAAOqpB,EAAKC,GAC9B,GAAI/e,GAAMgd,EAAG3jB,MAAM2jB,EAAGjlB,QAAQgI,KAAMgf,GAAK,MACjC,SAALD,EAAa7vB,EAAU8G,MAAMiK,EAAKvK,EAAOA,EAAM,GACrC,MAALqpB,GAAW7vB,EAAU8G,MAAMiK,EAAKvK,EAAOA,EAAM,GAIzD,QAASkgB,GAAW3kB,EAAI4D,GAGpB,OADAxG,QAAQ8H,QAAQlF,EAAG4kB,eAAe8B,SAAS7B,OAAOC,WAAW,GAAG/Q,QACxDnQ,GACJ,IAAK,OAAQvF,EAAG2vB,WAAY,CAAM,MAClC,KAAK,MAAO3vB,EAAG4vB,UAAW,CAAM,MAChC,KAAK,KAAM5vB,EAAG6vB,SAAU,GA/GhC,GAAI7vB,GAAK+I,KACL4kB,EAAKnjB,CACTmjB,GAAG3tB,GAAKA,CACR,IAAI2C,GAASvD,EAAQgO,SAErBpN,GAAG8vB,YAAc,GACjB9vB,EAAG+vB,WAAa,GAChB/vB,EAAGgwB,UAAY,GACfhwB,EAAG2vB,WAAY,EACf3vB,EAAG4vB,UAAW,EACd5vB,EAAG6vB,SAAU,EAGb7vB,EAAGsmB,WAAaA,EAChBtmB,EAAGwvB,aAAeA,EAElBhb,EAASka,GAHXD,EAAqBnhB,SAAW,SAAU,cAAe,UAAW,WAAY,UAAW,WAAY,aAnBvGvO,QACGC,OAAO,OACPqL,WAAW,yBAA0BokB,MA0H1C,WACE,YAOA,SAASjjB,GAAuBhB,EAAQ/K,EAAaC,EAASE,EAAWE,GAmCvE,QAASwmB,GAAW3kB,EAAI4D,GAEpB,OADAxG,QAAQ8H,QAAQlF,EAAG4kB,eAAe8B,SAAS7B,OAAOC,WAAW,GAAG/Q,QACxDnQ,GACJ,IAAK,MAAOvF,EAAGiwB,UAAW,GAIlC,QAASC,KACLlwB,EAAGmwB,WAAW,GACdnwB,EAAGiwB,UAAS,EAGhB,QAASzZ,GAAWM,GAChBhX,EAAUwQ,UAAUwG,GA/CxB,GAEIsZ,GAFApwB,EAAK+I,KACL4kB,EAAKnjB,CAETmjB,GAAG3tB,GAAKA,EACRA,EAAGmwB,WAAa,GAChBnwB,EAAGiwB,UAAW,EACdjwB,EAAGkc,cAGHlc,EAAGsmB,WAAaA,EAChBtmB,EAAGwW,WAAaA,EAChBxW,EAAGkwB,eAAiBA,EAEpBvC,EAAGC,OAAO,gBAAiB,WACvB,GAAI1sB,GAAGyP,CAGP,KAFA3Q,EAAGkc,cACHkU,EAAQzC,EAAG3jB,MAAM2jB,EAAGjlB,QAAQgI,SACvBxP,EAAI,EAAGA,EAAIkvB,EAAMjvB,OAAQD,IAAKlB,EAAGkc,WAAWpW,KAAKsqB,EAAMlvB,GAEzC,KAAflB,EAAGmwB,YAEH1wB,EAAYe,IAAKd,EAAQ,8KAA8KM,EAAGmwB,YACzM1vB,KAAK,SAAUC,GAGZ,IAFAV,EAAGkc,cACHvL,EAAMjQ,EAAUC,MAAMyN,UACjBlN,EAAI,EAAGA,EAAIkvB,EAAMjvB,OAAQD,IAAKlB,EAAGkc,WAAWpW,KAAKsqB,EAAMlvB,GAC5D,KAAKA,EAAI,EAAGA,EAAIyP,EAAIxP,OAAQD,IACpBtB,EAAU4uB,UAAU4B,EAAO,eAAgBzf,EAAIzP,GAAG0M,eAClD5N,EAAGkc,WAAWpW,KAAM6K,EAAIzP,QAd9CsK,EAAuB8B,SAAW,SAAU,cAAe,UAAW,YAAa,aApBnFvO,QACGC,OAAO,OACPqL,WAAW,qCAAsCmB,MAyDtD,WACE,YAOA,SAAS6kB,GAAiB7lB,EAAQ/K,EAAaC,EAASE,EAAWE,GAmCjE,QAASwmB,GAAW3kB,EAAI4D,GAEtB,OADAxG,QAAQ8H,QAAQlF,EAAG4kB,eAAe8B,SAAS7B,OAAOC,WAAW,GAAG/Q,QACxDnQ,GACN,IAAK,MAAOvF,EAAGiwB,UAAW,GAI9B,QAASC,KACPlwB,EAAGmwB,WAAW,GACdnwB,EAAGiwB,UAAS,EAGd,QAASzZ,GAAWM,GAClBhX,EAAUwQ,UAAUwG,GA/CtB,GAEAsZ,GAFIpwB,EAAK+I,KACT4kB,EAAKnjB,CAELmjB,GAAG3tB,GAAKA,EACRA,EAAGmwB,WAAa,GAChBnwB,EAAGiwB,UAAW,EACdjwB,EAAGkc,cAGHlc,EAAGsmB,WAAaA,EAChBtmB,EAAGwW,WAAaA,EAChBxW,EAAGkwB,eAAiBA,EAEpBvC,EAAGC,OAAO,gBAAiB,WACzB,GAAI1sB,GAAGyP,CAGP,KAFA3Q,EAAGkc,cACHkU,EAAQzC,EAAG3jB,MAAM2jB,EAAGjlB,QAAQgI,SACvBxP,EAAI,EAAGA,EAAIkvB,EAAMjvB,OAAQD,IAAKlB,EAAGkc,WAAWpW,KAAKsqB,EAAMlvB,GAEzC,KAAflB,EAAGmwB,YAEL1wB,EAAYe,IAAKd,EAAQ,8KAA8KM,EAAGmwB,YACzM1vB,KAAK,SAAUC,GAGd,IAFAV,EAAGkc,cACHvL,EAAMjQ,EAAUC,MAAMyN,UACjBlN,EAAI,EAAGA,EAAIkvB,EAAMjvB,OAAQD,IAAKlB,EAAGkc,WAAWpW,KAAKsqB,EAAMlvB,GAC5D,KAAKA,EAAI,EAAGA,EAAIyP,EAAIxP,OAAQD,IACtBtB,EAAU4uB,UAAU4B,EAAO,eAAgBzf,EAAIzP,GAAG0M,eACtD5N,EAAGkc,WAAWpW,KAAM6K,EAAIzP,QAblCmvB,EAAiB/iB,SAAW,SAAU,cAAe,UAAW,YAAa,aArB7EvO,QACCC,OAAO,OACPqL,WAAW,+BAAgCgmB,MAyD9C;AACE,YAOA,SAASC,GAAyB9lB,EAAQ/K,EAAaC,EAAS8U,EAAUpV,EAAS4jB,EAAUpjB,GAmB3F,QAAS8uB,KACL,GAAIC,GAAIC,EAAG1tB,EAAG8E,EAAG2K,EAAKke,EAAKC,EAAOC,EAAM7Z,EAAK8Z,EAAIuB,EAAWC,EACxDvB,EAAalwB,QAAQ2K,YAAYikB,EAAG3jB,MAAM2jB,EAAGjlB,QAAQgI,KAczD,IAZAie,GACI/d,WAAYjO,EAAOC,GACnBga,QAASja,EAAOkN,WAChBgN,UAAWla,EAAOmN,UAClB8Z,MAAOjnB,EAAOinB,OAIlB7qB,QAAQ8H,QAAQ,0BAA0BqoB,GAAG,UAAW,SAASvtB,GAC7DA,EAAGwtB,oBAGJF,EACCtB,EAAG3jB,MAAM2jB,EAAGjlB,QAAQgI,QACpBid,EAAG3jB,MAAM2jB,EAAGjlB,QAAQgI,KAAK,IAASie,OASlC,IANAG,EAAQnB,EAAG3jB,MAAM2jB,EAAGjlB,QAAQgI,KAAK,OAAYE,eAC7Cie,EAAMlB,EAAG3jB,MAAM2jB,EAAGjlB,QAAQgI,KAAK,KAAUE,eACzCme,EAAOpB,EAAG3jB,MAAM2jB,EAAGjlB,QAAQgI,KAAK,MAAWE,eAC3C5Q,EAAGovB,kBACHJ,EAAK5vB,EAAQyO,WAAW,aAErB9O,QAAQ+D,UAAUksB,IAAW,MAAJA,EAAS,CACjC,GAAW,MAARA,EAAGngB,IACF,IAAK3N,EAAI,EAAGA,EAAI8tB,EAAGngB,IAAI1N,OAAQD,IACxB8tB,EAAGngB,IAAI3N,KAAK8tB,EAAGrgB,aAClB3O,EAAGovB,eAAeJ,EAAGngB,IAAI3N,KAAM,EAGpCysB,GAAG3jB,MAAM,WAAa2jB,EAAG3jB,MAAM,UAAU,OACxChK,EAAGovB,eAAeJ,EAAGpgB,KAAK,KAAM,GAI5CnP,EAAYe,IAAId,EAAU,0BACzBe,KAAK,SAAU2N,GAKZ,GAJApO,EAAGiZ,YACHjZ,EAAGqvB,kBACH1e,EAAMvC,EAAUzN,MAEbsuB,EACC,IAAK/tB,EAAI,EAAGA,EAAIyP,EAAIxP,OAAQD,IAAK,CAG7B,IAFA0tB,EAAIU,EAAQ3e,EAAIzP,IAChBsvB,GAAY,EACPxqB,EAAI,EAAGA,EAAI2K,EAAIzP,GAAGioB,YAAYhoB,OAAQ6E,IACvCkP,EAAMvE,EAAIzP,GAAGioB,YAAYnjB,GAAGkP,IAAI3U,OACvB,SAAN2U,GAAqB,mBAANA,IACdsb,GAAU,EAElBxwB,GAAGiZ,SAASnT,KAAO6oB,EAAG/d,YAAYge,EAAEhe,WAAa+d,EAAKC,GACnD4B,GAAa7B,EAAG/d,YAAYge,EAAEhe,YAAY5Q,EAAGqvB,eAAevpB,KAAK8oB,OAGxE,KAAK1tB,EAAI,EAAGA,EAAIyP,EAAIxP,OAAQD,IAAK,CAyBzB,GAxBJqvB,GAAY,EACZC,GAAY,EACZ5B,EAAIU,EAAQ3e,EAAIzP,IACZ0tB,EAAEhe,YAAYke,EAAMle,aACpB5Q,EAAGqvB,eAAevpB,KAAKgpB,GACnByB,GAAWvwB,EAAGiZ,SAASnT,KAAK8oB,GAChC2B,GAAY,EACZC,GAAY,GAEbzB,GAAQnvB,EAAU4uB,UAAUO,EAAM,aAAcH,EAAEhe,cACjD5Q,EAAGqvB,eAAevpB,KAAKlG,EAAU4uB,UAAUO,EAAM,aAAcH,EAAEhe,YAAY,IACzE2f,GAAWvwB,EAAGiZ,SAASnT,KAAK8oB,GAChC2B,GAAY,EACZC,GAAY,GAEb5wB,EAAU4uB,UAAUK,EAAK,aAAcD,EAAEhe,cACxC5Q,EAAGiZ,SAASnT,KAAKlG,EAAU4uB,UAAUK,EAAK,aAAcD,EAAEhe,YAAY,IACtE2f,GAAY,GAIRA,GAAWvwB,EAAGiZ,SAASnT,KAAK8oB,GAEhC2B,GAAY,GACRC,EACA,IAAKxqB,EAAI,EAAGA,EAAI2K,EAAIzP,GAAGioB,YAAYhoB,OAAQ6E,IACvCkP,EAAMvE,EAAIzP,GAAGioB,YAAYnjB,GAAGkP,IAAI3U,OACvB,SAAN2U,GAAqB,mBAANA,IACdqb,GAAY,EAGrBA,IAAa5B,EAAG/d,YAAYge,EAAEhe,aAAgB4f,GAAWxwB,EAAGqvB,eAAevpB,KAAK8oB,MAOvG,QAASU,GAAQC,GACb,OACI3e,WAAY2e,EAAG3e,WACfgM,QAAS2S,EAAG3S,QACZC,UAAW0S,EAAG1S,UACd+M,MAAO2F,EAAG3F,OAIlB,QAAS4F,GAAappB,EAAOqpB,GACzB,GAAI9e,GAAMgd,EAAG3jB,MAAM2jB,EAAGjlB,QAAQgI,KAAK,GAC3B,SAAL+e,EAAa7vB,EAAU8G,MAAMiK,EAAKvK,EAAOA,EAAM,GACrC,MAALqpB,GAAW7vB,EAAU8G,MAAMiK,EAAKvK,EAAOA,EAAM,GAIzD,QAASkgB,GAAW3kB,EAAI4D,GAGpB,OADAxG,QAAQ8H,QAAQlF,EAAG4kB,eAAe8B,SAAS7B,OAAOC,WAAW,GAAG/Q,QACxDnQ,GACJ,IAAK,OAAQvF,EAAG2vB,WAAY,CAAM,MAClC,KAAK,MAAO3vB,EAAG4vB,UAAW,CAAM,MAChC,KAAK,KAAM5vB,EAAG6vB,SAAU,GAzIhC,GAAI7vB,GAAK+I,KACL4kB,EAAKnjB,CACTmjB,GAAG3tB,GAAKA,CACR,IAAI2C,GAASvD,EAAQgO,SAErBpN,GAAG8vB,YAAc,GACjB9vB,EAAG+vB,WAAa,GAChB/vB,EAAGgwB,UAAY,GACfhwB,EAAG2vB,WAAY,EACf3vB,EAAG4vB,UAAW,EACd5vB,EAAG6vB,SAAU,EAGb7vB,EAAGsmB,WAAaA,EAChBtmB,EAAGwvB,aAAeA,EAElBhb,EAASka,GAAX4B,EAAyBhjB,SAAW,SAAU,cAAe,UAAW,WAAY,UAAW,WAAY,aAtB3GvO,QACGC,OAAO,OACPqL,WAAW,6BAA8BimB,MAoJ9C,WACE,YAOA,SAAS5C,GAAeljB,EAAQwY,GAC9B,GAAIhjB,GAAK+I,KACL4kB,EAAKnjB,CACTmjB,GAAG3tB,GAAKA,EAEL2tB,EAAG3jB,MAAM2jB,EAAGjlB,QAAQgI,MAAQid,EAAG3jB,MAAM2jB,EAAGjlB,QAAQgI,KAAK,QACpDid,EAAG3jB,MAAM2jB,EAAGjlB,QAAQgI,KAAK,MAAWsS,EAASkC,OAAOyI,EAAG3jB,MAAM2jB,EAAGjlB,QAAQgI,KAAK,MAAU,sBAY7Fgd,EAAepgB,SAAW,SAAU,YAvBpCvO,QACGC,OAAO,OACPqL,WAAW,mBAAoBqjB,MAcpC,WACE,YAOA,SAAS+C,GAA0BjmB,EAAQgK,EAAUpV,GAQnD,QAASsvB,KACF3vB,QAAQ2K,YAAYikB,EAAG3jB,MAAM2jB,EAAGjlB,QAAQgI,QACvCid,EAAG3jB,MAAM2jB,EAAGjlB,QAAQgI,KAAO7N,EAAmBF,EAAOkN,WAAa,IAAMlN,EAAOmN,WAC/E6d,EAAG3jB,MAAM2jB,EAAGjlB,QAAQgI,MAAQ,iBAIpC,QAAS7N,GAAmB6tB,GACxBA,EAASA,EAAOlV,QAAQ,cAAe,GAIvC,KAAK,GAHDmV,GAAMD,EAAOlf,cACbof,EAAMD,EAAIzrB,MAAM,KAChBtE,EAAc,GACTM,EAAI,EAAGA,EAAI0vB,EAAIzvB,OAAQD,IAC5BN,GAA4BgwB,EAAI1vB,GAAG,EAEvC,OAAON,GAtBX,GAAIZ,GAAK+I,KACL4kB,EAAKnjB,CACTmjB,GAAG3tB,GAAKA,CACR,IAAI2C,GAASvD,EAAQgO,SAErBoH,GAASka,GAaX+B,EAA0BnjB,SAAW,SAAU,WAAY,WAxB3DvO,QACGC,OAAO,OACPqL,WAAW,8BAA+BomB,MA+B7C,WA0BE,YAnBA,SAAS7jB,GAAWpC,EAAQjL,GAC1B,GAAIS,GAAK+I,KACL4kB,EAAKnjB,CACTjL,GAAKqC,IAAI,qDAAsD+rB,GAC/DA,EAAG3tB,GAAKA,EACRA,EAAG6wB,QAAS,GACZ7wB,EAAG8wB,QAAS,GAGZnD,EAAGoD,kBAAoB,SAASC,EAAWC,GACzC,GAAIC,GAAiB,GAAIjiB,MACrBkiB,EAAiB,GAAIliB,KACTwE,SAAZud,GAAyBA,GAAa,IACxCrD,EAAGxkB,GAAG0nB,QAAS,GAAI5hB,MAAKiiB,EAAeE,QAAQF,EAAeG,UAAA,KAE7C5d,QAAfwd,GAA4BA,GAAe,IAC7CtD,EAAGxkB,GAAG2nB,QAAU,GAAI7hB,MAAKkiB,EAAeC,QAAQD,EAAeE,UAAA,MAKnE1D,EAAGoD,kBAAkBpD,EAAGxkB,GAAG6nB,UAAWrD,EAAGxkB,GAAG8nB,aAQ5CtD,EAAG2D,eAAiB,WAClB,MAAO,UAAUvT,EAAMwT,GACrB,IAAK,GAAIrwB,GAAI,EAAGA,EAAIqwB,EAAYpwB,OAAQD,IACtC,MAAO6c,GAAKyT,aAAeD,EAAYrwB,KAZ/C0L,EAAWU,SAAW,SAAU,QAzBhCvO,QACCC,OAAO,OACPqL,WAAW,yBAA0BuC,MAyC1C,WACE,YAOA,SAAS6kB,GAAoBjnB,EAAQgK,EAAU/U,EAAaC,GAmB1D,QAASgvB,KACLvlB,EAAKwkB,EAAGjlB,QAAQD,gBAChBzI,EAAGkc,cACCnd,QAAQ2K,YAAYikB,EAAG3jB,MAAM2jB,EAAGjlB,QAAQgI,OACxCid,EAAG3jB,MAAM2jB,EAAGjlB,QAAQgI,MAAS1L,QAAU0sB,YAAY,GACnD/D,EAAG3jB,MAAM2jB,EAAGjlB,QAAQgI,KAAKrJ,KAAgB,WAAT8B,EAAG9B,KAAiB,aAAc8B,EAAG9B,MAEvEsqB,IAEF3nB,EAAQ2jB,EAAG3jB,MAAM2jB,EAAGjlB,QAAQgI,KAGhC,QAASkhB,GAAeC,GACtB,GAAIhc,GAAMnW,EAAQ,uBAElB,OADImyB,KAAShc,GAAO,WAAWgc,GACxBpyB,EAAYe,IAAIqV,GACtBpV,KAAK,SAAUC,GACd,MAAOA,GAAUC,YAIrB,QAASgxB,GAAcvsB,GACjBA,IAAKA,EAAI6X,MAAQ6U,EAAQ1sB,EAAI6X,OAAQ1B,WAAWnW,EAAI6X,OAAO8U,QAAQ,GAAK,QAE5EpE,EAAG3jB,MAAM2jB,EAAGjlB,QAAQgI,KAAKghB,YAAc,EACvC/D,EAAG3jB,MAAM2jB,EAAGjlB,QAAQgI,KAAK1L,KAAKyiB,QAAQ,SAAUwD,GAC1C6G,EAAQ7G,EAAGhO,SAAQ0Q,EAAG3jB,MAAM2jB,EAAGjlB,QAAQgI,KAAKghB,aAAaM,EAAQ/G,EAAGhO,UAE1E0Q,EAAG3jB,MAAM2jB,EAAGjlB,QAAQgI,KAAKghB,YAAcnW,WAAWoS,EAAG3jB,MAAM2jB,EAAGjlB,QAAQgI,KAAKghB,aAAaK,QAAQ,GAElG,QAASC,GAAQC,GAAU,MAAO1W,YAAWA,WAAW0W,GAAQF,QAAQ,IACxE,QAASD,GAAQG,GAAU,MAAO,gBAAgBC,KAAKD,GAEvD,QAASE,GAAavT,GAClB,GAAI/I,GAAMnW,EAAQ,+BAA+Bkf,CACjDnf,GAAYe,IAAIqV,GACfpV,KAAK,SAAUC,GACVA,IACyB,SAAvBA,EAAU8E,aACZ4sB,EAAU,OAAQ,wCAAwC1xB,EAAUC,MAAMsc,OACjD,eAAvBvc,EAAU8E,aACZ4sB,EAAU,UAAW,IAAI1xB,EAAU+E,YAK7C,QAAS4sB,GAAejc,GACtB,GAAIA,EAAM,CACR,GAAIP,GAAMnW,EAAQ,8BAA8B0W,CAChD3W,GAAYe,IAAIqV,GACfpV,KAAK,SAAUC,GACd,GAAIA,EACF,GAA2B,SAAvBA,EAAU8E,aACZ,GAAIwE,EAAMhF,KAAM,CACdhF,EAAGsyB,qBACHtoB,EAAMhF,KAAKyiB,QAAQ,SAAUwD,GAAMjrB,EAAGsyB,kBAAkBrH,EAAGsH,kBAAoBtH,EAAGuH,eAElF,KAAK,GAAIjwB,KAAK7B,GAAUC,MAClBD,EAAUC,MAAM8xB,eAAelwB,KAAOvC,EAAGsyB,kBAAkB/vB,KAC3DyH,EAAMhF,KAAKc,MACTsQ,KAAMrX,QAAQuD,KAAKtC,EAAG0yB,OAAOC,kBAC7BC,QAAS7zB,QAAQuD,KAAK5B,EAAUC,MAAM4B,GAAGqwB,SACzCzd,YAAapW,QAAQuD,KAAK5B,EAAUC,MAAM4B,GAAG4S,aAC7Cod,gBAAiBxzB,QAAQuD,KAAK5B,EAAUC,MAAM4B,GAAGK,IACjD0Y,aAAcvc,QAAQuD,KAAK5B,EAAUC,MAAM4B,GAAG0a,OAC9CuV,cAAezzB,QAAQuD,KAAK5B,EAAUC,MAAM4B,GAAGiwB,eAC/CvV,MAAO,SAETjd,EAAGsyB,kBAAkB/vB,IAAM7B,EAAUC,MAAM4B,GAAGiwB,cAGlB,IAA9BK,OAAOC,KAAKpyB,EAAUC,QAAWyxB,EAAU,UAAW,uDAE5B,eAAvB1xB,EAAU8E,aAA4B4sB,EAAU,UAAW1xB,EAAU+E,QAElFzF,GAAG0yB,OAAOC,iBAAmB,QAKnC,QAASI,GAAiBlB,GACxB,GAAIhc,GAAMnW,EAAQ,2HAIlB,OAHImyB,KACFhc,GAAO,qDAAqDgc,GAEvDpyB,EAAYe,IAAIqV,GACtBpV,KAAK,SAAUC,GAId,MAHIA,KACFV,EAAGkc,WAAaxb,EAAUC,MAAMyN,WAE3B1N,EAAUC,MAAMyN,gBAI3B,QAAS4kB,GAAO3rB,EAAM4rB,GACV,cAAN5rB,GAA0B,gBAANA,EAClB4rB,EACEjzB,EAAG0yB,OAAOQ,iBACZlpB,EAAMhF,KAAKc,MAAO8sB,QAAS7zB,QAAQuD,KAAKtC,EAAG0yB,OAAOQ,kBAAmBjW,MAAM,SACxEmV,EAAU,UAAW,yCAEnBpyB,EAAG0yB,OAAOQ,kBAAkBlpB,EAAMhF,KAAKc,MAAO8sB,QAAS7zB,QAAQuD,KAAKtC,EAAG0yB,OAAOQ,kBAAmBjW,MAAM,SAElG,WAAN5V,GACR2C,EAAMhF,KAAKc,MAAMmX,MAAM,SACzB0U,IAEF,QAASwB,GAAUjyB,GAAK8I,EAAMhF,KAAKiE,OAAO/H,EAAG,GAAIywB,IACjD,QAASS,GAAU/qB,EAAM5B,EAAS2tB,GAChC,GAAIC,IACFC,KAAQ,OACR7U,QAAW,UAEbze,GAAG6mB,MAAMthB,MAAO,EAChBvF,EAAG6mB,MAAMxf,KAAOA,EAChBrH,EAAG6mB,MAAMphB,QAAUA,EACnBzF,EAAG6mB,MAAM0M,MAAQF,EAAMhsB,GACvBrH,EAAG6mB,MAAMuM,KAAOA,GAAQ,EAvI1B,GAEIppB,GAAOb,EAFPnJ,EAAK+I,KACL4kB,EAAKnjB,CAETmjB,GAAG3tB,GAAKA,EAERA,EAAG0yB,UACH1yB,EAAG6mB,SAEH7mB,EAAGgzB,OAASA,EACZhzB,EAAGmzB,UAAYA,EACfnzB,EAAG+yB,iBAAmBA,EACtB/yB,EAAG4xB,eAAiBA,EACpB5xB,EAAGqyB,eAAiBA,EACpBryB,EAAGmyB,aAAeA,EAClBnyB,EAAG2xB,cAAgBA,EAEnBnd,EAASka,GAIX+C,EAAoBnkB,SAAW,SAAU,WAAY,cAAe,WA1BpEvO,QACGC,OAAO,OACPqL,WAAW,wBAAyBonB,MAgJzC,WACE,YAOA,SAAS+B,GAAShpB,EAAQgK,EAAU1U,GAclC,QAAS4uB,KACL1uB,EAAGivB,WAAalwB,QAAQ2K,YAAYikB,EAAG3jB,MAAM2jB,EAAGjlB,QAAQgI,MACpD1Q,EAAGivB,YACCtB,EAAGxkB,GAAGyV,WACN+O,EAAG3jB,MAAM2jB,EAAGjlB,QAAQgI,KAAOid,EAAG3jB,MAAM2jB,EAAGjlB,QAAQgI,KAAK,IAKhE,QAASxD,GAAQ3M,GAAUT,EAAU2W,SAASlW,GAG9C,QAASkzB,GAAU9xB,GACf5C,QAAQ8H,QAAQlF,EAAG4kB,eAAeC,OAAO9Q,QAG7C,QAASge,GAAY/xB,EAAIgyB,GACrBA,EAAOlM,QAAQ,SAAUmM,EAAG1yB,EAAGyP,GACZ,mBAAZijB,EAAEC,WACDljB,EAAI1H,OAAO/H,EAAG,GACXysB,EAAGxkB,GAAGyV,SACL+O,EAAG3jB,MAAM2jB,EAAGjlB,QAAQgI,KAAKzH,OAAO/H,EAAE,SAE3BysB,GAAG3jB,MAAM2jB,EAAGjlB,QAAQgI,QAM3C,QAASojB,GAAW1tB,GACZunB,EAAGxkB,GAAGyV,SAGFxY,EACAunB,EAAG3jB,MAAM2jB,EAAGjlB,QAAQgI,KAAKzH,OAAO7C,EAAO,GAEvCunB,EAAG3jB,MAAM2jB,EAAGjlB,QAAQgI,KAAKzH,OAAO,EAAG,SALhC0kB,GAAG3jB,MAAM2jB,EAAGjlB,QAAQgI,KAUnC,QAASqjB,GAAUC,EAAGC,GAClB,MAAOpW,MAAKqW,MAAMF,EAAEnW,KAAKsW,IAAI,GAAGF,IAAIpW,KAAKsW,IAAI,GAAGF,GAvDpD,GAAIj0B,GAAK+I,KACL4kB,EAAKnjB,CACTmjB,GAAG3tB,GAAKA,EAGRA,EAAGyzB,UAAYA,EACfzzB,EAAG8zB,WAAaA,EAChB9zB,EAAGkN,QAAUA,EACblN,EAAG+zB,UAAYA,EACf/zB,EAAG0zB,YAAcA,EAEjBlf,EAASka,GAUX8E,EAASlmB,SAAW,SAAU,WAAY,aA3B1CvO,QACGC,OAAO,OACPqL,WAAW,sBAAuBmpB,MAiEvC,WACE,YAOA,SAASzU,GAAgBxf,EAAMuf,GAQ7B,QAASwC,GAAUpF,EAAYkY,GAE7B,GAAIzzB,IACF0zB,QAASnY,EACTgJ,OAAQ,QACRoP,SAAU,KAETv1B,SAAQ+D,UAAUsxB,KAAKzzB,EAAMyzB,GAAKA,EACrC,IAAIG,IACFrZ,SACEsZ,eAAgB,qBAIhBC,EAAWC,EAAc,OAC7B,OAAO5V,GAAG,SAAUW,EAASK,GAC3B6U,MAAMrvB,KAAKmvB,EAAU9zB,EAAO4zB,GAC3B9zB,KAAK,SAAUm0B,GAEd,MAAOnV,GAAQmV,KAHjBD,SAKO,SAAUE,GAEf,MAAO/U,IACL5M,YAAY,EACZxL,SAAUmtB,EAAWtiB,SAASjS,KAAKoH,SAAWmtB,EAAWtiB,SAASjS,MAAQ,iCAMlF,QAASwgB,KACP,GAAIpgB,IACFsgB,QAAQ,EACRvb,QAAS,GAEX,OAAOqZ,GAAG,SAAUW,GAClBkV,MAAMn0B,IAAIk0B,GACTj0B,KAAK,SAAUsgB,GAQd,MANyB,OAAtBA,EAAWS,OACZ9gB,EAAUsgB,QAAS,EAGnBzhB,EAAKqC,IAAI,qBAEJ6d,EAAQ/e,KATjBi0B,SAWO,SAAUG,GAMf,MALAp0B,GAAUsgB,QAAS,EAChB8T,EAAYptB,QAAQlF,SAAQ,KAC7B9B,EAAU+E,QAAU,sDAGfga,EAAQ/e,OA7DrB,GAAIg0B,GAAc,yBACdK,GACFzT,UAAWA,EACXR,gBAAiBA,EAEnB,OAAOiU,GAiBThW,EAAgBzR,SAAW,OAAQ,MA5BnCvO,QACCC,OAAO,OACP+1B,QAAQ,mBAAoB,OAAQ,KAAOhW,OAwE9C,WACI,YAOA,SAAS5M,GAAc5S,EAAMuf,EAAIkW,EAAOC,EAAUznB,EAAOmK,EAASxY,GAgB9D,QAAS+1B,GAAUC,EAAajrB,GAG5B,MAAOsD,GAAMjI,MACT2B,SAAU,sBACVmD,WAAY,4BACZ/J,MAAQ60B,YAAaA,EAAajrB,OAAQA,GAC1CkrB,KAAM,OAId,QAAS1hB,KACL,GAAI2hB,GAAI,IACJC,EAAI,IACJtX,EAAIrG,EAAQ4d,YAAc,EAAI5d,EAAQ6d,QAAWF,EAAI,EACrDtB,EAAIrc,EAAQ8d,WAAa,EAAI9d,EAAQ+d,QAAWL,EAAI,CACxD1d,GAAQge,KAAKC,EAAW,SAAU,uDAAuD5B,EAAE,SAAShW,EAAE,WAAWqX,EAAE,YAAYC,EAAE,iBAAkB,IAGvJ,QAAShjB,KACL,GAAIujB,GAAMD,EAAW,SACrB,OAAOE,GAAYD,GAGvB,QAAS9iB,GAAMgjB,GACX,GAAIF,GAAMD,EAAW,cAAcG,CACnC,OAAOD,GAAYD,GAGvB,QAASxiB,KACL,GAAIwiB,GAAMD,EAAW,QACrB,OAAOE,GAAYD,GAGvB,QAASG,GAAKC,EAAgBC,GAC1B,GAAIC,IACAC,eAAgBH,EAAeI,eAC/BC,WAAYL,EAAeK,WAC3BC,MAAOL,EAGX,OAAOpX,GAAG,SAASW,EAASK,GACxB6U,MAAMrvB,KAAKswB,EAAW,QAASO,GAC3Bjb,SAAWsZ,eAAgB,uCAE5B/zB,KAAK,SAAU8R,GAEdkN,EAAQlN,EAASjS,QALrBq0B,SAQS,SAAU9uB,GAEfia,GAAS5M,YAAY,EAAOzN,QAAS,4CAA8CI,QAK/F,QAAS2wB,KACL,GAAIX,GAAOD,EAAa,SACxB,OAAOE,GAAYD,GAGvB,QAASC,GAAYD,GACjB,MAAO/W,GAAG,SAASW,EAASK,GACxB6U,MAAMn0B,IAAIq1B,GACTp1B,KAAK,SAAU8R,GACZ,MAAIA,GAASjS,KAAK4S,cAAe,MAC7B4M,GAAOvN,EAASjS,UAGpBmf,GAAQlN,EAASjS,QANrBq0B,SAQO,SAAU9uB,GACTA,GACA1G,EAAQ0G,MAAM,8CACdia,GAAS5M,YAAY,EAAOzN,QAAS,gDAGrCtG,EAAQ0G,MAAM,gGACdia,GAAS5M,YAAY,EAAOzN,QAAS,sGA7FrD,GAAImwB,GAAa,yBAEbb,GACAG,UAAWA,EACXxhB,kBAAmBA,EACnBpB,WAAYA,EACZS,MAAOA,EACPM,iBAAkBA,EAClB2iB,KAAMA,EACNQ,OAAQA,EAGZ,OAAOzB,GAUX5iB,EAAc7E,SAAW,OAAQ,KAAM,QAAS,WAAY,QAAS,UAAW,WA7BhFvO,QACCC,OAAO,OACP+1B,QAAQ,iBAAkB,OAAQ,KAAM,QAAS,WAAY,QAAS,UAAW,UAAW5iB,OA6GjG,WACE,YAOA,SAASskB,GAAoBt3B,EAASU,EAASJ,EAAaF,EAAMO,EAAWoS,EAAM5S,GA4BjF,QAASsrB,KACP7rB,QAAQ8H,QAAQ,QAAQuhB,SAAS,YACjCrpB,QAAQ8H,QAAQ,QAAQshB,YAAY,aAGtC,QAASuK,KACJ1yB,EAAG02B,iBACJ12B,EAAG02B,kBACH12B,EAAG6T,IAAM,KACT7T,EAAGkU,WAAa,MAElBlU,EAAGW,MAAM4qB,OAASvrB,EAAGW,MAAM4qB,OAAO/Z,cAClC/R,EAAY6F,KAAKzF,EAAU,YAAaG,EAAGW,OAC1CF,KAAK,SAAUk2B,GACXA,GAAqC,UAAzBA,EAASnxB,cACtBxF,EAAG02B,eAAiBC,EAASh2B,MAC7BX,EAAGW,MAAM6nB,MAAQmO,EAASh2B,MAAM6nB,OAE/BmO,GACDl3B,EAAYoU,IAAIhU,EAAU,gBAAiBG,EAAGW,OAC7CF,KAAK,SAAU8R,GACXA,IACDvS,EAAG6T,IAAMtB,EAASsD,IAClB7V,EAAGkU,WAAa3B,EAASjS,KACrBN,EAAG42B,SACL1kB,EAAK+B,WAAW1B,EAASjS,KAAM,mCAbzCb,SAmBO,SAAUoG,GACf1G,EAAQ0G,MAAMA,KAIlB,QAASgxB,KACPv3B,EAAUoG,KAAK,SA9DjBklB,GACA,IAAI5qB,GAAK+I,IACT/I,GAAG82B,eAAgB,YACnB92B,EAAAA,QAAS,SAAS6a,GAChB7a,EAAGwhB,OAAS,SAAS3G,GAGvB7a,EAAGM,MACDy2B,cAAe,GAGjB/2B,EAAGwmB,KAAO,WACRxmB,EAAGM,KAAKy2B,cAAgBlZ,KAAKmZ,IAAIh3B,EAAGM,KAAKy2B,cAAe,EAAG,IAE7D/2B,EAAGi3B,SAAW,WACZj3B,EAAGM,KAAKy2B,cAAgBlZ,KAAK2J,IAAIxnB,EAAGM,KAAKy2B,cAAe,EAAG,IAI7D/2B,EAAG42B,QAAU92B,EAAUslB,WAGvBplB,EAAG0yB,OAASA,EACZ1yB,EAAG62B,SAAWA,EADhBJ,EAAoBnpB,SAAW,UAAW,UAAW,cAAe,OAAQ,YAAa,OAAQ,aA9BjGvO,QACCC,OAAO,OACPqL,WAAW,sBAAuBosB,MAyErC,WACI,YAOA,SAASS,MALTn4B,QACCC,OAAO,OACPqL,WAAW,iBAAkB6sB,MAWlC,WACI,YAkBA,SAASC,GAAwB3sB,EAAQ9K,EAASD,EAAaL,EAASg4B,EAAa5pB,GAgCjF,QAAS6pB,GAAuB/2B,EAAMkK,EAAQmH,GAO1C,QAASE,KACLF,EAAU8D,OAPd,GAAI7D,GAAMpH,CACVoH,GAAIC,OAASA,EAEbD,EAAItR,KAAOA,EAAOA,KAlCtB,GAAIN,GAAK+I,IACT/I,GAAGN,QAAUA,EAGbM,EAAGs3B,eAAiB,SAASC,GAE3B/pB,EAAM6B,QAAQ,yCAA0C,WACtD,GAAIka,GAAOvpB,EAAGw3B,SAASh1B,QAAQ+0B,EAG3BhO,QAEFvpB,EAAGw3B,SAASvuB,OAAOsgB,EAAQ,GAE3BvpB,EAAGy3B,iBAAiB3xB,KAAKyxB,OAO/Bv3B,EAAG03B,cAAgB,SAAUrM,GACzB,GAAInhB,IACA5J,KAAM+qB,EACN9gB,YAAa,yDACbF,YAAa,OAAQ,SAAU,YAAagtB,GAEhD7pB,GAAMjI,KAAK2E,IA7CnBnL,QACCC,OAAO,OACP24B,UAAU,iBACPptB,YAAc,kDACdF,YAAc,SAAU,UAAW,cAAe,UAAW,eAAe,QAAS8sB,GACrFS,aAAc,KACdC,UACIpsB,OAAQ,IACR+rB,SAAU,IACVM,MAAO,IACPC,KAAM,IACNC,SAAU,IACVP,iBAAkB,UAsD9B,WACI,YAOA,SAASQ,GAAsBx4B,EAAaC,GA6BxC,QAASw4B,GAActkB,GACnB,GAAIukB,GAAW,EAIf,OAHAA,IAAY,gDACZA,GAAYvkB,EACZukB,GAAY,+BA/BhB,GAAIC,IACAC,OACIrpB,IAAK,KAETspB,SAAU,IACVC,KAAM,SAAU5K,EAAI6K,EAAKC,EAAOpuB,GAC5BmuB,EAAI/iB,OACJhW,EAAYe,IAAId,EAAQ,8BAA8BiuB,EAAG3e,IAAIpB,aAAa,SACzEnN,KAAK,SAAUC,GACZ,GAAGA,EAAU,CACT,GAAIg4B,GAAMF,EAAInQ,SAASA,SAASA,SAASA,SAASA,SAASA,SAASA,QACpEqQ,GAAIC,OAAOT,EAAcx3B,EAAUC,OACnC,IAAIi4B,GAAQF,EAAIjS,SAAS,UACzBmS,GAAMnjB,OACN+iB,EAAInQ,SAASwQ,UAAU,WACnBD,EAAMrzB,OACNizB,EAAInQ,SAASyQ,IAAI,SAAS,aAE9BN,EAAInQ,SAAS0Q,SAAS,WAClBH,EAAMnjB,OACN+iB,EAAInQ,SAASyQ,IAAI,SAAS,gBAe9C,OAAOV,GA1CXr5B,QACCC,OAAO,OACPo5B,UAAU,WAAY,cAAe,UAAWH;;;;;AAmDpD,SAAUe,EAAMC,GACO,kBAAXC,SAAyBA,OAAOC,IAEzCD,OAAO,YAAa,SAAS,gBAAgB,iBAAiB,mBAAoB,SAAUE,EAAGC,EAAcC,EAAeC,GAC1H,MAAQP,GAAK,SAAcC,EAAQG,EAAGC,EAAcC,EAAeC,KAEzC,gBAAZC,SAIhBx6B,OAAOw6B,QAAUP,EAAQQ,QAAQ,UAAUA,QAAQ,iBAAiBA,QAAQ,kBAAkBA,QAAQ,oBAEtGT,EAAK,SAAcC,EAAQS,OAAOL,aAAaM,OAAOC,QAAQD,OAAOE,WAEvE9wB,KAAM,SAAUqwB,EAAGC,EAAcC,EAAeC,GAElD,GAAIO,GAAiBC,EAAkBC,EAAYC,EAAQC,EAAWC,EAAYC,EAAaC,EAAaC,EAAiBC,EAAWC,EAAUC,EAAaC,EAAcC,EAAcC,EAAaC,EAAcC,EAAcC,EAAWC,EAAYC,EAAaC,EAAYC,EAAiBC,EAAeC,EAASC,EAAWC,EAAUC,EAAqBC,EAAaC,EAAaC,EAASC,EAAiBC,EAAgC3pB,EACzb4pB,EAAS,SAASC,EAAO1T,GAA+F,QAAS2T,KAASjzB,KAAKkzB,YAAcF,EAA1H,IAAK,GAAIrrB,KAAO2X,GAAc6T,EAAQC,KAAK9T,EAAQ3X,KAAMqrB,EAAMrrB,GAAO2X,EAAO3X,GAA2J,OAArGsrB,GAAKnzB,UAAYwf,EAAOxf,UAAWkzB,EAAMlzB,UAAY,GAAImzB,GAAQD,EAAMK,UAAY/T,EAAOxf,UAAkBkzB,GAClRG,KAAazJ,eACbjwB,KAAaA,SAAW,SAAS6D,GAAQ,IAAK,GAAInF,GAAI,EAAGm7B,EAAItzB,KAAK5H,OAAQD,EAAIm7B,EAAGn7B,IAAO,GAAIA,IAAK6H,OAAQA,KAAK7H,KAAOmF,EAAM,MAAOnF,EAAK,WACvIo7B,KAAWA,KAqpLb,OAnpLAhB,GAAY,SAAUiB,GAGpB,QAASjB,KACP,MAAOA,GAAUc,UAAUH,YAAYnzB,MAAMC,KAAMC,WAsarD,MAzaA8yB,GAAOR,EAAWiB,GAMlBjB,EAAUkB,WAAa,YAEvBlB,EAAUzyB,UAAU4zB,OAAS,KAE7BnB,EAAUzyB,UAAU6zB,YAAc,KAElCpB,EAAUzyB,UAAU8zB,UAAY,KAEhCrB,EAAUzyB,UAAU+zB,eAAiB,KAErCtB,EAAUzyB,UAAUg0B,OAAS,KAE7BvB,EAAUzyB,UAAUi0B,YAAc,KAElCxB,EAAUzyB,UAAUk0B,WAAa,KAEjCzB,EAAUzyB,UAAUm0B,MAAQ,WAS1B,MARAj0B,MAAKk0B,OAASl0B,KAAKm0B,QACnBn0B,KAAKo0B,WAAaC,SAASC,eAC3Bt0B,KAAKk0B,OAAO/N,GAAG,mBAAoB,SAAUoO,GAC3C,MAAO,UAASC,GAEd,MADAD,GAAME,QACCF,EAAMb,OAASa,EAAMH,WAAWM,WAAW,KAEnD10B,OACIA,KAAKk0B,OAAO/N,GAAG,OAAQ,SAAUoO,GACtC,MAAO,UAASC,GACd,MAAOD,GAAME,UAEdz0B,QAGLuyB,EAAUzyB,UAAU20B,MAAQ,WAO1B,MANAz0B,MAAK0zB,OAAS,KACd1zB,KAAK2zB,YAAc,KACnB3zB,KAAK4zB,UAAY,KACjB5zB,KAAK6zB,eAAiB,KACtB7zB,KAAK8zB,OAAS,KACd9zB,KAAK+zB,YAAc,KACZ/zB,KAAKg0B,WAAa,MAG3BzB,EAAUzyB,UAAU60B,MAAQ,WAC1B,GAAIH,EACJ,KACEx0B,KAAKo0B,WAAWQ,kBAChB,MAAOC,GACPL,EAAIK,EAEN,MAAO70B,MAAKy0B,SAGdlC,EAAUzyB,UAAUg1B,MAAQ,SAASA,GACnC,GAAIC,EAYJ,OAXID,IACF90B,KAAK20B,QACL30B,KAAKo0B,WAAWY,SAASF,GACzB90B,KAAK0zB,OAASoB,EACdC,EAAS/0B,KAAKk0B,OAAOe,KAAKC,QAAQC,SAAWn1B,KAAKk0B,OAAOe,KAAKC,QAAQE,MACjEp1B,KAAKk0B,OAAOmB,aAAaC,SAAWP,GACvC/0B,KAAKk0B,OAAOqB,KAAKC,UAETx1B,KAAK0zB,QAAU1zB,KAAKk0B,OAAOmB,aAAaC,SAAWt1B,KAAKo0B,WAAWqB,aAC7Ez1B,KAAK0zB,OAAS1zB,KAAKo0B,WAAWM,WAAW,IAEpC10B,KAAK0zB,QAGdnB,EAAUzyB,UAAU41B,WAAa,WAW/B,MAVI11B,MAAK0zB,SACP1zB,KAAK2zB,cAAgB3zB,KAAK2zB,YAAc,SAAUY,GAChD,MAAO,YACL,GAAImB,EAGJ,OAFAA,GAAarF,EAAEkE,EAAMb,OAAOiC,gBAAgBC,aAAarB,EAAML,OAAOqB,MAAM99B,MAC5Ei+B,EAAW70B,QAAQ0zB,EAAMb,OAAOiC,gBACzBtF,EAAEqF,KAEV11B,UAEEA,KAAK2zB,aAGdpB,EAAUzyB,UAAU+1B,SAAW,WAC7B,GAAIA,EAIJ,OAHI71B,MAAK0zB,SACP1zB,KAAK4zB,YAAc5zB,KAAK4zB,UAAY5zB,KAAK0zB,OAAOoC,UAAY91B,KAAK01B,cAAgBG,EAAWxF,EAAErwB,KAAK0zB,OAAOqC,cAAcH,aAAa51B,KAAKk0B,OAAOqB,MAAM99B,MAAOo+B,EAASh1B,QAAQb,KAAK0zB,OAAOqC,cAAe1F,EAAEwF,MAEvM71B,KAAK4zB,WAGdrB,EAAUzyB,UAAUk2B,cAAgB,WAIlC,MAHIh2B,MAAK0zB,SACP1zB,KAAK6zB,iBAAmB7zB,KAAK6zB,eAAiBxD,EAAErwB,KAAK0zB,OAAOuC,2BAEvDj2B,KAAK6zB,gBAGdtB,EAAUzyB,UAAUo2B,MAAQ,WA+C1B,MA9CIl2B,MAAK0zB,SACP1zB,KAAK8zB,SAAW9zB,KAAK8zB,OAAS,SAAUS,GACtC,MAAO,YACL,GAAI2B,EAuCJ,OAtCAA,MACI3B,EAAMmB,aAAaS,QAAQC,GAAG7B,EAAMsB,WAAWM,SACjDD,EAAQ3B,EAAMmB,aAAaj+B,OAE3B88B,EAAMmB,aAAaW,KAAK,SAASl+B,EAAGm+B,GAClC,GAAIC,GAAUC,EAAOC,EAAQC,EAAUr5B,EAAOs5B,EAAaC,CAE3D,OADAJ,GAAQnG,EAAEiG,GACN/B,EAAMsB,WAAWx4B,MAAMm5B,MAClBN,EAAMn5B,KAAKu5B,GACTE,EAAMlX,SAAS8W,GAAG7B,EAAML,OAAOqB,QAAUoB,EAAcpC,EAAMsB,WAAWx4B,MAAMm5B,EAAMlX,eAE3FiX,EADEI,GAAeA,KACNpC,EAAMsB,WAAWgB,GAAGF,EAAc,GAElCpC,EAAMsB,WAAWiB,OAE9BL,EAASD,EAAMlX,SAASyX,WACxBH,EAAaH,EAAOp5B,MAAMm5B,GAC1BE,EAAWD,EAAOp5B,MAAMk5B,GACjBlG,EAAE2G,MAAMd,EAAOO,EAAOlD,MAAMqD,EAAYF,GAAUj/B,SAEzDg/B,EAASD,EAAMlX,SAASyX,WACxB15B,EAAQo5B,EAAOp5B,MAAMm5B,GACdnG,EAAE2G,MAAMd,EAAOO,EAAOlD,MAAMl2B,GAAO5F,UAG9C88B,EAAMsB,WAAWQ,KAAK,SAASl+B,EAAGm+B,GAChC,GAAIE,GAAOC,EAAQp5B,CAEnB,OADAm5B,GAAQnG,EAAEiG,GACNE,EAAMlX,SAAS8W,GAAG7B,EAAML,OAAOqB,OAAShB,EAAMmB,aAAar4B,MAAMm5B,EAAMlX,cACzE4W,EAAMn5B,KAAKu5B,IACJ,IAEPG,EAASD,EAAMlX,SAASyX,WACxB15B,EAAQo5B,EAAOp5B,MAAMm5B,GACdnG,EAAE2G,MAAMd,EAAOO,EAAOlD,MAAM,EAAGl2B,EAAQ,QAI7CgzB,EAAEA,EAAE4G,OAAOf,MAEnBl2B,UAEEA,KAAK8zB,QAGdvB,EAAUzyB,UAAUo3B,WAAa,WAC/B,GAAKl3B,KAAK0zB,OAUV,MAPA1zB,MAAK+zB,cAAgB/zB,KAAK+zB,YAAc,SAAUQ,GAChD,MAAO,YACL,MAAOA,GAAM2B,QAAQiB,OAAO,SAASh/B,EAAGm+B,GACtC,MAAO/B,GAAML,OAAOe,KAAKmC,YAAYd,OAGxCt2B,SACIA,KAAK+zB,aAGdxB,EAAUzyB,UAAUu3B,UAAY,WAC9B,GAAKr3B,KAAK0zB,OAYV,MATA1zB,MAAKg0B,aAAeh0B,KAAKg0B,WAAa,SAAUO,GAC9C,MAAO,YACL,MAAOA,GAAM2B,QAAQiB,OAAO,SAASh/B,EAAGm+B,GACtC,GAAIgB,EAEJ,OADAA,GAAUjH,EAAEiG,GAAMhX,SACXgY,EAAQlB,GAAG7B,EAAML,OAAOqB,OAAS+B,EAAQlB,GAAG,kBAGtDp2B,SACIA,KAAKg0B,YAGdzB,EAAUzyB,UAAUy3B,aAAe,SAASjB,EAAMxB,GAChD,GAAI0C,GAAeC,EAAgBC,EAASC,EAAeC,EAAcC,CAIzE,IAHa,MAAT/C,IACFA,EAAQ90B,KAAK80B,SAETA,GAASA,EAAMgB,UASrB,MANAQ,GAAOjG,EAAEiG,GAAM,GACfoB,EAAU5C,EAAMiB,aAChB4B,EAAgB33B,KAAKk0B,OAAOe,KAAK6C,cAAcJ,GAC/CD,EAAiB3C,EAAMiD,YAAcJ,EAAgB,EACrDC,EAAevH,EAAEqH,GAASX,WAAWD,OAAOV,GAAG,MAC/CoB,EAAgB1C,EAAMiD,YAAcJ,KAC7BF,GAAkBG,GAAiBJ,KAGtClB,IAASoB,KAEDrH,EAAE2H,SAAS1B,EAAMoB,KAG7BG,GAAS,EACTxH,EAAEqH,GAAS9B,aAAaU,GAAM2B,UAAU5B,KAAK,SAASl+B,EAAG+/B,GACvD,GAAIC,GAAYC,EAAcC,EAAYnC,CAO1C,IANAA,EAAQ7F,EAAE6H,GAAG5Y,SAASyX,WAAWI,OAAO,WACtC,QAASn3B,OAASk4B,GAAuB,IAAlBl4B,KAAKs4B,WAAmBt4B,KAAKu4B,aAEtDJ,EAAajC,EAAMY,OACnBuB,EAAaF,EAAW1gC,IAAI,KAAOygC,EACnCE,EAAeD,EAAW/B,GAAG,OAAS+B,EAAW5Y,OAAO9nB,IAAI,KAAOygC,GAC7DG,IAAcD,EAElB,MADAP,IAAS,GACF,IAGJA,KAGTtF,EAAUzyB,UAAU04B,eAAiB,SAASlC,EAAMxB,GAClD,GAAI+C,GAAQY,CAIZ,IAHa,MAAT3D,IACFA,EAAQ90B,KAAK80B,SAETA,GAASA,EAAMgB,UAKrB,MAFAQ,GAAOjG,EAAEiG,GAAM,GACfmC,EAAY3D,EAAMa,eACQ,IAAtBb,EAAM4D,cAGNpC,IAASmC,KAEDpI,EAAE2H,SAAS1B,EAAMmC,KAG7BZ,GAAS,EACTxH,EAAEoI,GAAW7C,aAAaU,GAAM2B,UAAU5B,KAAK,SAASl+B,EAAG+/B,GACzD,GAAIhC,EAIJ,IAHAA,EAAQ7F,EAAE6H,GAAG5Y,SAASyX,WAAWI,OAAO,WACtC,QAASn3B,OAASk4B,GAAuB,IAAlBl4B,KAAKs4B,WAAmBt4B,KAAKu4B,aAElDrC,EAAMC,QAAQ1+B,IAAI,KAAOygC,EAC3B,MAAOL,IAAS,IAGbA,KAGTtF,EAAUzyB,UAAU64B,WAAa,SAASrC,EAAMxB,GAI9C,GAHa,MAATA,IACFA,EAAQ90B,KAAK80B,SAEVA,EAKL,MAFAwB,GAAOjG,EAAEiG,GAAM,GACfxB,EAAM6D,WAAWrC,GACVt2B,KAAK44B,cAActC,EAAMxB,IAGlCvC,EAAUzyB,UAAU84B,cAAgB,SAAStC,EAAMxB,GAIjD,GAHa,MAATA,IACFA,EAAQ90B,KAAK80B,SAEF,MAATA,EAMJ,MAHAwB,GAAOjG,EAAEiG,GAAM,GACfxB,EAAM+D,YAAYvC,GAClBxB,EAAMgE,UAAS,GACR94B,KAAK80B,MAAMA,IAGpBvC,EAAUzyB,UAAUi5B,eAAiB,SAASzC,EAAMxB,GAIlD,GAHa,MAATA,IACFA,EAAQ90B,KAAK80B,SAEF,MAATA,EAMJ,MAHAwB,GAAOjG,EAAEiG,GAAM,GACfxB,EAAMkE,aAAa1C,GACnBxB,EAAMgE,UAAS,GACR94B,KAAK80B,MAAMA,IAGpBvC,EAAUzyB,UAAUm5B,kBAAoB,SAAS3C,EAAMxB,GAOrD,MANa,OAATA,IACFA,EAAQ90B,KAAK80B,SAEfwB,EAAOjG,EAAEiG,GAAM7+B,IAAI,GACnBq9B,EAAMoE,OAAO5C,EAAM,GACnBxB,EAAMgE,UAAS,GACR94B,KAAK80B,MAAMA,IAGpBvC,EAAUzyB,UAAUq5B,gBAAkB,SAAS7C,EAAMxB,GACnD,GAAIsE,GAAW5C,EAAOO,EAAUsC,EAAWC,EAAiBC,EAAUC,CAmCtE,OAlCa,OAAT1E,IACFA,EAAQ90B,KAAK80B,SAEf0B,EAAQnG,EAAEiG,GACVA,EAAOE,EAAM,GACTA,EAAMJ,GAAG,QACXW,EAAWP,EAAMO,WACbA,EAAS3+B,OAAS,GACpBihC,EAAYtC,EAASD,OACrByC,EAAWF,EAAUxc,OACrByc,EAAkBt5B,KAAKk0B,OAAOe,KAAK6C,cAAcuB,EAAU,IACd,OAAzCE,EAASE,OAAOF,EAASnhC,OAAS,GACpC08B,EAAMoE,OAAOG,EAAU,GAAIC,EAAkB,GAE7CxE,EAAMoE,OAAOG,EAAU,GAAIC,IAG7BxE,EAAMoE,OAAO5C,EAAM,KAGrBkD,EAAax5B,KAAKk0B,OAAOe,KAAK6C,cAAcxB,GACtB,IAAlBA,EAAKgC,UAAkBkB,EAAa,IACtCJ,EAAY/I,EAAEiG,GAAMS,WAAWD,OAC3BsC,EAAUhD,GAAG,MACfoD,GAAc,EACqB,IAA1BJ,EAAU,GAAGd,UAAkBt4B,KAAKk0B,OAAOe,KAAKyE,YAAYN,KACrEA,EAAUxJ,OAAO5vB,KAAKk0B,OAAOe,KAAK0E,MAClCrD,EAAO8C,EAAU,GACjBI,EAAa,IAGjB1E,EAAMoE,OAAO5C,EAAMkD,IAErB1E,EAAMgE,UAAS,GACR94B,KAAK80B,MAAMA,IAGpBvC,EAAUzyB,UAAU85B,oBAAsB,SAAS9E,GACjD,GAAI+E,GAAaC,EAAeC,EAAUC,CAkB1C,OAjBa,OAATlF,IACFA,EAAQ90B,KAAK80B,SAEfkF,EAAalF,EAAMmF,aACnBF,EAAWjF,EAAMmF,aACjBD,EAAWlB,UAAS,GACpBiB,EAASjB,UAAS,GAClBgB,EAAgB95B,KAAKw4B,eAAex4B,KAAKk0B,OAAOqB,KAAMyE,GACtDH,EAAc75B,KAAKu3B,aAAav3B,KAAKk0B,OAAOqB,KAAMwE,IAC7CjF,EAAMgB,WAAagE,GAAiBD,GACvC75B,KAAKk0B,OAAOqB,KAAK2E,QACjBpF,EAAMqF,SAASn6B,KAAKk0B,OAAOqB,KAAK,GAAI,GACpCT,EAAMgE,UAAS,GACf94B,KAAK80B,MAAMA,IAEXA,EAAMsF,iBAEDtF,GAGTvC,EAAUzyB,UAAUu6B,aAAe,SAAS7T,EAAIsO,GAC9C,GAAIwF,EAKJ,OAJa,OAATxF,IACFA,EAAQ90B,KAAK80B,SAEfwF,EAAMjK,EAAE7J,GACHsO,EAAMgB,WAGXhB,EAAMyF,eAAeD,EAAI7iC,IAAI,IACzBq9B,EAAMgB,UACDwE,EAEFA,EAAIE,OAAO1F,EAAM2F,oBANfH,GASX/H,EAAUzyB,UAAUuI,KAAO,SAASysB,GAClC,GAAI4F,GAAUX,EAAUY,CAIxB,IAHa,MAAT7F,IACFA,EAAQ90B,KAAK80B,UAEX90B,KAAK46B,gBAUT,MAPAb,GAAWjF,EAAMmF,aACjBF,EAASjB,UAAS,GAClB6B,EAAatK,EAAE,WAAWhR,SAAS,wBACnCqb,EAAWrK,EAAE,WAAWhR,SAAS,sBACjC0a,EAASpB,WAAW+B,EAAS,IAC7B5F,EAAM6D,WAAWgC,EAAW,IAC5B36B,KAAK20B,QACE30B,KAAK46B,iBAAkB,GAGhCrI,EAAUzyB,UAAU+6B,QAAU,WAC5B,GAAIH,GAAU3E,EAAcgC,EAAWjD,EAAO6F,EAAYhF,EAAgB+C,CAC1E,SAAK14B,KAAK46B,kBAGVD,EAAa36B,KAAKk0B,OAAOqB,KAAKpW,KAAK,yBACnCub,EAAW16B,KAAKk0B,OAAOqB,KAAKpW,KAAK,uBAC7Bwb,EAAWviC,QAAUsiC,EAAStiC,QAChCu9B,EAAiBgF,EAAWrb,SAC5BoZ,EAAc/C,EAAeoB,WAAW15B,MAAMs9B,GAC9C5E,EAAe2E,EAASpb,SACxByY,EAAYhC,EAAagB,WAAW15B,MAAMq9B,GACtC/E,EAAe,KAAOI,EAAa,KACrCgC,GAAa,GAEfjD,EAAQT,SAASyG,cACjBhG,EAAMqF,SAASxE,EAAel+B,IAAI,GAAIihC,GACtC5D,EAAMoE,OAAOnD,EAAat+B,IAAI,GAAIsgC,GAClC4C,EAAWI,SACXL,EAASK,SACT/6B,KAAK80B,MAAMA,KAEX6F,EAAWI,SACXL,EAASK,UAEX/6B,KAAK46B,iBAAkB,EAChB9F,IAGFvC,GAENjC,GAEHkB,EAAY,SAAUgC,GAGpB,QAAShC,KACP,MAAOA,GAAU6B,UAAUH,YAAYnzB,MAAMC,KAAMC,WAwSrD,MA3SA8yB,GAAOvB,EAAWgC,GAMlBhC,EAAUiC,WAAa,YAEvBjC,EAAU1xB,UAAUk7B,MAClBC,eACAC,qBACAC,kBAGF3J,EAAU1xB,UAAUm0B,MAAQ,WAe1B,MAdAj0B,MAAKk0B,OAASl0B,KAAKm0B,QACnBn0B,KAAKo7B,aAAe/K,EAAE2G,OAAO,KAAM,OAAQ,IAAK,MAAM,UAAW,SAAU,IAAK,IAAK,KAAM,KAAM,aAAc,MAAO,OAAQ,KAAM,KAAM,KAAM,KAAM,MAAOh3B,KAAKg7B,KAAKC,aACvKj7B,KAAKq7B,mBAAqBhL,EAAE0C,QAC1BuI,KAAM,MAAO,MAAO,QAAS,SAAU,kBACvCpQ,GAAI,OAAQ,UACZqQ,MAAO,UACNv7B,KAAKg7B,KAAKE,mBACbl7B,KAAKw7B,eAAiBnL,EAAE0C,QACtBlV,GAAI,cAAe,cACnB4d,IAAK,cAAe,cACpBC,IAAK,cAAe,cACpBC,IAAK,cAAe,cACpBC,IAAK,cAAe,eACnB57B,KAAKg7B,KAAKG,eACNn7B,KAAKk0B,OAAOqB,KAAKpP,GAAG,QAAS,IAAK,SAASqO,GAChD,OAAO,KAIXhD,EAAU1xB,UAAU+7B,SAAW,SAASvB,GAKtC,MAJW,OAAPA,IACFA,EAAMt6B,KAAKk0B,OAAOqB,MAEpBv1B,KAAKk0B,OAAO4H,QAAQ,YAAaxB,IAC1BA,GAGT9I,EAAU1xB,UAAUi8B,WAAa,SAASzB,GAKxC,MAJW,OAAPA,IACFA,EAAMt6B,KAAKk0B,OAAOqB,KAAKyG,SAEzBh8B,KAAKk0B,OAAO4H,QAAQ,cAAexB,IAC5BA,GAGT9I,EAAU1xB,UAAUm8B,SAAW,SAAS3B,GACtC,GAAI4B,GAAO1F,EAAO2F,EAAc3iC,EAAG4iC,EAAWhjB,EAAKijB,EAAWC,EAAOC,EAAIC,EAAYC,EAAQ5f,EAAM6f,CAqBnG,KApBW,MAAPpC,IACFA,EAAMt6B,KAAKk0B,OAAOqB,MAEpB8G,KACAF,EAAe,SAASQ,GACtB,MAAOA,GAAY5F,WAAWV,KAAK,SAASl+B,EAAGm+B,GAC7C,GAAIE,GAAO3Z,CAEX,IADA2Z,EAAQnG,EAAEiG,IACNE,EAAMJ,GAAG,OAAQI,EAAMoG,QAAQ,SAAUtC,GAAKliC,OAGlD,OAAKo+B,EAAMJ,GAAG,WAAaI,EAAMO,WAAW3+B,OACnC+jC,EAAa3F,IACV3Z,EAAO2Z,EAAM3Z,SAAW,sBAAsBsM,KAAKtM,GACtDwf,EAAUt/B,KAAKy5B,GADjB,UAKX2F,EAAa7B,GACbiC,EAAK,gDACA/iC,EAAI,EAAG4f,EAAMijB,EAAUjkC,OAAQoB,EAAI4f,EAAK5f,IAAK,CAMhD,IALAg9B,EAAQ6F,EAAU7iC,GAClBqjB,EAAO2Z,EAAM3Z,OACb2f,KACAF,EAAQ,KACRF,EAAY,EACuB,QAA3BE,EAAQC,EAAGM,KAAKhgB,KACtB4f,EAAS5f,EAAKigB,UAAUV,EAAWE,EAAMj/B,OACzCm/B,EAAWz/B,KAAKs3B,SAAS0I,eAAeN,IACxCL,EAAYG,EAAGH,UACfM,EAAM,sBAAsBvT,KAAKmT,EAAM,IAAMA,EAAM,GAAK,UAAYA,EAAM,GAC1EJ,EAAQ7L,EAAE,YAAeqM,EAAM,yBAA4B7f,KAAKyf,EAAM,IACtEE,EAAWz/B,KAAKm/B,EAAM,GAExBM,GAAWz/B,KAAKs3B,SAAS0I,eAAelgB,EAAKigB,UAAUV,KACvD5F,EAAMwG,YAAY3M,EAAEmM,IAEtB,MAAOlC,IAGT9I,EAAU1xB,UAAUqc,OAAS,SAASme,GACpC,GAAI9D,GAAOyG,EAAWzjC,EAAG85B,EAAGla,EAAK8jB,EAAMhF,EAAG5B,EAAM6G,EAAKC,CAKrD,IAJW,MAAP9C,IACFA,EAAMt6B,KAAKk0B,OAAOqB,MAGhB+E,EAAIlE,GAAG,UAET,MADAkE,GAAI1K,OAAO,MAAQ5vB,KAAKk0B,OAAOe,KAAK0E,KAAO,QACpCW,CAGT,KADA6C,EAAM7C,EAAIvD,WACLv9B,EAAI,EAAG4f,EAAM+jB,EAAI/kC,OAAQoB,EAAI4f,EAAK5f,IACrC0+B,EAAIiF,EAAI3jC,GACRwG,KAAKq9B,UAAUnF,GAAG,EAGpB,KADAkF,EAAO9C,EAAIvD,WACNzD,EAAI,EAAG4J,EAAOE,EAAKhlC,OAAQk7B,EAAI4J,EAAM5J,IACxCgD,EAAO8G,EAAK9J,GACZkD,EAAQnG,EAAEiG,GACNE,EAAMJ,GAAG,OACc,mBAAd6G,IAA2C,OAAdA,IACtCA,EAAY,MAEdzG,EAAMuE,UACG/6B,KAAKk0B,OAAOe,KAAKmC,YAAYd,GAClCE,EAAMJ,GAAG,MACP6G,GAAaA,EAAU7G,GAAG,UAC5B6G,EAAUrN,OAAO0G,IAEjB2G,EAAY5M,EAAE,SAASiN,aAAahH,GACpC2G,EAAUrN,OAAO0G,IAGnB2G,EAAY,MAGTA,IAAaA,EAAU7G,GAAG,YAC7B6G,EAAY5M,EAAE,QAAQiN,aAAahH,IAErC2G,EAAUrN,OAAO0G,GACbt2B,KAAKk0B,OAAOe,KAAKyE,YAAYuD,IAC/BA,EAAUrN,OAAO5vB,KAAKk0B,OAAOe,KAAK0E,MAIxC,OAAOW,IAGT9I,EAAU1xB,UAAUu9B,UAAY,SAAS/G,EAAMiH,GAC7C,GAAIC,GAAWC,EAAWjH,EAAOkH,EAAI/N,EAAKuL,EAAmByC,EAAM5G,EAAU6G,EAAcpkC,EAAG85B,EAAGla,EAAK8jB,EAAMhF,EAAGiF,EAAKC,EAAMvgB,EAAMghB,CAEhI,IADArH,EAAQnG,EAAEiG,GACJE,EAAMp+B,OAAS,EAArB,CAGA,GAA0B,IAAtBo+B,EAAM,GAAG8B,SAQX,MAPAzb,GAAO2Z,EAAM3Z,OAAOpK,QAAQ,iBAAkB,SAC1CoK,GACFghB,EAAWxJ,SAAS0I,eAAelgB,GACnC2Z,EAAMwG,YAAYa,IAElBrH,EAAMuE,SAMV,IAFAhE,EAAWP,EAAMJ,GAAG,UAAY,KAAOI,EAAMO,WAC7C6G,EAAe59B,KAAKk0B,OAAOe,KAAK6I,gBAAgBtH,GAC5CA,EAAMJ,GAAGp2B,KAAKo7B,aAAa2C,KAAK,OAASH,GAiB3C,GAhBIpH,EAAMJ,GAAG,OAASqH,EAAYjH,EAAMrX,KAAK,QAAQ/mB,OAAS,IAC5Do+B,EAAMwG,YAAYS,GAClBjH,EAAQiH,EACR1G,EAAW,MAETP,EAAMJ,GAAG,QAAUoH,EAAYhH,EAAMrX,KAAKnf,KAAKk0B,OAAOe,KAAKiC,WAAW6G,KAAK,OAAO3lC,OAAS,IAC7FolC,EAAUnH,KAAK,SAAU9B,GACvB,MAAO,UAASp8B,EAAG6lC,GACjB,MAAO3N,GAAE2N,GAASjH,WAAWkH,WAE9Bj+B,OACH+2B,EAAWP,EAAMO,YAEfP,EAAMJ,GAAG,QAAUI,EAAM0H,SAAS,cACpC1H,EAAMuE,UAEH6C,EAAc,CAGjB,IAFA1C,EAAoBl7B,KAAKq7B,mBAAmB7E,EAAM,GAAG2H,QAAQC,eAC7DjB,EAAM9M,EAAEgO,UAAU7H,EAAM,GAAG8H,YACtB9kC,EAAI,EAAG4f,EAAM+jB,EAAI/kC,OAAQoB,EAAI4f,EAAK5f,IACrCmkC,EAAOR,EAAI3jC,GACO,UAAdmkC,EAAKj/B,OAGmB,MAArBw8B,IAA+BkC,EAAOO,EAAKj/B,KAAMjF,EAAQ25B,KAAK8H,EAAmBkC,IAAS,IAC/F5G,EAAM+H,WAAWZ,EAAKj/B,MAG1BsB,MAAKw+B,iBAAiBhI,GAClBA,EAAMJ,GAAG,SAA0C,IAA/BI,EAAM,GAAG8H,WAAWlmC,QAC1Co+B,EAAMO,WAAWZ,QAAQ8H,cAGE,KAAtBzH,EAAM,GAAG8B,UAAmB9B,EAAMJ,GAAG,WAqB9CI,EAAMuE,SACNhE,EAAW,MArBPP,EAAMJ,GAAG,yCACXI,EAAM5G,OAAO,SACbmH,EAASZ,QAAQ8H,UACRzH,EAAMJ,GAAG,UAClBsH,EAAKrN,EAAE,QACPmG,EAAMrX,KAAK,MAAMkX,KAAK,SAASl+B,EAAGsmC,GAChC,MAAOf,GAAG9N,OAAOS,EAAEoO,GAAI5hB,OAAS,WAElC2Z,EAAMwG,YAAYU,GAClB3G,EAAW,MACFP,EAAMJ,GAAG,iBAClBI,EAAMuE,SACNhE,EAAW,MACFP,EAAMJ,GAAG,OAClBzG,EAAMU,EAAE,SAAST,OAAO4G,EAAMO,YAC9BP,EAAMwG,YAAYrN,IAElBoH,EAASZ,QAAQ8H,QAMrB,IAAIV,GAA0B,MAAZxG,IAAsBP,EAAMJ,GAAG,OAC/C,IAAK9C,EAAI,EAAG4J,EAAOnG,EAAS3+B,OAAQk7B,EAAI4J,EAAM5J,IAC5C4E,EAAInB,EAASzD,GACbtzB,KAAKq9B,UAAUnF,GAAG,EAGtB,OAAO,QAGT1G,EAAU1xB,UAAU0+B,iBAAmB,SAAShI,GAC9C,GAAI2E,GAAe3hC,EAAG4f,EAAKslB,EAAMvB,EAAKC,EAAMrY,EAAO4Z,EAAUC,CAE7D,IADAD,EAAWnI,EAAMmH,KAAK,SACtB,CAKA,GAFAnH,EAAM+H,WAAW,SACjBpD,EAAgBn7B,KAAKw7B,eAAehF,EAAM,GAAG2H,QAAQC,iBAC/CjD,GAAiBA,EAAc/iC,OAAS,GAC5C,MAAOo+B,EAIT,KAFAoI,KACAzB,EAAMwB,EAASxiC,MAAM,KAChB3C,EAAI,EAAG4f,EAAM+jB,EAAI/kC,OAAQoB,EAAI4f,EAAK5f,IACrCurB,EAAQoY,EAAI3jC,GACZurB,EAAQsL,EAAEwO,KAAK9Z,GACf2Z,EAAO3Z,EAAM5oB,MAAM,MACbuiC,EAAKtmC,OAAS,KAGhBglC,EAAOsB,EAAK,GAAIjlC,EAAQ25B,KAAK+H,EAAeiC,IAAS,IACvDwB,EAAOvO,EAAEwO,KAAKH,EAAK,KAAOrO,EAAEwO,KAAKH,EAAK,KAM1C,OAHI5U,QAAOC,KAAK6U,GAAQxmC,OAAS,GAC/Bo+B,EAAMzG,IAAI6O,GAELpI,IAGThF,EAAU1xB,UAAUg/B,UAAY,SAASj0B,EAAMk0B,GAC7C,GAAIC,GAAWjI,EAAUc,CAwBzB,OAvBiB,OAAbkH,IACFA,GAAY,GAEdC,EAAY3O,EAAE,UAAUT,OAAO/kB,GAC/BksB,EAAWiI,EAAUjI,WACrBc,EAAS,GACTd,EAASV,KAAK,SAAU9B,GACtB,MAAO,UAASp8B,EAAGm+B,GACjB,GAAIE,GAAO9Y,CACX,OAAsB,KAAlB4Y,EAAKgC,SACAT,GAAUvB,EAAKiC,UACK,IAAlBjC,EAAKgC,WACd9B,EAAQnG,EAAEiG,GACV5Y,EAAW8Y,EAAMJ,GAAG,UAAY,KAAOI,EAAMO,WACzCrZ,GAAYA,EAAStlB,OAAS,IAChCy/B,GAAUtD,EAAMuK,UAAUphB,IAExBqhB,GAAa5mC,EAAI4+B,EAAS3+B,OAAS,GAAKo+B,EAAMJ,GAAG,oGAC5CyB,GAAU,KAPd,SAWR73B,OACI63B,GAGTrG,EAAU1xB,UAAUm/B,SAAW,SAASC,GACtC,GAAIC,EAIJ,OAHAA,GAAW,SAAS7E,GAClB,SAAUA,EAAIlE,GAAG,OAASkE,EAAIzd,QAAUyd,EAAI5c,SAAS,YAAYtlB,OAAS,IAErE8mC,EAAU7I,KAAK,SAASl+B,EAAGquB,GAChC,GAAI8T,GAAK8E,CAMT,OALA9E,GAAMjK,EAAE7J,GACR4Y,EAAU9E,EAAIlE,GAAG,2DACbgJ,GAAWD,EAAS7E,KACtBA,EAAIS,SAECT,EAAInb,KAAK,0DAA0D4b,YAIvEvJ,GAENlB,GAEHwB,EAAe,SAAU0B,GAGvB,QAAS1B,KACP,MAAOA,GAAauB,UAAUH,YAAYnzB,MAAMC,KAAMC,WAuOxD,MA1OA8yB,GAAOjB,EAAc0B,GAMrB1B,EAAa2B,WAAa,eAE1B3B,EAAahyB,UAAUu/B,eAAiB,GAAI,GAAI,GAAI,GAAI,GAAI,KAE5DvN,EAAahyB,UAAUw/B,YAAc,GAAI,GAAI,GAAI,IAEjDxN,EAAahyB,UAAUm0B,MAAQ,WAC7B,GAAIsL,GAAcC,CA8GlB,OA7GAx/B,MAAKk0B,OAASl0B,KAAKm0B,QACnBn0B,KAAKy/B,sBAAwBz/B,KAAKk0B,OAAOe,KAAKyK,SAAS,SAAUnL,GAC/D,MAAO,UAASoL,GACd,MAAOC,YAAW,WAChB,MAAOrL,GAAML,OAAO4H,QAAQ,eAAgB6D,IAC3C,MAEJ3/B,MAAO,KACVA,KAAK6/B,0BAA4B7/B,KAAKk0B,OAAOe,KAAKyK,SAAS,SAAUnL,GACnE,MAAO,YACL,MAAOA,GAAML,OAAO4H,QAAQ,sBAE7B97B,MAAO,IACVqwB,EAAEgE,UAAUlO,GAAG,2BAA6BnmB,KAAKk0B,OAAOr6B,GAAI,SAAU06B,GACpE,MAAO,UAASC,GACd,GAAIsL,EACJ,IAAMvL,EAAMe,UAAYf,EAAML,OAAO6L,UAAUC,QAmB/C,OAhBAF,EAAe,WAKb,MAJIvL,GAAM0L,kBACRC,aAAa3L,EAAM0L,iBACnB1L,EAAM0L,gBAAkB,MAEtB1L,EAAML,OAAOiM,UAAU/L,WAAWqB,WAAa,EAC1ClB,EAAMsL,4BAENtL,EAAM0L,gBAAkBL,WAAW,WAExC,GADArL,EAAM0L,gBAAkB,KACpB1L,EAAMe,QACR,MAAOwK,MAER,UAKR9/B,OACHA,KAAKk0B,OAAO/N,GAAG,eAAgB,SAAUoO,GACvC,MAAO,YACL,GAAI6L,EA6BJ,IA5BA7L,EAAM8L,kBAAoB,KAC1BD,EAAc7L,EAAML,OAAOqB,KAAK7X,WAAWyZ,OAAO,SAASh/B,EAAGm+B,GAC5D,MAAO/B,GAAML,OAAOe,KAAKmC,YAAYd,KAEnC/B,EAAMe,SAAkC,IAAvB8K,EAAYhoC,SAC/Bm8B,EAAML,OAAOiM,UAAU93B,OACvBksB,EAAML,OAAOoM,UAAUnkB,SACvBoY,EAAML,OAAOiM,UAAUtF,WAEzBtG,EAAML,OAAOqB,KAAKpW,KAAK,4BAA4BkX,KAAK,SAASl+B,EAAGquB,GAClE,GAAI8T,GAAKiG,CAET,IADAjG,EAAMjK,EAAE7J,IACJ8T,EAAIhb,SAAS8W,GAAG,eAAiBkE,EAAIhb,SAAS,KAAOiV,EAAML,OAAOqB,KAAK,MACzEgL,GAAY,EACc,IAAtBjG,EAAI7c,OAAOrlB,SACbi4B,EAAE,QAAQT,OAAO2E,EAAML,OAAOe,KAAK0E,MAAM6G,YAAYlG,GACrDiG,GAAY,GAEY,IAAtBjG,EAAI/a,OAAOnnB,SACbi4B,EAAE,QAAQT,OAAO2E,EAAML,OAAOe,KAAK0E,MAAM2D,aAAahD,GACtDiG,GAAY,GAEVA,GACF,MAAOhM,GAAMkL,0BAInBlL,EAAML,OAAOqB,KAAKpW,KAAK,aAAayQ,OAAO2E,EAAML,OAAOe,KAAK0E,OACxDpF,EAAML,OAAOe,KAAKwL,QAAQC,mBAAqBnM,EAAMe,QACxD,MAAOf,GAAMsL,8BAGhB7/B,OACHA,KAAKk0B,OAAOqB,KAAKpP,GAAG,UAAWkK,EAAEsQ,MAAM3gC,KAAK4gC,WAAY5gC,OAAOmmB,GAAG,WAAYkK,EAAEsQ,MAAM3gC,KAAK6gC,YAAa7gC,OAAOmmB,GAAG,QAASkK,EAAEsQ,MAAM3gC,KAAK8gC,SAAU9gC,OAAOmmB,GAAG,UAAWkK,EAAEsQ,MAAM3gC,KAAK+gC,WAAY/gC,OAAOmmB,GAAG,QAASkK,EAAEsQ,MAAM3gC,KAAKghC,SAAUhhC,OAAOmmB,GAAG,OAAQkK,EAAEsQ,MAAM3gC,KAAKihC,QAASjhC,OAAOmmB,GAAG,OAAQkK,EAAEsQ,MAAM3gC,KAAKkhC,QAASlhC,OAAOmmB,GAAG,QAASkK,EAAEsQ,MAAM3gC,KAAKmhC,SAAUnhC,OAChWA,KAAKk0B,OAAOe,KAAKC,QAAQC,UAC3Bn1B,KAAKk0B,OAAOrD,QAAQuQ,IAAI,WAAY,SAAU7M,GAC5C,MAAO,UAASC,GAGd,MAFAA,GAAE6M,iBACF9M,EAAML,OAAOiM,UAAU/L,WAAWkN,OAAO,OAAQ,WAAY,iBACtD,IAERthC,OACHA,KAAKk0B,OAAOrD,QAAQuQ,IAAI,YAAa,SAAU7M,GAC7C,MAAO,UAASC,GAGd,MAFAA,GAAE6M,iBACF9M,EAAML,OAAOiM,UAAU/L,WAAWkN,OAAO,OAAQ,UAAW,iBACrD,IAERthC,OACHu/B,EAAev/B,KAAKk0B,OAAOe,KAAKsM,GAAGC,IAAM,QAAU,SACnDxhC,KAAKk0B,OAAOrD,QAAQuQ,IAAI7B,EAAc,SAAUhL,GAC9C,MAAO,UAASC,GACd,GAAIiN,GAAWC,EAAYC,EAAW7M,CAEtC,IADA2M,EAAYlN,EAAML,OAAOqB,KAAK7X,WACxB+jB,EAAUrpC,OAAS,EASzB,MANAspC,GAAaD,EAAUtL,QAAQ1+B,IAAI,GACnCkqC,EAAYF,EAAU3K,OAAOr/B,IAAI,GACjCq9B,EAAQT,SAASyG,cACjBhG,EAAMqF,SAASuH,EAAY,GAC3B5M,EAAMoE,OAAOyI,EAAWpN,EAAML,OAAOe,KAAK6C,cAAc6J,IACxDpN,EAAML,OAAOiM,UAAUrL,MAAMA,IACtB,IAER90B,QAELw/B,EAAYx/B,KAAKk0B,OAAOe,KAAKsM,GAAGC,IAAM,YAAc,aAC7CxhC,KAAKk0B,OAAOrD,QAAQuQ,IAAI5B,EAAW,SAAUjL,GAClD,MAAO,UAASC,GAEd,MADAD,GAAML,OAAO1N,GAAGoW,QAAQ,QAAQzd,KAAK,iBAAiBxS,SAC/C,IAER3M,QAGL8xB,EAAahyB,UAAUkhC,SAAW,SAASxM,GACzC,IAAIx0B,KAAKk0B,OAAO6L,UAAUC,QAK1B,MAFAhgC,MAAKk0B,OAAO1N,GAAGnH,SAAS,SAASD,YAAY,SAC7Cpf,KAAKs1B,SAAU,EACRsK,WAAW,SAAUrL,GAC1B,MAAO,YACL,GAAIqN,GAAU9M,CAad,IAZAA,EAAQP,EAAML,OAAOiM,UAAU/L,WAAWM,WAAW,GACjDI,EAAMa,iBAAmBpB,EAAML,OAAOqB,KAAK,KACzChB,EAAM8L,kBACR9L,EAAML,OAAO2N,YAAYC,cAAcvN,EAAM8L,oBAE7CuB,EAAWrN,EAAML,OAAOqB,KAAK7X,WAAWyY,QACxCrB,EAAQT,SAASyG,cACjBvG,EAAML,OAAOiM,UAAUlH,kBAAkB2I,EAAU9M,KAGvDP,EAAM8L,kBAAoB,KAC1B9L,EAAML,OAAO6N,eAAe,UACvBxN,EAAML,OAAOe,KAAKwL,QAAQC,kBAC7B,MAAOnM,GAAMsL,8BAGhB7/B,MAAO,IAGZ8xB,EAAahyB,UAAUmhC,QAAU,SAASzM,GACxC,GAAI2I,EACJ,KAAIn9B,KAAKk0B,OAAO6L,UAAUC,QAO1B,MAJAhgC,MAAKk0B,OAAO1N,GAAGpH,YAAY,SAC3Bpf,KAAKk0B,OAAO8N,OACZhiC,KAAKs1B,SAAU,EACft1B,KAAKqgC,kBAAsE,OAAjDlD,EAAMn9B,KAAKk0B,OAAO2N,YAAYI,gBAA0B9E,EAAI+E,MAAQ,OACvFliC,KAAKk0B,OAAO6N,eAAe,SAGpCjQ,EAAahyB,UAAUihC,WAAa,SAASvM,GAC3C,IAAKx0B,KAAKk0B,OAAOe,KAAKwL,QAAQC,kBAC5B,MAAO1gC,MAAK6/B,6BAIhB/N,EAAahyB,UAAU8gC,WAAa,SAASpM,GAC3C,GAAI2I,GAAKC,CACT,IAAIp9B,KAAKk0B,OAAO6N,eAAevN,MAAO,EACpC,OAAO,CAET,KAAIx0B,KAAKk0B,OAAOrD,QAAQsR,UAAU3N,GAAlC,CAGA,GAAIx0B,KAAKk0B,OAAOkO,UAAUD,UAAU3N,GAElC,MADAx0B,MAAKy/B,yBACE,CAET,IAAKtC,EAAM3I,EAAE6N,QAAO5oC,EAAQ25B,KAAKpzB,KAAKq/B,cAAelC,IAAQ,IAAOC,EAAO5I,EAAE6N,MAAO5oC,EAAQ25B,KAAKpzB,KAAKs/B,WAAYlC,IAAS,IAGvHp9B,KAAKk0B,OAAOe,KAAKqN,QAAQ9N,IAAkB,KAAZA,EAAE6N,OAMrC,MAHKriC,MAAKk0B,OAAOe,KAAKwL,QAAQ8B,SAC5BviC,KAAKy/B,uBAAuB,WAEvB,OAGT3N,EAAahyB,UAAU+gC,YAAc,SAASrM,GAC5C,GAAIx0B,KAAKk0B,OAAO6N,eAAevN,MAAO,EACpC,OAAO,GAIX1C,EAAahyB,UAAUghC,SAAW,SAAStM,GACzC,GAAI3W,GAAGsf,CACP,OAAIn9B,MAAKk0B,OAAO6N,eAAevN,MAAO,KAGjCx0B,KAAKk0B,OAAOe,KAAKwL,QAAQC,oBAAsBvD,EAAM3I,EAAE6N,MAAO5oC,EAAQ25B,KAAKpzB,KAAKs/B,WAAYnC,IAAQ,OACvGn9B,MAAKy/B,6BAGU,IAAZjL,EAAE6N,OAA2B,KAAZ7N,EAAE6N,QAAiBriC,KAAKk0B,OAAOe,KAAKyE,YAAY15B,KAAKk0B,OAAOqB,QAChFv1B,KAAKk0B,OAAOqB,KAAK2E,QACjBrc,EAAIwS,EAAE,QAAQT,OAAO5vB,KAAKk0B,OAAOe,KAAK0E,MAAM6I,SAASxiC,KAAKk0B,OAAOqB,MACjEv1B,KAAKk0B,OAAOiM,UAAUlH,kBAAkBpb,OAI5CiU,EAAahyB,UAAUohC,QAAU,SAAS1M,GACxC,MAAIx0B,MAAKk0B,OAAO6N,eAAevN,MAAO,GAG/Bx0B,KAAKy/B,yBAGd3N,EAAahyB,UAAUqhC,SAAW,SAAS3M,GACzC,MAAOx0B,MAAKy/B,uBAAuB,aAG9B3N,GAENxB,GAEH0B,EAAY,SAAUwB,GAGpB,QAASxB,KACP,MAAOA,GAAUqB,UAAUH,YAAYnzB,MAAMC,KAAMC,WAoRrD,MAvRA8yB,GAAOf,EAAWwB,GAMlBxB,EAAUyB,WAAa,YAEvBzB,EAAUlyB,UAAUm0B,MAAQ,WAG1B,MAFAj0B,MAAKk0B,OAASl0B,KAAKm0B,QACnBn0B,KAAKyiC,sBACEziC,KAAK0iC,0BAGd1Q,EAAUlyB,UAAUshC,IAAM,SAASz5B,EAAK2uB,EAAMqM,GAM5C,MALAh7B,GAAMA,EAAIy2B,cACVz2B,EAAM3H,KAAKk0B,OAAOrD,QAAQqC,YAAY0P,QAAQj7B,IAAQA,EACjD3H,KAAKyiC,mBAAmB96B,KAC3B3H,KAAKyiC,mBAAmB96B,OAEnB3H,KAAKyiC,mBAAmB96B,GAAK2uB,GAAQqM,GAG9C3Q,EAAUlyB,UAAUqiC,UAAY,SAAS3N,GACvC,GAAIqO,GAAMl7B,EAAKw1B,EAAKtF,CAEpB,IADAlwB,EAAqE,OAA9Dw1B,EAAMn9B,KAAKk0B,OAAOrD,QAAQqC,YAAY4P,WAAWtO,EAAE6N,QAAkBlF,EAAIiB,cAAgB,OAIhG,SAAIz2B,IAAO3H,MAAKyiC,qBACd5K,EAA+D,mBAA9CgL,EAAO7iC,KAAKyiC,mBAAmB96B,IAAM,KAAsBk7B,EAAK,KAAKrO,GAAK,OACtFqD,GACH73B,KAAKk0B,OAAOiM,UAAUzK,aAAaW,KAAK,SAAU9B,GAChD,MAAO,UAASp8B,EAAGm+B,GACjB,GAAIqM,GAASvF,CACb,IAAI9G,EAAKgC,WAAayK,KAAKC,aAK3B,MAFAL,GAAoD,OAAzCvF,EAAO7I,EAAMkO,mBAAmB96B,IAAgBy1B,EAAK9G,EAAK6H,QAAQC,eAAiB,OAC9FvG,EAA4B,kBAAZ8K,GAAyBA,EAAQnO,EAAGnE,EAAEiG,IAAS,OAC3DuB,KAAW,GAAQA,KAAW,GAAlC,SAID73B,OAED63B,KAjBN,QAuBF7F,EAAUlyB,UAAU4iC,uBAAyB,WAC3C,GAAIO,EAoNJ,OAnNIjjC,MAAKk0B,OAAOe,KAAKC,QAAQgO,QAC3BljC,KAAKohC,IAAI,QAAS,IAAK,SAAU7M,GAC/B,MAAO,UAASC,GACd,GAAIoN,GAAUuB,CACd,IAAK3O,EAAE4O,WAGPxB,EAAWrN,EAAML,OAAOiM,UAAUjJ,aAAaJ,QAC3C8K,EAASxL,GAAG,QAWhB,MARA+M,GAAM9S,EAAE,SACJkE,EAAML,OAAOiM,UAAU5I,aAAaqK,IACtCrN,EAAML,OAAOiM,UAAUxH,WAAWwK,GAClC5O,EAAML,OAAOiM,UAAUxH,WAAWtI,EAAE,UACpCkE,EAAML,OAAOiM,UAAUpH,eAAeoK,IAEtC5O,EAAML,OAAOiM,UAAUxH,WAAWwK,IAE7B,IAERnjC,QAEDA,KAAKk0B,OAAOe,KAAKC,QAAQmO,QAAUrjC,KAAKk0B,OAAOe,KAAKC,QAAQE,QAC9D6N,EAAoB,SAAU1O,GAC5B,MAAO,UAASC,EAAGgC,GACjB,GAAIkH,EACJ,IAAKnJ,EAAML,OAAOiM,UAAU5I,aAAaf,GAKzC,MAFAkH,GAAKrN,EAAE,QAAQT,OAAO2E,EAAML,OAAOe,KAAK0E,MAAM6G,YAAYhK,GAC1DjC,EAAML,OAAOiM,UAAUlH,kBAAkByE,IAClC,IAER19B,MACHA,KAAKohC,IAAI,QAAS,KAAM6B,GACxBjjC,KAAKohC,IAAI,QAAS,KAAM6B,GACxBjjC,KAAKohC,IAAI,QAAS,KAAM6B,GACxBjjC,KAAKohC,IAAI,QAAS,KAAM6B,GACxBjjC,KAAKohC,IAAI,QAAS,KAAM6B,GACxBjjC,KAAKohC,IAAI,QAAS,KAAM6B,IAE1BjjC,KAAKohC,IAAI,YAAa,IAAK,SAAU7M,GACnC,MAAO,UAASC,GACd,GAAIoN,GAAU0B,EAAcC,EAAYC,CAGxC,OAFAD,GAAahP,EAAML,OAAOiM,UAAU9I,YAAYlB,QAChDmN,EAAeC,EAAWhkB,OACtB+jB,EAAalN,GAAG,OAAS7B,EAAML,OAAOiM,UAAU3H,eAAe+K,IACjEhP,EAAML,OAAOiM,UAAU93B,OACvBi7B,EAAavI,SACbxG,EAAML,OAAOiM,UAAUtF,WAChB,IAET+G,EAAWrN,EAAML,OAAOiM,UAAUjJ,aAAaJ,OAC/C0M,EAAWjP,EAAML,OAAOe,KAAKC,QAAQmO,OACjCG,GAAYjP,EAAML,OAAOiM,UAAU3H,eAAeoJ,IACpDrN,EAAML,OAAOiM,UAAU93B,OACvBksB,EAAML,OAAOoM,UAAUjD,UAAUuE,GAAU,GAC3CrN,EAAML,OAAOiM,UAAUtF,UAChB,MAJT,UAOD76B,OACHA,KAAKohC,IAAI,QAAS,KAAM,SAAU7M,GAChC,MAAO,UAASC,EAAGgC,GACjB,GAAIiN,GAAYC,EAAQC,EAAYC,CAGpC,IAFAH,EAAajN,EAAMwF,QACnByH,EAAWtkB,KAAK,UAAU4b,SACpBxG,EAAML,OAAOe,KAAKyE,YAAY+J,IAAejN,EAAMJ,GAAG7B,EAAML,OAAOiM,UAAUjJ,aAAaJ,QAAhG,CAIA,GADA4M,EAASlN,EAAMlX,SACXkX,EAAM/Y,KAAK,MAAMrlB,OAAS,EAAG,CAC/B,IAAKm8B,EAAML,OAAOe,KAAKyE,YAAYlD,GACjC,MAEEkN,GAAOpkB,OAAO,MAAMlnB,OAAS,GAC/BurC,EAAatT,EAAE,SAAST,OAAO2E,EAAML,OAAOe,KAAK0E,MAAM6G,YAAYkD,EAAOpkB,OAAO,OACjFskB,EAAYvT,EAAE,IAAMqT,EAAO,GAAGvF,QAAU,MAAMvO,OAAO4G,EAAMqN,QAAQ,OACnEF,EAAW/T,OAAOgU,KAElBD,EAAatT,EAAE,QAAQT,OAAO2E,EAAML,OAAOe,KAAK0E,MAAM6G,YAAYkD,GAClEE,EAAYvT,EAAE,IAAMqT,EAAO,GAAGvF,QAAU,MAAMvO,OAAO4G,EAAMqN,QAAQ,OACnEF,EAAWG,MAAMF,QAGfF,GAAOpkB,OAAO,MAAMlnB,OAAS,GAC/BurC,EAAatT,EAAE,SAASmQ,YAAYkD,EAAOpkB,OAAO,OAC9CkX,EAAMO,WAAW3+B,OAAS,EAC5BurC,EAAW/T,OAAO4G,EAAMO,YAExB4M,EAAW/T,OAAO2E,EAAML,OAAOe,KAAK0E,QAGtCgK,EAAatT,EAAE,QAAQT,OAAO2E,EAAML,OAAOe,KAAK0E,MAAM6G,YAAYkD,GAC9DlN,EAAM9Y,SAAS,UAAUtlB,OAAS,GACpCurC,EAAWG,MAAMtN,EAAM9Y,SAAS,WAUtC,OANI8Y,GAAMjX,KAAK,MAAMnnB,OACnBo+B,EAAMuE,SAEN2I,EAAO3I,SAETxG,EAAML,OAAOiM,UAAUlH,kBAAkB0K,IAClC,KAER3jC,OACHA,KAAKohC,IAAI,QAAS,MAAO,SAAU7M,GACjC,MAAO,UAASC,EAAGgC,GACjB,GAAIkH,GAAIqG,EAAWjP,CAEnB,OADAN,GAAE6M,iBACE7M,EAAE4O,UACJ1F,EAAKrN,EAAE,QAAQT,OAAO2E,EAAML,OAAOe,KAAK0E,MAAM6G,YAAYhK,GAC1DjC,EAAML,OAAOiM,UAAUlH,kBAAkByE,IAClC,IAET5I,EAAQP,EAAML,OAAOiM,UAAUrL,QAC/BiP,EAAY,KACZjP,EAAMsF,kBACD7F,EAAML,OAAOe,KAAKC,QAAQE,MAAQb,EAAML,OAAOiM,UAAU5I,aAAaf,IACzEuN,EAAY1P,SAAS0I,eAAe,QACpCjI,EAAM6D,WAAWoL,GACjBjP,EAAMoE,OAAO6K,EAAW,KAExBA,EAAY1P,SAAS0I,eAAe,MACpCjI,EAAM6D,WAAWoL,GACjBjP,EAAMkP,cAAcD,IAEtBjP,EAAMgE,UAAS,GACfvE,EAAML,OAAOiM,UAAUrL,MAAMA,IACtB,KAER90B,OACHA,KAAKohC,IAAI,QAAS,aAAc,SAAU7M,GACxC,MAAO,UAASC,EAAGgC,GACjB,GAAIyN,GAAenP,CAEnB,IADAmP,EAAgB1P,EAAML,OAAOiM,UAAUjJ,aAAaJ,OAC9CmN,EAAc7N,GAAG,OAAS6N,EAAcxmB,OAAOrlB,QAAUm8B,EAAML,OAAOe,KAAKyE,YAAYuK,GAM7F,MAHAzN,GAAMsN,MAAMG,GACZnP,EAAQT,SAASyG,cACjBvG,EAAML,OAAOiM,UAAUlH,kBAAkBgL,EAAenP,IACjD,IAER90B,OACHA,KAAKohC,IAAI,YAAa,KAAM,SAAU7M,GACpC,MAAO,UAASC,EAAGgC,GACjB,GAAI2M,GAAKe,EAAYC,EAAQC,EAAgBC,EAAWC,EAAWC,EAAMzP,EAAOjY,CAGhF,OAFAqnB,GAAa1N,EAAM9Y,SAAS,UAC5B2mB,EAAY7N,EAAMjX,KAAK,MACjB2kB,EAAW9rC,OAAS,GAAKisC,EAAUjsC,OAAS,IAGlDykB,EAAO,GACPynB,EAAY,KACZ9N,EAAMO,WAAWV,KAAK,SAASl+B,EAAG+/B,GAChC,GAAmB,IAAfA,EAAEI,UAAkB,QAAQnP,KAAK+O,EAAEsM,UACrC,OAAO,CAET,IAAmB,IAAftM,EAAEI,WAAkB,KAAKnP,KAAK+O,EAAEsM,UAQpC,MALmB,KAAftM,EAAEI,UAAkBJ,EAAEK,UACxB1b,GAAQqb,EAAEK,UACc,IAAfL,EAAEI,WACXzb,GAAQwT,EAAE6H,GAAGrb,QAERynB,EAAYjU,EAAE6H,KAEvBqM,EAAOhQ,EAAML,OAAOe,KAAKC,QAAQC,UAAYmP,EAAU7mB,KAAK,MAAMrlB,OAC9DksC,GAA6B,IAAhBznB,EAAKzkB,QAAgBmsC,GACpCpB,EAAM9S,EAAEkE,EAAML,OAAOe,KAAK0E,MAAM6G,YAAY8D,GAC5CA,EAAUvJ,SACVxG,EAAML,OAAOiM,UAAUpH,eAAeoK,IAC/B,KACEtmB,EAAKzkB,OAAS,KAGzB08B,EAAQT,SAASyG,cACjBsJ,EAAiBC,EAAU3mB,SAAS,UAChC0mB,EAAehsC,OAAS,GAC1B+rC,EAAS9T,EAAE,SAAST,OAAO2E,EAAML,OAAOe,KAAK0E,MAAM6I,SAAS4B,GAC5DA,EAAexU,OAAOsU,EAAWxmB,SAAS,OAC1C8Y,EAAMuE,SACNxG,EAAML,OAAOiM,UAAUhH,gBAAgBgL,EAAQrP,KAE/CP,EAAML,OAAOiM,UAAUhH,gBAAgBkL,EAAWvP,GAClDuP,EAAUzU,OAAOsU,GACjB1N,EAAMuE,SACNxG,EAAML,OAAOiM,UAAUrL,MAAMA,KAExB,MAER90B,OACHA,KAAKohC,IAAI,YAAa,MAAO,SAAU7M,GACrC,MAAO,UAASC,EAAGgC,GACjB,GAAIiO,GAAUC,EAAS5P,CACvB,IAAKP,EAAML,OAAOiM,UAAU3H,eAAehC,GAQ3C,MALAkO,GAAUlO,EAAM3rB,OAAO4H,QAAQ,KAAM,UAAY8hB,EAAML,OAAOe,KAAK0E,KACnE8K,EAAWpU,EAAE,QAAQT,OAAO8U,GAASlE,YAAYhK,GACjDA,EAAMuE,SACNjG,EAAQT,SAASyG,cACjBvG,EAAML,OAAOiM,UAAUlH,kBAAkBwL,EAAU3P,IAC5C,IAER90B,OACIA,KAAKohC,IAAI,YAAa,aAAc,SAAU7M,GACnD,MAAO,UAASC,EAAGgC,GACjB,GAAImO,GAAa7P,CACjB,IAAKP,EAAML,OAAOiM,UAAU3H,eAAehC,GAM3C,MAHAmO,GAAcnO,EAAM9Y,WAAWyY,QAAQ8H,SACvCnJ,EAAQT,SAASyG,cACjBvG,EAAML,OAAOiM,UAAUlH,kBAAkB0L,EAAa7P,IAC/C,IAER90B,QAGEgyB,GAEN1B,GAEHwC,EAAc,SAAUU,GAGtB,QAASV,KACP,MAAOA,GAAYO,UAAUH,YAAYnzB,MAAMC,KAAMC,WAoSvD,MAvSA8yB,GAAOD,EAAaU,GAMpBV,EAAYW,WAAa,cAEzBX,EAAYhzB,UAAU8kC,UAEtB9R,EAAYhzB,UAAU+kC,UAAY,GAElC/R,EAAYhzB,UAAUglC,eAAiB,KAEvChS,EAAYhzB,UAAUilC,aAAe,KAErCjS,EAAYhzB,UAAUm0B,MAAQ,WAC5B,GAAI+Q,GAAcC,CAqDlB,OApDAjlC,MAAKk0B,OAASl0B,KAAKm0B,QACnBn0B,KAAKklC,UACDllC,KAAKk0B,OAAOe,KAAKsM,GAAGC,KACtByD,EAAe,QACfD,EAAe,eACNhlC,KAAKk0B,OAAOe,KAAKsM,GAAG4D,KAC7BF,EAAe,SACfD,EAAe,WAEfC,EAAe,SACfD,EAAe,gBAEjBhlC,KAAKk0B,OAAOrD,QAAQuQ,IAAI6D,EAAc,SAAU1Q,GAC9C,MAAO,UAASC,GAGd,MAFAA,GAAE6M,iBACF9M,EAAM6Q,QACC,IAERplC,OACHA,KAAKk0B,OAAOrD,QAAQuQ,IAAI4D,EAAc,SAAUzQ,GAC9C,MAAO,UAASC,GAGd,MAFAA,GAAE6M,iBACF9M,EAAM8Q,QACC,IAERrlC,OACHA,KAAKslC,mBAAqBtlC,KAAKk0B,OAAOe,KAAKyK,SAAS,SAAUnL,GAC5D,MAAO,YACL,MAAOA,GAAMgR,mBAEdvlC,MAAO,KACVA,KAAKk0B,OAAO/N,GAAG,eAAgB,SAAUoO,GACvC,MAAO,UAASC,EAAGgR,GACjB,GAAY,SAARA,GAA0B,SAARA,EAGtB,MAAOjR,GAAM+Q,uBAEdtlC,OACHA,KAAKk0B,OAAO/N,GAAG,mBAAoB,SAAUoO,GAC3C,MAAO,UAASC,GAEd,MADAD,GAAMkR,qBACClR,EAAMpmB,WAEdnO,OACHA,KAAKk0B,OAAO/N,GAAG,QAAS,SAAUoO,GAChC,MAAO,UAASC,GACd,GAA4B,IAAxBD,EAAM2Q,OAAO9sC,OACf,MAAOm8B,GAAMgR,mBAGhBvlC,OACIA,KAAKk0B,OAAO/N,GAAG,OAAQ,SAAUoO,GACtC,MAAO,UAASC,GACd,MAAOD,GAAMkR,uBAEdzlC,QAGL8yB,EAAYhzB,UAAU2lC,mBAAqB,WAEzC,MADAzlC,MAAK8kC,eAAiB,KACf9kC,KAAK+kC,aAAe,MAG7BjS,EAAYhzB,UAAU4lC,cAAgB,WAIpC,MAHI1lC,MAAKk0B,OAAOiM,UAAUzM,SACxB1zB,KAAK8kC,iBAAmB9kC,KAAK8kC,eAAiB9kC,KAAK2lC,aAAa,WAE3D3lC,KAAK8kC,gBAGdhS,EAAYhzB,UAAU8lC,YAAc,WAalC,MAZI5lC,MAAKk0B,OAAOiM,UAAUzM,SACxB1zB,KAAK+kC,eAAiB/kC,KAAK+kC,aAAe,SAAUxQ,GAClD,MAAO,YACL,GAAIO,EAEJ,OADAA,GAAQP,EAAML,OAAOiM,UAAUrL,QAC3BA,EAAMgB,UACDvB,EAAMuQ,eAERvQ,EAAMoR,aAAa,SAE3B3lC,UAEEA,KAAK+kC,cAGdjS,EAAYhzB,UAAUylC,eAAiB,WACrC,GAAIrD,EACJ,IAAIliC,KAAKk0B,OAAO6N,eAAe,oBAAqB,IAGpDG,EAAQliC,KAAK8hC,gBACRI,EAAM2D,OASX,MANA7lC,MAAK4kC,QAAU,EACf5kC,KAAKklC,OAAO9sC,OAAS4H,KAAK4kC,OAC1B5kC,KAAKklC,OAAOnoC,MACV8N,KAAM7K,KAAKk0B,OAAOqB,KAAK1qB,OACvBq3B,MAAOliC,KAAK8hC,kBAEV9hC,KAAKklC,OAAO9sC,OAAS4H,KAAK6kC,WAC5B7kC,KAAKklC,OAAOtkC,QACLZ,KAAK4kC,QAAU,GAFxB,QAMF9R,EAAYhzB,UAAUmiC,aAAe,WACnC,MAAIjiC,MAAKklC,OAAO9sC,QAAU4H,KAAK4kC,UACtB5kC,KAAKklC,OAAOllC,KAAK4kC,QAEjB,MAIX9R,EAAYhzB,UAAUslC,KAAO,WAC3B,GAAIU,EACJ,MAAI9lC,KAAK4kC,OAAS,GAAK5kC,KAAKklC,OAAO9sC,OAAS,GAU5C,MAPA4H,MAAKk0B,OAAO6R,cACZ/lC,KAAK4kC,QAAU,EACfkB,EAAQ9lC,KAAKklC,OAAOllC,KAAK4kC,QACzB5kC,KAAKk0B,OAAOqB,KAAK99B,IAAI,GAAGuuC,UAAYF,EAAMj7B,KAC1C7K,KAAK8hC,cAAcgE,EAAM5D,OACzBliC,KAAKk0B,OAAOqB,KAAKpW,KAAK,aAAaC,YAAY,YAC/Cpf,KAAKk0B,OAAO8N,OACLhiC,KAAKk0B,OAAO4H,QAAQ,gBAAiB,UAG9ChJ,EAAYhzB,UAAUulC,KAAO,WAC3B,GAAIS,EACJ,MAAI9lC,KAAK4kC,OAAS,GAAK5kC,KAAKklC,OAAO9sC,OAAS4H,KAAK4kC,OAAS,GAU1D,MAPA5kC,MAAKk0B,OAAO6R,cACZ/lC,KAAK4kC,QAAU,EACfkB,EAAQ9lC,KAAKklC,OAAOllC,KAAK4kC,QACzB5kC,KAAKk0B,OAAOqB,KAAK99B,IAAI,GAAGuuC,UAAYF,EAAMj7B,KAC1C7K,KAAK8hC,cAAcgE,EAAM5D,OACzBliC,KAAKk0B,OAAOqB,KAAKpW,KAAK,aAAaC,YAAY,YAC/Cpf,KAAKk0B,OAAO8N,OACLhiC,KAAKk0B,OAAO4H,QAAQ,gBAAiB,UAG9ChJ,EAAYhzB,UAAUqO,OAAS,WAC7B,GAAI8zB,EAEJ,IADAA,EAAejiC,KAAKiiC,eAKpB,MADAA,GAAap3B,KAAO7K,KAAKk0B,OAAOqB,KAAK1qB,OAC9Bo3B,EAAaC,MAAQliC,KAAK8hC,iBAGnChP,EAAYhzB,UAAUmmC,eAAiB,SAAS3P,EAAMj5B,GACpD,GAAIi6B,GAAS4O,EAASngC,CA0BtB,OAxBEuxB,GADEjH,EAAE8V,UAAU9oC,GACJgzB,EAAEiG,GAEFjG,EAAEiG,GAAMhX,SAEpBvZ,EAAS,EACTmgC,GAAU,EACV5O,EAAQP,WAAWV,KAAK,SAASl+B,EAAG66B,GAClC,MAAIsD,KAAStD,IAAU31B,IAAUlF,GAAW,IAANA,KAGlC66B,EAAMsF,WAAayK,KAAKqD,WACrBF,GAAWlT,EAAMuF,UAAUngC,OAAS,IACvC2N,GAAU,EACVmgC,GAAU,IAGZngC,GAAU,EACVmgC,GAAU,GAER7oC,EAAQ,IAAMlF,GAGX,QAEF4N,GAGT+sB,EAAYhzB,UAAU6lC,aAAe,SAASttC,GAC5C,GAAIo+B,GAAQH,EAAMJ,EAAOnwB,EAAQsgC,EAAUC,EAAUxR,CAQrD,IAPY,MAARz8B,IACFA,EAAO,SAETy8B,EAAQ90B,KAAKk0B,OAAOiM,UAAUrL,QAC9B/uB,EAAS+uB,EAAMz8B,EAAO,UACtBo+B,EAASz2B,KAAKk0B,OAAOiM,UAAU9nC,EAAO,WACtCi+B,EAAOG,EAAON,QAAQ,GAClBG,EAAKgC,WAAayK,KAAKqD,UAAW,CAEpC,IADAE,EAAWhQ,EAAKiQ,gBACTD,GAAYA,EAAShO,WAAayK,KAAKqD,WAC5C9P,EAAOgQ,EACPvgC,GAAU/F,KAAKk0B,OAAOe,KAAK6C,cAAcwO,GACzCA,EAAWA,EAASC,eAEtBrQ,GAAQO,EAAOh/B,MACfy+B,EAAM,GAAKI,EACXG,EAASpG,EAAE6F,OAEXnwB,GAAS/F,KAAKimC,eAAe3P,EAAMvwB,EAQrC,OANAsgC,IAAYtgC,GACZ0wB,EAAOJ,KAAK,SAAU9B,GACpB,MAAO,UAASp8B,EAAGm+B,GACjB,MAAO+P,GAASxlC,QAAQ0zB,EAAM0R,eAAe3P,MAE9Ct2B,OACIqmC,GAGTvT,EAAYhzB,UAAU0mC,mBAAqB,SAASH,GAClD,GAAIrT,GAAOyT,EAAYtuC,EAAGqB,EAAG4f,EAAKkd,EAAMvwB,EAAQo3B,CAGhD,KAFA7G,EAAOt2B,KAAKk0B,OAAOqB,KAAK,GACxB4H,EAAMkJ,EAAS9S,MAAM,EAAG8S,EAASjuC,OAAS,GACrCD,EAAIqB,EAAI,EAAG4f,EAAM+jB,EAAI/kC,OAAQoB,EAAI4f,EAAKjhB,IAAMqB,EAAG,CAGlD,GAFAuM,EAASo3B,EAAIhlC,GACbsuC,EAAanQ,EAAKmQ,WACd1gC,EAAS0gC,EAAWruC,OAAS,EAAG,CAClC,GAAID,IAAMkuC,EAASjuC,OAAS,IAAKi4B,EAAEiG,GAAMF,GAAG,aAIrC,CACLE,EAAO,IACP,OALAtD,EAAQqB,SAAS0I,eAAe,IAChCzG,EAAKoQ,YAAY1T,GACjByT,EAAanQ,EAAKmQ,WAMtBnQ,EAAOmQ,EAAW1gC,GAEpB,MAAOuwB,IAGTxD,EAAYhzB,UAAUgiC,cAAgB,SAASI,GAC7C,GAAInM,GAAcgC,EAAWjD,EAAOa,EAAgB+C,CACpD,IAAKwJ,EAQE,CACL,IAAKA,EAAM2D,MACT,MAWF,OATAlQ,GAAiB31B,KAAKwmC,mBAAmBtE,EAAM2D,OAC/CnN,EAAcwJ,EAAM2D,MAAM3D,EAAM2D,MAAMztC,OAAS,GAC3C8pC,EAAMpM,WACRC,EAAeJ,EACfoC,EAAYW,IAEZ3C,EAAe/1B,KAAKwmC,mBAAmBtE,EAAMyE,KAC7C5O,EAAYmK,EAAM2D,MAAM3D,EAAM2D,MAAMztC,OAAS,IAE1Cu9B,GAAmBI,GAQxBjB,EAAQT,SAASyG,cACjBhG,EAAMqF,SAASxE,EAAgB+C,GAC/B5D,EAAMoE,OAAOnD,EAAcgC,GACpB/3B,KAAKk0B,OAAOiM,UAAUrL,MAAMA,SAVV,mBAAZ8R,UAAuC,OAAZA,SACR,kBAAjBA,SAAQC,MACjBD,QAAQC,KAAK,kCAjBnB,MANA/R,GAAQ90B,KAAKk0B,OAAOiM,UAAUrL,QAC9BoN,EAAQliC,KAAKk0B,OAAOmB,aAAaC,SAAqB,MAATR,GAC3C+Q,MAAO7lC,KAAK0lC,gBACZiB,IAAK3mC,KAAK4lC,cACV9P,UAAWhB,EAAMgB,eA+BhBhD,GAENxC,GAEHnnB,EAAO,SAAUqqB,GAGf,QAASrqB,KACP,MAAOA,GAAKkqB,UAAUH,YAAYnzB,MAAMC,KAAMC,WA8QhD,MAjRA8yB,GAAO5pB,EAAMqqB,GAMbrqB,EAAKsqB,WAAa,OAElBtqB,EAAKrJ,UAAUm0B,MAAQ,WAErB,GADAj0B,KAAKk0B,OAASl0B,KAAKm0B,QACfn0B,KAAKk1B,QAAQE,MAAQp1B,KAAKk1B,QAAQ4R,QAAU,GAC9C,MAAO9mC,MAAK25B,KAAO,IAIvBxwB,EAAKrJ,UAAU65B,KAAO,QAEtBxwB,EAAKrJ,UAAUyhC,GAAK,WAClB,GAAIA,EAcJ,OAbAA,MACI,MAAMpY,KAAK4d,UAAUC,YACvBzF,EAAGC,KAAM,EACA,QAAQrY,KAAK4d,UAAUC,YAChCzF,EAAG0F,OAAQ,EACF,MAAM9d,KAAK4d,UAAUC,YAC9BzF,EAAG4D,KAAM,EACA,MAAMhc,KAAK4d,UAAUC,cAC9BzF,EAAG2F,MAAO,GAER,OAAO/d,KAAK4d,UAAUC,cACxBzF,EAAG4F,QAAS,GAEP5F,KAGTp4B,EAAKrJ,UAAUo1B,QAAU,WACvB,GAAIkS,GAAQC,EAAMlS,EAASmS,EAAInK,EAAKC,EAAMmK,EAAMC,EAAMC,EAAMvE,EAAQwE,CAOpE,OANAA,GAAKX,UAAUY,UACfL,EAAK,kBAAkBne,KAAKue,GAC5BN,EAAS,gBAAgBje,KAAKue,GAC9BxE,EAAS,UAAU/Z,KAAKue,KAAQN,EAChCjS,EAAU,WAAWhM,KAAKue,GAC1BL,EAAO,QAAQle,KAAKue,GAChBJ,GAEAlS,MAAM,EACN0R,QAAqF,GAA1B,OAAhD3J,EAAMuK,EAAGpL,MAAM,8BAAwCa,EAAI,GAAK,SAEpEkK,GAEPA,MAAM,EACNhE,QAAQ,EACRyD,QAAkF,GAA3B,OAA5C1J,EAAOsK,EAAGpL,MAAM,yBAAmCc,EAAK,GAAK,SAEjEgK,GAEP/D,QAAQ,EACR+D,QAAQ,EACRN,QAA8F,GAA3B,OAAxDS,EAAOG,EAAGpL,MAAM,qCAA+CiL,EAAK,GAAK,SAE7ErE,GAEPG,QAAQ,EACRH,QAAQ,EACR4D,QAAqF,GAA3B,OAA/CU,EAAOE,EAAGpL,MAAM,4BAAsCkL,EAAK,GAAK,SAEpErS,GAEPyS,SAAS,EACTzS,SAAS,EACT2R,QAAqF,GAA3B,OAA/CW,EAAOC,EAAGpL,MAAM,4BAAsCmL,EAAK,GAAK,eAOjFt+B,EAAKrJ,UAAU2gC,QAAU,WACvB,OACEC,kBAAmB,WACjB,GAAIlM,GAAGkM,CAEP,IADAA,EAAoBrM,SAASqM,kBACH,SAAtBA,EACF,IAEE,MADArM,UAASqM,kBAAoB,EACS,OAA/BrM,SAASqM,kBAChB,MAAO7L,GACPL,EAAIK,EAgCJ,QA9BAR,SAASqM,kBAAoBA,EAGjC,OAAO,KAET6B,QAAS,WACP,OAAQ,kBAAkBpZ,KAAK4d,UAAUY,kBAK/Cx+B,EAAKrJ,UAAU+nC,OAAS,SAASrhB,GAI/B,MAHU,OAANA,IACFA,EAAK6N,UAEAhE,EAAE7J,GAAI,GAAGshB,cAGlB3+B,EAAKrJ,UAAUwiC,QAAU,SAAS9N,GAChC,GAAIuT,EAEJ,OADAA,GAAQ,MAAM5e,KAAK4d,UAAUY,WACzBI,EACKvT,EAAE8N,QAEF9N,EAAEwT,SAIb7+B,EAAKrJ,UAAU45B,YAAc,SAASpD,GACpC,GAAIE,EAEJ,OADAA,GAAQnG,EAAEiG,GACHE,EAAMJ,GAAG,YAAeI,EAAM3Z,SAAW2Z,EAAMrX,KAAK,uBAAuB/mB,QAGpF+Q,EAAKrJ,UAAUg+B,gBAAkB,SAASxH,GACxC,MAAOjG,GAAEiG,GAAMF,GAAG,yBAGpBjtB,EAAKrJ,UAAUo3B,YAAc,MAAO,IAAK,KAAM,KAAM,KAAM,aAAc,KAAM,MAAO,KAAM,KAAM,KAAM,KAAM,KAAM,SAEpH/tB,EAAKrJ,UAAUs3B,YAAc,SAASd,GAEpC,MADAA,GAAOjG,EAAEiG,GAAM,MACVA,GAA0B,IAAlBA,EAAKgC,WAGX,GAAI2P,QAAO,KAAQjoC,KAAKk3B,WAAW6G,KAAK,KAAQ,MAAM5U,KAAKmN,EAAKkO,SAASpG,gBAGlFj1B,EAAKrJ,UAAUg4B,cAAgB,SAASxB,GAEtC,OADAA,EAAOjG,EAAEiG,GAAM,GACPA,EAAKgC,UACX,IAAK,GACL,IAAK,IACH,MAAO,EACT,KAAK,GACL,IAAK,GACH,MAAOhC,GAAKl+B,MACd,SACE,MAAOk+B,GAAKmQ,WAAWruC,SAI7B+Q,EAAKrJ,UAAUooC,cAAgB,SAASC,GACtC,GAAIC,GAAaC,EAAaC,EAAIC,EAAWC,EAAYC,EAA2BC,EAAoBvwC,EAAGwwC,EAAUnvC,EAAGovC,EAAYzL,EAAK0L,CAqBzI,IApBAH,EAAqBI,OAAOC,MAAQ,WAClC,GAAIvU,EACJ,KACE,MAAOwU,SAAQ,GAAID,OACnB,MAAOlU,GAEP,MADAL,GAAIK,GACG,MAGX4T,EAA4BC,GAAsBI,OAAO3vB,YAAc,WACrE,GAAIqb,EACJ,KACE,MAAgD,OAAzC,GAAIuU,OAAM,GAAI5vB,YAAW,OAAOkT,KACvC,MAAOwI,GAEP,MADAL,GAAIK,GACG,MAGXuT,EAAcU,OAAOV,aAAeU,OAAOG,mBAAqBH,OAAOI,gBAAkBJ,OAAOK,cAChGN,EAAcH,GAAsBN,IAC9BS,GAAeC,OAAOM,MAAQN,OAAOO,aAAeP,OAAO3vB,YAC/D,OAAO,CAST,KANEqvB,EADEL,EAAQhsC,MAAM,KAAK,GAAG1C,QAAQ,WAAa,EAChC2vC,KAAKjB,EAAQhsC,MAAM,KAAK,IAExBmtC,mBAAmBnB,EAAQhsC,MAAM,KAAK,IAErDksC,EAAc,GAAIgB,aAAYb,EAAWpwC,QACzCuwC,EAAW,GAAIxvB,YAAWkvB,GACrBlwC,EAAIqB,EAAI,EAAG2jC,EAAMqL,EAAWpwC,OAAQ,GAAK+kC,EAAM3jC,GAAK2jC,EAAM3jC,GAAK2jC,EAAKhlC,EAAI,GAAKglC,IAAQ3jC,IAAMA,EAC9FmvC,EAASxwC,GAAKqwC,EAAWe,WAAWpxC,EAGtC,OADAywC,GAAaT,EAAQhsC,MAAM,KAAK,GAAGA,MAAM,KAAK,GAAGA,MAAM,KAAK,GACxDusC,GACFH,EAAYE,EAA4BE,EAAWN,EAC5C,GAAIU,OAAMR,IACflwC,KAAMuwC,MAGVN,EAAK,GAAIF,GACTE,EAAG1Y,OAAOyY,GACHC,EAAGkB,QAAQZ,KAGpBz/B,EAAKrJ,UAAU4/B,SAAW,SAAS+J,EAAMC,GACvC,GAAIC,GAAMvW,EAAMwW,EAAK9S,EAAM+S,EAAKC,EAAWC,CAgC3C,OA/BAjT,GAAO,EACPiT,EAAY,EACZH,EAAMD,EAAOE,EAAM,KACnBzW,EAAO,WAKL,MAJA2W,GAAY,EACZjT,GAAQ,GAAI5wB,MACZ2jC,EAAMJ,EAAK1pC,MAAM6pC,EAAKD,GACtBC,EAAM,KACCD,EAAO,MAEhBG,EAAY,WACV,GAAIE,EAWJ,OAVAJ,GAAM5pC,KACN2pC,EAAO1pC,UACP+pC,EAAQ,GAAI9jC,MAAS4wB,EAChBiT,IACCC,GAASN,EACXtW,IAEA2W,EAAYnK,WAAWxM,EAAMsW,EAAOM,IAGjCH,GAETC,EAAUnV,MAAQ,WAChB,GAAKoV,EAIL,MADA7J,cAAa6J,GACN3W,KAEF0W,GAGT3gC,EAAKrJ,UAAUmqC,WAAa,SAASp/B,GACnC,GAAIq/B,GAAQC,EAAcC,EAAWC,EAAO/N,EAAOC,EAAI+N,EAAczS,EAAQjQ,CAS7E,KARA2U,EAAK,qBACL1E,EAAS,GACTwS,EAAQ,EACRD,EAAY,KACZD,EAAe,KACfG,EAAe,SAAS1iB,EAAKsQ,GAC3B,MAAO,IAAIr4B,OAAMq4B,EAAI,GAAG6F,KAAKnW,IAEI,QAA3B0U,EAAQC,EAAGM,KAAKhyB,KACtByxB,EAAMlF,YAAc/G,EAAEka,QAAQjO,EAAM,GAAIt8B,KAAKk3B,eAC7CoF,EAAMkO,WAA0B,MAAblO,EAAM,IAA2B,MAAbA,EAAM,GAC7CA,EAAMmO,SAAwB,MAAbnO,EAAM,IAA2B,MAAbA,EAAM,GAC3C4N,EAASE,EAAYA,EAAU/sC,MAAQ+sC,EAAU,GAAGhyC,OAAS,GACxDwvB,EAAM/c,EAAKiyB,UAAUoN,EAAQ5N,EAAMj/B,QAAQjF,OAAS,GAAKi4B,EAAEwO,KAAKjX,KACnEiQ,GAAUjQ,GAER0U,EAAMlF,aAAekF,EAAMmO,WAAanO,EAAMkO,aAChDH,GAAS,GAEP/N,EAAMlF,aAAekF,EAAMkO,aACvBJ,GAAaA,EAAUhT,aAAegT,EAAUK,WACpD5S,GAAU,MAEZA,GAAUyS,EAAaH,EAAcE,IAEvCxS,GAAUyE,EAAM,GACZA,EAAMlF,aAAekF,EAAMmO,WAC7B5S,GAAU,MAERyE,EAAMlF,aAAekF,EAAMkO,aAC7BH,GAAS,GAEXD,EAAY9N,CAEd,OAAOjM,GAAEwO,KAAKhH,IAGT1uB,GAENmnB,GAEHsC,EAAU,SAAUY,GAGlB,QAASZ,KACP,MAAOA,GAAQS,UAAUH,YAAYnzB,MAAMC,KAAMC,WAqInD,MAxIA8yB,GAAOH,EAASY,GAMhBZ,EAAQa,WAAa,UAErBb,EAAQ9yB,UAAUk7B,MAChB0P,SAAS,EACTC,cAAc,EACdC,eAAe,EACfC,mBAAoB,GAGtBjY,EAAQ9yB,UAAUgrC,MAChBC,QAAS,gDACTC,UAAW,4CAGbpY,EAAQ9yB,UAAUm0B,MAAQ,WACxB,GAAIgX,GAAkBC,EAAkBC,CAExC,IADAnrC,KAAKk0B,OAASl0B,KAAKm0B;AACdn0B,KAAKg7B,KAAK0P,QAqEf,MAlEKra,GAAE+a,QAAQprC,KAAKg7B,KAAK0P,WACvB1qC,KAAKg7B,KAAK0P,SAAW,OAAQ,SAAU,YAAa,gBAAiB,IAAK,KAAM,KAAM,aAAc,OAAQ,IAAK,OAAQ,QAAS,IAAK,SAAU,YAEnJ1qC,KAAKqrC,UACLrrC,KAAKsrC,KAAKnlB,GAAG,QAAS,SAASqO,GAC7B,OAAO,IAETx0B,KAAK+qC,QAAQ5kB,GAAG,YAAa,SAAUoO,GACrC,MAAO,UAASC,GACd,MAAOD,GAAM+W,KAAKnsB,KAAK,YAAYC,YAAY,cAEhDpf,OACHqwB,EAAEgE,UAAUlO,GAAG,qBAAuBnmB,KAAKk0B,OAAOr6B,GAAI,SAAU06B,GAC9D,MAAO,UAASC,GACd,MAAOD,GAAM+W,KAAKnsB,KAAK,YAAYC,YAAY,cAEhDpf,QACEA,KAAKg7B,KAAK4P,eAAiB5qC,KAAKg7B,KAAK2P,eACxC3qC,KAAK+qC,QAAQhb,IAAI,MAAO/vB,KAAKg7B,KAAK6P,oBAClCM,EAAgB,EAChBD,EAAmB,SAAU3W,GAC3B,MAAO,YASL,MARAA,GAAMwW,QAAQhb,IAAI,WAAY,UAC9BwE,EAAMwW,QAAQQ,MAAM,QACpBhX,EAAML,OAAOe,KAAK4S,OAAOtT,EAAMwW,SAC/BxW,EAAMwW,QAAQQ,MAAMhX,EAAMwW,QAAQre,cAClC6H,EAAMwW,QAAQhb,IAAI,OAAQwE,EAAML,OAAOe,KAAKsM,GAAG4F,OAAS5S,EAAMwW,QAAQ1E,WAAWmF,KAAOjX,EAAMwW,QAAQhlC,SAASylC,MAC/GjX,EAAMwW,QAAQhb,IAAI,WAAY,IAC9Bob,EAAgB5W,EAAMwW,QAAQve,cAC9B+H,EAAML,OAAOuX,cAAc1b,IAAI,MAAOob,IAC/B,IAERnrC,MACHirC,EAAmB,KACnB5a,EAAEyY,QAAQ3iB,GAAG,mBAAqBnmB,KAAKk0B,OAAOr6B,GAAI,SAAS26B,GACzD,MAAOyW,GAAmBC,MAE5B7a,EAAEyY,QAAQ3iB,GAAG,mBAAqBnmB,KAAKk0B,OAAOr6B,GAAI,SAAU06B,GAC1D,MAAO,UAASC,GACd,GAAIkX,GAAYC,EAAWC,CAC3B,IAAKrX,EAAMwW,QAAQ3U,GAAG,YAMtB,GAHAwV,EAAUrX,EAAML,OAAO6W,QAAQhlC,SAAS8lC,IACxCH,EAAaE,EAAUrX,EAAML,OAAO6W,QAAQve,cAAgB,GAC5Dmf,EAAYtb,EAAEgE,UAAUsX,YAAcpX,EAAMyG,KAAK6P,mBAC7Cc,GAAaC,GAAWD,GAAaD,GAEvC,GADAnX,EAAML,OAAO6W,QAAQ3rB,YAAY,oBAAoB2Q,IAAI,cAAe,IACpEwE,EAAML,OAAOe,KAAKsM,GAAG4F,OACvB,MAAO5S,GAAMwW,QAAQhb,IAAI,MAAOwE,EAAMyG,KAAK6P,wBAK7C,IAFAI,IAAqBA,EAAmBC,KACxC3W,EAAML,OAAO6W,QAAQ1rB,SAAS,oBAAoB0Q,IAAI,cAAeob,GACjE5W,EAAML,OAAOe,KAAKsM,GAAG4F,OACvB,MAAO5S,GAAMwW,QAAQhb,IAAI,MAAO4b,EAAYC,EAAUrX,EAAMyG,KAAK6P,sBAItE7qC,QAELA,KAAKk0B,OAAO/N,GAAG,UAAW,SAAUoO,GAClC,MAAO,YACL,MAAOA,GAAMlmB,QAAQjW,OAAS,IAE/B4H,OACIqwB,EAAEgE,UAAUlO,GAAG,sBAAwBnmB,KAAKk0B,OAAOr6B,GAAI,SAAU06B,GACtE,MAAO,UAASC,GACd,MAAOD,GAAM+W,KAAKnsB,KAAK,cAAcC,YAAY,aAElDpf,QAGL4yB,EAAQ9yB,UAAUurC,QAAU,WAC1B,GAAI7xC,GAAG4f,EAAK1a,EAAMy+B,CAKlB,KAJAn9B,KAAKqO,WACLrO,KAAK+qC,QAAU1a,EAAErwB,KAAK8qC,KAAKC,SAASe,UAAU9rC,KAAKk0B,OAAO6W,SAC1D/qC,KAAKsrC,KAAOtrC,KAAK+qC,QAAQ5rB,KAAK,MAC9Bge,EAAMn9B,KAAKg7B,KAAK0P,QACXlxC,EAAI,EAAG4f,EAAM+jB,EAAI/kC,OAAQoB,EAAI4f,EAAK5f,IAErC,GADAkF,EAAOy+B,EAAI3jC,GACE,MAATkF,EAAJ,CAIA,IAAKsB,KAAKkzB,YAAY7kB,QAAQ3P,GAC5B,KAAM,IAAI1E,OAAM,oCAAsC0E,EAGxDsB,MAAKqO,QAAQtR,KAAK,GAAIiD,MAAKkzB,YAAY7kB,QAAQ3P,IAC7Cw1B,OAAQl0B,KAAKk0B,cARb7D,GAAErwB,KAAK8qC,KAAKE,WAAWxI,SAASxiC,KAAKsrC,KAWzC,IAAItrC,KAAKg7B,KAAK4P,cACZ,MAAO5qC,MAAK+qC,QAAQr+B,QAIxBkmB,EAAQ9yB,UAAUisC,WAAa,SAASrtC,GACtC,GAAIwrB,EAEJ,OADAA,GAASlqB,KAAKsrC,KAAKnsB,KAAK,iBAAmBzgB,GAAMnH,KAAK,UACrC,MAAV2yB,EAAiBA,EAAS,MAGnC0I,EAAQoZ,UAAY,SAASC,GAC3B,MAAOjsC,MAAKqO,QAAQ49B,EAAInsC,UAAUpB,MAAQutC,GAG5CrZ,EAAQvkB,WAEDukB,GAENtC,GAEHuB,EAAc,SAAU2B,GAGtB,QAAS3B,KACP,MAAOA,GAAYwB,UAAUH,YAAYnzB,MAAMC,KAAMC,WA0LvD,MA7LA8yB,GAAOlB,EAAa2B,GAMpB3B,EAAY4B,WAAa,cAEzB5B,EAAY/xB,UAAUk7B,MACpBkR,WAAW,GAGbra,EAAY/xB,UAAUm0B,MAAQ,WAE5B,MADAj0B,MAAKk0B,OAASl0B,KAAKm0B,QACZn0B,KAAKk0B,OAAOkO,UAAUhB,IAAI,MAAO,IAAK,SAAU7M,GACrD,MAAO,UAASC,GACd,GAAI2X,EAEJ,IADAA,EAAa5X,EAAML,OAAOwW,QAAQqB,WAAW,QACvCxX,EAAMyG,KAAKkR,WAAcC,GAAcA,EAAWC,OAGxD,MAAO7X,GAAM8X,OAAO7X,EAAE4O,YAEvBpjC,QAGL6xB,EAAY/xB,UAAUusC,OAAS,SAASC,GACtC,GAAIC,GAAaC,EAAWC,EAAavW,EAAO2B,CAkChD,OAjCA4U,GAAczsC,KAAKk0B,OAAOiM,UAAUzK,aACpC8W,EAAYxsC,KAAKk0B,OAAOiM,UAAUtK,WAClC0W,EAAcvsC,KAAKk0B,OAAOiM,UAAUjJ,aACpChB,KACAqW,EAAcA,EAAYlW,KAAK,SAASl+B,EAAGm+B,GACzC,GAAIoW,GAASzvC,EAAGzD,EAAG4f,EAAK8e,CAExB,KADAwU,GAAU,EACLzvC,EAAIzD,EAAI,EAAG4f,EAAM8c,EAAM99B,OAAQoB,EAAI4f,EAAKnc,IAAMzD,EAAG,CAEpD,GADA0+B,EAAIhC,EAAMj5B,GACNozB,EAAE2H,SAAS1B,EAAM4B,GAAI,CACvBwU,GAAU,CACV,OACK,GAAIrc,EAAE2H,SAASE,EAAG5B,GAAO,CAC9BJ,EAAMh2B,OAAOjD,EAAG,EAAGq5B,GACnBoW,GAAU,CACV,QAGJ,GAAIA,EACF,MAAOxW,GAAMn5B,KAAKu5B,KAGtBiW,EAAclc,EAAE6F,GAChB2B,GAAS,EACT0U,EAAYlW,KAAK,SAAU9B,GACzB,MAAO,UAASp8B,EAAG6lC,GACjB,GAAI2O,EAEJ,IADAA,EAAIL,EAAa/X,EAAMqY,aAAa5O,GAAWzJ,EAAMsY,YAAY7O,GAE/D,MAAOnG,GAAS8U,IAGnB3sC,OACI63B,GAGThG,EAAY/xB,UAAU+sC,YAAc,SAAS7O,GAC3C,GAAI4D,GAAUsC,EAAY4I,EAASC,EAASC,EAAWC,EAAMtd,EAAKud,EAAKC,EAAYhP,CAEnF,IADAyD,EAAWvR,EAAE2N,GACR4D,EAASxpC,OAAd,CAGA,GAAIwpC,EAASxL,GAAG,OAAQ,CAEtB,GADA6W,EAAOjtC,KAAKk0B,OAAOiM,UAAUnK,iBACvBiX,EAAK7W,GAAGwL,KAAaqL,EAAKrQ,QAAQ,OAAOxG,GAAGwL,GAChD,MAEF5hC,MAAKotC,WAAWptC,KAAKk0B,OAAOiM,UAAUrL,aACjC,IAAI8M,EAASxL,GAAG,MAAO,CAE5B,GADA4W,EAAYpL,EAASriB,KAAK,MACtBytB,EAAU50C,OAAS,EACrB,MAEF4H,MAAKk0B,OAAOiM,UAAU93B,OACtB81B,EAAUyD,EAAStiB,SAAS,GAAG6e,QAC/B+F,EAAa8I,EAAUtvB,SAAS,UAC5BwmB,EAAW9rC,OAAS,EACtB8rC,EAAWtU,OAAOgS,GAElBvR,EAAE,IAAM8N,EAAU,MAAMvO,OAAOgS,GAAUY,SAASwK,GAEpDhtC,KAAKk0B,OAAOiM,UAAUtF,cACjB,IAAI+G,EAASxL,GAAG,qBACrB+W,EAAaE,SAASzL,EAAS7R,IAAI,iBAAmB,EACtDod,GAAcr4B,KAAKqW,MAAMgiB,EAAantC,KAAKg7B,KAAKsS,aAAe,GAAKttC,KAAKg7B,KAAKsS,YAC9E1L,EAAS7R,IAAI,cAAeod,OACvB,CAAA,IAAIvL,EAASxL,GAAG,WAAYwL,EAASxL,GAAG,mBAgB7C,OAAO,CALP,IAVAzG,EAAM3vB,KAAKk0B,OAAOiM,UAAUnK,gBAAgB4G,QAAQ,UACpDkQ,EAAUnd,EAAIlS,KAAK,UACbqvB,EAAQ10C,OAAS,IACrB80C,EAAMvd,EAAIrQ,OAAO,MACjBytB,EAAUG,EAAIzvB,KAAK,MACfsvB,EAAQ30C,OAAS,GAAK80C,EAAI5tB,SAAS8W,GAAG,WACxC2W,EAAUG,EAAI5tB,OAAO,SAAS7B,KAAK,SAAS0B,KAAK,aAEnD2tB,EAAUC,EAAQ5tB,KAAK,yBAEnBwQ,EAAIv3B,OAAS,GAAK00C,EAAQ10C,OAAS,GACvC,MAEF4H,MAAKk0B,OAAOiM,UAAUhH,gBAAgB2T,GAIxC,OAAO,IAGTjb,EAAY/xB,UAAUstC,WAAa,SAAStY,GAC1C,GAAIjY,GAAMghB,CAKV,OAJAhhB,GAAOiY,EAAMrM,WAAWhW,QAAQ,YAAa,MAC7CorB,EAAWxJ,SAAS0I,eAAelgB,GAAQ,MAC3CiY,EAAMsF,iBACNtF,EAAM6D,WAAWkF,GACbhhB,GACFiY,EAAMyY,WAAW1P,GACV79B,KAAKk0B,OAAOiM,UAAUrL,MAAMA,IAE5B90B,KAAKk0B,OAAOiM,UAAUvH,cAAciF,IAI/ChM,EAAY/xB,UAAU8sC,aAAe,SAAS5O,GAC5C,GAAI4D,GAAUtK,EAAS0V,EAAWC,EAAMO,EAASC,EAAS9d,EAAKud,EAAKC,EAAYrY,CAEhF,IADA8M,EAAWvR,EAAE2N,GACP4D,GAAYA,EAASxpC,OAAS,EAApC,CAGA,GAAIwpC,EAASxL,GAAG,OAAQ,CAEtB,GADA6W,EAAOjtC,KAAKk0B,OAAOiM,UAAUnK,iBACvBiX,EAAK7W,GAAGwL,KAAaqL,EAAKrQ,QAAQ,OAAOxG,GAAGwL,GAChD,MAEF5hC,MAAK0tC,YAAY5Y,OACZ,IAAI8M,EAASxL,GAAG,MACrBkB,EAAUsK,EAAStiB,SACnB0tB,EAAY1V,EAAQhY,OAAO,MAC3Btf,KAAKk0B,OAAOiM,UAAU93B,OAClB2kC,EAAU50C,OAAS,GACrB08B,EAAQT,SAASyG,cACjBhG,EAAMyF,eAAejD,EAAQ,IAC7BxC,EAAMkE,aAAa4I,EAAS,IAC5BtK,EAAQkD,OAAO1F,EAAM2F,mBACrBpK,EAAE,QAAQiN,aAAahG,GAASwM,MAAMlC,EAASlkB,SAAS,WAAWkS,OAAOgS,EAAS7K,YACnF6K,EAAS7G,WAEL6G,EAASnkB,KAAK,MAAMrlB,OAAS,GAC/Bi4B,EAAE,IAAMiH,EAAQ,GAAG6G,QAAU,MAAMvO,OAAOgS,EAASiC,QAAQ,OAAOrB,SAASZ,GAE7EA,EAASpB,YAAYwM,GACjB1V,EAAQ5Z,SAAS,MAAMtlB,OAAS,GAClCk/B,EAAQyD,UAGZ/6B,KAAKk0B,OAAOiM,UAAUtF,cACjB,IAAI+G,EAASxL,GAAG,qBACrB+W,EAAaE,SAASzL,EAAS7R,IAAI,iBAAmB,EACtDod,EAAar4B,KAAK2J,IAAI3J,KAAKqW,MAAMgiB,EAAantC,KAAKg7B,KAAKsS,aAAe,EAAG,GAAKttC,KAAKg7B,KAAKsS,YACzF1L,EAAS7R,IAAI,cAA8B,IAAfod,EAAmB,GAAKA,OAC/C,CAAA,IAAIvL,EAASxL,GAAG,WAAYwL,EAASxL,GAAG,mBAgB7C,OAAO,CALP,IAVAzG,EAAM3vB,KAAKk0B,OAAOiM,UAAUnK,gBAAgB4G,QAAQ,UACpD4Q,EAAU7d,EAAIpQ,KAAK,UACbiuB,EAAQp1C,OAAS,IACrB80C,EAAMvd,EAAIrQ,OAAO,MACjBmuB,EAAUP,EAAI3tB,KAAK,MACfkuB,EAAQr1C,OAAS,GAAK80C,EAAI5tB,SAAS8W,GAAG,WACxCqX,EAAUP,EAAI5tB,OAAO,SAASC,KAAK,SAASJ,KAAK,aAEnDquB,EAAUC,EAAQtuB,KAAK,uBAEnBwQ,EAAIv3B,OAAS,GAAKo1C,EAAQp1C,OAAS,GACvC,MAEF4H,MAAKk0B,OAAOiM,UAAUhH,gBAAgBqU,GAIxC,OAAO,IAGT3b,EAAY/xB,UAAU4tC,YAAc,SAAS5Y,KAEtCjD,GAENvB,GAEHa,EAAY,SAAUqC,GAGpB,QAASrC,KACP,MAAOA,GAAUkC,UAAUH,YAAYnzB,MAAMC,KAAMC,WA4NrD,MA/NA8yB,GAAO5B,EAAWqC,GAMlBrC,EAAUsC,WAAa,YAEvBtC,EAAUrxB,UAAUk7B,MAClB2S,YAAY,EACZC,YAAY,GAGdzc,EAAUrxB,UAAUm0B,MAAQ,WAK1B,MAJAj0B,MAAKk0B,OAASl0B,KAAKm0B,QACfn0B,KAAKg7B,KAAK2S,YAA8C,gBAAzB3tC,MAAKg7B,KAAK2S,aAC3C3tC,KAAKg7B,KAAK2S,WAAa,UAElB3tC,KAAKk0B,OAAOqB,KAAKpP,GAAG,QAAS,SAAUoO,GAC5C,MAAO,UAASC,GACd,GAAIM,EACJ,KAAIP,EAAMyL,UAAWzL,EAAMsZ,UAG3B,MAAItZ,GAAML,OAAO6N,eAAevN,MAAO,IAGvCM,EAAQP,EAAML,OAAOiM,UAAUvG,sBAC3BrF,EAAML,OAAOqB,KAAK1qB,OACfiqB,EAAMgB,WACThB,EAAMgE,UAAS,IAGjBvE,EAAML,OAAOoM,UAAUnkB,SACvBoY,EAAML,OAAOiM,UAAUlH,kBAAkB1E,EAAML,OAAOqB,KAAKpW,KAAK,cAE9DoV,EAAMuZ,4BAA4BtZ,KAGtCD,EAAML,OAAOmB,aAAaoK,sBAAsB9K,QAChDJ,EAAML,OAAOmB,aAAawK,0BAA0BlL,QACpDJ,EAAML,OAAO2N,YAAYyD,mBAAmB3Q,QAC5CJ,EAAML,OAAOiM,UAAU1L,QACvBF,EAAML,OAAO2N,YAAY4D,qBACzBlR,EAAMyL,SAAU,EACTzL,EAAMwZ,iBAAiB,SAASC,GAIrC,MAHAzZ,GAAM0Z,qBAAqBD,GAC3BzZ,EAAM2Z,gBAAkB,KACxB3Z,EAAM4Z,gBAAkB,KACjB5Z,EAAMyL,SAAU,QAG1BhgC,QAGLmxB,EAAUrxB,UAAUguC,4BAA8B,SAAStZ,GACzD,GAAI4Z,GAAWC,EAAWlR,EAAKmR,CAC/B,KAAItuC,KAAKk0B,OAAOe,KAAKC,QAAQmS,MAGzB7S,EAAE+Z,cAAcC,eAAiBha,EAAE+Z,cAAcC,cAAcp3C,OAASo9B,EAAE+Z,cAAcC,cAAcp3C,MAAMgB,OAAS,IACvHi2C,EAAY7Z,EAAE+Z,cAAcC,cAAcp3C,MAAM,GAC5C,WAAW+xB,KAAKklB,EAAUh2C,OAAO,CAEnC,GADA+1C,EAAYC,EAAUI,YACF,MAAbL,IAAsBpuC,KAAKg7B,KAAK2S,WACrC,MAKF,IAHKS,EAAU1vC,OACb0vC,EAAU1vC,KAAO,uBAEfsB,KAAKk0B,OAAO6N,eAAe,WAAYqM,OAAgB,EACzD,MAOF,OALAE,MACAA,EAAUtuC,KAAKg7B,KAAK2S,aAAc,EACE,OAA/BxQ,EAAMn9B,KAAKk0B,OAAOpD,WACrBqM,EAAIuR,OAAON,EAAWE,IAEjB,IAKbnd,EAAUrxB,UAAUiuC,iBAAmB,SAASY,GAC9C,GAAI7I,EAOJ,OANA9lC,MAAK6tC,UAAYxd,EAAE,kCAAkChR,SAAS,sBAAsBse,KAAK,WAAY,MAAM6E,SAASxiC,KAAKk0B,OAAO1N,IAChIsf,GACEj7B,KAAM7K,KAAKk0B,OAAOqB,KAAK1qB,OACvBq3B,MAAOliC,KAAKk0B,OAAO2N,YAAYC,iBAEjC9hC,KAAK6tC,UAAUrY,QACRoK,WAAW,SAAUrL,GAC1B,MAAO,YACL,GAAIyZ,EA2BJ,OA1BAzZ,GAAML,OAAO6R,cACbxR,EAAML,OAAOqB,KAAK99B,IAAI,GAAGuuC,UAAYF,EAAMj7B,KAC3C0pB,EAAML,OAAO2N,YAAYC,cAAcgE,EAAM5D,OAC7C3N,EAAML,OAAOqB,KAAKC,QAClBjB,EAAML,OAAOiM,UAAU1L,QACvBF,EAAML,OAAOiM,UAAUrL,QACvBP,EAAM2Z,gBAAkB3Z,EAAML,OAAOiM,UAAUjJ,aAAaJ,OAE5DvC,EAAMsZ,UAAUnwB,SAAS,SAASqd,SAClCxG,EAAMsZ,UAAU1uB,KAAK,MAAMkX,KAAK,SAASl+B,EAAGy2C,GAAKve,EAAEue,GAAIpU,OAAOnK,EAAE,SAAST,OAAOS,EAAEue,GAAIzvB,KAAK,QAASkR,EAAEue,GAAI7T,WAC1GxG,EAAMsZ,UAAU1uB,KAAK,MAAMA,KAAK,MAAMzB,SAAS,KAAK2Y,KAAK,SAASl+B,EAAG0lB,GAAIwS,EAAExS,GAAGimB,MAAMzT,EAAExS,GAAGhT,QAASwlB,EAAExS,GAAGkd,WAEvGxG,EAAM4Z,gBAAkB5Z,EAAMyG,KAAK4S,YAAcrZ,EAAM2Z,gBAAgB9X,GAAG,cACtE7B,EAAM4Z,gBACRH,EAAezZ,EAAML,OAAOoM,UAAUxB,UAAUvK,EAAMsZ,UAAUhjC,QAAQ,IAExEmjC,EAAe3d,EAAE,UAAUT,OAAO2E,EAAMsZ,UAAU9W,YAClDiX,EAAa7uB,KAAK,kBAAkB4b,SACpCxG,EAAML,OAAOoM,UAAUnkB,OAAO6xB,GAC9BzZ,EAAML,OAAOoM,UAAUzE,SAASmS,GAChCzZ,EAAML,OAAOoM,UAAUrB,SAAS+O,EAAatwB,YAC7CswB,EAAa7uB,KAAK,KAAKkX,KAAK,SAASl+B,EAAG0lB,GAAoB,YAAbwS,EAAExS,GAAGhT,QAAgBwlB,EAAExS,GAAGhT,KAAK,UAC9EmjC,EAAeA,EAAajX,YAE9BxC,EAAMsZ,UAAU9S,SAChBxG,EAAMsZ,UAAY,KACXc,EAASX,KAEjBhuC,MAAO,IAGZmxB,EAAUrxB,UAAUmuC,qBAAuB,SAASD,GAClD,GAAIpM,GAAUiN,EAAMC,EAAMpxB,EAAUqxB,EAAgBv1C,EAAG85B,EAAG0b,EAAU51B,EAAK8jB,EAAM+R,EAAMC,EAAMC,EAAMC,EAAMC,EAAOn6B,EAAGohB,EAAMgZ,EAAGC,EAAGpS,EAAKC,EAAMmK,EAAM+G,CAC9I,IAAItuC,KAAKk0B,OAAO6N,eAAe,WAAYiM,OAAmB,IAG9DpM,EAAW5hC,KAAKkuC,gBACXF,GAAL,CAEO,GAAIhuC,KAAKmuC,gBACd,GAAIvM,EAASxL,GAAG,SAAU,CAGxB,IAFAiZ,EAAQrB,EAAa7xC,MAAM,MAC3B6yC,EAAWK,EAAMG,MACZh2C,EAAI,EAAG4f,EAAMi2B,EAAMj3C,OAAQoB,EAAI4f,EAAK5f,IACvC41C,EAAOC,EAAM71C,GACbwG,KAAKk0B,OAAOiM,UAAUxH,WAAWtE,SAAS0I,eAAeqS,IACzDpvC,KAAKk0B,OAAOiM,UAAUxH,WAAWtI,EAAE,SAErCrwB,MAAKk0B,OAAOiM,UAAUxH,WAAWtE,SAAS0I,eAAeiS,QAIzD,KAFAhB,EAAe3d,EAAE,UAAUxT,KAAKmxB,GAChC7Q,EAAM6Q,EAAajX,WACdzD,EAAI,EAAG4J,EAAOC,EAAI/kC,OAAQk7B,EAAI4J,EAAM5J,IACvCgD,EAAO6G,EAAI7J,GACXtzB,KAAKk0B,OAAOiM,UAAUxH,WAAWtI,EAAEiG,GAAM,QAGxC,IAAIsL,EAASxL,GAAGp2B,KAAKk0B,OAAOqB,MACjC,IAAKrgB,EAAI,EAAG+5B,EAAOjB,EAAa51C,OAAQ8c,EAAI+5B,EAAM/5B,IAChDohB,EAAO0X,EAAa94B,GACpBlV,KAAKk0B,OAAOiM,UAAUxH,WAAWrC,OAE9B,CAAA,GAAI0X,EAAa51C,OAAS,EAC/B,MACK,IAA4B,IAAxB41C,EAAa51C,OACtB,GAAI41C,EAAa5X,GAAG,KAAM,CAExB,GADA1Y,EAAWswB,EAAajX,WACA,IAApBrZ,EAAStlB,QAAgBslB,EAAS0Y,GAAG,OAAQ,CAE/C,GADAyY,EAAOnxB,EACH,cAAcyL,KAAK0lB,EAAKlR,KAAK,QAAS,CACxC,IAAK39B,KAAKg7B,KAAK2S,WACb,MASF,OAPAmB,GAAO9uC,KAAKk0B,OAAOe,KAAKiT,cAAc2G,EAAKlR,KAAK,QAChDmR,EAAKpwC,KAAO,sBACZ4vC,KACAA,EAAUtuC,KAAKg7B,KAAK2S,aAAc,OACG,OAAhCvQ,EAAOp9B,KAAKk0B,OAAOpD,WACtBsM,EAAKsR,OAAOI,EAAMR,IAGf,GAAIO,EAAKzY,GAAG,kCACjB,OAGJ,IAAKkZ,EAAI,EAAGJ,EAAOxxB,EAAStlB,OAAQk3C,EAAIJ,EAAMI,IAC5ChZ,EAAO5Y,EAAS4xB,GAChBtvC,KAAKk0B,OAAOiM,UAAUxH,WAAWrC,OAE9B,IAAIsL,EAASxL,GAAG,MAAQp2B,KAAKk0B,OAAOe,KAAKyE,YAAYkI,GAC1DA,EAAS5E,YAAYgR,GACrBhuC,KAAKk0B,OAAOiM,UAAUhH,gBAAgB6U,OACjC,IAAIA,EAAa5X,GAAG,UACzB,GAAuC,IAAnC4X,EAAa7uB,KAAK,MAAM/mB,OAG1B,IAFA41C,EAAe3d,EAAE,UAAUxT,KAAKmxB,EAAanxB,QAC7C0qB,EAAOyG,EAAajX,WACfwY,EAAI,EAAGJ,EAAO5H,EAAKnvC,OAAQm3C,EAAIJ,EAAMI,IACxCjZ,EAAOiR,EAAKgI,GACZvvC,KAAKk0B,OAAOiM,UAAUxH,WAAWtI,EAAEiG,GAAM,QAElCsL,GAASxL,GAAG,OACrBwL,EAAStiB,SAASwkB,MAAMkK,GACxBhuC,KAAKk0B,OAAOiM,UAAUhH,gBAAgB6U,KAEtCpM,EAASkC,MAAMkK,GACfhuC,KAAKk0B,OAAOiM,UAAUhH,gBAAgB6U,QAGxCpM,GAASkC,MAAMkK,GACfhuC,KAAKk0B,OAAOiM,UAAUhH,gBAAgB6U,OAGpCpM,GAASxL,GAAG,QACdwL,EAAWA,EAAStiB,UAElBtf,KAAKk0B,OAAOiM,UAAU3H,eAAeoJ,GACvCmN,EAAiB,SACR/uC,KAAKk0B,OAAOiM,UAAU5I,aAAaqK,GAC5CmN,EAAiB,SAEjB/uC,KAAKk0B,OAAOiM,UAAU9F,aAAauH,GACnCmN,EAAiB,UAEnBnN,EAASmN,GAAgBf,GACzBhuC,KAAKk0B,OAAOiM,UAAUhH,gBAAgB6U,EAAalX,QAErD,MAAO92B,MAAKk0B,OAAOmB,aAAaoK,0BAG3BtO,GAENb,GAEHkC,EAAW,SAAUgB,GAGnB,QAAShB,KACP,MAAOA,GAASa,UAAUH,YAAYnzB,MAAMC,KAAMC,WAoOpD,MAvOA8yB,GAAOP,EAAUgB,GAMjBhB,EAASid,QAAQtmC,GAEjBqpB,EAASid,QAAQ3d,GAEjBU,EAASid,QAAQld,GAEjBC,EAASid,QAAQ3c,GAEjBN,EAASid,QAAQzd,GAEjBQ,EAASid,QAAQje,GAEjBgB,EAASid,QAAQ7c,GAEjBJ,EAASid,QAAQ5d,GAEjBW,EAASid,QAAQte,GAEjBqB,EAASt2B,MAAQ,EAEjBs2B,EAAS1yB,UAAUk7B,MACjB53B,SAAU,KACVssC,YAAa,GACbC,aAAc,mBACdhQ,UACA+O,QAAQ,EACRpB,YAAa,IAGf9a,EAAS1yB,UAAUm0B,MAAQ,WACzB,GAAIO,GAAGN,EAAQ0b,EAAMC,CAGrB,IAFA7vC,KAAKoD,SAAWitB,EAAErwB,KAAKg7B,KAAK53B,UAC5BpD,KAAKg7B,KAAK0U,YAAc1vC,KAAKg7B,KAAK0U,aAAe1vC,KAAKoD,SAASu6B,KAAK,gBAC/D39B,KAAKoD,SAAShL,OACjB,KAAM,IAAI4B,OAAM,wCASlB,IANAk6B,EAASl0B,KAAKoD,SAAS7L,KAAK,YACd,MAAV28B,GACFA,EAAOjyB,UAETjC,KAAKnG,KAAO24B,EAASt2B,MACrB8D,KAAKqrC,WACD9a,EAKF,KAAM,IAAIv2B,OAAM,wCAiClB,IArCEgG,KAAK6wB,QAAUN,GACb/J,GAAIxmB,KAAKu1B,OAMTv1B,KAAKg7B,KAAK0T,QAAUle,IACtBqf,EAAyC,gBAArB7vC,MAAKg7B,KAAK0T,OAAsB1uC,KAAKg7B,KAAK0T,UAC9D1uC,KAAK8wB,SAAWN,EAAeqf,IAEjCD,EAAO5vC,KAAKoD,SAASw5B,QAAQ,QACzBgT,EAAKx3C,SACPw3C,EAAKzpB,GAAG,mBAAqBnmB,KAAKnG,GAAI,SAAU06B,GAC9C,MAAO,YACL,MAAOA,GAAMyN,SAEdhiC,OACH4vC,EAAKzpB,GAAG,kBAAoBnmB,KAAKnG,GAAI,SAAU06B,GAC7C,MAAO,YACL,MAAOA,GAAMub,SAAS,MAEvB9vC,QAELA,KAAKmmB,GAAG,cAAe,SAAUoO,GAC/B,MAAO,YAOL,GANIA,EAAMyG,KAAK0U,aACbnb,EAAMpO,GAAG,eAAgB,WACvB,MAAOoO,GAAMwb,iBAGjBxb,EAAMub,SAASvb,EAAMnxB,SAASvF,MAAMghC,QAAU,IAC1CtK,EAAMnxB,SAASu6B,KAAK,aACtB,MAAOpJ,GAAMiB,UAGhBx1B,OACCA,KAAKi1B,KAAKC,QAAQ0S,QAAS,CAC7B5nC,KAAKi1B,KAAK4S,QACV,KAEE,MADAxT,UAAS2b,YAAY,wBAAwB,GAAO,GAC7C3b,SAAS2b,YAAY,4BAA4B,GAAO,GAC/D,MAAOnb,GACPL,EAAIK,KAKVrC,EAAS1yB,UAAUgrC,KAAO,+LAE1BtY,EAAS1yB,UAAUurC,QAAU,WAC3B,GAAI1jC,GAAKw1B,EAAK8S,EAASpyC,CAiBvB,IAhBAmC,KAAKwmB,GAAK6J,EAAErwB,KAAK8qC,MAAMxN,aAAat9B,KAAKoD,UACzCpD,KAAK+qC,QAAU/qC,KAAKwmB,GAAGrH,KAAK,qBAC5Bnf,KAAKu1B,KAAOv1B,KAAK+qC,QAAQ5rB,KAAK,kBAC9Bnf,KAAKyrC,cAAgBzrC,KAAK+qC,QAAQ5rB,KAAK,yBAAyByQ,OAAO5vB,KAAKg7B,KAAK0U,aACjF1vC,KAAKwmB,GAAGjvB,KAAK,WAAYyI,MACzBA,KAAK+qC,QAAQnb,OAAO5vB,KAAKoD,UACzBpD,KAAKoD,SAAS7L,KAAK,WAAYyI,MAAMkwC,OACrClwC,KAAKu1B,KAAKoI,KAAK,WAAY39B,KAAKoD,SAASu6B,KAAK,aAC1C39B,KAAKi1B,KAAKsM,GAAGC,IACfxhC,KAAKwmB,GAAGnH,SAAS,gBACRrf,KAAKi1B,KAAKsM,GAAG0F,OACtBjnC,KAAKwmB,GAAGnH,SAAS,kBAEfrf,KAAKi1B,KAAKsM,GAAG4F,QACfnnC,KAAKwmB,GAAGnH,SAAS,mBAEfrf,KAAKg7B,KAAK2E,OAAQ,CACpBxC,EAAMn9B,KAAKg7B,KAAK2E,OAChBsQ,IACA,KAAKtoC,IAAOw1B,GACVt/B,EAAMs/B,EAAIx1B,GACVsoC,EAAQlzC,KAAKszB,EAAE,YACbh4B,KAAM,SACNqG,KAAMiJ,EACN/H,MAAO/B,IACN2iC,YAAYxgC,KAAKoD,UAEtB,OAAO6sC,KAIXzd,EAAS1yB,UAAUiwC,aAAe,WAChC,GAAIryB,EAEJ,OADAA,GAAW1d,KAAKu1B,KAAK7X,WACG,IAApBA,EAAStlB,QAAqC,IAApBslB,EAAStlB,QAAgB4H,KAAKi1B,KAAKyE,YAAYhc,IAAa2vB,SAAS3vB,EAASqS,IAAI,gBAAkB,GAAK/vB,KAAKg7B,KAAKsS,YACxIttC,KAAKyrC,cAAcjvC,OAEnBwD,KAAKyrC,cAAc/+B,QAI9B8lB,EAAS1yB,UAAUgwC,SAAW,SAASjyC,GAQrC,MAPAmC,MAAK+lC,cACL/lC,KAAKoD,SAASvF,IAAIA,GAClBmC,KAAKu1B,KAAK99B,IAAI,GAAGuuC,UAAYnoC,EAC7BmC,KAAKsgC,UAAUnkB,SACfnc,KAAKsgC,UAAUzE,WACf77B,KAAKi1B,KAAK4S,OAAO7nC,KAAKu1B,MACtBv1B,KAAKq1B,aAAagL,kBAAoB,KAC/BrgC,KAAK87B,QAAQ,iBAGtBtJ,EAAS1yB,UAAUqwC,SAAW,WAC5B,MAAOnwC,MAAKgiC,QAGdxP,EAAS1yB,UAAUkiC,KAAO,WACxB,GAAItkB,GAAU0yB,EAAWC,EAAQC,EAAQC,EAAO1yC,CAQhD,KAPAuyC,EAAYpwC,KAAKu1B,KAAKyG,QACtBh8B,KAAKsgC,UAAUvE,WAAWqU,GAC1BpwC,KAAKsgC,UAAUnkB,OAAOi0B,GACtBpwC,KAAKsgC,UAAUrE,SAASmU,GACxB1yB,EAAW0yB,EAAU1yB,WACrB6yB,EAAQ7yB,EAASoZ,KAAK,KACtBwZ,EAAS5yB,EAASyY,MAAM,KACjBoa,EAAMna,GAAG,MAAQp2B,KAAKi1B,KAAKyE,YAAY6W,IAC5CF,EAASE,EACTA,EAAQA,EAAMhxB,KAAK,KACnB8wB,EAAOtV,QAET,MAAOuV,EAAOla,GAAG,MAAQp2B,KAAKi1B,KAAKyE,YAAY4W,IAC7CD,EAASC,EACTA,EAASC,EAAM9yB,KAAK,KACpB4yB,EAAOtV,QAKT,OAHAqV,GAAUjxB,KAAK,iBAAiB4b,SAChCl9B,EAAMwyB,EAAEwO,KAAKuR,EAAUvlC,QACvB7K,KAAKoD,SAASvF,IAAIA,GACXA,GAGT20B,EAAS1yB,UAAU01B,MAAQ,WACzB,GAAIoM,GAAU9M,CACd,OAAM90B,MAAKu1B,KAAKa,GAAG,aAAep2B,KAAKu1B,KAAKa,GAAG,qBAI3Cp2B,KAAKq1B,aAAagL,mBACpBrgC,KAAK6hC,YAAYC,cAAc9hC,KAAKq1B,aAAagL,mBAC1CrgC,KAAKq1B,aAAagL,kBAAoB,OAE7CuB,EAAW5hC,KAAKu1B,KAAK7X,WAAWoZ,OAC3B8K,EAASxL,GAAG,OACfwL,EAAWvR,EAAE,QAAQT,OAAO5vB,KAAKi1B,KAAK0E,MAAM6I,SAASxiC,KAAKu1B,OAE5DT,EAAQT,SAASyG,cACV96B,KAAKmgC,UAAUhH,gBAAgByI,EAAU9M,QAZhD90B,MAAKwmB,GAAGrH,KAAK,oBAAoBqW,SAgBrChD,EAAS1yB,UAAUowC,KAAO,WACxB,MAAIlwC,MAAKu1B,KAAKa,GAAG,aAAep2B,KAAKu1B,KAAKa,GAAG,qBACpCp2B,KAAKu1B,KAAK2a,OAEVlwC,KAAKu1B,KAAKpW,KAAK,oBAAoB+wB,QAI9C1d,EAAS1yB,UAAUimC,YAAc,WAC/B,MAAO/lC,MAAKwmB,GAAGrH,KAAK,qBAAqBkX,KAAK,SAASl+B,EAAGq4C,GAExD,GADAA,EAAUngB,EAAEmgB,GAASj5C,KAAK,WACtBi5C,EAAQpE,OACV,MAAOoE,GAAQ9jC,UAKrB8lB,EAAS1yB,UAAUmC,QAAU,WAS3B,MARAjC,MAAK+hC,eAAe,WACpB/hC,KAAKoD,SAASw5B,QAAQ,QAAQ6T,IAAI,uBAAyBzwC,KAAKnG,IAChEmG,KAAKmgC,UAAUxL,QACf30B,KAAKq1B,aAAaC,SAAU,EAC5Bt1B,KAAKoD,SAASk6B,aAAat9B,KAAKwmB,IAAI9Z,OAAO7O,IAAI,IAAI6yC,WAAW,YAC9D1wC,KAAKwmB,GAAGuU,SACR1K,EAAEgE,UAAUoc,IAAI,aAAezwC,KAAKnG,IACpCw2B,EAAEyY,QAAQ2H,IAAI,aAAezwC,KAAKnG,IAC3BmG,KAAKywC,OAGPje,GAENlC,GAEHkC,EAASme,MACPC,SACEC,WAAc,KACdC,KAAQ,OACRvV,KAAQ,OACRwV,MAAS,OACTC,YAAe,OACfC,GAAM,MACNC,MAAS,OACTC,cAAiB,OACjBC,YAAe,OACfC,aAAgB,QAChBC,YAAe,QACfC,SAAY,OACZC,UAAa,OACbC,SAAY,OACZC,iBAAoB,SACpBC,UAAa,OACbtF,OAAU,OACVuF,QAAW,OACXC,OAAU,OACVriB,KAAQ,OACRsiB,SAAY,OACZC,QAAW,OACXC,WAAc,OACdC,wBAA2B,WAC3BC,oBAAuB,UACvBC,WAAc,OACdC,GAAM,OACNxD,GAAM,OACNyD,cAAiB,QACjBC,MAAS,KACTloB,UAAa,MACbmoB,eAAkB,SAClBC,eAAkB,SAClBC,aAAgB,MAChBC,iBAAoB,SACpBC,kBAAqB,SACrBC,YAAe,OACfxgC,MAAS,KACTygC,WAAc,OACdC,UAAa,QACbC,UAAa,OACbC,YAAe,KACfC,UAAa,KACbC,WAAc,KACdC,eAAkB,SAClBC,UAAa,OACbC,gBAAmB,OACnBC,eAAkB,OAClBC,gBAAmB,OACnBC,eAAkB,OAClBC,gBAAmB,OACnBC,SAAY,YACZC,UAAa,aACbC,YAAe,eACfC,aAAgB,gBAChBC,UAAa,cACbC,aAAgB,iBAChBC,SAAY,YACZC,WAAc,cACdC,WAAc,cACdC,YAAe,eACfC,aAAgB,iBAChBC,eAAkB,mBAClBC,eAAkB,mBAClBC,eAAkB,mBAClBC,eAAkB,mBAClBC,UAAa,aACbC,WAAc,eAEhBC,SACE9D,WAAc,cACdC,KAAQ,OACRvV,KAAQ,OACRwV,MAAS,aACTC,YAAe,eACfC,GAAM,kBACNC,MAAS,eACTC,cAAiB,iBACjBC,YAAe,eACfC,aAAgB,gBAChBC,YAAe,6BACfC,SAAY,MACZC,UAAa,OACbC,SAAY,MACZC,iBAAoB,sBACpBC,UAAa,YACbtF,OAAU,SACVuF,QAAW,UACXC,OAAU,SACVriB,KAAQ,cACRsiB,SAAY,OACZC,QAAW,MACXC,WAAc,SACdC,wBAA2B,8BAC3BC,oBAAuB,0BACvBC,WAAc,cACdC,GAAM,eACNxD,GAAM,iBACNyD,cAAiB,gBACjBC,MAAS,QACTloB,UAAa,aACbmoB,eAAkB,mBAClBC,eAAkB,mBAClBC,aAAgB,gBAChBC,iBAAoB,qBACpBC,kBAAqB,sBACrBC,YAAe,eACfxgC,MAAS,QACTygC,WAAc,OACdC,UAAa,YACbC,UAAa,YACbC,YAAe,eACfC,UAAa,aACbC,WAAc,cACd0B,aAAgB,gBAChBzB,eAAkB,kBAClBC,UAAa,YACbC,gBAAmB,eACnBC,eAAkB,aAClBC,gBAAmB,cACnBC,eAAkB,aAClBC,gBAAmB,eACnBC,SAAY,YACZC,UAAa,aACbC,YAAe,eACfC,aAAgB,gBAChBC,UAAa,cACbC,aAAgB,iBAChBC,SAAY,YACZC,WAAc,cACdC,WAAc,cACdC,YAAe,eACfC,aAAgB,iBAChBC,eAAkB,mBAClBC,eAAkB,mBAClBC,eAAkB,mBAClBC,eAAkB,mBAClBC,UAAa,aACbC,WAAc,gBAIlBxjB,EAAS,SAAUsC,GAgCjB,QAAStC,GAAO8J,GACdh7B,KAAKk0B,OAAS8G,EAAK9G,OACnBl0B,KAAKoS,MAAQpS,KAAK60C,GAAG70C,KAAKtB,MAC1BwyB,EAAOmC,UAAUH,YAAYE,KAAKpzB,KAAMg7B,GAyM1C,MA3OAjI,GAAO7B,EAAQsC,GAEftC,EAAOpxB,UAAUgrC,MACfxtC,KAAM,yGACNw3C,YAAa,mCACbC,SAAU,sGACV/J,UAAW,4CAGb9Z,EAAOpxB,UAAUpB,KAAO,GAExBwyB,EAAOpxB,UAAUyO,KAAO,GAExB2iB,EAAOpxB,UAAUsS,MAAQ,GAEzB8e,EAAOpxB,UAAU+c,KAAO,GAExBqU,EAAOpxB,UAAUk1C,QAAU,GAE3B9jB,EAAOpxB,UAAUm1C,WAAa,GAE9B/jB,EAAOpxB,UAAUye,MAAO,EAExB2S,EAAOpxB,UAAUssC,QAAS,EAE1Blb,EAAOpxB,UAAUo1C,UAAW,EAE5BhkB,EAAOpxB,UAAUq1C,WAAY,EAE7BjkB,EAAOpxB,UAAUs1C,SAAW,KAQ5BlkB,EAAOpxB,UAAUm0B,MAAQ,WACvB,GAAIz6B,GAAG4f,EAAK+jB,EAAKkY,CAoEjB,KAnEAr1C,KAAKs1C,SACLt1C,KAAKwmB,GAAGL,GAAG,YAAa,SAAUoO,GAChC,MAAO,UAASC,GACd,GAAI+gB,GAAQC,EAASC,CAGrB,OAFAjhB,GAAE6M,iBACFmU,EAAUjhB,EAAM4gB,YAAc5gB,EAAML,OAAOmB,aAAaC,SACpDf,EAAM/N,GAAG0X,SAAS,cAAesX,IAGjCjhB,EAAMhW,MACRgW,EAAMwW,QAAQ2K,YAAY,WAAWC,SAAS,MAAMv2B,YAAY,WAC5DmV,EAAMwW,QAAQ3U,GAAG,cACnBmf,EAAShhB,EAAMugB,YAAY/uC,SAASylC,KAAOjX,EAAMugB,YAAYpoB,aAAe,EAAI6H,EAAML,OAAO6W,QAAQhlC,SAASylC,KAAOjX,EAAML,OAAO6W,QAAQre,aACtI6oB,EAAS,GACXhhB,EAAMugB,YAAY/kB,KAChByb,KAAQ,OACRoK,MAAS,IAGbrhB,EAAMuH,QAAQ,gBAET,IAET2Z,EAAQlhB,EAAM/N,GAAGjvB,KAAK,SACtBg9B,EAAMshB,QAAQJ,IACP,MAERz1C,OACHA,KAAK+qC,QAAQ5kB,GAAG,QAAS,cAAe,SAAUoO,GAChD,MAAO,UAASC,GACd,GAAIyX,GAAKuJ,EAASC,CAKlB,OAJAjhB,GAAE6M,iBACF4K,EAAM5b,EAAEmE,EAAEhX,eACV+W,EAAMwW,QAAQ3rB,YAAY,WAC1Bo2B,EAAUjhB,EAAM4gB,YAAc5gB,EAAML,OAAOmB,aAAaC,SACpD2W,EAAI/N,SAAS,cAAesX,IAGhCjhB,EAAML,OAAOwW,QAAQK,QAAQ3rB,YAAY,WACzCq2B,EAAQxJ,EAAI10C,KAAK,SACjBg9B,EAAMshB,QAAQJ,IACP,KAERz1C,OACHA,KAAK+qC,QAAQ5kB,GAAG,YAAa,cAAe,SAASqO,GACnD,OAAO,IAETx0B,KAAKk0B,OAAO/N,GAAG,OAAQ,SAAUoO,GAC/B,MAAO,YACL,GAAIuhB,EAEJ,IADAA,EAAevhB,EAAML,OAAOqB,KAAKa,GAAG,aAAe7B,EAAML,OAAOqB,KAAKa,GAAG,qBAClE0f,IAAiBvhB,EAAML,OAAO6L,UAAUC,QAI9C,MADAzL,GAAMwhB,WAAU,GACTxhB,EAAMyhB,aAAY,KAE1Bh2C,OACkB,MAAjBA,KAAKo1C,UACPp1C,KAAKk0B,OAAOrD,QAAQuQ,IAAIphC,KAAKo1C,SAAU,SAAU7gB,GAC/C,MAAO,UAASC,GAEd,MADAD,GAAM/N,GAAGyvB,aACF,IAERj2C,OAELm9B,EAAMn9B,KAAKg1C,QAAQ74C,MAAM,KACpB3C,EAAI,EAAG4f,EAAM+jB,EAAI/kC,OAAQoB,EAAI4f,EAAK5f,IACrC67C,EAAMlY,EAAI3jC,GACV67C,EAAMhlB,EAAEwO,KAAKwW,GACTA,GAAOhlB,EAAEka,QAAQ8K,EAAKr1C,KAAKk0B,OAAOoM,UAAUlF,cAAgB,GAC9Dp7B,KAAKk0B,OAAOoM,UAAUlF,aAAar+B,KAAKs4C,EAG5C,OAAOr1C,MAAKk0B,OAAO/N,GAAG,mBAAoB,SAAUoO,GAClD,MAAO,UAASC,GACd,GAAID,EAAML,OAAOmB,aAAaC,QAC5B,MAAOf,GAAM2hB,YAGhBl2C,QAGLkxB,EAAOpxB,UAAUq2C,YAAc,SAAS5nC,GACtC,MAAIA,GACK,+BAAiCA,EAEjC,IAIX2iB,EAAOpxB,UAAUs2C,QAAU,SAAS7nC,GAClC,MAAOvO,MAAKwmB,GAAGrH,KAAK,QAAQC,cAAcC,SAASrf,KAAKm2C,YAAY5nC,IAAOsO,KAAK7c,KAAK6c,OAGvFqU,EAAOpxB,UAAUw1C,OAAS,WAKxB,GAJAt1C,KAAK+qC,QAAU1a,EAAErwB,KAAK8qC,KAAKxtC,MAAMklC,SAASxiC,KAAKk0B,OAAOwW,QAAQY,MAC9DtrC,KAAKwmB,GAAKxmB,KAAK+qC,QAAQ5rB,KAAK,kBAC5Bnf,KAAKwmB,GAAGmX,KAAK,QAAS39B,KAAKoS,OAAOiN,SAAS,gBAAkBrf,KAAKtB,MAAMnH,KAAK,SAAUyI,MACvFA,KAAKo2C,QAAQp2C,KAAKuO,MACbvO,KAAKue,KAKV,MAFAve,MAAK80C,YAAczkB,EAAErwB,KAAK8qC,KAAKgK,aAAatS,SAASxiC,KAAK+qC,SAC1D/qC,KAAK80C,YAAYz1B,SAAS,gBAAkBrf,KAAKtB,MAC1CsB,KAAKq2C,cAGdnlB,EAAOpxB,UAAUu2C,WAAa,WAC5B,GAAIC,GAAYC,EAAa/8C,EAAG4f,EAAK27B,EAAU5X,EAAKC,EAAM6S,CAC1D,IAAK5f,EAAE+a,QAAQprC,KAAKue,MAApB,CAMA,IAHAve,KAAKw2C,OAASnmB,EAAE,SAASmS,SAASxiC,KAAK80C,aACvC3X,EAAMn9B,KAAKue,KACX0xB,KACKz2C,EAAI,EAAG4f,EAAM+jB,EAAI/kC,OAAQoB,EAAI4f,EAAK5f,IACrCu7C,EAAW5X,EAAI3jC,GACE,MAAbu7C,GAIJwB,EAAclmB,EAAErwB,KAAK8qC,KAAKiK,UAAUvS,SAASxiC,KAAKw2C,QAClDF,EAAaC,EAAYp3B,KAAK,eAAewe,MAC3CvrB,MAAoC,OAA1BgrB,EAAO2X,EAAS3iC,OAAiBgrB,EAAO2X,EAASl4B,KAC3D45B,aAAc1B,EAASU,QACtBp2B,SAAS,aAAe01B,EAASr2C,MAChCq2C,EAASxmC,KACX0hC,EAAQlzC,KAAKu5C,EAAWn3B,KAAK,QAAQE,SAASrf,KAAKm2C,YAAYpB,EAASxmC,QAExE0hC,EAAQlzC,KAAKu5C,EAAWn3B,KAAK,QAAQtC,KAAKk4B,EAASl4B,QAXnDwT,EAAErwB,KAAK8qC,KAAKE,WAAWxI,SAASxiC,KAAKw2C,OAczC,OAAOvG,KAGT/e,EAAOpxB,UAAUi2C,UAAY,SAAS3J,GACpC,GAAIA,IAAWpsC,KAAKosC,OAIpB,MADApsC,MAAKosC,OAASA,EACPpsC,KAAKwmB,GAAGkvB,YAAY,SAAU11C,KAAKosC,SAG5Clb,EAAOpxB,UAAUk2C,YAAc,SAASd,GACtC,GAAIA,IAAal1C,KAAKk1C,SAItB,MADAl1C,MAAKk1C,SAAWA,EACTl1C,KAAKwmB,GAAGkvB,YAAY,WAAY11C,KAAKk1C,WAG9ChkB,EAAOpxB,UAAU42C,eAAiB,WAChC,GAAIxB,GAAUrf,EAAUH,CAQxB,OAPAA,GAAa11B,KAAKk0B,OAAOiM,UAAUzK,aACnCG,EAAW71B,KAAKk0B,OAAOiM,UAAUtK,WACjCqf,EAAWxf,EAAWyB,OAAOn3B,KAAKi1C,YAAY78C,OAAS,GAAKy9B,EAASsB,OAAOn3B,KAAKi1C,YAAY78C,OAAS,EACtG4H,KAAKg2C,YAAYd,GACbl1C,KAAKk1C,UACPl1C,KAAK+1C,WAAU,GAEV/1C,KAAKk1C,UAGdhkB,EAAOpxB,UAAU62C,cAAgB,WAC/B,GAAIvK,GAAQ1U,EAAS7B,EAAU4C,EAAW/C,CAQ1C,OAPAA,GAAa11B,KAAKk0B,OAAOiM,UAAUzK,aACnCG,EAAW71B,KAAKk0B,OAAOiM,UAAUtK,WACjC4C,EAAY/C,EAAWyB,OAAOn3B,KAAKg1C,SACnCtd,EAAU7B,EAASsB,OAAOn3B,KAAKg1C,SAC/B5I,EAAS3T,EAAUrgC,OAAS,GAAKs/B,EAAQt/B,OAAS,GAAKqgC,EAAUrC,GAAGsB,GACpE13B,KAAKs2B,KAAO8V,EAAS3T,EAAY,KACjCz4B,KAAK+1C,UAAU3J,GACRpsC,KAAKosC,QAGdlb,EAAOpxB,UAAUo2C,QAAU,WAEzB,GADAl2C,KAAK02C,kBACD12C,KAAKk1C,SAGT,MAAOl1C,MAAK22C,iBAGdzlB,EAAOpxB,UAAU+1C,QAAU,SAASJ,KAEpCvkB,EAAOpxB,UAAU+0C,GAAK,WACpB,GAAIlL,GAAMxM,EAAKtF,CAMf,OALA8R,GAAO,GAAK1pC,UAAU7H,OAASm7B,EAAMH,KAAKnzB,UAAW,MACrD43B,EAAS3G,EAAOmC,UAAUwhB,GAAG90C,MAAMC,KAAM2pC,GACpC9R,IACHA,GAAUsF,EAAMn9B,KAAKk0B,QAAQ2gB,GAAG90C,MAAMo9B,EAAKwM,IAEtC9R,GAGF3G,GAENZ,GAEHkC,EAAStB,OAASA,EAElBoB,EAAU,SAAUkB,GAYlB,QAASlB,GAAQ0I,GACfh7B,KAAKkqB,OAAS8Q,EAAK9Q,OACnBlqB,KAAKk0B,OAAS8G,EAAK9Q,OAAOgK,OAC1B5B,EAAQe,UAAUH,YAAYE,KAAKpzB,KAAMg7B,GAiI3C,MA/IAjI,GAAOT,EAASkB,GAEhBlB,EAAQxyB,UAAUiG,QAChB8lC,IAAK,EACLL,KAAM,GAGRlZ,EAAQxyB,UAAU82C,OAAS,KAE3BtkB,EAAQxyB,UAAUssC,QAAS,EAQ3B9Z,EAAQxyB,UAAUm0B,MAAQ,WAQxB,MAPAj0B,MAAKwmB,GAAK6J,EAAE,wCAAwCmS,SAASxiC,KAAKk0B,OAAO1N,IAAIjvB,KAAK,UAAWyI,MAC7FA,KAAKs1C,SACLt1C,KAAKwmB,GAAGL,GAAG,aAAc,SAAUoO,GACjC,MAAO,UAASC,GACd,MAAOD,GAAM/N,GAAGnH,SAAS,WAE1Brf,OACIA,KAAKwmB,GAAGL,GAAG,aAAc,SAAUoO,GACxC,MAAO,UAASC,GACd,MAAOD,GAAM/N,GAAGpH,YAAY,WAE7Bpf,QAGLsyB,EAAQxyB,UAAUw1C,OAAS,aAE3BhjB,EAAQxyB,UAAU+2C,gBAAkB,WAClC,GAAIC,EAEJ,IADAA,EAAU92C,KAAKwmB,GAAGrH,KAAK,mBACjB23B,EAAQ1+C,OAAS,EAevB,MAZA4H,MAAK+2C,YAAc,EACnBD,EAAQzgB,KAAK,SAAU9B,GACrB,MAAO,UAASp8B,EAAG6+C,GACjB,GAAIC,GAAQC,CAGZ,IAFAD,EAAS5mB,EAAE2mB,GACXE,EAASD,EAAO93B,KAAK,SACf+3B,EAAO9+C,OAAS,EAGtB,MAAOm8B,GAAMwiB,YAAcjiC,KAAK2J,IAAI8V,EAAMwiB,YAAaG,EAAO3L,WAE/DvrC,OACI82C,EAAQ33B,KAAK,SAASosB,MAAMvrC,KAAK+2C,cAG1CzkB,EAAQxyB,UAAUtD,KAAO,SAAS26C,EAAS9Q,GAIzC,GAHgB,MAAZA,IACFA,EAAW,UAEE,MAAX8Q,EAaJ,MAVAn3C,MAAKwmB,GAAGmvB,SAAS,qBAAqBtf,KAAK,SAASl+B,EAAGq4C,GAErD,GADAA,EAAUngB,EAAEmgB,GAASj5C,KAAK,WACtBi5C,EAAQpE,OACV,MAAOoE,GAAQ9jC,SAGf1M,KAAKosC,QAAUpsC,KAAK42C,QACtB52C,KAAK42C,OAAOx3B,YAAY,YAE1Bpf,KAAK42C,OAASO,EAAQ93B,SAAS,YAC3Brf,KAAKosC,QACPpsC,KAAKo3C,QAAQ/Q,GACNrmC,KAAK87B,QAAQ,iBAEpB97B,KAAKosC,QAAS,EACdpsC,KAAKwmB,GAAGuJ,KACNyb,aACChvC,OACEwD,KAAK+2C,aACR/2C,KAAK62C,kBAEP72C,KAAKk0B,OAAOe,KAAK4S,SACjB7nC,KAAKo3C,QAAQ/Q,GACNrmC,KAAK87B,QAAQ,iBAIxBxJ,EAAQxyB,UAAU4M,KAAO,WACvB,GAAK1M,KAAKosC,OASV,MANIpsC,MAAK42C,QACP52C,KAAK42C,OAAOx3B,YAAY,YAE1Bpf,KAAK42C,OAAS,KACd52C,KAAKosC,QAAS,EACdpsC,KAAKwmB,GAAG9Z,OACD1M,KAAK87B,QAAQ,gBAGtBxJ,EAAQxyB,UAAUs3C,QAAU,SAAS/Q,GACnC,GAAIgR,GAAc7L,EAAM8L,EAASC,EAASC,EAAc3L,CAIxD,IAHgB,MAAZxF,IACFA,EAAW,UAERrmC,KAAKosC,OAaV,MAVAiL,GAAer3C,KAAKk0B,OAAO1N,GAAGzgB,SAC9ByxC,EAAex3C,KAAK42C,OAAO7wC,SAC3BwxC,EAAUv3C,KAAK42C,OAAOpqB,cACL,WAAb6Z,EACFwF,EAAM2L,EAAa3L,IAAMwL,EAAaxL,IAAM0L,EACtB,QAAblR,IACTwF,EAAM2L,EAAa3L,IAAMwL,EAAaxL,IAAM7rC,KAAKwmB,GAAGxB,UAEtDsyB,EAAUt3C,KAAKk0B,OAAO6W,QAAQQ,QAAUvrC,KAAKwmB,GAAGkG,aAAe,GAC/D8e,EAAO12B,KAAKmZ,IAAIupB,EAAahM,KAAO6L,EAAa7L,KAAM8L,GAChDt3C,KAAKwmB,GAAGuJ,KACb8b,IAAKA,EAAM7rC,KAAK+F,OAAO8lC,IACvBL,KAAMA,EAAOxrC,KAAK+F,OAAOylC,QAI7BlZ,EAAQxyB,UAAUmC,QAAU,WAI1B,MAHAjC,MAAK42C,OAAS,KACd52C,KAAKosC,QAAS,EACdpsC,KAAKk0B,OAAOuc,IAAI,gBACTzwC,KAAKwmB,GAAGuU,UAGjBzI,EAAQxyB,UAAU+0C,GAAK,WACrB,GAAIlL,GAAMxM,EAAKtF,CAMf,OALA8R,GAAO,GAAK1pC,UAAU7H,OAASm7B,EAAMH,KAAKnzB,UAAW,MACrD43B,EAASvF,EAAQe,UAAUwhB,GAAG90C,MAAMC,KAAM2pC,GACrC9R,IACHA,GAAUsF,EAAMn9B,KAAKkqB,QAAQ2qB,GAAG90C,MAAMo9B,EAAKwM,IAEtC9R,GAGFvF,GAENhC,GAEHkC,EAASF,QAAUA,EAEnBK,EAAc,SAAUa,GAGtB,QAASb,KACP,MAAOA,GAAYU,UAAUH,YAAYnzB,MAAMC,KAAMC,WAqEvD,MAxEA8yB,GAAOJ,EAAaa,GAMpBb,EAAY7yB,UAAUpB,KAAO,QAE7Bi0B,EAAY7yB,UAAUk1C,QAAU,qBAEhCriB,EAAY7yB,UAAUm1C,WAAa,aAEnCtiB,EAAY7yB,UAAUm0B,MAAQ,WA4B5B,MA3BAj0B,MAAKue,OAED7f,KAAM,SACNme,KAAM7c,KAAK60C,GAAG,cACdY,MAAO,KACN,KACD/2C,KAAM,KACNme,KAAM7c,KAAK60C,GAAG,SAAW,KACzBY,MAAO,OAEP/2C,KAAM,KACNme,KAAM7c,KAAK60C,GAAG,SAAW,KACzBY,MAAO,OAEP/2C,KAAM,KACNme,KAAM7c,KAAK60C,GAAG,SAAW,KACzBY,MAAO,OAEP/2C,KAAM,KACNme,KAAM7c,KAAK60C,GAAG,SAAW,KACzBY,MAAO,OAEP/2C,KAAM,KACNme,KAAM7c,KAAK60C,GAAG,SAAW,KACzBY,MAAO,OAGJ9iB,EAAYU,UAAUY,MAAMb,KAAKpzB,OAG1C2yB,EAAY7yB,UAAUi2C,UAAY,SAAS3J,EAAQqJ,GAMjD,GALA9iB,EAAYU,UAAU0iB,UAAU3iB,KAAKpzB,KAAMosC,GACvCA,IACFqJ,IAAUA,EAAQz1C,KAAKs2B,KAAK,GAAG6H,QAAQC,gBAEzCp+B,KAAKwmB,GAAGpH,YAAY,8DAChBgtB,EACF,MAAOpsC,MAAKwmB,GAAGnH,SAAS,iBAAmBo2B,IAI/C9iB,EAAY7yB,UAAU+1C,QAAU,SAASJ,GACvC,GAAIgC,EAcJ,OAbAA,GAAaz3C,KAAKk0B,OAAOiM,UAAU9I,YACnCr3B,KAAKk0B,OAAOiM,UAAU93B,OACtBovC,EAAWphB,KAAK,SAAU9B,GACxB,MAAO,UAASp8B,EAAGm+B,GACjB,GAAIE,EAEJ,IADAA,EAAQnG,EAAEiG,KACNE,EAAMJ,GAAG,eAAiBI,EAAMJ,GAAGqf,IAAUjf,EAAMJ,GAAG7B,EAAM0gB,aAAe1gB,EAAML,OAAOe,KAAK6I,gBAAgBtH,IAGjH,MAAOnG,GAAE,IAAMolB,EAAQ,MAAM7lB,OAAO4G,EAAMO,YAAY2gB,WAAWlhB,KAElEx2B,OACHA,KAAKk0B,OAAOiM,UAAUtF,UACf76B,KAAKk0B,OAAO4H,QAAQ,iBAGtBnJ,GAENzB,GAEHsB,EAASI,QAAQoZ,UAAUrZ,GAE3BpB,EAAkB,SAAUiC,GAG1B,QAASjC,KACP,MAAOA,GAAgB8B,UAAUH,YAAYnzB,MAAMC,KAAMC,WAyF3D,MA5FA8yB,GAAOxB,EAAiBiC,GAMxBjC,EAAgBzxB,UAAUpB,KAAO,YAEjC6yB,EAAgBzxB,UAAUyO,KAAO,OAEjCgjB,EAAgBzxB,UAAUm1C,WAAa,MAEvC1jB,EAAgBzxB,UAAUk1C,QAAU,OAEpCzjB,EAAgBzxB,UAAU63C,SACxBC,UAAW,QACXC,MAAS,SACTC,MAAS,QACTC,UAAW,QAGbxmB,EAAgBzxB,UAAUm0B,MAAQ,WAwBhC,MAvBAj0B,MAAKue,OAED7f,KAAM,OACNme,KAAM7c,KAAK60C,GAAG,mBACdY,MAAO,MAEP/2C,KAAM,OACNme,KAAM7c,KAAK60C,GAAG,kBACdY,MAAO,MAEP/2C,KAAM,OACNme,KAAM7c,KAAK60C,GAAG,mBACdY,MAAO,MAEP/2C,KAAM,MACNme,KAAM7c,KAAK60C,GAAG,kBACdY,MAAO,MAEP/2C,KAAM,MACNme,KAAM7c,KAAK60C,GAAG,mBACdY,MAAO,MAGJlkB,EAAgB8B,UAAUY,MAAMb,KAAKpzB,OAG9CuxB,EAAgBzxB,UAAU62C,cAAgB,WACxC,GAAIvK,GAAQ1U,EAAS7B,EAAUf,EAAO2D,EAAW/C,CAQjD,OAPAZ,GAAQ90B,KAAKk0B,OAAOiM,UAAUrL,QAC9BY,EAAa11B,KAAKk0B,OAAOiM,UAAUzK,aACnCG,EAAW71B,KAAKk0B,OAAOiM,UAAUtK,WACjC4C,EAAY/C,EAAWyB,OAAO,4BAC9BO,EAAU7B,EAASsB,OAAO,4BAC1BiV,EAAS1W,EAAWt9B,OAAS,GAAKy9B,EAASz9B,OAAS,GAAKqgC,EAAUrC,GAAGsB,GACtE13B,KAAK+1C,UAAU3J,GACRpsC,KAAKosC,QAGd7a,EAAgBzxB,UAAU+1C,QAAU,SAASJ,GAC3C,GAAIuC,GAAShiB,EAAelB,CAE5B,IADAA,EAAQ90B,KAAKk0B,OAAOiM,UAAUrL,SAC1BA,EAAMgB,UA0BV,MAvBAzB,UAAS2b,YAAY,gBAAgB,GAAO,GAC5C3b,SAAS2b,YAAY,YAAY,EAAOyF,GACxCphB,SAAS2b,YAAY,gBAAgB,GAAO,GAC5ChwC,KAAKk0B,OAAOiM,UAAU1L,QACtBz0B,KAAKk0B,OAAOiM,UAAUrL,QACtBkB,EAAgBh2B,KAAKk0B,OAAOiM,UAAUnK,gBAEpCgiB,EADEhiB,EAAc,GAAGsC,WAAayK,KAAKqD,UAC3BpQ,EAAc4G,QAAQ,4BAEtB5G,EAAc7W,KAAK,4BAE/B64B,EAAQ3hB,KAAK,SAAU9B,GACrB,MAAO,UAASp8B,EAAG+/B,GACjB,GAAI+f,GAAO5rB,CAGX,OAFA4rB,GAAQ5nB,EAAE6H,GACV7L,EAAO6L,EAAEnT,MAAMmzB,SACX,8BAA8B/uB,KAAKkD,GAC9B4rB,EAAMloB,IAAI,WAAYwE,EAAMojB,QAAQtrB,IACzB,WAATA,EACF4rB,EAAMjb,YAAYib,EAAMlhB,YAD1B,SAIR/2B,OACIA,KAAKk0B,OAAO4H,QAAQ,iBAGtBvK,GAENL,GAEHsB,EAASI,QAAQoZ,UAAUza,GAE3BN,EAAa,SAAUuC,GAGrB,QAASvC,KACP,MAAOA,GAAWoC,UAAUH,YAAYnzB,MAAMC,KAAMC,WAsCtD,MAzCA8yB,GAAO9B,EAAYuC,GAMnBvC,EAAWnxB,UAAUpB,KAAO,OAE5BuyB,EAAWnxB,UAAUyO,KAAO,OAE5B0iB,EAAWnxB,UAAUk1C,QAAU,YAE/B/jB,EAAWnxB,UAAUm1C,WAAa,MAElChkB,EAAWnxB,UAAUs1C,SAAW,QAEhCnkB,EAAWnxB,UAAUm0B,MAAQ,WAO3B,MANIj0B,MAAKk0B,OAAOe,KAAKsM,GAAGC,IACtBxhC,KAAKoS,MAAQpS,KAAKoS,MAAQ,gBAE1BpS,KAAKoS,MAAQpS,KAAKoS,MAAQ,gBAC1BpS,KAAKo1C,SAAW,UAEXnkB,EAAWoC,UAAUY,MAAMb,KAAKpzB,OAGzCixB,EAAWnxB,UAAU62C,cAAgB,WACnC,GAAIvK,EAGJ,OAFAA,GAAS/X,SAAS8jB,kBAAkB,WAAY,EAChDn4C,KAAK+1C,UAAU3J,GACRpsC,KAAKosC,QAGdnb,EAAWnxB,UAAU+1C,QAAU,WAK7B,MAJAxhB,UAAS2b,YAAY,QAChBhwC,KAAKk0B,OAAOe,KAAKwL,QAAQ8B,SAC5BviC,KAAKk0B,OAAO4H,QAAQ,gBAEfzL,EAAEgE,UAAUyH,QAAQ,oBAGtB7K,GAENC,GAEHsB,EAASI,QAAQoZ,UAAU/a,GAE3Bc,EAAe,SAAUyB,GAGvB,QAASzB,KACP,MAAOA,GAAasB,UAAUH,YAAYnzB,MAAMC,KAAMC,WAsCxD,MAzCA8yB,GAAOhB,EAAcyB,GAMrBzB,EAAajyB,UAAUpB,KAAO,SAE9BqzB,EAAajyB,UAAUyO,KAAO,SAE9BwjB,EAAajyB,UAAUk1C,QAAU,IAEjCjjB,EAAajyB,UAAUm1C,WAAa,MAEpCljB,EAAajyB,UAAUs1C,SAAW,QAElCrjB,EAAajyB,UAAUm0B,MAAQ,WAO7B,MANIj0B,MAAKk0B,OAAOe,KAAKsM,GAAGC,IACtBxhC,KAAKoS,MAAQpS,KAAKoS,MAAQ,gBAE1BpS,KAAKoS,MAAQpS,KAAKoS,MAAQ,gBAC1BpS,KAAKo1C,SAAW,UAEXrjB,EAAasB,UAAUY,MAAMb,KAAKpzB,OAG3C+xB,EAAajyB,UAAU62C,cAAgB,WACrC,GAAIvK,EAGJ,OAFAA,GAAS/X,SAAS8jB,kBAAkB,aAAc,EAClDn4C,KAAK+1C,UAAU3J,GACRpsC,KAAKosC,QAGdra,EAAajyB,UAAU+1C,QAAU,WAK/B,MAJAxhB,UAAS2b,YAAY,UAChBhwC,KAAKk0B,OAAOe,KAAKwL,QAAQ8B,SAC5BviC,KAAKk0B,OAAO4H,QAAQ,gBAEfzL,EAAEgE,UAAUyH,QAAQ,oBAGtB/J,GAENb,GAEHsB,EAASI,QAAQoZ,UAAUja,GAE3Bc,EAAkB,SAAUW,GAG1B,QAASX,KACP,MAAOA,GAAgBQ,UAAUH,YAAYnzB,MAAMC,KAAMC,WAsC3D,MAzCA8yB,GAAOF,EAAiBW,GAMxBX,EAAgB/yB,UAAUpB,KAAO,YAEjCm0B,EAAgB/yB,UAAUyO,KAAO,YAEjCskB,EAAgB/yB,UAAUk1C,QAAU,IAEpCniB,EAAgB/yB,UAAUm1C,WAAa,MAEvCpiB,EAAgB/yB,UAAUs1C,SAAW,QAErCviB,EAAgB/yB,UAAUw1C,OAAS,WAOjC,MANIt1C,MAAKk0B,OAAOe,KAAKsM,GAAGC,IACtBxhC,KAAKoS,MAAQpS,KAAKoS,MAAQ,gBAE1BpS,KAAKoS,MAAQpS,KAAKoS,MAAQ,gBAC1BpS,KAAKo1C,SAAW,UAEXviB,EAAgBQ,UAAUiiB,OAAOliB,KAAKpzB,OAG/C6yB,EAAgB/yB,UAAU62C,cAAgB,WACxC,GAAIvK,EAGJ,OAFAA,GAAS/X,SAAS8jB,kBAAkB,gBAAiB,EACrDn4C,KAAK+1C,UAAU3J,GACRpsC,KAAKosC,QAGdvZ,EAAgB/yB,UAAU+1C,QAAU,WAKlC,MAJAxhB,UAAS2b,YAAY,aAChBhwC,KAAKk0B,OAAOe,KAAKwL,QAAQ8B,SAC5BviC,KAAKk0B,OAAO4H,QAAQ,gBAEfzL,EAAEgE,UAAUyH,QAAQ,oBAGtBjJ,GAEN3B,GAEHsB,EAASI,QAAQoZ,UAAUnZ,GAE3BvB,EAAc,SAAUkC,GAGtB,QAASlC,KACP,MAAOA,GAAY+B,UAAUH,YAAYnzB,MAAMC,KAAMC,WAiFvD,MApFA8yB,GAAOzB,EAAakC,GAMpBlC,EAAYxxB,UAAUpB,KAAO,QAE7B4yB,EAAYxxB,UAAUyO,KAAO,OAE7B+iB,EAAYxxB,UAAUm1C,WAAa,MAEnC3jB,EAAYxxB,UAAUye,MAAO,EAE7B+S,EAAYxxB,UAAUw1C,OAAS,WAC7B,GAAI3L,EAEJ,OADAA,GAAO,GAAK1pC,UAAU7H,OAASm7B,EAAMH,KAAKnzB,UAAW,MAC9CqxB,EAAY+B,UAAUiiB,OAAOv1C,MAAMC,KAAM2pC,IAGlDrY,EAAYxxB,UAAUu2C,WAAa,WAKjC,MAJAhmB,GAAE,wmBAAwmBmS,SAASxiC,KAAK80C,aACxnB90C,KAAK80C,YAAY3uB,GAAG,YAAa,cAAe,SAASqO,GACvD,OAAO,IAEFx0B,KAAK80C,YAAY3uB,GAAG,QAAS,cAAe,SAAUoO,GAC3D,MAAO,UAASC,GACd,GAAI0H,GAAOwB,EAAI0a,EAAKtjB,EAAOujB,EAAKxa,CAGhC,IAFAtJ,EAAMwW,QAAQ3rB,YAAY,WAC1B8c,EAAQ7L,EAAEmE,EAAEhX,eACR0e,EAAMgC,SAAS,sBAAuB,CAExC,GADAR,EAAKnJ,EAAML,OAAOqB,KAAKpW,KAAK,WACtBue,EAAGtlC,OAAS,GAChB,MAEFigD,GAAMvP,OAAOwP,iBAAiB5a,EAAG,GAAI,MAAM6a,iBAAiB,SAC5DH,EAAM7jB,EAAMikB,iBAAiBH,OAE7BA,GAAMvP,OAAOwP,iBAAiBpc,EAAM,GAAI,MAAMqc,iBAAiB,oBAC/DH,EAAM7jB,EAAMikB,iBAAiBH,EAE/B,IAAKD,EAaL,MAVAtjB,GAAQP,EAAML,OAAOiM,UAAUrL,SAC1BoH,EAAMgC,SAAS,uBAAyBpJ,EAAMgB,YACjD+H,EAAWxJ,SAAS0I,eAAexI,EAAMsgB,GAAG;AAC5C/f,EAAM6D,WAAWkF,GACjB/I,EAAM2jB,mBAAmB5a,GACzBtJ,EAAML,OAAOiM,UAAUrL,MAAMA,IAE/BT,SAAS2b,YAAY,gBAAgB,GAAO,GAC5C3b,SAAS2b,YAAY,aAAa,EAAOoI,GACzC/jB,SAAS2b,YAAY,gBAAgB,GAAO,GACvCzb,EAAML,OAAOe,KAAKwL,QAAQ8B,QAA/B,OACShO,EAAML,OAAO4H,QAAQ,kBAG/B97B,QAGLsxB,EAAYxxB,UAAU04C,iBAAmB,SAASH,GAChD,GAAI/b,GAAOC,EAAImc,CAGf,OAFAnc,GAAK,mCACLD,EAAQC,EAAGM,KAAKwb,KAIhBK,EAAW,SAAS/L,EAAGgM,EAAGC,GACxB,GAAIC,EAUJ,OATAA,GAAiB,SAASC,GACxB,GAAIV,EAEJ,OADAA,GAAMU,EAAErwB,SAAS,IACE,IAAf2vB,EAAIhgD,OACC,IAAMggD,EAENA,GAGJ,IAAMS,EAAelM,GAAKkM,EAAeF,GAAKE,EAAeD,KAE3C,EAAXtc,EAAM,GAAmB,EAAXA,EAAM,GAAmB,EAAXA,EAAM,IAfzC,IAkBJhL,GAENJ,GAEHsB,EAASI,QAAQoZ,UAAU1a,GAE3Ba,EAAa,SAAUqB,GAGrB,QAASrB,KACP,MAAOA,GAAWkB,UAAUH,YAAYnzB,MAAMC,KAAMC,WA4CtD,MA/CA8yB,GAAOZ,EAAYqB,GAMnBrB,EAAWryB,UAAUzH,KAAO,GAE5B85B,EAAWryB,UAAUm1C,WAAa,aAElC9iB,EAAWryB,UAAU+1C,QAAU,SAASJ,GACtC,GAAIsD,GAAOtB,EAAYuB,CAiCvB,OAhCAvB,GAAaz3C,KAAKk0B,OAAOiM,UAAUjJ,aACnC8hB,EAA4B,OAAdh5C,KAAK3H,KAAgB,KAAO,KAC1C2H,KAAKk0B,OAAOiM,UAAU93B,OACtB0wC,EAAQ,KACRtB,EAAWphB,KAAK,SAAU9B,GACxB,MAAO,UAASp8B,EAAGm+B,GACjB,GAAIE,EAEJ,IADAA,EAAQnG,EAAEiG,KACNE,EAAMJ,GAAG,mBAAqBI,EAAMJ,GAAG7B,EAAM0gB,aAAe1gB,EAAML,OAAOe,KAAK6I,gBAAgBtH,KAAWnG,EAAE2H,SAAS3D,SAAUiC,GAGlI,MAAIE,GAAMJ,GAAG7B,EAAMl8B,OACjBm+B,EAAM9Y,SAAS,MAAM2Y,KAAK,SAASl+B,EAAG8gD,GACpC,GAAI/U,GAAYgV,CAGhB,OAFAA,GAAM7oB,EAAE4oB,GACR/U,EAAagV,EAAIx7B,SAAS,UAAU8iB,YAAYhK,GACzCnG,EAAE,QAAQT,OAAOS,EAAE4oB,GAAIpuC,QAAU0pB,EAAML,OAAOe,KAAK0E,MAAM2D,aAAa9G,KAExEA,EAAMuE,UACJvE,EAAMJ,GAAG4iB,GACX3oB,EAAE,IAAMkE,EAAMl8B,KAAO,MAAMu3B,OAAO4G,EAAMO,YAAY2gB,WAAWlhB,GAC7DuiB,GAASviB,EAAMjX,OAAO6W,GAAG2iB,IAClC1oB,EAAE,SAAST,OAAO4G,EAAM3rB,QAAU0pB,EAAML,OAAOe,KAAK0E,MAAM6I,SAASuW,GAC5DviB,EAAMuE,WAEbge,EAAQ1oB,EAAE,IAAMkE,EAAMl8B,KAAO,eAAiBk8B,EAAMl8B,KAAO,KAC3D0gD,EAAM55B,KAAK,MAAMyQ,OAAO4G,EAAM3rB,QAAU0pB,EAAML,OAAOe,KAAK0E,MACnDof,EAAMrB,WAAWlhB,MAG3Bx2B,OACHA,KAAKk0B,OAAOiM,UAAUtF,UACf76B,KAAKk0B,OAAO4H,QAAQ,iBAGtB3J,GAENjB,GAEHkB,EAAkB,SAAUoB,GAG1B,QAASpB,KACP,MAAOA,GAAgBiB,UAAUH,YAAYnzB,MAAMC,KAAMC,WAuB3D,MA1BA8yB,GAAOX,EAAiBoB,GAMxBpB,EAAgBtyB,UAAUzH,KAAO,KAEjC+5B,EAAgBtyB,UAAUpB,KAAO,KAEjC0zB,EAAgBtyB,UAAUyO,KAAO,UAEjC6jB,EAAgBtyB,UAAUk1C,QAAU,KAEpC5iB,EAAgBtyB,UAAUs1C,SAAW,QAErChjB,EAAgBtyB,UAAUm0B,MAAQ,WAOhC,MANIj0B,MAAKk0B,OAAOe,KAAKsM,GAAGC,IACtBxhC,KAAKoS,MAAQpS,KAAKoS,MAAQ,gBAE1BpS,KAAKoS,MAAQpS,KAAKoS,MAAQ,gBAC1BpS,KAAKo1C,SAAW,UAEXhjB,EAAgBiB,UAAUY,MAAMb,KAAKpzB,OAGvCoyB,GAEND,GAEHK,EAASI,QAAQoZ,UAAU5Z,GAE3B+mB,qBAAuB,SAAU3lB,GAG/B,QAAS2lB,KACP,MAAOA,GAAqB9lB,UAAUH,YAAYnzB,MAAMC,KAAMC,WAuGhE,MA1GA8yB,GAAOomB,EAAsB3lB,GAM7B2lB,EAAqBr5C,UAAUpB,KAAO,MAEtCy6C,EAAqBr5C,UAAUyO,KAAO,UAEtC4qC,EAAqBr5C,UAAUzH,KAAO,KAEtC8gD,EAAqBr5C,UAAUk1C,QAAU,KAEzCmE,EAAqBr5C,UAAUm1C,WAAa,aAE5CkE,EAAqBr5C,UAAUye,MAAO,EAEtC46B,EAAqBr5C,UAAUs1C,SAAW,QAE1C+D,EAAqBr5C,UAAUm0B,MAAQ,WAUrC,MATA5D,GAAE0C,OAAO/yB,KAAKk0B,OAAOoM,UAAU9E,gBAC7B4W,IAAK,qBAEHpyC,KAAKk0B,OAAOe,KAAKsM,GAAGC,IACtBxhC,KAAKoS,MAAQpS,KAAKoS,MAAQ,gBAE1BpS,KAAKoS,MAAQpS,KAAKoS,MAAQ,gBAC1BpS,KAAKo1C,SAAW,UAEX+D,EAAqB9lB,UAAUY,MAAMb,KAAKpzB,OAGnDm5C,EAAqBr5C,UAAUu2C,WAAa,WAC1ChmB,EAAE,yNAA0OrwB,KAAK60C,GAAG,YAAe,6KAA0L70C,KAAK60C,GAAG,cAAiB,8KAA2L70C,KAAK60C,GAAG,cAAiB,4NAA2O70C,KAAK60C,GAAG,eAAkB,gLAA6L70C,KAAK60C,GAAG,gBAAmB,kLAA+L70C,KAAK60C,GAAG,kBAAqB,kLAA+L70C,KAAK60C,GAAG,kBAAqB,+NAA8O70C,KAAK60C,GAAG,kBAAqB,kLAA+L70C,KAAK60C,GAAG,kBAAqB,6KAA0L70C,KAAK60C,GAAG,aAAgB,8KAA2L70C,KAAK60C,GAAG,cAAiB,sDAAsDrS,SAASxiC,KAAK80C,aAChhF90C,KAAKo5C,WAAap5C,KAAK80C,YAAY31B,KAAK,qBACxCnf,KAAKq5C,SAAWr5C,KAAK80C,YAAY31B,KAAK,oBAGxCg6B,EAAqBr5C,UAAU+1C,QAAU,SAASJ,GAChD,GAAI6D,GAAKjhD,CAeT,IAdAA,GACI27C,SAAY,OACZC,WAAc,SACdC,WAAc,SACdC,YAAe,UACfC,aAAgB,uBAChBC,eAAkB,cAClBC,eAAkB,cAClBC,eAAkB,cAClBC,eAAkB,cAClBC,UAAa,eAGjB6E,EAAMt5C,KAAKk0B,OAAOiM,UAAUnK,gBACxB39B,EAAKo9C,GAAQ,CACf,MAAO6D,EAAIljB,GAAG,QACTkjB,EAAIljB,GAAG,sBACVkjB,EAAMA,EAAIh6B,QAEZ,KAAIg6B,EAAIljB,GAAG,qBAET,MADAkjB,GAAIvpB,IAAI,kBAAmB13B,EAAKo9C,IACzBz1C,KAAKk0B,OAAO4H,QAAQ,gBAK/B,GAAIid,GAAOtB,EAAYuB,CAoCvB,OAnCAvB,GAAaz3C,KAAKk0B,OAAOiM,UAAUjJ,aACnC8hB,EAA4B,OAAdh5C,KAAK3H,KAAgB,KAAO,KAC1C2H,KAAKk0B,OAAOiM,UAAU93B,OACtB0wC,EAAQ,KACRtB,EAAWphB,KAAK,SAAU9B,GACxB,MAAO,UAASp8B,EAAGm+B,GACjB,GAAIE,EAEJ,IADAA,EAAQnG,EAAEiG,KACNE,EAAMJ,GAAG,mBAAqBI,EAAMJ,GAAG7B,EAAM0gB,aAAe1gB,EAAML,OAAOe,KAAK6I,gBAAgBtH,KAAWnG,EAAE2H,SAAS3D,SAAUiC,GAGlI,MAAIE,GAAMJ,GAAG7B,EAAMl8B,OACjBm+B,EAAM9Y,SAAS,MAAM2Y,KAAK,SAASl+B,EAAG8gD,GACpC,GAAI/U,GAAYgV,CAGhB,OAFAA,GAAM7oB,EAAE4oB,GACR/U,EAAagV,EAAIx7B,SAAS,UAAU8iB,YAAYhK,GACzCnG,EAAE,QAAQT,OAAOS,EAAE4oB,GAAIpuC,QAAU0pB,EAAML,OAAOe,KAAK0E,MAAM2D,aAAa9G,KAExEA,EAAMuE,UACJvE,EAAMJ,GAAG4iB,GACX3oB,EAAE,IAAMkE,EAAMl8B,KAAO,MAAMu3B,OAAO4G,EAAMO,YAAY2gB,WAAWlhB,GAC7DuiB,GAASviB,EAAMjX,OAAO6W,GAAG2iB,IAClC1oB,EAAE,SAAST,OAAO4G,EAAM3rB,QAAU0pB,EAAML,OAAOe,KAAK0E,MAAM6I,SAASuW,GAC5DviB,EAAMuE,WAEbge,EAAQ1oB,EAAE,IAAMkE,EAAMl8B,KAAO,eAAiBk8B,EAAMl8B,KAAO,KAC3D0gD,EAAM55B,KAAK,MAAMyQ,OAAO4G,EAAM3rB,QAAU0pB,EAAML,OAAOe,KAAK0E,MACnDof,EAAMrB,WAAWlhB,MAG3Bx2B,OACHA,KAAKk0B,OAAOiM,UAAUtF,UAElBxiC,EAAKo9C,IAAUsD,GAASA,EAAMhpB,IAAI,kBAAmB13B,EAAKo9C,IAEvDz1C,KAAKk0B,OAAO4H,QAAQ,iBAGtBqd,GAENjoB,GAEHsB,EAASI,QAAQoZ,UAAUmN,sBAkE3BnoB,EAAmB,SAAUwC,GAG3B,QAASxC,KACP,MAAOA,GAAiBqC,UAAUH,YAAYnzB,MAAMC,KAAMC,WAiD5D,MApDA8yB,GAAO/B,EAAkBwC,GAMzBxC,EAAiBlxB,UAAUpB,KAAO,aAElCsyB,EAAiBlxB,UAAUyO,KAAO,aAElCyiB,EAAiBlxB,UAAUk1C,QAAU,aAErChkB,EAAiBlxB,UAAUm1C,WAAa,aAExCjkB,EAAiBlxB,UAAU+1C,QAAU,WACnC,GAAI4B,GAAY8B,EAAYC,CAkC5B,OAjCA/B,GAAaz3C,KAAKk0B,OAAOiM,UAAU9I,YACnCogB,EAAaA,EAAWtgB,OAAO,SAASh/B,EAAGm+B,GACzC,OAAQjG,EAAEiG,GAAMhX,SAAS8W,GAAG,gBAE9Bp2B,KAAKk0B,OAAOiM,UAAU93B,OACtBmxC,KACAD,EAAa,SAAUhlB,GACrB,MAAO,YACL,GAAIilB,EAAUphD,OAAS,EAErB,MADAi4B,GAAE,IAAMkE,EAAMygB,QAAU,MAAM1X,aAAakc,EAAU,IAAI5pB,OAAO4pB,GACzDA,EAAUphD,OAAS,IAG7B4H,MACHy3C,EAAWphB,KAAK,SAAU9B,GACxB,MAAO,UAASp8B,EAAGm+B,GACjB,GAAIE,EAEJ,IADAA,EAAQnG,EAAEiG,GACLE,EAAMlX,SAAS8W,GAAG7B,EAAML,OAAOqB,MAGpC,MAAIiB,GAAMJ,GAAG7B,EAAMygB,UACjBuE,IACO/iB,EAAM9Y,WAAWugB,UACfzH,EAAMJ,GAAG7B,EAAM0gB,aAAe1gB,EAAML,OAAOe,KAAK6I,gBAAgBtH,GAClE+iB,IAEAC,EAAUz8C,KAAKu5B,KAGzBt2B,OACHu5C,IACAv5C,KAAKk0B,OAAOiM,UAAUtF,UACf76B,KAAKk0B,OAAO4H,QAAQ,iBAGtB9K,GAENE,GAEHsB,EAASI,QAAQoZ,UAAUhb,GAE3BI,EAAa,SAAUoC,GAGrB,QAASpC,KACP,MAAOA,GAAWiC,UAAUH,YAAYnzB,MAAMC,KAAMC,WAmJtD,MAtJA8yB,GAAO3B,EAAYoC,GAMnBpC,EAAWtxB,UAAUpB,KAAO,OAE5B0yB,EAAWtxB,UAAUyO,KAAO,OAE5B6iB,EAAWtxB,UAAUk1C,QAAU,MAE/B5jB,EAAWtxB,UAAUm1C,WAAa,gBAElC7jB,EAAWtxB,UAAUm0B,MAAQ,WAS3B,MARA7C,GAAWiC,UAAUY,MAAMb,KAAKpzB,MAChCA,KAAKk0B,OAAO/N,GAAG,WAAY,SAAUoO,GACnC,MAAO,UAASC,EAAG8F,GACjB,MAAOA,GAAInb,KAAK,OAAOkX,KAAK,SAASl+B,EAAGshD,GACtC,MAAOllB,GAAMsH,SAASxL,EAAEopB,QAG3Bz5C,OACIA,KAAKk0B,OAAO/N,GAAG,aAAc,SAAUoO,GAC5C,MAAO,UAASC,EAAG8F,GACjB,MAAOA,GAAInb,KAAK,OAAOkX,KAAK,SAASl+B,EAAGshD,GACtC,MAAOllB,GAAMwH,WAAW1L,EAAEopB,QAG7Bz5C,QAGLoxB,EAAWtxB,UAAUw1C,OAAS,WAC5B,GAAI3L,EAGJ,OAFAA,GAAO,GAAK1pC,UAAU7H,OAASm7B,EAAMH,KAAKnzB,UAAW,MACrDmxB,EAAWiC,UAAUiiB,OAAOv1C,MAAMC,KAAM2pC,GACjC3pC,KAAKwwC,QAAU,GAAInf,IACxBnH,OAAQlqB,QAIZoxB,EAAWtxB,UAAU45C,WAAa,WAChC,GAAInN,GAAazX,CAEjB,OADAA,GAAQ90B,KAAKk0B,OAAOiM,UAAUrL,SACzByX,EAAclc,EAAEyE,EAAM6kB,iBAAiBx6B,KAAKnf,KAAKk0B,OAAOe,KAAKiC,WAAW6G,KAAK,OAAS,GAAMjJ,EAAMgB,WAA0E,IAA7D91B,KAAKk0B,OAAOiM,UAAUzK,aAAayB,OAAO,QAAQ/+B,QACpK4H,KAAK45C,YAAa,EACX55C,KAAKg1C,QAAU,QAEtBh1C,KAAK45C,YAAa,EACX55C,KAAKg1C,QAAU,SAI1B5jB,EAAWtxB,UAAUo2C,QAAU,WAG7B,GAFAl2C,KAAK05C,aACLtoB,EAAWiC,UAAU6iB,QAAQ9iB,KAAKpzB,OAC9BA,KAAK45C,WAGT,MAAI55C,MAAKosC,OACApsC,KAAKwwC,QAAQh0C,KAAKwD,KAAKs2B,MAEvBt2B,KAAKwwC,QAAQ9jC,QAIxB0kB,EAAWtxB,UAAU+7B,SAAW,SAASoR,GACvC,GAAI4M,GAAOC,EAAM3c,EAAKC,CAEtB,IADAyc,EAAQ5M,EAAK9tB,KAAK,UACd06B,EAAMzhD,OAAS,IACjB0hD,EAAsC,OAA9B3c,EAAM0c,EAAMlc,KAAK,WAAwD,OAAnCP,EAAOD,EAAIb,MAAM,eAAyBc,EAAK,GAAc,OAC3Gyc,EAAM9iB,WAAWkH,SACb6b,GACF,MAAO7M,GAAKtP,KAAK,YAAamc,IAKpC1oB,EAAWtxB,UAAUi8B,WAAa,SAASkR,GACzC,GAAI4M,GAAOC,CAMX,OALAA,GAAO7M,EAAKtP,KAAK,aACjBkc,EAAQxpB,EAAE,WACNypB,GAAQA,QACVD,EAAMx6B,SAAS,QAAUy6B,GAEpB7M,EAAK8M,UAAUF,GAAOtb,WAAW,cAG1CnN,EAAWtxB,UAAU+1C,QAAU,WAC7B,MAAI71C,MAAK45C,WACA55C,KAAKg6C,iBAELh6C,KAAKi6C,iBAIhB7oB,EAAWtxB,UAAUm6C,cAAgB,WACnC,GAAIxC,GAAY8B,EAAYC,EAAWU,CAgCvC,OA/BAzC,GAAaz3C,KAAKk0B,OAAOiM,UAAU9I,YACnCmiB,KACAU,KACAX,EAAa,SAAUhlB,GACrB,MAAO,YACL,GAAI0Y,EACJ,IAAMuM,EAAUphD,OAAS,EAKzB,MAFA60C,GAAO5c,EAAE,IAAMkE,EAAMygB,QAAU,MAAM1X,aAAakc,EAAU,IAAI38B,KAAK0X,EAAML,OAAOoM,UAAUxB,UAAU0a,IACtGU,EAAYn9C,KAAKkwC,EAAK,IACfuM,EAAUphD,OAAS,IAE3B4H,MACHy3C,EAAWphB,KAAK,SAAU9B,GACxB,MAAO,UAASp8B,EAAGm+B,GACjB,GAAIE,GAAOkH,CAEX,OADAlH,GAAQnG,EAAEiG,GACNE,EAAMJ,GAAG7B,EAAMygB,UACjBuE,IACA7b,EAAKrN,EAAE,QAAQT,OAAO4G,EAAM3rB,OAAO4H,QAAQ,KAAM,UAAUilC,WAAWlhB,GAC/D0jB,EAAYn9C,KAAK2gC,EAAG,KAClBlH,EAAMJ,GAAG7B,EAAM0gB,aAAe1gB,EAAML,OAAOe,KAAK6I,gBAAgBtH,IAAUA,EAAMJ,GAAG,cACrFmjB,IAEAC,EAAUz8C,KAAKu5B,KAGzBt2B,OACHu5C,IACAv5C,KAAKk0B,OAAOiM,UAAUhH,gBAAgB9I,EAAE6pB,GAAapjB,QAC9C92B,KAAKk0B,OAAO4H,QAAQ,iBAG7B1K,EAAWtxB,UAAUk6C,eAAiB,WACpC,GAAIH,GAAO3a,EAAWpK,CActB,OAbAA,GAAQ90B,KAAKk0B,OAAOiM,UAAUrL,QAC1B90B,KAAKosC,QACPtX,EAAM2jB,mBAAmBz4C,KAAKs2B,KAAK,IACnCt2B,KAAKk0B,OAAOiM,UAAU93B,KAAKysB,GAC3B90B,KAAKs2B,KAAKS,WAAWkH,SACrBj+B,KAAKk0B,OAAOiM,UAAUtF,YAEtBqE,EAAY7O,EAAEyE,EAAM2F,mBACpBof,EAAQxpB,EAAE,IAAMrwB,KAAKg1C,QAAU,MAAMplB,OAAOsP,EAAUnI,YACtDjC,EAAM6D,WAAWkhB,EAAM,IACvB/kB,EAAM2jB,mBAAmBoB,EAAM,IAC/B75C,KAAKk0B,OAAOiM,UAAUrL,MAAMA,IAEvB90B,KAAKk0B,OAAO4H,QAAQ,iBAGtB1K,GAENF,GAEHG,EAAc,SAAUmC,GAGtB,QAASnC,KACP,MAAOA,GAAYgC,UAAUH,YAAYnzB,MAAMC,KAAMC,WAmHvD,MAtHA8yB,GAAO1B,EAAamC,GAMpBnC,EAAYvxB,UAAUw1C,OAAS,WAC7B,GAAI6E,GAAS3gD,EAAGsgD,EAAM1gC,EAAK+jB,CAoE3B,KAnEAn9B,KAAK8qC,KAAO,2HAAsI9qC,KAAK60C,GAAG,kBAAqB,6CAC/K70C,KAAKo6C,MAAQp6C,KAAKk0B,OAAO8G,KAAKqf,iBAE1B37C,KAAM,OACNkB,MAAO,SAEPlB,KAAM,MACNkB,MAAO,QAEPlB,KAAM,KACNkB,MAAO,OAEPlB,KAAM,MACNkB,MAAO,QAEPlB,KAAM,SACNkB,MAAO,WAEPlB,KAAM,OACNkB,MAAO,SAEPlB,KAAM,OACNkB,MAAO,SAEPlB,KAAM,OACNkB,MAAO,SAEPlB,KAAM,eACNkB,MAAO,iBAEPlB,KAAM,WACNkB,MAAO,SAEPlB,KAAM,OACNkB,MAAO,SAEPlB,KAAM,OACNkB,MAAO,SAEPlB,KAAM,aACNkB,MAAO,OAEPlB,KAAM,WACNkB,MAAO,aAEPlB,KAAM,cACNkB,MAAO,OAEPlB,KAAM,MACNkB,MAAO,QAEPlB,KAAM,OACNkB,MAAO,SAEPlB,KAAM,SACNkB,MAAO,WAEPlB,KAAM,OACNkB,MAAO,SAEPlB,KAAM,MACNkB,MAAO,QAGXI,KAAKwmB,GAAGnH,SAAS,gBAAgBuQ,OAAO5vB,KAAK8qC,MAC7C9qC,KAAKs6C,SAAWt6C,KAAKwmB,GAAGrH,KAAK,gBAC7Bge,EAAMn9B,KAAKo6C,MACN5gD,EAAI,EAAG4f,EAAM+jB,EAAI/kC,OAAQoB,EAAI4f,EAAK5f,IACrCsgD,EAAO3c,EAAI3jC,GACX2gD,EAAU9pB,EAAE,aACVxT,KAAMi9B,EAAKp7C,KACXkB,MAAOk6C,EAAKl6C,QACX4iC,SAASxiC,KAAKs6C,SAiBnB,OAfAt6C,MAAKs6C,SAASn0B,GAAG,SAAU,SAAUoO,GACnC,MAAO,UAASC,GACd,GAAI3b,EAUJ,OATA0b,GAAMulB,KAAOvlB,EAAM+lB,SAASz8C,MAC5Bgb,EAAW0b,EAAMqiB,OAAO1Y,SAAS,YACjC3J,EAAMqiB,OAAOx3B,cAAcmf,WAAW,aAClChK,EAAMulB,WACRvlB,EAAMqiB,OAAOjZ,KAAK,YAAapJ,EAAMulB,MAEnCjhC,GACF0b,EAAMqiB,OAAOv3B,SAAS,YAEjBkV,EAAML,OAAO4H,QAAQ,kBAE7B97B,OACIA,KAAKk0B,OAAO/N,GAAG,eAAgB,SAAUoO,GAC9C,MAAO,UAASC,GACd,GAAID,EAAM6X,OACR,MAAO7X,GAAM6iB,YAGhBp3C,QAGLqxB,EAAYvxB,UAAUtD,KAAO,WAC3B,GAAImtC,EAIJ,OAHAA,GAAO,GAAK1pC,UAAU7H,OAASm7B,EAAMH,KAAKnzB,UAAW,MACrDoxB,EAAYgC,UAAU72B,KAAKuD,MAAMC,KAAM2pC,GACvC3pC,KAAK85C,KAAO95C,KAAK42C,OAAOjZ,KAAK,aACZ,MAAb39B,KAAK85C,KACA95C,KAAKs6C,SAASz8C,IAAImC,KAAK85C,MAEvB95C,KAAKs6C,SAASz8C,SAIlBwzB,GAENiB,GAEHE,EAASI,QAAQoZ,UAAU5a,GAE3Ba,EAAa,SAAUuB,GAGrB,QAASvB,KACP,MAAOA,GAAWoB,UAAUH,YAAYnzB,MAAMC,KAAMC,WAmEtD,MAtEA8yB,GAAOd,EAAYuB,GAMnBvB,EAAWnyB,UAAUpB,KAAO,OAE5BuzB,EAAWnyB,UAAUyO,KAAO,OAE5B0jB,EAAWnyB,UAAUk1C,QAAU,IAE/B/iB,EAAWnyB,UAAUm1C,WAAa,MAElChjB,EAAWnyB,UAAUw1C,OAAS,WAC5B,GAAI3L,EAGJ,OAFAA,GAAO,GAAK1pC,UAAU7H,OAASm7B,EAAMH,KAAKnzB,UAAW,MACrDgyB,EAAWoB,UAAUiiB,OAAOv1C,MAAMC,KAAM2pC,GACjC3pC,KAAKwwC,QAAU,GAAIte,IACxBhI,OAAQlqB,QAIZiyB,EAAWnyB,UAAUo2C,QAAU,WAE7B,MADAjkB,GAAWoB,UAAU6iB,QAAQ9iB,KAAKpzB,MAC9BA,KAAKosC,SAAWpsC,KAAKk0B,OAAOiM,UAAU5I,aAAav3B,KAAKs2B,MACnDt2B,KAAKwwC,QAAQh0C,KAAKwD,KAAKs2B,MAEvBt2B,KAAKwwC,QAAQ9jC,QAIxBulB,EAAWnyB,UAAU+1C,QAAU,WAC7B,GAAI3W,GAAWhD,EAAOqe,EAAWzI,EAAUhd,EAAO0lB,CAkClD,OAjCA1lB,GAAQ90B,KAAKk0B,OAAOiM,UAAUrL,QAC1B90B,KAAKosC,QACPoO,EAAUnmB,SAAS0I,eAAe/8B,KAAKs2B,KAAKzZ,QAC5C7c,KAAKs2B,KAAK0G,YAAYwd,GACtB1lB,EAAMyY,WAAWiN,KAEjBtb,EAAY7O,EAAEyE,EAAM2F,mBACpBqX,EAAW9xC,KAAKk0B,OAAOoM,UAAUxB,UAAUI,EAAUnI,YAAY,GACjEmF,EAAQ7L,EAAE,QACR3N,KAAM,yBACNk0B,OAAQ,SACR/5B,KAAMi1B,GAAY9xC,KAAK60C,GAAG,cAExB70C,KAAKk0B,OAAOiM,UAAUjJ,aAAa9+B,OAAS,EAC9C08B,EAAM6D,WAAWuD,EAAM,KAEvBqe,EAAYlqB,EAAE,QAAQT,OAAOsM,GAC7BpH,EAAM6D,WAAW4hB,EAAU,KAE7BzlB,EAAM2jB,mBAAmBvc,EAAM,IAC/Bl8B,KAAKwwC,QAAQiK,IAAI,cAAe,SAAUlmB,GACxC,MAAO,YACL,MAAIud,IACFvd,EAAMic,QAAQkK,MAAMllB,QACbjB,EAAMic,QAAQkK,MAAM,GAAGx3C,WAE9BqxB,EAAMic,QAAQmK,OAAOnlB,QACdjB,EAAMic,QAAQmK,OAAO,GAAGz3C,YAGlClD,QAELA,KAAKk0B,OAAOiM,UAAUrL,MAAMA,GACrB90B,KAAKk0B,OAAO4H,QAAQ,iBAGtB7J,GAENf,GAEHgB,EAAc,SAAUsB,GAGtB,QAAStB,KACP,MAAOA,GAAYmB,UAAUH,YAAYnzB,MAAMC,KAAMC,WAyEvD,MA5EA8yB,GAAOb,EAAasB,GAMpBtB,EAAYpyB,UAAUw1C,OAAS,WAC7B,GAAIsF,EAqDJ,OApDAA,GAAM,2EAAkF56C,KAAK60C,GAAG,YAAe,8GAA0H70C,KAAK60C,GAAG,cAAiB,2JAAqK70C,KAAK60C,GAAG,WAAc,6GAAsH70C,KAAK60C,GAAG,cAAiB,4EAAmF70C,KAAK60C,GAAG,uBAA0B,mDAAwD70C,KAAK60C,GAAG,2BAA8B,qDAC/xB70C,KAAKwmB,GAAGnH,SAAS,gBAAgBuQ,OAAOgrB,GACxC56C,KAAK26C,OAAS36C,KAAKwmB,GAAGrH,KAAK,cAC3Bnf,KAAK06C,MAAQ16C,KAAKwmB,GAAGrH,KAAK,aAC1Bnf,KAAK66C,SAAW76C,KAAKwmB,GAAGrH,KAAK,eAC7Bnf,KAAK86C,aAAe96C,KAAKwmB,GAAGrH,KAAK,gBACjCnf,KAAK26C,OAAOx0B,GAAG,QAAS,SAAUoO,GAChC,MAAO,UAASC,GACd,GAAgB,KAAZA,EAAE6N,MAIN,MADA9N,GAAMqiB,OAAO/5B,KAAK0X,EAAMomB,OAAO98C,OACxB02B,EAAML,OAAOmB,aAAaoK,0BAElCz/B,OACHA,KAAK06C,MAAMv0B,GAAG,QAAS,SAAUoO,GAC/B,MAAO,UAASC,GACd,GAAI32B,EACJ,IAAgB,KAAZ22B,EAAE6N,MAQN,MALAxkC,GAAM02B,EAAMmmB,MAAM78C,OACZ,oBAAoBsrB,KAAKtrB,IAASA,IACtCA,EAAM,UAAYA,GAEpB02B,EAAMqiB,OAAOjZ,KAAK,OAAQ9/B,GACnB02B,EAAML,OAAOmB,aAAaoK,0BAElCz/B,OACHqwB,GAAGrwB,KAAK06C,MAAM,GAAI16C,KAAK26C,OAAO,KAAKx0B,GAAG,UAAW,SAAUoO,GACzD,MAAO,UAASC,GACd,GAAIM,EACJ,IAAgB,KAAZN,EAAE6N,OAA4B,KAAZ7N,EAAE6N,QAAkB7N,EAAE4O,UAAwB,IAAZ5O,EAAE6N,OAAehS,EAAEmE,EAAEoiB,QAAQ1Y,SAAS,YAK5F,MAJA1J,GAAE6M,iBACFvM,EAAQT,SAASyG,cACjBvG,EAAML,OAAOiM,UAAUvH,cAAcrE,EAAMqiB,OAAQ9hB,GACnDP,EAAM7nB,OACC6nB,EAAML,OAAOmB,aAAaoK,0BAGpCz/B,OACHA,KAAK66C,SAAS10B,GAAG,QAAS,SAAUoO,GAClC,MAAO,UAASC,GACd,GAAIM,GAAO0lB,CAMX,OALAA,GAAUnmB,SAAS0I,eAAexI,EAAMqiB,OAAO/5B,QAC/C0X,EAAMqiB,OAAO5Z,YAAYwd,GACzBjmB,EAAM7nB,OACNooB,EAAQT,SAASyG,cACjBvG,EAAML,OAAOiM,UAAUvH,cAAc4hB,EAAS1lB,GACvCP,EAAML,OAAOmB,aAAaoK,0BAElCz/B,OACIA,KAAK86C,aAAa30B,GAAG,SAAU,SAAUoO,GAC9C,MAAO,UAASC,GAEd,MADAD,GAAMqiB,OAAOjZ,KAAK,SAAUpJ,EAAMumB,aAAaj9C,OACxC02B,EAAML,OAAOmB,aAAaoK,0BAElCz/B,QAGLkyB,EAAYpyB,UAAUtD,KAAO,WAC3B,GAAImtC,EAIJ,OAHAA,GAAO,GAAK1pC,UAAU7H,OAASm7B,EAAMH,KAAKnzB,UAAW,MACrDiyB,EAAYmB,UAAU72B,KAAKuD,MAAMC,KAAM2pC,GACvC3pC,KAAK26C,OAAO98C,IAAImC,KAAK42C,OAAO/5B,QACrB7c,KAAK06C,MAAM78C,IAAImC,KAAK42C,OAAOjZ,KAAK,UAGlCzL,GAENI,GAEHE,EAASI,QAAQoZ,UAAU/Z,GAE3BP,EAAc,SAAU8B,GAGtB,QAAS9B,KACP,MAAOA,GAAY2B,UAAUH,YAAYnzB,MAAMC,KAAMC,WA4ZvD,MA/ZA8yB,GAAOrB,EAAa8B,GAMpB9B,EAAY5xB,UAAUpB,KAAO,QAE7BgzB,EAAY5xB,UAAUyO,KAAO,YAE7BmjB,EAAY5xB,UAAUk1C,QAAU,MAEhCtjB,EAAY5xB,UAAUm1C,WAAa,aAEnCvjB,EAAY5xB,UAAU6vC,aAAe,GAErCje,EAAY5xB,UAAUq1C,WAAY,EAElCzjB,EAAY5xB,UAAUm0B,MAAQ,WAC5B,GAAI32B,GAAM9D,EAAG4f,EAAK+jB,CAClB,IAAIn9B,KAAKk0B,OAAO8G,KAAK+f,YACnB,GAAIl7C,MAAMurC,QAAQprC,KAAKk0B,OAAO8G,KAAK+f,aAGjC,IAFA/6C,KAAKue,QACL4e,EAAMn9B,KAAKk0B,OAAO8G,KAAK+f,YAClBvhD,EAAI,EAAG4f,EAAM+jB,EAAI/kC,OAAQoB,EAAI4f,EAAK5f,IACrC8D,EAAO6/B,EAAI3jC,GACXwG,KAAKue,KAAKxhB,MACR2B,KAAMpB,EAAO,SACbuf,KAAM7c,KAAK60C,GAAGv3C,EAAO,eAIzB0C,MAAKue,MAAO,MAGc,OAAxBve,KAAKk0B,OAAOpD,SACd9wB,KAAKue,OAED7f,KAAM,eACNme,KAAM7c,KAAK60C,GAAG,iBAEdn2C,KAAM,iBACNme,KAAM7c,KAAK60C,GAAG,mBAIlB70C,KAAKue,MAAO,CA8DhB,OA3DAve,MAAK2vC,aAAe3vC,KAAKk0B,OAAO8G,KAAK2U,aACrC3vC,KAAKk0B,OAAOqB,KAAKpP,GAAG,QAAS,4BAA6B,SAAUoO,GAClE,MAAO,UAASC,GACd,GAAIqa,GAAM/Z,CAQV,OAPA+Z,GAAOxe,EAAEmE,EAAEhX,eACXsX,EAAQT,SAASyG,cACjBhG,EAAMyY,WAAWsB,EAAK,IACtBta,EAAML,OAAOiM,UAAUrL,MAAMA,GACxBP,EAAML,OAAOe,KAAKwL,QAAQC,mBAC7BnM,EAAML,OAAO4H,QAAQ,qBAEhB,IAER97B,OACHA,KAAKk0B,OAAOqB,KAAKpP,GAAG,UAAW,4BAA6B,SAASqO,GACnE,OAAO,IAETx0B,KAAKk0B,OAAO/N,GAAG,yBAA0B,SAAUoO,GACjD,MAAO,YACL,GAAI2K,GAAW2P,EAAM/Z,CAErB,IADAA,EAAQP,EAAML,OAAOiM,UAAUrL,QAClB,MAATA,EAIJ,MADAoK,GAAY7O,EAAEyE,EAAM6kB,iBAAiB5iB,WACZ,IAArBmI,EAAU9mC,QAAgB8mC,EAAU9I,GAAG,8BACzCyY,EAAOxe,EAAEyE,EAAMa,gBAAgBoB,WAAWF,GAAG/B,EAAM4D,aAC5CnE,EAAMic,QAAQh0C,KAAKqyC,IAEnBta,EAAMic,QAAQ9jC,SAGxB1M,OACHA,KAAKk0B,OAAO/N,GAAG,qBAAsB,SAAUoO,GAC7C,MAAO,YACL,GAAIymB,EAEJ,IADAA,EAASzmB,EAAML,OAAO6W,QAAQ5rB,KAAK,2BAC7B67B,EAAO5iD,OAAS,EAGtB,MAAO4iD,GAAO3kB,KAAK,SAASl+B,EAAG8iD,GAC7B,GAAIpM,GAAMqM,EAAOC,CAGjB,IAFAD,EAAQ7qB,EAAE4qB,GACVpM,EAAOqM,EAAM3jD,KAAK,SACZs3C,GAAQA,EAAKvvB,SAASlnB,OAAS,KACnC8iD,EAAMngB,SACF8T,IACFsM,EAAOtM,EAAKt3C,KAAK,QACb4jD,IACF5mB,EAAML,OAAOpD,SAAS/nB,OAAOoyC,GACzB5mB,EAAML,OAAOqB,KAAKpW,KAAK,iBAAiB/mB,OAAS,KACnD,MAAOm8B,GAAML,OAAOpD,SAASgL,QAAQ,eAAgBqf,QAOhEn7C,OACI0xB,EAAY2B,UAAUY,MAAMb,KAAKpzB,OAG1C0xB,EAAY5xB,UAAUw1C,OAAS,WAC7B,GAAI3L,EAMJ,IALAA,EAAO,GAAK1pC,UAAU7H,OAASm7B,EAAMH,KAAKnzB,UAAW,MACrDyxB,EAAY2B,UAAUiiB,OAAOv1C,MAAMC,KAAM2pC,GACzC3pC,KAAKwwC,QAAU,GAAI7e,IACjBzH,OAAQlqB,OAE2B,WAAjCA,KAAKk0B,OAAO8G,KAAK+f,YACnB,MAAO/6C,MAAKo7C,cAAcp7C,KAAKwmB,KAInCkL,EAAY5xB,UAAUu2C,WAAa,WAEjC,MADA3kB,GAAY2B,UAAUgjB,WAAWjjB,KAAKpzB,MAC/BA,KAAKo7C,iBAGd1pB,EAAY5xB,UAAUs7C,cAAgB,SAASC,GAC7C,GAAIC,GAAQC,EAAaC,CAIzB,OAHmB,OAAfH,IACFA,EAAcr7C,KAAKw2C,OAAOr3B,KAAK,4BAEL,MAAxBnf,KAAKk0B,OAAOpD,aACd9wB,MAAKwmB,GAAGrH,KAAK,eAAe4b,UAG9BugB,EAAS,KACTC,EAAc,SAAUhnB,GACtB,MAAO,YAIL,MAHI+mB,IACFA,EAAOvgB,SAEFugB,EAASjrB,EAAE,YAChBh4B,KAAM,OACN+Z,MAAOmiB,EAAMsgB,GAAG,eAChBh/B,UAAU,EACV4lC,OAAQ,YACPjZ,SAAS6Y,KAEbr7C,MACHu7C,IACAF,EAAYl1B,GAAG,kBAAmB,mBAAoB,SAASqO,GAC7D,MAAOA,GAAEpO,oBAEXi1B,EAAYl1B,GAAG,SAAU,mBAAoB,SAAUoO,GACrD,MAAO,UAASC,GAed,MAdID,GAAML,OAAOmB,aAAaC,SAC5Bf,EAAML,OAAOpD,SAAS4d,OAAO4M,GAC3BI,QAAQ,IAEVH,MAEAhnB,EAAML,OAAOumB,IAAI,QAAS,SAASjmB,GAIjC,MAHAD,GAAML,OAAOpD,SAAS4d,OAAO4M,GAC3BI,QAAQ,IAEHH,MAEThnB,EAAML,OAAOsB,SAERjB,EAAMwW,QAAQ3rB,YAAY,aAElCpf,OACHA,KAAKk0B,OAAOpD,SAAS3K,GAAG,eAAgB,SAAUoO,GAChD,MAAO,UAASC,EAAG2mB,GACjB,GAAItM,EACJ,IAAKsM,EAAKO,OAWV,MARIP,GAAK7f,IACPuT,EAAOxe,EAAE8qB,EAAK7f,MAEduT,EAAOta,EAAMonB,YAAYR,EAAKz8C,MAC9By8C,EAAK7f,IAAMuT,GAEbA,EAAKxvB,SAAS,aACdwvB,EAAKt3C,KAAK,OAAQ4jD,GACX5mB,EAAML,OAAOpD,SAAS8qB,cAAcT,EAAKU,IAAK,SAASvgB,GAC5D,GAAIkK,EACJ,IAAKqJ,EAAK3Q,SAAS,aAInB,MADAsH,GAAMlK,EAAMA,EAAIkK,IAAMjR,EAAMob,aACrBpb,EAAMunB,UAAUjN,EAAMrJ,EAAK,WAChC,GAAIjR,EAAMic,QAAQpE,OAEhB,MADA7X,GAAMic,QAAQ4G,UACP7iB,EAAMic,QAAQuL,MAAMl+C,IAAI02B,EAAMsgB,GAAG,cAAcmH,KAAK,YAAY,SAK9Eh8C,OACHw7C,EAAiBnrB,EAAEsQ,MAAM3gC,KAAKk0B,OAAOe,KAAKyK,SAAS,SAASlL,EAAG2mB,EAAMc,EAAQxjD,GAC3E,GAAIo2C,GAAMqM,EAAOgB,CACjB,IAAKf,EAAKO,SAGVR,EAAQC,EAAK7f,IAAI/jC,KAAK,SAKtB,MADAs3C,GAAOqM,EAAM3jD,KAAK,OACZs3C,EAAK3Q,SAAS,cAAgB2Q,EAAKvvB,SAASlnB,OAAS,GAI3D8jD,EAAUD,EAASxjD,EACnByjD,GAAqB,IAAVA,GAAelzB,QAAQ,GAC9BkzB,EAAU,KACZA,EAAU,IAELhB,EAAM/7B,KAAK,aAAa6F,OAAQ,IAAMk3B,EAAW,UARtDhB,GAAMngB,UASP,KAAM/6B,MACTA,KAAKk0B,OAAOpD,SAAS3K,GAAG,iBAAkBq1B,GAC1Cx7C,KAAKk0B,OAAOpD,SAAS3K,GAAG,gBAAiB,SAAUoO,GACjD,MAAO,UAASC,EAAG2mB,EAAMtjB,GACvB,GAAIgX,GAAMsN,EAAUC,CACpB,IAAKjB,EAAKO,SAGV7M,EAAOsM,EAAK7f,IACNuT,EAAK3Q,SAAS,cAAgB2Q,EAAKvvB,SAASlnB,OAAS,GAA3D,CAGA,GAAsB,gBAAXy/B,GACT,IACEA,EAASxH,EAAEgsB,UAAUxkB,GACrB,MAAOhD,GACPL,EAAIK,EACJgD,GACEjf,SAAS,GAyBf,MArBIif,GAAOjf,WAAY,GACrBwjC,EAAMvkB,EAAOukB,KAAO7nB,EAAMsgB,GAAG,gBAC7B/2B,MAAMs+B,GACND,EAAW5nB,EAAMob,cAEjBwM,EAAWtkB,EAAOykB,UAEpB/nB,EAAMunB,UAAUjN,EAAMsN,EAAU,WAC9B,GAAIjB,EASJ,IARArM,EAAK6B,WAAW,QAChB7B,EAAKzvB,YAAY,aAAaA,YAAY,WAC1C87B,EAAQrM,EAAKt3C,KAAK,QACd2jD,GACFA,EAAMngB,SAER8T,EAAK6B,WAAW,QAChBnc,EAAML,OAAO4H,QAAQ,gBACjBvH,EAAML,OAAOqB,KAAKpW,KAAK,iBAAiB/mB,OAAS,EACnD,MAAOm8B,GAAML,OAAOpD,SAASgL,QAAQ,eAAgBqf,EAAMtjB,MAG3DtD,EAAMic,QAAQpE,QAChB7X,EAAMic,QAAQuL,MAAMC,KAAK,YAAY,GAC9BznB,EAAMic,QAAQuL,MAAMl+C,IAAIg6B,EAAOykB,YAFxC,UAKDt8C,OACIA,KAAKk0B,OAAOpD,SAAS3K,GAAG,cAAe,SAAUoO,GACtD,MAAO,UAASC,EAAG2mB,EAAMoB,GACvB,GAAI1N,GAAMuN,EAAKvkB,CACf,IAAKsjB,EAAKO,QAGa,UAAnBa,EAAIC,WAAR,CAGA,GAAID,EAAIE,aAAc,CACpB,IACE5kB,EAASxH,EAAEgsB,UAAUE,EAAIE,cACzBL,EAAMvkB,EAAOukB,IACb,MAAOvnB,GACPL,EAAIK,EACJunB,EAAM7nB,EAAMsgB,GAAG,eAEjB/2B,MAAMs+B,GAGR,GADAvN,EAAOsM,EAAK7f,IACNuT,EAAK3Q,SAAS,cAAgB2Q,EAAKvvB,SAASlnB,OAAS,EAkB3D,MAfAm8B,GAAMunB,UAAUjN,EAAMta,EAAMob,aAAc,WACxC,GAAIuL,EAOJ,OANArM,GAAK6B,WAAW,QAChB7B,EAAKzvB,YAAY,aAAaA,YAAY,WAC1C87B,EAAQrM,EAAKt3C,KAAK,QACd2jD,GACFA,EAAMngB,SAED8T,EAAK6B,WAAW,UAErBnc,EAAMic,QAAQpE,SAChB7X,EAAMic,QAAQuL,MAAMC,KAAK,YAAY,GACrCznB,EAAMic,QAAQuL,MAAMl+C,IAAI02B,EAAMob,eAEhCpb,EAAML,OAAO4H,QAAQ,gBACjBvH,EAAML,OAAOqB,KAAKpW,KAAK,iBAAiB/mB,OAAS,EAC5Cm8B,EAAML,OAAOpD,SAASgL,QAAQ,eAAgBqf,EAAMtjB,IAD7D,UAID73B,SAGL0xB,EAAY5xB,UAAUo2C,QAAU,WAC9B,MAAOl2C,MAAK02C,kBAGdhlB,EAAY5xB,UAAUg8C,UAAY,SAASjN,EAAMrJ,EAAKmJ,GACpD,GAAIuM,GAAO5f,EAAKohB,CAwDhB,OAvDAA,GAAe,SAAUnoB,GACvB,MAAO,YACL,GAAIooB,GAAWC,CAGf,OAFAD,GAAY9N,EAAK9oC,SACjB62C,EAAgBroB,EAAML,OAAO6W,QAAQhlC,SAC9Bm1C,EAAMnrB,KACX8b,IAAK8Q,EAAU9Q,IAAM+Q,EAAc/Q,IACnCL,KAAMmR,EAAUnR,KAAOoR,EAAcpR,KACrCD,MAAOsD,EAAKtD,QACZvmB,OAAQ6pB,EAAK7pB,WACZxoB,SAEJwD,MACH6uC,EAAKxvB,SAAS,WACd67B,EAAQrM,EAAKt3C,KAAK,QACb2jD,IACHA,EAAQ7qB,EAAE,gFAAgF3jB,OAAO81B,SAASxiC,KAAKk0B,OAAO6W,SACtH2R,IACA7N,EAAKt3C,KAAK,OAAQ2jD,GAClBA,EAAM3jD,KAAK,MAAOs3C,IAEpBvT,EAAM,GAAIuhB,OACVvhB,EAAIwhB,OAAS,SAAUvoB,GACrB,MAAO,YACL,GAAIvP,GAAQumB,CACZ,IAAKsD,EAAK3Q,SAAS,YAAe2Q,EAAK3Q,SAAS,aAkBhD,MAfAqN,GAAQjQ,EAAIiQ,MACZvmB,EAASsW,EAAItW,OACb6pB,EAAKlR,MACH6H,IAAKA,EACL+F,MAAOA,EACPvmB,OAAQA,EACR+3B,kBAAmBxR,EAAQ,IAAMvmB,IAChC5F,YAAY,WACXyvB,EAAK3Q,SAAS,cAChB3J,EAAML,OAAOe,KAAK4S,OAAOtT,EAAML,OAAOqB,MACtCmnB,MAEAxB,EAAMngB,SACN8T,EAAK6B,WAAW,SAEdrgB,EAAE2sB,WAAWrO,GACRA,EAASrT,GADlB,SAIDt7B,MACHs7B,EAAI2hB,QAAU,WAKZ,MAJI5sB,GAAE2sB,WAAWrO,IACfA,GAAS,GAEXuM,EAAMngB,SACC8T,EAAK6B,WAAW,QAAQtxB,YAAY,YAEtCkc,EAAIkK,IAAMA,GAGnB9T,EAAY5xB,UAAU67C,YAAc,SAASj9C,GAC3C,GAAImwC,GAAM/Z,CAcV,OAbY,OAARp2B,IACFA,EAAO,SAEJsB,KAAKk0B,OAAOmB,aAAaC,SAC5Bt1B,KAAKk0B,OAAOsB,QAEdV,EAAQ90B,KAAKk0B,OAAOiM,UAAUrL,QAC9BA,EAAMsF,iBACNp6B,KAAKk0B,OAAOiM,UAAUrL,MAAMA,GAC5B+Z,EAAOxe,EAAE,UAAUsN,KAAK,MAAOj/B,GAC/Bo2B,EAAM6D,WAAWkW,EAAK,IACtB7uC,KAAKk0B,OAAOiM,UAAUvH,cAAciW,EAAM/Z,GAC1C90B,KAAKk0B,OAAO4H,QAAQ,gBACb+S,GAGTnd,EAAY5xB,UAAU+1C,QAAU,SAASrQ,GACvC,GAAIqJ,EAEJ,OADAA,GAAO7uC,KAAK27C,cACL37C,KAAK87C,UAAUjN,EAAMrJ,GAAOxlC,KAAK2vC,aAAc,SAAUpb,GAC9D,MAAO,YAIL,MAHAA,GAAML,OAAO4H,QAAQ,gBACrBvH,EAAML,OAAOe,KAAK4S,OAAOgH,GACzBA,EAAKliC,QACE4nB,EAAMic,QAAQiK,IAAI,cAAe,WAEtC,MADAlmB,GAAMic,QAAQuL,MAAMvmB,QACbjB,EAAMic,QAAQuL,MAAM,GAAG74C,aAGjClD,QAGE0xB,GAENR,GAEHS,EAAe,SAAU6B,GAGvB,QAAS7B,KACP,MAAOA,GAAa0B,UAAUH,YAAYnzB,MAAMC,KAAMC,WA2OxD,MA9OA8yB,GAAOpB,EAAc6B,GAMrB7B,EAAa7xB,UAAUiG,QACrB8lC,IAAK,EACLL,SAGF7Z,EAAa7xB,UAAUw1C,OAAS,WAC9B,GAAIsF,EA4FJ,OA3FAA,GAAM,2EAAkF56C,KAAK60C,GAAG,YAAe,mIAAiJ70C,KAAK60C,GAAG,eAAkB,sJAA4J70C,KAAK60C,GAAG,YAAe,2IAAwJ70C,KAAK60C,GAAG,aAAgB,qQAA+R70C,KAAK60C,GAAG,oBAAuB,6GAC37B70C,KAAKwmB,GAAGnH,SAAS,iBAAiBuQ,OAAOgrB,GACzC56C,KAAK+7C,MAAQ/7C,KAAKwmB,GAAGrH,KAAK,cAC1Bnf,KAAKk9C,QAAUl9C,KAAKwmB,GAAGrH,KAAK,gBAC5Bnf,KAAKm9C,SAAWn9C,KAAKwmB,GAAGrH,KAAK,iBAC7Bnf,KAAKo9C,MAAQp9C,KAAKwmB,GAAGrH,KAAK,cAC1Bnf,KAAK+7C,MAAM51B,GAAG,UAAW,SAAUoO,GACjC,MAAO,UAASC,GACd,GAAIM,EACJ,IAAkB,KAAZN,EAAE6N,QAAiB9N,EAAMqiB,OAAO1Y,SAAS,aAM/C,MAHA1J,GAAE6M,iBACFvM,EAAQT,SAASyG,cACjBvG,EAAMrK,OAAOgK,OAAOiM,UAAUvH,cAAcrE,EAAMqiB,OAAQ9hB,GACnDP,EAAM7nB,SAEd1M,OACHA,KAAK+7C,MAAM51B,GAAG,OAAQ,SAAUoO,GAC9B,MAAO,UAASC,GACd,MAAOD,GAAM8oB,WAAW9oB,EAAMwnB,MAAMl+C,SAErCmC,OACHA,KAAKwmB,GAAGrH,KAAK,eAAegH,GAAG,OAAQ,SAAUoO,GAC/C,MAAO,UAASC,GAEd,MADAD,GAAM+oB,WAAWjtB,EAAEmE,EAAEhX,gBACd+W,EAAM/N,GAAGjvB,KAAK,WAAW6/C,YAEjCp3C,OACHA,KAAKwmB,GAAGrH,KAAK,eAAegH,GAAG,QAAS,SAAUoO,GAChD,MAAO,UAASC,GACd,GAAI+oB,EAEJ,IADAA,EAAUltB,EAAEmE,EAAEhX,eACI,KAAZgX,EAAE6N,OAA4B,KAAZ7N,EAAE6N,OAA4B,IAAZ7N,EAAE6N,MAC1C,MAAO9N,GAAM+oB,WAAWC,GAAS,KAGpCv9C,OACHA,KAAKwmB,GAAGrH,KAAK,eAAegH,GAAG,UAAW,SAAUoO,GAClD,MAAO,UAASC,GACd,GAAIqa,GAAM0O,EAASzoB,CAEnB,OADAyoB,GAAUltB,EAAEmE,EAAEhX,eACE,KAAZgX,EAAE6N,OAA4B,KAAZ7N,EAAE6N,OACtB7N,EAAE6M,iBACc,KAAZ7M,EAAE6N,MACJ9N,EAAM+oB,WAAWC,GAEjBhpB,EAAMipB,cAER3O,EAAOta,EAAMqiB,OACbriB,EAAM7nB,OACNooB,EAAQT,SAASyG,cACVvG,EAAMrK,OAAOgK,OAAOiM,UAAUvH,cAAciW,EAAM/Z,IACpC,IAAZN,EAAE6N,MACJ9N,EAAM/N,GAAGjvB,KAAK,WAAW6/C,UAD3B,SAIRp3C,OACHA,KAAKo9C,MAAMj3B,GAAG,UAAW,SAAUoO,GACjC,MAAO,UAASC,GACd,GAAIM,EACJ,IAAgB,KAAZN,EAAE6N,MAIJ,MAHA7N,GAAE6M,iBACFvM,EAAQT,SAASyG,cACjBvG,EAAMrK,OAAOgK,OAAOiM,UAAUvH,cAAcrE,EAAMqiB,OAAQ9hB,GACnDP,EAAM7nB,SAGhB1M,OACHA,KAAKo9C,MAAMj3B,GAAG,QAAS,SAAUoO,GAC/B,MAAO,UAASC,GACd,GAAgB,KAAZA,EAAE6N,OAA4B,KAAZ7N,EAAE6N,OAA4B,IAAZ7N,EAAE6N,MAI1C,MADA9N,GAAMkpB,IAAMlpB,EAAM6oB,MAAMv/C,MACjB02B,EAAMqiB,OAAOjZ,KAAK,MAAOpJ,EAAMkpB,OAEvCz9C,OACHA,KAAKwmB,GAAGrH,KAAK,gBAAgBgH,GAAG,QAAS,SAAUoO,GACjD,MAAO,UAASC,GAEd,MADAD,GAAMipB,cACCjpB,EAAM/N,GAAGjvB,KAAK,WAAW6/C,YAEjCp3C,OACHA,KAAKk0B,OAAO/N,GAAG,eAAgB,SAAUoO,GACvC,MAAO,UAASC,GACd,GAAID,EAAM6X,OACR,MAAO7X,GAAM6iB,YAGhBp3C,OACIA,KAAKo7C,iBAGdzpB,EAAa7xB,UAAUs7C,cAAgB,WACrC,GAAIsC,GAAYnC,CAEhB,OADAmC,GAAa19C,KAAKwmB,GAAGrH,KAAK,eACE,MAAxBnf,KAAKk0B,OAAOpD,aACd4sB,GAAW3iB,UAGbwgB,EAAc,SAAUhnB,GACtB,MAAO,YAIL,MAHIA,GAAMvxB,OACRuxB,EAAMvxB,MAAM+3B,SAEPxG,EAAMvxB,MAAQqtB,EAAE,YACrBh4B,KAAM,OACN+Z,MAAOmiB,EAAMsgB,GAAG,eAChBh/B,UAAU,EACV4lC,OAAQ,YACPjZ,SAASkb,KAEb19C,MACHu7C,IACAv7C,KAAKwmB,GAAGL,GAAG,kBAAmB,mBAAoB,SAASqO,GACzD,MAAOA,GAAEpO,oBAEJpmB,KAAKwmB,GAAGL,GAAG,SAAU,mBAAoB,SAAUoO,GACxD,MAAO,UAASC,GAKd,MAJAD,GAAML,OAAOpD,SAAS4d,OAAOna,EAAMvxB,OACjC04C,QAAQ,EACRpgB,IAAK/G,EAAMqiB,SAEN2E,MAERv7C,SAGL2xB,EAAa7xB,UAAUw9C,WAAa,SAASC,EAASI,GACpD,GAAI34B,GAAQplB,EAAO2rC,CAKnB,IAJkB,MAAdoS,IACFA,GAAa,GAEf/9C,EAAwB,EAAhB29C,EAAQ1/C,MACVmC,KAAK42C,SAAWvmB,EAAE8V,UAAUvmC,IAAUA,EAAQ,GAYpD,MATI29C,GAAQnnB,GAAGp2B,KAAKk9C,UAClB3R,EAAQ3rC,EACRolB,EAAShlB,KAAKglB,OAASplB,EAAQI,KAAKurC,MACpCvrC,KAAKm9C,SAASt/C,IAAImnB,KAElBA,EAASplB,EACT2rC,EAAQvrC,KAAKurC,MAAQ3rC,EAAQI,KAAKglB,OAClChlB,KAAKk9C,QAAQr/C,IAAI0tC,IAEdoS,EAAL,QACE39C,KAAK42C,OAAOjZ,MACV4N,MAAOA,EACPvmB,OAAQA,IAEHhlB,KAAKk0B,OAAO4H,QAAQ,kBAI/BnK,EAAa7xB,UAAU09C,YAAc,WACnC,GAAIrgB,GAAK9Q,CAQT,OAPAA,IAAkD,OAAzC8Q,EAAMn9B,KAAK42C,OAAOr/C,KAAK,eAAyB4lC,EAAIhhC,MAAM,KAAO,UAAY6D,KAAKurC,MAAOvrC,KAAKglB,QACvGhlB,KAAK42C,OAAOjZ,MACV4N,MAAiB,EAAVlf,EAAK,GACZrH,OAAkB,EAAVqH,EAAK,KAEfrsB,KAAKk9C,QAAQr/C,IAAIwuB,EAAK,IACtBrsB,KAAKm9C,SAASt/C,IAAIwuB,EAAK,IAChBrsB,KAAKk0B,OAAO4H,QAAQ,iBAG7BnK,EAAa7xB,UAAUu9C,WAAa,SAAS7X,EAAKmJ,GAChD,GAAI,cAAcxlB,KAAKqc,KAASxlC,KAAKk0B,OAAOpD,SAI1C,YAHI6d,GACFA,GAAS,GAIb,IAAI3uC,KAAK42C,OAAOjZ,KAAK,SAAW6H,EAGhC,MAAOxlC,MAAKkqB,OAAO4xB,UAAU97C,KAAK42C,OAAQpR,EAAK,SAAUjR,GACvD,MAAO,UAAS+G,GACd,GAAIwT,EACJ,IAAKxT,EAmBL,MAhBI/G,GAAM6X,SACR7X,EAAMgX,MAAQjQ,EAAIiQ,MAClBhX,EAAMvP,OAASsW,EAAItW,OACnBuP,EAAM2oB,QAAQr/C,IAAI02B,EAAMgX,OACxBhX,EAAM4oB,SAASt/C,IAAI02B,EAAMvP,SAEvB,cAAcmE,KAAKqc,IACrBsJ,EAAOva,EAAML,OAAOe,KAAKiT,cAAc1C,GACvCsJ,EAAKpwC,KAAO,mBACZ61B,EAAML,OAAOpD,SAAS4d,OAAOI,GAC3B4M,QAAQ,EACRpgB,IAAK/G,EAAMqiB,UAGbriB,EAAML,OAAO4H,QAAQ,gBAEnB6S,EACKA,EAASrT,GADlB,SAIDt7B,QAGL2xB,EAAa7xB,UAAUtD,KAAO,WAC5B,GAAIqyC,GAAMlF,CAOV,OANAA,GAAO,GAAK1pC,UAAU7H,OAASm7B,EAAMH,KAAKnzB,UAAW,MACrD0xB,EAAa0B,UAAU72B,KAAKuD,MAAMC,KAAM2pC,GACxCkF,EAAO7uC,KAAK42C,OACZ52C,KAAKurC,MAAQsD,EAAKtD,QAClBvrC,KAAKglB,OAAS6pB,EAAK7pB,SACnBhlB,KAAKy9C,IAAM5O,EAAKlR,KAAK,OACjBkR,EAAK3Q,SAAS,aACTl+B,KAAK+7C,MAAMl+C,IAAImC,KAAK60C,GAAG,cAAcmH,KAAK,YAAY,IAE7Dh8C,KAAK+7C,MAAMl+C,IAAIgxC,EAAKlR,KAAK,QAAQqe,KAAK,YAAY,GAClDh8C,KAAKk9C,QAAQr/C,IAAImC,KAAKurC,OACtBvrC,KAAKm9C,SAASt/C,IAAImC,KAAKglB,QAChBhlB,KAAKo9C,MAAMv/C,IAAImC,KAAKy9C,OAIxB9rB,GAENW,GAEHE,EAASI,QAAQoZ,UAAUta,GAE3BE,EAAe,SAAU4B,GAGvB,QAAS5B,KACP,MAAOA,GAAayB,UAAUH,YAAYnzB,MAAMC,KAAMC,WAkBxD,MArBA8yB,GAAOnB,EAAc4B,GAMrB5B,EAAa9xB,UAAUpB,KAAO,SAE9BkzB,EAAa9xB,UAAUyO,KAAO,SAE9BqjB,EAAa9xB,UAAUm0B,MAAQ,WAE7B,MADAj0B,MAAKoS,MAAQpS,KAAK60C,GAAG70C,KAAKtB,MAAQ,SAC3BkzB,EAAayB,UAAUY,MAAMb,KAAKpzB,OAG3C4xB,EAAa9xB,UAAUo2C,QAAU,aAEjCtkB,EAAa9xB,UAAU+1C,QAAU,WAC/B,MAAO71C,MAAKk0B,OAAO0pB,YAAYvR,UAG1Bza,GAENV,GAEHsB,EAASI,QAAQoZ,UAAUpa,GAE3BS,EAAgB,SAAUmB,GAGxB,QAASnB,KACP,MAAOA,GAAcgB,UAAUH,YAAYnzB,MAAMC,KAAMC,WAkBzD,MArBA8yB,GAAOV,EAAemB,GAMtBnB,EAAcvyB,UAAUpB,KAAO,UAE/B2zB,EAAcvyB,UAAUyO,KAAO,UAE/B8jB,EAAcvyB,UAAUm0B,MAAQ,WAE9B,MADAj0B,MAAKoS,MAAQpS,KAAK60C,GAAG70C,KAAKtB,MAAQ,iBAC3B2zB,EAAcgB,UAAUY,MAAMb,KAAKpzB,OAG5CqyB,EAAcvyB,UAAUo2C,QAAU,aAElC7jB,EAAcvyB,UAAU+1C,QAAU,WAChC,MAAO71C,MAAKk0B,OAAO0pB,YAAYvR,QAAO,IAGjCha,GAENnB,GAEHsB,EAASI,QAAQoZ,UAAU3Z,GAE3BZ,EAAW,SAAU+B,GAGnB,QAAS/B,KACP,MAAOA,GAAS4B,UAAUH,YAAYnzB,MAAMC,KAAMC,WA8BpD,MAjCA8yB,GAAOtB,EAAU+B,GAMjB/B,EAAS3xB,UAAUpB,KAAO,KAE1B+yB,EAAS3xB,UAAUyO,KAAO,QAE1BkjB,EAAS3xB,UAAUk1C,QAAU,KAE7BvjB,EAAS3xB,UAAUo2C,QAAU,aAE7BzkB,EAAS3xB,UAAU+1C,QAAU,WAC3B,GAAIgI,GAAKtD,EAAWuD,EAAYva,CAehC,OAdAA,GAAavjC,KAAKk0B,OAAOiM,UAAU9I,YAAYlB,QAC/C2nB,EAAava,EAAW9lB,OACpBqgC,EAAW1lD,OAAS,EACtB4H,KAAKk0B,OAAOiM,UAAU93B,OAEtBkyC,EAAYlqB,EAAE,QAAQT,OAAO5vB,KAAKk0B,OAAOe,KAAK0E,MAEhDkkB,EAAMxtB,EAAE,SAASmQ,YAAY+C,GACzBgX,GACFA,EAAU/Z,YAAYqd,GACtB79C,KAAKk0B,OAAOiM,UAAUlH,kBAAkBshB,IAExCv6C,KAAKk0B,OAAOiM,UAAUtF,UAEjB76B,KAAKk0B,OAAO4H,QAAQ,iBAGtBrK,GAENP,GAEHsB,EAASI,QAAQoZ,UAAUva,GAE3BiB,EAAc,SAAUc,GAGtB,QAASd,KACP,MAAOA,GAAYW,UAAUH,YAAYnzB,MAAMC,KAAMC,WA8hBvD,MAjiBA8yB,GAAOL,EAAac,GAMpBd,EAAY5yB,UAAUpB,KAAO,QAE7Bg0B,EAAY5yB,UAAUyO,KAAO,QAE7BmkB,EAAY5yB,UAAUk1C,QAAU,QAEhCtiB,EAAY5yB,UAAUm1C,WAAa,sBAEnCviB,EAAY5yB,UAAUye,MAAO,EAE7BmU,EAAY5yB,UAAUm0B,MAAQ,WAsE5B,MArEAvB,GAAYW,UAAUY,MAAMb,KAAKpzB,MACjCqwB,EAAE2G,MAAMh3B,KAAKk0B,OAAOoM,UAAUlF,cAAe,QAAS,KAAM,QAAS,KAAM,KAAM,WAAY,QAC7F/K,EAAE0C,OAAO/yB,KAAKk0B,OAAOoM,UAAUjF,oBAC7BiX,OAAQ,SACRyL,IAAK,UAAW,UAAW,SAC3BC,KAAM,WAER3tB,EAAE0C,OAAO/yB,KAAKk0B,OAAOoM,UAAU9E,gBAC7BuiB,IAAK,cACLE,IAAK,gBAEPj+C,KAAKk+C,iBACLl+C,KAAKk0B,OAAO/N,GAAG,WAAY,SAAUoO,GACnC,MAAO,UAASC,EAAG8F,GACjB,MAAOA,GAAInb,KAAK,SAASkX,KAAK,SAASl+B,EAAGm6C,GACxC,MAAO/d,GAAMsH,SAASxL,EAAEiiB,QAG3BtyC,OACHA,KAAKk0B,OAAO/N,GAAG,aAAc,SAAUoO,GACrC,MAAO,UAASC,EAAG8F,GACjB,MAAOA,GAAInb,KAAK,SAASkX,KAAK,SAASl+B,EAAGm6C,GACxC,MAAO/d,GAAMwH,WAAW1L,EAAEiiB,QAG7BtyC,OACHA,KAAKk0B,OAAO/N,GAAG,yBAA0B,SAAUoO,GACjD,MAAO,UAASC,GACd,GAAI2pB,GAAYrpB,CAGhB,IAFAP,EAAML,OAAOqB,KAAKpW,KAAK,0CAA0CC,YAAY,UAC7E0V,EAAQP,EAAML,OAAOiM,UAAUrL,QAa/B,MATAqpB,GAAa5pB,EAAML,OAAOiM,UAAUnK,gBAChClB,EAAMgB,WAAaqoB,EAAW/nB,GAAG,qBAEjC+nB,EADE5pB,EAAML,OAAOiM,UAAU3H,eAAe2lB,GAC3BA,EAAWh/B,KAAK,YAEhBg/B,EAAWh/B,KAAK,WAE/BoV,EAAML,OAAOiM,UAAUhH,gBAAgBglB,IAElCA,EAAWvhB,QAAQ,SAAUrI,EAAML,OAAOqB,MAAMlW,SAAS,YAEjErf,OACHA,KAAKk0B,OAAO/N,GAAG,aAAc,SAAUoO,GACrC,MAAO,UAASC,GACd,MAAOD,GAAML,OAAOqB,KAAKpW,KAAK,0CAA0CC,YAAY,YAErFpf,OACHA,KAAKk0B,OAAOkO,UAAUhB,IAAI,KAAM,KAAM,SAAU7M,GAC9C,MAAO,UAASC,EAAGgC,GAEjB,MADAjC,GAAM6pB,OAAO5nB,EAAO,OACb,IAERx2B,OACHA,KAAKk0B,OAAOkO,UAAUhB,IAAI,KAAM,KAAM,SAAU7M,GAC9C,MAAO,UAASC,EAAGgC,GAEjB,MADAjC,GAAM6pB,OAAO5nB,EAAO,OACb,IAERx2B,OACHA,KAAKk0B,OAAOkO,UAAUhB,IAAI,OAAQ,KAAM,SAAU7M,GAChD,MAAO,UAASC,EAAGgC,GAEjB,MADAjC,GAAM6pB,OAAO5nB,EAAO,SACb,IAERx2B,OACIA,KAAKk0B,OAAOkO,UAAUhB,IAAI,OAAQ,KAAM,SAAU7M,GACvD,MAAO,UAASC,EAAGgC,GAEjB,MADAjC,GAAM6pB,OAAO5nB,EAAO,SACb,IAERx2B,QAGL0yB,EAAY5yB,UAAUs+C,OAAS,SAASzuB,EAAK0uB,GAC3C,GAAIC,GAAYpR,EAAKqR,EAAQC,EAAYnhD,EAAOohD,EAAWthB,CAQ3D,OAPiB,OAAbkhB,IACFA,EAAY,MAEdE,EAAuB,OAAdF,EAAqB,OAAS,OACvClhB,EAAoB,OAAdkhB,GAAsB,QAAS,UAAY,QAAS,SAAUI,EAAYthB,EAAI,GAAIqhB,EAAarhB,EAAI,GACzG+P,EAAMvd,EAAIrQ,OAAO,MACjBg/B,EAAat+C,KAAK,IAAMu+C,EAAS,OAAOrR,GAClCoR,EAAWlmD,OAAS,GAO1BiF,EAAQ6vC,EAAI/tB,KAAK,UAAU9hB,MAAMsyB,GAC9B2uB,EAAWn/B,KAAK,UAAU/mB,OAAO,EAAEiF,IAAOA,EAAQihD,EAAWn/B,KAAK,SAAS/mB,OAAO,GAC9E4H,KAAKk0B,OAAOiM,UAAUhH,gBAAgBmlB,EAAWn/B,KAAK,UAAU0X,GAAGx5B,KARxD,MAAXghD,EACQr+C,KAAKk0B,OAAOiM,UAAUhH,gBAAgB+T,EAAI5tB,SAASA,SAASA,SAASC,QAClE,QAAX8+B,GACQr+C,KAAKk0B,OAAOiM,UAAUhH,gBAAgB+T,EAAI5tB,SAASA,SAASA,SAAS7B,SAQtFiV,EAAY5yB,UAAU4+C,SAAW,SAASxR,GACxC,GAAIH,EAKJ,OAJAA,GAAUG,EAAIzvB,KAAK,MACfsvB,EAAQ30C,OAAS,GAAK80C,EAAI5tB,OAAO,SAASlnB,OAAS,IACrD20C,EAAUG,EAAI5tB,OAAO,SAAS7B,KAAK,SAAS0B,KAAK,aAE5C4tB,GAGTra,EAAY5yB,UAAU6+C,SAAW,SAASzR,GACxC,GAAIO,EAKJ,OAJAA,GAAUP,EAAI3tB,KAAK,MACfkuB,EAAQr1C,OAAS,GAAK80C,EAAI5tB,OAAO,SAASlnB,OAAS,IACrDq1C,EAAUP,EAAI5tB,OAAO,SAASC,KAAK,SAASJ,KAAK,OAE5CsuB,GAGT/a,EAAY5yB,UAAU8+C,WAAa,SAASC,GAC1C,GAAIC,GAAWC,EAAeC,CAG9B,IAFAA,EAAWH,EAAOv/B,OAAO,mBACzBw/B,EAAYD,EAAO1/B,KAAK,YACpB2/B,EAAU1mD,OAAS,EAAG,CACxB0mD,EAAYzuB,EAAE,eAAeyb,UAAU+S,EAEvC,IAAII,GAASC,EAAQC,CACrBD,GAAS,EACTL,EAAO1/B,KAAK,YAAYkX,KAAK,SAASl+B,EAAGsmC,GACrCwgB,EAAU5uB,EAAEoO,GAAItf,KAAK,MAAM/mB,OACxB6mD,EAAQC,IACPC,EAAO9uB,EAAEoO,GACTygB,EAASD,KAGjBE,EAAKhgC,KAAK,MAAMkX,KAAK,SAASl+B,EAAG4lD,GAC/B,GAAIqB,EACJ,OAAOA,GAAO/uB,EAAE,UAAUmS,SAASsc,KAErC9+C,KAAKq/C,kBAAkBR,GAmCzB,MAjCAE,GAAgB1uB,EAAE,WAChBivB,QAAS;AACTC,gBAAiB,UAChB/c,SAASwc,GACZA,EAAS74B,GAAG,YAAa,SAAU,SAASqO,GAC1C,GAAI4qB,GAAMzvB,EAAKtyB,EAAO8/B,EAAKC,EAAMnS,CACjC,KAAI+zB,EAAS9gB,SAAS,YAQtB,MALAvO,GAAMU,EAAEmE,EAAEhX,eACVyN,EAAIuJ,EAAEgrB,MAAQnvB,EAAEmE,EAAEhX,eAAezX,SAASylC,KACtCvgB,EAAI,GAAK0E,EAAIpQ,OAAOnnB,OAAS,IAC/Bu3B,EAAMA,EAAIpQ,QAERoQ,EAAIlS,KAAK,UAAUrlB,OAAS,MAC9B2mD,GAAcryC,QAGwB,OAAnCywB,EAAM4hB,EAAcxnD,KAAK,OAAiB4lC,EAAI/G,GAAGzG,GAAO,YAC3DovB,GAAcviD,QAGhBa,EAAQsyB,EAAIrQ,SAASH,KAAK,UAAU9hB,MAAMsyB,GAC1CyvB,EAAON,EAAU3/B,KAAK,OAAO0X,GAAGx5B,IACU,OAArC+/B,EAAO2hB,EAAcxnD,KAAK,QAAkB6lC,EAAKhH,GAAGgpB,GAAQ,YAC/DL,GAAcviD,OAGTuiD,EAAchvB,IAAI,OAAQJ,EAAI0W,WAAWmF,KAAO7b,EAAIjD,aAAe,GAAGn1B,KAAK,KAAMo4B,GAAKp4B,KAAK,MAAO6nD,GAAM5iD,UAEjHwiD,EAAS74B,GAAG,aAAc,SAASqO,GACjC,MAAOuqB,GAAcryC,SAEhBsyC,EAAS74B,GAAG,YAAa,0BAA2B,SAASqO,GAClE,GAAIirB,GAASC,EAAUC,EAASC,EAAWC,EAAUC,EAAUC,EAAiBC,EAAgBC,EAAiBC,EAAQC,CAmCzH,OAlCAV,GAAUpvB,EAAEmE,EAAEhX,eACdmiC,EAAUF,EAAQloD,KAAK,MACvBmoD,EAAWD,EAAQloD,KAAK,OACxBsoD,EAAWF,EAAQliC,KAAK,UACxBmiC,EAAYF,EAASjiC,KAAK,OAC1ByiC,EAAS1rB,EAAEgrB,MACXQ,EAAwC,EAAvBL,EAAQjzB,aACzBuzB,EAA0C,EAAxBJ,EAASnzB,aAC3BqzB,EAAkBvtC,WAAWitC,EAAQ1vB,IAAI,SACzCowB,EAAaR,EAAQ/iB,QAAQ,SAAS2O,QACtCuU,EAAW,GACXzvB,EAAEgE,UAAUlO,GAAG,kCAAmC,SAASqO,GACzD,GAAI4rB,GAAQC,EAAWC,CAevB,OAdAF,GAAS5rB,EAAEgrB,MAAQU,EACnBG,EAAYL,EAAiBI,EAC7BE,EAAaL,EAAkBG,EAC3BC,EAAYP,GACdO,EAAYP,EACZM,EAASN,EAAWE,EACpBM,EAAaL,EAAkBG,GACtBE,EAAaR,IACtBQ,EAAaR,EACbM,EAASH,EAAkBH,EAC3BO,EAAYL,EAAiBI,GAE/BV,EAAS/hB,KAAK,QAAU0iB,EAAYF,EAAa,IAAO,KACxDP,EAAUjiB,KAAK,QAAU2iB,EAAaH,EAAa,IAAO,KACnDV,EAAQ1vB,IAAI,OAAQgwB,EAAkBK,KAE/C/vB,EAAEgE,UAAUomB,IAAI,gCAAiC,SAASjmB,GAExD,MADAnE,GAAEgE,UAAUoc,IAAI,0BACTuO,EAAS5/B,YAAY,cAE9B4/B,EAAS3/B,SAAS,aACX,KAIXqT,EAAY5yB,UAAUo+C,eAAiB,WAmBrC,MAlBAl+C,MAAKk0B,OAAOrD,QAAQuQ,IAAI,cAAe,SAAU7M,GAC/C,MAAO,UAASC,GAEd,MADAD,GAAM8kB,SAASl6B,KAAK,yCAAyCxS,SACtD,IAER3M,OACHA,KAAKk0B,OAAOrD,QAAQuQ,IAAI,gBAAiB,SAAU7M,GACjD,MAAO,UAASC,GAEd,MADAD,GAAM8kB,SAASl6B,KAAK,yCAAyCxS,SACtD,IAER3M,OACHA,KAAKk0B,OAAOrD,QAAQuQ,IAAI,gBAAiB,SAAU7M,GACjD,MAAO,UAASC,GAEd,MADAD,GAAM8kB,SAASl6B,KAAK,wCAAwCxS,SACrD,IAER3M,OACIA,KAAKk0B,OAAOrD,QAAQuQ,IAAI,iBAAkB,SAAU7M,GACzD,MAAO,UAASC,GAEd,MADAD,GAAM8kB,SAASl6B,KAAK,yCAAyCxS,SACtD,IAER3M,QAGL0yB,EAAY5yB,UAAU+7B,SAAW,SAASgjB,GAOxC,MALIA,GAAOv/B,OAAO,mBAAmBlnB,OAAS,GAC5C4H,KAAK+7B,WAAW8iB,GAElBA,EAAO0B,KAAK,sCACZvgD,KAAK4+C,WAAWC,GACTA,EAAOv/B,UAGhBoT,EAAY5yB,UAAUi8B,WAAa,SAAS8iB,GAC1C,GAAMA,EAAOv/B,OAAO,mBAAmBlnB,OAAS,EAGhD,MAAOymD,GAAOv/B,SAAS0d,YAAY6hB,IAGrCnsB,EAAY5yB,UAAUu2C,WAAa,WACjC,GAAIwI,EAsBJ,OArBAxuB,GAAE,4NAA6OrwB,KAAK60C,GAAG,aAAgB,iLAA8L70C,KAAK60C,GAAG,kBAAqB,oMAAiN70C,KAAK60C,GAAG,kBAAqB,6OAA4P70C,KAAK60C,GAAG,gBAAmB,gLAA6L70C,KAAK60C,GAAG,oBAAuB,oMAAiN70C,KAAK60C,GAAG,qBAAwB,4OAA2P70C,KAAK60C,GAAG,YAAe,0KAAuL70C,KAAK60C,GAAG,aAAgB,8KAA2L70C,KAAK60C,GAAG,eAAkB,6KAA0L70C,KAAK60C,GAAG,gBAAmB,2KAAwL70C,KAAK60C,GAAG,aAAgB,8KAA2L70C,KAAK60C,GAAG,gBAAmB,2NAA0O70C,KAAK60C,GAAG,eAAkB,mDAAmDrS,SAASxiC,KAAK80C,aAC1iG90C,KAAKo5C,WAAap5C,KAAK80C,YAAY31B,KAAK,sBACxCnf,KAAKq5C,SAAWr5C,KAAK80C,YAAY31B,KAAK,oBACtC0/B,EAAS7+C,KAAKwgD,YAAY,EAAG,GAAGhe,SAASxiC,KAAKo5C,YAC9Cp5C,KAAKo5C,WAAWjzB,GAAG,aAAc,SAAU,SAAUoO,GACnD,MAAO,UAASC,GACd,GAAI7E,GAAKud,EAAKuT,EAAMrkD,CASpB,OARAm4B,GAAM6kB,WAAWj6B,KAAK,UAAUC,YAAY,YAC5CuQ,EAAMU,EAAEmE,EAAEhX,eACV0vB,EAAMvd,EAAIrQ,SACVljB,EAAM8wC,EAAI/tB,KAAK,UAAU9hB,MAAMsyB,GAAO,EACtC8wB,EAAOvT,EAAIwT,QAAQ,MAAMzoB,UACrBiV,EAAI5tB,SAAS8W,GAAG,WAClBqqB,EAAOA,EAAKrf,IAAIyd,EAAO1/B,KAAK,cAEvBshC,EAAKthC,KAAK,SAAW/iB,EAAM,YAAcA,EAAM,KAAKijB,SAAS,cAErErf,OACHA,KAAKo5C,WAAWjzB,GAAG,aAAc,SAASqO,GACxC,MAAOnE,GAAEmE,EAAEhX,eAAe2B,KAAK,UAAUC,YAAY,cAEhDpf,KAAKo5C,WAAWjzB,GAAG,YAAa,KAAM,SAAUoO,GACrD,MAAO,UAASC,GACd,GAAIyP,GAAetU,EAAKud,EAAKyT,EAAQC,CAErC,IADArsB,EAAMwW,QAAQ3rB,YAAY,WACrBmV,EAAML,OAAOmB,aAAaC,QAoB/B,MAjBA3F,GAAMU,EAAEmE,EAAEhX,eACV0vB,EAAMvd,EAAIrQ,SACVqhC,EAASzT,EAAI/tB,KAAK,MAAM9hB,MAAMsyB,GAAO,EACrCixB,EAAS1T,EAAIwT,QAAQ,MAAMtoD,OAAS,EAChC80C,EAAI5tB,SAAS8W,GAAG,WAClBwqB,GAAU,GAEZ/B,EAAStqB,EAAMisB,YAAYI,EAAQD,GAAQ,GAC3C1c,EAAgB1P,EAAML,OAAOiM,UAAUjJ,aAAaJ,OAChDvC,EAAML,OAAOe,KAAKyE,YAAYuK,GAChCA,EAAcjH,YAAY6hB,GAE1B5a,EAAcH,MAAM+a,GAEtBtqB,EAAMsH,SAASgjB,GACftqB,EAAML,OAAOiM,UAAUlH,kBAAkB4lB,EAAO1/B,KAAK,aACrDoV,EAAML,OAAO4H,QAAQ,iBACd,IAER97B,QAGL0yB,EAAY5yB,UAAU0gD,YAAc,SAASnkD,EAAK2hD,EAAKrkB,GACrD,GAAIklB,GAAQgC,EAAQlxB,EAAaud,EAAK4L,EAAGt/C,EAAG85B,EAAGqZ,EAAGxP,EAAKC,CAGvD,KAFAyhB,EAASxuB,EAAE,YACXwwB,EAASxwB,EAAE,YAAYmS,SAASqc,GAC3BlS,EAAInzC,EAAI,EAAG2jC,EAAM9gC,EAAK,GAAK8gC,EAAM3jC,EAAI2jC,EAAM3jC,EAAI2jC,EAAKwP,EAAI,GAAKxP,IAAQ3jC,IAAMA,EAG9E,IAFA0zC,EAAM7c,EAAE,SACR6c,EAAI1K,SAASqe,GACR/H,EAAIxlB,EAAI,EAAG8J,EAAO4gB,EAAK,GAAK5gB,EAAO9J,EAAI8J,EAAO9J,EAAI8J,EAAM0b,EAAI,GAAK1b,IAAS9J,IAAMA,EACnF3D,EAAMU,EAAE,SAASmS,SAAS0K,GACtBvT,GACFhK,EAAIC,OAAO5vB,KAAKk0B,OAAOe,KAAK0E,KAIlC,OAAOklB,IAGTnsB,EAAY5yB,UAAUu/C,kBAAoB,SAASR,GACjD,GAAIiC,GAAMX,CACVA,GAAatB,EAAOtT,QACpBuV,EAAOjC,EAAO1/B,KAAK,MAGnB,IAAI8/B,GAASC,EAAQC,CAUrB,OATAD,GAAS,EACTL,EAAO1/B,KAAK,YAAYkX,KAAK,SAASl+B,EAAGsmC,GACrCwgB,EAAU5uB,EAAEoO,GAAItf,KAAK,MAAM/mB,OACxB6mD,EAAQC,IACPC,EAAO9uB,EAAEoO,GACTygB,EAASD,KAIVE,EAAKhgC,KAAK,MAAMkX,KAAK,SAASl+B,EAAG4lD,GACtC,GAAIqB,GAAM2B,CAGV,OAFA3B,GAAO0B,EAAKjqB,GAAG1+B,GACf4oD,EAAgC,kBAAlB1wB,GAAE0tB,GAAIrxB,WAAyB,IAAIo0B,EAAK1oD,OAA8B,GAApBi4B,EAAE0tB,GAAIrxB,aAAkB,IAAIo0B,EAAK1oD,OAAQ,EAAKs0B,aAAeyzB,EAAa,IACnIf,EAAKzhB,KAAK,QAASojB,EAAM,QAIpCruB,EAAY5yB,UAAUi2C,UAAY,SAAS3J,GAEzC,MADA1Z,GAAYW,UAAU0iB,UAAU3iB,KAAKpzB,KAAMosC,GACvCA,GACFpsC,KAAKo5C,WAAW1sC,OACT1M,KAAKq5C,SAAS78C,SAErBwD,KAAKo5C,WAAW58C,OACTwD,KAAKq5C,SAAS3sC,SAIzBgmB,EAAY5yB,UAAUkhD,eAAiB,SAAS9T,EAAK/O,GACnD,MAAO+O,GAAI/tB,KAAK,UAAUkX,KAAK,SAASl+B,EAAG8oD,GACzC,GAAIC,EAEJ,OADAA,GAAQ7wB,EAAE4wB,GACHC,EAAMlkB,YAAY,IAAMmB,EAAU,IAAO+iB,EAAMr2C,OAAU,KAAOszB,EAAU,QAIrFzL,EAAY5yB,UAAUsqB,UAAY,SAASuF,GACzC,GAAIwxB,GAAQjU,EAAK7vC,CAEjB,OADA6vC,GAAMvd,EAAIrQ,OAAO,MACb4tB,EAAItQ,QAAQ,SAASzd,KAAK,MAAM/mB,OAAS,EACpC4H,KAAK4yC,YAAYjjB,IAExBwxB,EAASnhD,KAAK0+C,SAASxR,GACjBiU,EAAO/oD,OAAS,IACpB+oD,EAASnhD,KAAK2+C,SAASzR,IAEzB7vC,EAAQ6vC,EAAI/tB,KAAK,UAAU9hB,MAAMsyB,GAC7Bud,EAAI5tB,SAAS8W,GAAG,WAClB+qB,EAAO3e,SAAS0K,EAAI5tB,UACpBtf,KAAKghD,eAAeG,EAAQ,OAEa,GAAxCA,EAAOhiC,KAAK,UAAU0X,GAAGx5B,GAAOjF,OAAkB4H,KAAK4yC,YAAYjjB,IACtEud,EAAInS,SACG/6B,KAAKk0B,OAAOiM,UAAUhH,gBAAgBgoB,EAAOhiC,KAAK,UAAU0X,GAAGx5B,OAI1Eq1B,EAAY5yB,UAAUshD,UAAY,SAASzxB,EAAK0uB,GAC9C,GAAI8C,GAAQtC,EAAQ3R,EAAKmU,EAASV,EAAQxoD,EAAGkF,EAAO7D,EAAG2jC,CAuBvD,KAtBiB,MAAbkhB,IACFA,EAAY,SAEdnR,EAAMvd,EAAIrQ,OAAO,MACjBu/B,EAAS3R,EAAItQ,QAAQ,SACrB+jB,EAAS,EACT9B,EAAO1/B,KAAK,MAAMkX,KAAK,SAASl+B,EAAGsmC,GACjC,MAAOkiB,GAAS7rC,KAAK2J,IAAIkiC,EAAQtwB,EAAEoO,GAAItf,KAAK,MAAM/mB,UAEpDiF,EAAQ6vC,EAAI/tB,KAAK,UAAU9hB,MAAMsyB,GACjCwxB,EAAS9wB,EAAE,SACXgxB,EAAU,KACQ,UAAdhD,GAAyBnR,EAAI5tB,SAAS8W,GAAG,SAC3C8W,EAAI5tB,SAAS7B,KAAK,SAAS6jC,QAAQH,GACZ,WAAd9C,GAA0BnR,EAAI5tB,SAAS8W,GAAG,UACnD8W,EAAI1S,OAAO2mB,GACXjU,EAAI5tB,SAAS7B,KAAK,SAAS6jC,QAAQpU,GACnCltC,KAAKghD,eAAe9T,EAAK,MACzBmU,EAAU,MAEVnU,EAAImR,GAAW8C,GAEZhpD,EAAIqB,EAAI,EAAG2jC,EAAMwjB,EAAQ,GAAKxjB,EAAM3jC,GAAK2jC,EAAM3jC,GAAK2jC,EAAKhlC,EAAI,GAAKglC,IAAQ3jC,IAAMA,EACnF62B,EAAE,IAAMgxB,EAAU,MAAMzxB,OAAO5vB,KAAKk0B,OAAOe,KAAK0E,MAAM6I,SAAS2e,EAEjE,OAAOnhD,MAAKk0B,OAAOiM,UAAUlH,kBAAkBkoB,EAAOhiC,KAAK,UAAU0X,GAAGx5B,KAG1Eq1B,EAAY5yB,UAAUyhD,UAAY,SAAS5xB,GACzC,GAAI6xB,GAAQ3C,EAAQ3R,EAAK7vC,EAAOokD,EAAYC,CAI5C,OAHAxU,GAAMvd,EAAIrQ,OAAO,MACjBoiC,EAAaxU,EAAItQ,QAAQ,SAASzd,KAAK,MAAM/mB,OAAS,EACtDqpD,EAAa9xB,EAAIgmB,SAAS,UAAUv9C,OAAS,EACzCspD,GAAcD,EACTzhD,KAAK4yC,YAAYjjB,GACW,GAA3Bud,EAAI/tB,KAAK,UAAU/mB,OACpB4H,KAAK4yC,YAAYjjB,IAExBtyB,EAAQ6vC,EAAI/tB,KAAK,UAAU9hB,MAAMsyB,GACjC6xB,EAAqC,GAA3B7xB,EAAIlS,KAAK,UAAUrlB,OAAYu3B,EAAIlS,KAAK,UAAWkS,EACvD6xB,EAAOppD,OAAS,IACpBopD,EAAStU,EAAI3tB,KAAK,WAEpBs/B,EAAS3R,EAAItQ,QAAQ,SACrBiiB,EAAO1/B,KAAK,OAAO0X,GAAGx5B,GAAO09B,SAC7B8jB,EAAO1/B,KAAK,MAAMkX,KAAK,SAASl+B,EAAGsmC,GACjC,MAAOpO,GAAEoO,GAAItf,KAAK,UAAU0X,GAAGx5B,GAAO09B,WAExC/6B,KAAKq/C,kBAAkBR,GAChB7+C,KAAKk0B,OAAOiM,UAAUhH,gBAAgBqoB,KAIjD9uB,EAAY5yB,UAAU6hD,UAAY,SAAShyB,EAAK0uB,GAC9C,GAAIe,GAAMwC,EAASJ,EAAQ3C,EAAQ3R,EAAK7vC,EAAO8iD,EAAY5U,CAwB3D,OAvBiB,OAAb8S,IACFA,EAAY,SAEdnR,EAAMvd,EAAIrQ,OAAO,MACjBjiB,EAAQ6vC,EAAI/tB,KAAK,UAAU9hB,MAAMsyB,GACjCkvB,EAASlvB,EAAIiN,QAAQ,SACrBwiB,EAAOP,EAAO1/B,KAAK,OAAO0X,GAAGx5B,GAC7BwhD,EAAO1/B,KAAK,MAAMkX,KAAK,SAAU9B,GAC/B,MAAO,UAASp8B,EAAGsmC,GACjB,GAAI+iB,GAAQH,CAGZ,OAFAA,GAAUhxB,EAAEoO,GAAInf,SAAS8W,GAAG,SAAW,KAAO,KAC9CorB,EAASnxB,EAAE,IAAMgxB,EAAU,MAAMzxB,OAAO2E,EAAML,OAAOe,KAAK0E,MACnDtJ,EAAEoO,GAAItf,KAAK,UAAU0X,GAAGx5B,GAAOghD,GAAWmD,KAElDxhD,OACH4hD,EAAUvxB,EAAE,UACZ+uB,EAAKf,GAAWuD,GAChBzB,EAAatB,EAAOtT,QACpBA,EAAQz2B,KAAK2J,IAAIjM,WAAW4sC,EAAKzhB,KAAK,UAAY,EAAG,GAAKwiB,EAAa,KACvEf,EAAKzhB,KAAK,QAAS4N,EAAQ,KAC3BqW,EAAQjkB,KAAK,QAAS4N,EAAQ,KAC9BvrC,KAAKq/C,kBAAkBR,GACvB2C,EAAuB,UAAdnD,EAAwB1uB,EAAIlS,KAAK,UAAYkS,EAAIpQ,KAAK,UACxDvf,KAAKk0B,OAAOiM,UAAUlH,kBAAkBuoB,IAGjD9uB,EAAY5yB,UAAU8yC,YAAc,SAASjjB,GAC3C,GAAIkyB,GAAQhD,CAKZ,IAJAA,EAASlvB,EAAIiN,QAAQ,mBACrBilB,EAAShD,EAAOphC,KAAK,KACrBokC,EAAOh3C,KAAK,QACZg0C,EAAO9jB,SACH8mB,EAAOzpD,OAAS,EAClB,MAAO4H,MAAKk0B,OAAOiM,UAAUlH,kBAAkB4oB,IAKnDnvB,EAAY5yB,UAAU6zC,UAAY,SAAShkB,GAAOA,EAAItQ,SAAS,WAC/DqT,EAAY5yB,UAAU4zC,SAAW,SAAS/jB,GAAOA,EAAIrQ,OAAO,MAAMH,KAAK,MAAMkX,KAAK,SAAUl+B,EAAG4lD,GAAO1tB,EAAE0tB,GAAI1+B,SAAS,UAAWgR,EAAE0tB,GAAIhuB,KAAM+xB,aAAc,cAC1JpvB,EAAY5yB,UAAU+zC,aAAe,SAASlkB,GAAOA,EAAIvQ,YAAY,WACrEsT,EAAY5yB,UAAU8zC,YAAc,SAASjkB,GAAOA,EAAIrQ,OAAO,MAAMH,KAAK,MAAMkX,KAAK,SAAUl+B,EAAG4lD,GAAO1tB,EAAE0tB,GAAI3+B,YAAY,UAAWiR,EAAE0tB,GAAIhuB,KAAM+xB,aAAc,YAChKpvB,EAAY5yB,UAAUg0C,UAAY,SAASnkB,GAAOA,EAAIiN,QAAQ,SAASxd,YAAY,eACnFsT,EAAY5yB,UAAUi0C,aAAe,SAASpkB,GAAOA,EAAIiN,QAAQ,SAASvd,SAAS,eAEnFqT,EAAY5yB,UAAU+1C,QAAU,SAASJ,GACvC,GAAI9lB,EAEJ,IADAA,EAAM3vB,KAAKk0B,OAAOiM,UAAUnK,gBAAgB4G,QAAQ,UAC9CjN,EAAIv3B,OAAS,EAAnB,CAGA,GAAc,cAAVq9C,EACFz1C,KAAKoqB,UAAUuF,OACV,IAAc,mBAAV8lB,EACTz1C,KAAKohD,UAAUzxB,EAAK,cACf,IAAc,mBAAV8lB,EACTz1C,KAAKohD,UAAUzxB,OACV,IAAc,cAAV8lB,EACTz1C,KAAKuhD,UAAU5xB,OACV,IAAc,kBAAV8lB,EACTz1C,KAAK2hD,UAAUhyB,EAAK,cACf,IAAc,mBAAV8lB,EACTz1C,KAAK2hD,UAAUhyB,OACV,IAAc,aAAV8lB,EACTz1C,KAAK0zC,SAAS/jB,OACT,IAAc,cAAV8lB,EACTz1C,KAAK2zC,UAAUhkB,OACV,IAAc,gBAAV8lB,EACTz1C,KAAK4zC,YAAYjkB,OACZ,IAAc,iBAAV8lB,EACTz1C,KAAK6zC,aAAalkB,OACb,IAAc,cAAV8lB,EACTz1C,KAAK8zC,UAAUnkB,OACV,IAAc,iBAAV8lB,EACTz1C,KAAK+zC,aAAapkB,OACb,CAAA,GAAc,gBAAV8lB,EAGT,MAFAz1C,MAAK4yC,YAAYjjB,GAInB,MAAO3vB,MAAKk0B,OAAO4H,QAAQ,kBAGtBpJ,GAENxB,GAEHsB,EAASI,QAAQoZ,UAAUtZ,GAE3BD,EAAsB,SAAUe,GAG9B,QAASf,KACP,MAAOA,GAAoBY,UAAUH,YAAYnzB,MAAMC,KAAMC,WA0B/D,MA7BA8yB,GAAON,EAAqBe,GAM5Bf,EAAoB3yB,UAAUpB,KAAO,gBAErC+zB,EAAoB3yB,UAAUyO,KAAO,gBAErCkkB,EAAoB3yB,UAAUk1C,QAAU,SAExCviB,EAAoB3yB,UAAUm1C,WAAa,MAE3CxiB,EAAoB3yB,UAAU62C,cAAgB,WAC5C,GAAIvK,EAGJ,OAFAA,GAAS/X,SAAS8jB,kBAAkB,oBAAqB,EACzDn4C,KAAK+1C,UAAU3J,GACRpsC,KAAKosC,QAGd3Z,EAAoB3yB,UAAU+1C,QAAU,WAKtC,MAJAxhB,UAAS2b,YAAY,iBAChBhwC,KAAKk0B,OAAOe,KAAKwL,QAAQ8B,SAC5BviC,KAAKk0B,OAAO4H,QAAQ,gBAEfzL,EAAEgE,UAAUyH,QAAQ,oBAGtBrJ,GAENvB,GAEHsB,EAASI,QAAQoZ,UAAUvZ,GAE3B1B,EAAkB,SAAUyC,GAG1B,QAASzC,KACP,MAAOA,GAAgBsC,UAAUH,YAAYnzB,MAAMC,KAAMC,WA8E3D,MAjFA8yB,GAAOhC,EAAiByC,GAMxBzC,EAAgBjxB,UAAUpB,KAAO,YAEjCqyB,EAAgBjxB,UAAUyO,KAAO,aAEjCwiB,EAAgBjxB,UAAUk1C,QAAU,4BAEpCjkB,EAAgBjxB,UAAUm0B,MAAQ,WAwBhC,MAvBAj0B,MAAKue,OAED7f,KAAM,OACNme,KAAM7c,KAAK60C,GAAG,aACdtmC,KAAM,aACNknC,MAAO,SAEP/2C,KAAM,SACNme,KAAM7c,KAAK60C,GAAG,eACdtmC,KAAM,eACNknC,MAAO,WAEP/2C,KAAM,QACNme,KAAM7c,KAAK60C,GAAG,cACdtmC,KAAM,cACNknC,MAAO,UAEP/2C,KAAM,UACNme,KAAM,UACNtO,KAAM,gBACNknC,MAAO,YAGJ1kB,EAAgBsC,UAAUY,MAAMb,KAAKpzB,OAG9C+wB,EAAgBjxB,UAAUi2C,UAAY,SAAS3J,EAAQ2V,GAiBrD,MAhBa,OAATA,IACFA,EAAQ,QAEI,SAAVA,GAA8B,WAAVA,GAAgC,UAAVA,GAA+B,YAAVA,IACjEA,EAAQ,QAEI,SAAVA,EACFhxB,EAAgBsC,UAAU0iB,UAAU3iB,KAAKpzB,MAAM,GAE/C+wB,EAAgBsC,UAAU0iB,UAAU3iB,KAAKpzB,KAAMosC,GAEjDpsC,KAAKwmB,GAAGpH,YAAY,qDAChBgtB,GACFpsC,KAAKwmB,GAAGnH,SAAS,SAAW0iC,GAE9B/hD,KAAKo2C,QAAQ,SAAW2L,GACjB/hD,KAAKw2C,OAAOr3B,KAAK,cAAc3iB,OAAOmqC,MAAMxnB,KAAK,cAAgB4iC,GAAOr1C,QAGjFqkB,EAAgBjxB,UAAUo2C,QAAU,WAElC,MADAl2C,MAAKk2B,MAAQl2B,KAAKk0B,OAAOiM,UAAUjK,QAAQiB,OAAOn3B,KAAKg1C,SACnDh1C,KAAKk2B,MAAM99B,OAAS,GACtB4H,KAAKg2C,aAAY,GACVh2C,KAAK+1C,WAAU,KAEtB/1C,KAAKg2C,aAAY,GACVh2C,KAAK+1C,WAAU,EAAM/1C,KAAKk2B,MAAMC,QAAQpG,IAAI,iBAIvDgB,EAAgBjxB,UAAU+1C,QAAU,SAASkM,GAC3C,GAAc,SAAVA,GAA8B,WAAVA,GAAgC,UAAVA,GAA+B,YAAVA,EACjE,KAAM,IAAI/nD,OAAM,4CAA8C+nD,EAMhE,OAJA/hD,MAAKk2B,MAAMnG,KACT+xB,aAAwB,SAAVC,EAAmB,GAAKA,IAExC/hD,KAAKk0B,OAAO4H,QAAQ,gBACb97B,KAAKk0B,OAAOmB,aAAawK,6BAG3B9O,GAENG,GAEHsB,EAASI,QAAQoZ,UAAUjb,GAEpByB,IAIP,WACI,YAMA,SAASxU,KAEL,GAAIkS,IACA5R,MACIzkB,GAAI,GACJiN,WAAY,GACZC,UAAW,GACX8Z,MAAO,GACPc,MAAO,GACPqgC,MAAO,IAEX/+B,UAAW,GACXg/B,SAAS,EACT1jC,QACAM,QAAS,WACL,MAAO7e,MAAKue,MAEhBla,QAAS,WACL,MAAOrE,MAAKse,MAEhB4jC,WAAY,WACR,MAAOliD,MAAKiiD,SAEhBrjC,QAAS,SAAUL,GACfve,KAAKue,KAAOA,GAEhBI,QAAS,SAAUL,GACfte,KAAKse,KAAOA,GAEhB6jC,WAAY,SAAUF,GAClBjiD,KAAKiiD,QAAUA,GAIvB,OAAO/xB,GAtCXl6B,QACCC,OAAO,OACPi6B,QAAQ,iBAAkBlS,MAyC/B,WACI,YAsCA,SAASokC,KAKL,QAASC,GAAkB52C,EAAUhV,EAAYunB,EAAgBznB,EAAWF,EAAS8S,EAAM+U,EAAmB1nB,GA6B1G,QAASqrB,KACFxrB,EAAQisD,cACPtkC,EAAeW,QAAQtoB,EAAQgO,WAC/B2Z,EAAeY,QAAQvoB,EAAQyO,WAAW,UAE9C7N,EAAGsnB,KAAOP,EAAea,UACzBxoB,EAAQiP,WAAW,OAAQrO,EAAGsnB,MAE9BtnB,EAAGm1C,OAAS71C,EAAUoG,OAAO8V,QAAQ,IAAK,IAC1CuL,EAAeiF,UAAY8tB,EAAM1D,SAASv4B,KAAKytC,SAASxR,EAAM34C,SAE9DqT,EAAS,WACLzV,QAAQ8H,QAAQ,YAAYqhB,KAAK,0BAA0BG,SAASA,SAASC,OAAO5S,SACrF,KA6BP,QAAS61C,GAAS/Y,EAAMC,GACpB,GAAI+Y,EACJ,OAAO,YACH,GAAIC,GAAUzrD,EACd0yC,EAAO9pC,MAAMC,UAAUyzB,MAAMH,KAAKnzB,UAClCwL,GAAS1C,OAAO05C,GAChBA,EAAQh3C,EAAS,WACbg3C,EAAQ/3C,OACR++B,EAAK1pC,MAAM2iD,EAAS/Y,IACrBD,GAAQ,KAOnB,QAASiZ,GAAoBC,GACzB,MAAOJ,GAAS,WACZ/rD,EAAWmsD,GACV9pD,SACApB,KAAK,WACFlB,EAAKqsD,MAAM,UAAYD,EAAQ,eAEpC,KA7FP,GAAI3rD,GAAK+I,KACL+wC,GAAS,OAAQ,UAAW,SAAU,UAAW,UAErD95C,GAAGqnB,QACHrnB,EAAGsnB,QAEHtnB,EAAG6rD,WAAaH,EAAoB,QAEpC1rD,EAAG8rD,KAAO,SAAUj2C,EAAKk2C,GACrB,GAAsB,mBAAXA,GAAwB,CAC/B,GAAI3sD,EAAQ4sD,MAAM,QAAS,CACvB,GAAInxC,GAAO3I,EAAK4V,cAAc1oB,EAAQyO,WAAW,QAASgI,EAC1DoR,GAAkBc,UAAUlN,EAAK,IACjCoM,EAAkBe,WAAWnN,EAAK,IAEtCzb,EAAQiP,WAAW,aAAcwH,GAEjCvW,EAAUoG,KAAKmQ,GAEnB7V,EAAGw9B,SAGPx9B,EAAGw9B,MAAQ,WACPz+B,QAAQ8H,QAAQ,yBAAyBqhB,KAAK,YAAYO,WAG9DmC,IAkBA5qB,EAAG+rB,SAAW,WACV,MAAOhF,GAAeiF,WAG1BhsB,EAAGisB,QAAU,WACT,GAAI5E,GAAON,EAAe3Z,SAC1B,OAAOia,GAAKxX,WAAa,IAAMwX,EAAKvX,WAGxC9P,EAAGksB,SAAW,WACV,MAAOnF,GAAe3Z,UAAUsd,OAGpC1qB,EAAGmsB,WAAa,WACZ,GAAIC,GAAYrF,EAAe3Z,UAAUyC,UACzC,OAAOuc,GAAUjrB,OAASirB,EAAU,GAAG5a,cAAgB,KAG3DxR,EAAG4nB,QAAU,WACT,MAAOb,GAAea,WApE9BwjC,EAAkB99C,SAAW,WAAY,aAAc,iBAAkB,YAAa,UAAW,OAAQ,oBAAqB,OA/B9H,IAAI8qB,IACAE,SAAU,IACV/tB,YAAa,sCACb8tB,SACAhuB,YAAa,WAAY,aAAc,iBAAkB,YAAa,UAAW,OAAQ,oBAAqB,OAAQ+gD,GACtHxzB,aAAc,KACdq0B,kBAAkB,EAClB1zB,KAAM,SAASF,EAAO6zB,GAClB,GAAIjkC,GAAWikC,CAEfjkC,GAASiH,GAAG,QAAS,kBAAmB,WACpCjH,EAASC,KAAK,mBAAmBC,YAAY,UAC7CppB,QAAQ8H,QAAQkC,MAAMqf,SAAS,YAGnCH,EAASiH,GAAG,QAAS,oBAAqB,WACtC,GAAIjH,EAASgf,SAAS,aAClB,OAAO,CAEXhf,GAASC,KAAK,oBAAoBikC,QAAQ,KAC1ClkC,EAASC,KAAK,sBAAsBC,YAAY,SAEhD,IAAIikC,GAAQrtD,QAAQ8H,QAAQkC,KAC5BqjD,GAAMhkC,SAAS,UACXgkC,EAAM5lC,OAAO2Y,GAAG,cAChBitB,EAAM5lC,OAAO6lC,YAAY,KACzBD,EAAMzmB,QAAQ,MAAMvd,SAAS,cAM7C,OAAOgQ,GAtCXr5B,QACCC,OAAO,OACPo5B,UAAU,cAAe+yB,MA2I9B,WACI,YAsBA,SAASmB,GAAqB9hD,EAAQwY,GAKlC,QAAS4H,KAKL,GAJA2hC,IACAC,IACAC,IAEIzsD,EAAG0sD,SAAW1pC,EAAS2pC,OAAO,GAAI19C,MAAKjP,EAAG0sD,UAAW,CACrD,GAAI3uC,GAAO,GAAI9O,MAAKjP,EAAG0sD,QACvB1sD,GAAG4sD,IAAM7uC,EAAKsT,UACdrxB,EAAG6sD,MAAQ9uC,EAAK1F,WAAa,EAC7BrY,EAAG8sD,KAAO/uC,EAAKrF,eAIvB,QAAS6zC,KAEL,IAAK,GADDQ,MACK7rD,EAAI,EAAGA,GAAK,GAAIA,IACrB6rD,EAAKjnD,MACD2B,KAAMvG,EACNyH,MAAOzH,GAGflB,GAAG+sD,KAAOA,EAGd,QAASP,KAEL,IAAK,GADDQ,MACK9rD,EAAI,EAAGA,EAAI,GAAIA,IACpB8rD,EAAOlnD,MACH2B,KAAMub,EAASgqC,OAAO9rD,GACtByH,MAAOzH,EAAI,GAGnBlB,GAAGgtD,OAASA,EAGhB,QAASP,KAKL,IAAK,GAJDK,GAAO1W,SAASpzB,EAASiqC,IAAI,SAC7BC,KACAC,EAAUL,GAAQ9sD,EAAGmtD,SAAW,KAChCC,EAAUN,GAAQ9sD,EAAGotD,SAAW,GAC3BlsD,EAAIksD,EAAS/wB,EAAI8wB,EAASjsD,GAAKm7B,EAAGn7B,IACvCgsD,EAAMpnD,MACF2B,KAAMvG,EACNyH,MAAOzH,GAGflB,GAAGktD,MAAQA,EAlDf,GAAIltD,GAAK+I,IAET6hB,KAsDApgB,EAAOojB,OAAO,SAAU,SAAUC,EAAUw/B,GACxCA,EAAWA,EACXrtD,EAAG0sD,QAAU,GAAIz9C,MAAKjP,EAAG8sD,KAAM9sD,EAAG6sD,MAAM,EAAGh/B,KAE/CrjB,EAAOojB,OAAO,WAAY,SAAUC,EAAUw/B,GAC1CA,EAAWA,EACXrtD,EAAG0sD,QAAU,GAAIz9C,MAAKjP,EAAG8sD,KAAMj/B,EAAS,EAAG7tB,EAAG4sD,OAElDpiD,EAAOojB,OAAO,UAAW,SAAUC,EAAUw/B,GACzCA,EAAWA,EACXrtD,EAAG0sD,QAAU,GAAIz9C,MAAK4e,EAAU7tB,EAAG6sD,MAAM,EAAG7sD,EAAG4sD,OAEnDpiD,EAAOojB,OAAO,aAAc,SAAUC,EAAUw/B,GAC5C,GAAIx/B,GAAYA,GAAYw/B,GAAYrqC,EAAS2pC,OAAO,GAAI19C,MAAK4e,IAAY,CACzE,GAAI9P,GAAO,GAAI9O,MAAK4e,EACpB7tB,GAAG4sD,IAAM7uC,EAAKsT,UACdrxB,EAAG6sD,MAAQ9uC,EAAK1F,WAAa,EAC7BrY,EAAG8sD,KAAO/uC,EAAKrF,iBA9D3B4zC,EAAqBh/C,SAAW,SAAU,YAhC1CvO,QACCC,OAAO,OACP24B,UAAU,gBACPptB,YAAa,4CACbF,YAAa,SAAU,WAAYiiD,GACnC10B,aAAc,KACdC,UACI60B,QAAS,IACTY,WAAY,IACZC,WAAY,IACZC,QAAS,IACTL,QAAS,IACTC,QAAS,IACTN,KAAM,IACND,MAAO,IACPD,IAAK,UAsFjB,WACI,YAgBA,SAASa,KAiEL,QAASC,GAAQrmD,GACVtI,QAAQ+D,UAAU9C,EAAGkI,iBACpBlI,EAAGkI,eAAeb,GAlE1B,GAAIrH,GAAK+I,IAKT/I,GAAG0tD,QAAUA,EAGb1tD,EAAG2tD,YAEKC,UAAY,EACZniD,OAAW,aACXsgD,UACMtkD,KAAM,kBAAmBJ,KAAM,mBAC/BI,KAAM,aAAcJ,KAAM,eAC1BI,KAAM,SAAWJ,KAAM,WAEvBI,KAAM,0BAA2BJ,KAAM,2BACvCI,KAAM,sBAAuBJ,KAAM,qBACnCI,KAAM,cAAeJ,KAAM,cAC3BI,KAAM,aAAcJ,KAAM,cAC1BI,KAAM,6BAA8BJ,KAAM,8BAC1CI,KAAM,qBAAsBJ,KAAM,mBAClCI,KAAM,kBAAmBJ,KAAM,kBAIrCumD,UAAY,EACZniD,OAAW,SACXsgD,UACMtkD,KAAM,SAAUJ,KAAM,WACtBI,KAAM,YAAaJ,KAAM,cACzBI,KAAM,UAAWJ,KAAM,YACvBI,KAAM,QAASJ,KAAM,YAI3BumD,UAAY,EACZniD,OAAW,UACXsgD,UACMtkD,KAAM,aAAcJ,KAAM,WAC1BI,KAAM,UAAWJ,KAAM,YAI7BumD,UAAY,EACZniD,OAAW,uBACXsgD,UACMtkD,KAAM,UAAWJ,KAAM,YACvBI,KAAM,iBAAmBJ,KAAM,UAC/BI,KAAM,kBAAmBJ,KAAM,UAC/BI,KAAM,mBAAoBJ,KAAM,WAChCI,KAAM,qBAAsBJ,KAAM,oBAClCI,KAAM,gBAAiBJ,KAAM,aAC7BI,KAAM,WAAYJ,KAAM,aACxBI,KAAM,aAAcJ,KAAM,eAE1BI,KAAM,aAAcJ,KAAM,WAC1BI,KAAM,cAAeJ,KAAM,WAC3BI,KAAM,iBAAkBJ,KAAM,YA1EhDtI,QACCC,OAAO,OACP24B,UAAU,iBACPptB,YAAc,kDACdF,WAAaojD,EACb71B,aAAc,KACdC,UACIvQ,KAAM,IACNpf,eAAgB,IAChBQ,QAAS,IACT22B,KAAM,UA8ElB,WACI,YAwCA,SAASwuB,KApBL,QAASC,GAAiBrgD,EAAgBnO,EAAWF,EAAS2nB,EAAgB7U,EAAMzS,EAAakY,EAASjY,GACtG,GAAIM,GAAK+I,IAET/I,GAAG6B,OAAS,WACR9C,QAAQ8H,QAAQ,iBAAiB43C,YAAY,cAGjDz+C,EAAGiK,SAAW,SAAU7B,EAAazG,GACjCyG,EAAYzG,IAGhB3B,EAAG+tD,QAAU,WACTzuD,EAAUoG,KAAK,YAGnB1F,EAAGguD,SAAW,WACV1uD,EAAUoG,KAAK,kBAGnB1F,EAAGiuD,aAAe,WACd,MAAI7uD,GAAQisD,YACDjsD,EAAQgO,UAAUyC,WAEtBkX,EAAe3Z,UAAUyC,YAGpC7P,EAAG+rB,SAAW,WACV,MAAOhF,GAAeiF,WAG1BhsB,EAAGmsB,WAAa,WACZ,GAAIC,GAAYrF,EAAe3Z,UAAUyC,UACzC,OAAOuc,GAAUjrB,OAASirB,EAAU,GAAG5a,cAAgB,KAG3DxR,EAAGw2B,OAAS,WACV,GAAIjL,GAAS5T,EAAQkT,aAAaC,QAAQ,eACtCS,GAEA9rB,EAAYe,IAAId,EAAU,gBAAkB6rB,GAC3C9qB,KAAK,SAAU8R,GACZoF,EAAQ6T,SAASC,KAAOlZ,EAAS5R,QAGrC8M,EAAe+oB,UAIrBx2B,EAAGkuD,WAAa,WACZnvD,QAAQ8H,QAAQ,QAAQ43C,YAAY,cACpCvsC,EAAKg8C,cAGTluD,EAAGmuD,eAAiB,WAChB7uD,EAAUoG,KAAK,WAjCvBooD,EAAiBxgD,SAAW,iBAAkB,YAAa,UAAW,iBAAkB,OAAQ,cAAe,UAAW,UAjC1H,IAAI8qB,IACAE,SAAU,IACV/tB,YAAa,oCACb8tB,SACAhuB,YAAa,iBAAkB,YAAa,UAAW,iBAAkB,OAAQ,cAAe,UAAW,UAAWyjD,GACtHl2B,aAAc,KACdq0B,kBAAkB,EAGtB,OAAO7zB,GAfXr5B,QACCC,OAAO,OACPo5B,UAAU,aAAcy1B,MA6E7B,WACI,YAeA,SAASO,MAbTrvD,QACCC,OAAO,OACP24B,UAAU,YACPptB,YAAc,wCACdF,YAAc+jD,GACdx2B,aAAc,KACdC,UACI13B,MAAO,IACPkuD,WAAY,IACZhvB,KAAM,UAQlB,WACI,YAEAtgC,SACKC,OAAO,OACPsvD,SAAS,kBACN7V,YAAa,4BACbhF,SAAW,YAAa,MAAO,IAAK,SAAU,UAAW,YAAa,IAAK,QAAS,OAAQ,MAC5FzP,aAAc,KAAM,IAAK,IAAK,KAAM,OACpC2P,eAAe,IAElBvb,UAAU,cAAe,WAAY,iBAAkB,SAAU5jB,EAAU+5C,GAwCxE,MAvCAhzB,UAASizB,OAAS,QAClBjzB,SAASme,KAAK,UACVG,KAAQ,UACRe,OAAU,UACViB,UAAa,WACb/B,MAAS,QACT1E,OAAU,mBACVuF,QAAW,iBACXmB,UAAa,UACbT,MAAS,QACT9iB,KAAQ,SACRyhB,GAAM,QACN7mB,UAAa,gBACbmoB,eAAkB,uBAClBC,eAAkB,sBAClBC,aAAgB,mBAChBC,iBAAoB,kCACpBC,kBAAqB,gCACrBe,SAAY,cACZC,UAAa,eACbC,YAAe,iBACfC,aAAgB,kBAChBjB,YAAe,iBACfkB,UAAa,iBACbC,aAAgB,kBAChBC,SAAY,kBACZC,WAAc,kBACdC,WAAc,mBACdC,YAAe,gBACfC,aAAgB,oBAChBC,eAAkB,oBAClBC,eAAkB,oBAClBC,eAAkB,gBAClBC,eAAkB,gBAClBC,UAAa,iBACbC,WAAc,wBAQdplB,OACIo2B,QAAS,IACTxQ,SAAU,IACV7sC,KAAM,KAIVknB,SAAU,IACVpxB,SAAU,uDAEVsU,SAAS,EAGT+c,KAAM,SAAU/tB,EAAQkkD,EAAMC,EAAQtkD,GAClC,GAAIsjB,GAAKnjB,EACLyyB,EAAS,GAAI1B,UACbx8B,QAAQ+8B,QAAS3vB,SAAUuiD,GAAQH,GAKvC/5C,GAAS,WACLyoB,EAAOqB,KAAK,GAAGswB,iBAAmB7vD,QAAQ+D,UAAU6qB,EAAGswB,YAAatwB,EAAGswB,SACpEl/C,QAAQ+D,UAAU6qB,EAAG8gC,UAAWxxB,EAAO4b,SAASlrB,EAAG8gC,UAI1D,IAAII,GAAU,SAAUltD,GACpBgsB,EAAG8gC,QAAUxxB,EAAOic,WAGxBjc,GAAO/N,GAAG,eAAgB2/B,GAE1B5xB,EAAO/N,GAAG,QAAS,SAAUvtB,GACzB5C,QAAQ8H,QAAQ6nD,GAAMpmC,OAAOA,OAAOA,OAAOF,SAAS,mBAGxD6U,EAAO/N,GAAG,OAAQ,SAAUvtB,GACxB6S,EAAS,WACLzV,QAAQ8H,QAAQ6nD,GAAMpmC,OAAOA,OAAOA,OAAOH,YAAY,kBACxD,eAQ3B,WACI,YAiBA,SAAS2mC,GAA6BtkD,EAAQ/K,EAAaujB,EAAU7jB,GAoBjE,QAASyrB,KACD5qB,EAAG0sD,SACH1sD,EAAGgK,MAAQhK,EAAG0sD,QACd1sD,EAAG+uD,iBAAmB,GAAI9/C,MAAKjP,EAAGgK,MAAMglD,QAAQD,kBAChD/uD,EAAGivD,YAAcjvD,EAAGgK,MAAMglD,QAAQC,YAClCjvD,EAAGkvD,cAAgBlvD,EAAGgK,MAAMglD,QAAQE,cACpClvD,EAAGmvD,eAAiBnvD,EAAGgK,MAAMglD,QAAQG,gBAErCnvD,EAAGgK,SAIX,QAASolD,KACL,MAAkC,mBAApBpvD,GAAGkvD,gBAAiClsC,EAAS2pC,OAAO3sD,EAAG+uD,kBAGzE,QAASM,KACLlwD,EAAQmwD,QAAQ,8BAChB7vD,EAAYe,IAAIR,EAAG6V,IAAM7V,EAAGkvD,cAAgB,qBAAuBlsC,EAASkC,OAAOllB,EAAG+uD,iBAAkB,eACvGtuD,KAAK,SAAS8R,GACPA,GACAvS,EAAGgK,MAAMglD,QAAUz8C,EACnBvS,EAAG0sD,QAAU1sD,EAAGgK,QAEhBhK,EAAGgK,MAAMglD,WACThvD,EAAG0sD,QAAU1sD,EAAGgK,SA5C5B,GAAIhK,GAAK+I,IAET/I,GAAGuvD,QAEK5mD,MAAO,KACPlB,KAAM,wBAGNkB,MAAO,YACPlB,KAAM,cAIdzH,EAAGmvD,eAAiB,KACpBnvD,EAAGqvD,OAASA,EACZrvD,EAAGovD,WAAaA,EAEhBxkC,IAgCApgB,EAAOojB,OAAO,oBAAqB,SAAUC,GACzC7tB,EAAGgK,MAAMmlD,eAAiBthC,EAC1B7tB,EAAG0sD,QAAU1sD,EAAGgK,QAEpBQ,EAAOojB,OAAO,mBAAoB,SAAUC,GACxC7tB,EAAGgK,MAAMklD,cAAgBrhC,EACzB7tB,EAAG0sD,QAAU1sD,EAAGgK,QAEpBQ,EAAOojB,OAAO,iBAAkB,SAAUC,GACtC7tB,EAAGgK,MAAMilD,YAAcphC,EACvB7tB,EAAG0sD,QAAU1sD,EAAGgK,QAEpBQ,EAAOojB,OAAO,sBAAuB,SAAUC,GAC3C7tB,EAAGgK,MAAM+kD,iBAAmBlhC,EAC5B7tB,EAAG0sD,QAAU1sD,EAAGgK,QA7CxB8kD,EAA6BxhD,SAAW,SAAU,cAAe,WAAY,WAlC7EvO,QACCC,OAAO,OACP24B,UAAU,sBACPptB,YAAa,4DACbF,YAAa,SAAU,cAAe,WAAY,UAAWykD,GAC7Dl3B,aAAc,KACdC,UACI60B,QAAS,IACTY,WAAY,IACZkC,OAAQ,IACR35C,IAAK,UA4EjB,WACI,YA0CA,SAAS45C,GAAoBjlD,EAAQ/K,EAAaN,EAASqO,EAAO0E,EAAMsC,EAAU5U,EAAWojB,EAAU0sC,GAsEnG,QAAS9kC,KACL+kC,IAGJ,QAASC,KACJ7wD,QAAQgnD,WAAW/lD,EAAG2gB,gBAAgBnM,EAAS,WAAYxU,EAAG2gB,cAAckvC,OAGjF,QAASC,GAAiBzpD,GACtBA,EAAKV,sBAAwB3F,EAAG4V,QAChCnW,EAAYmG,IAAI5F,EAAG6V,IAAI3D,EAAK69C,MAAM1pD,EAAMrG,EAAGgwD,YAAajxD,QAAQuD,KAAK+D,IAClErG,EAAG8V,OAAOtT,QAAQ,qCAAsC6D,GAAKV,sBAGpE,QAASsqD,KACDjwD,EAAGmnB,YAKHnnB,EAAGG,MAAMG,KAAK+a,IAAK,SAAUhV,GACzBA,EAAKub,UAAW,IALpB5hB,EAAGG,MAAMG,KAAK+a,IAAK,SAAUhV,GACzBA,EAAKub,UAAW,IAOrB7iB,QAAQgnD,WAAW/lD,EAAG2gB,gBAAgB3gB,EAAG2gB,cAAckvC,KAG9D,QAASK,GAAQvuD,GACbA,EAAGwtB,kBAGP,QAASghC,KACDnwD,EAAGgwD,aACHhwD,EAAGwiB,QAAU6J,KAIrB,QAAS8d,GAAI9hC,EAAOhC,GAChB,GAAIzD,GAAKsP,EAAK69C,MAAM1pD,EAAMrG,EAAGgwD,WACzBptD,GACAkoB,EAAQziB,GAAO,EAAOzF,IAEtByD,KACAA,EAAK3D,kBAAoB1C,EAAG4V,QAC5BvP,EAAKkP,gBAAkB,GAAItG,MAC3B5I,EAAKmP,oBAAsB,GAAIvG,MAC/BmhD,EAAW/nD,GAAO,EAAMhC,IAIhC,QAAS+K,GAAM9Q,GAEX,GAAIskD,KAEJ,KAAK,GAAI1jD,KAAKZ,GACVskD,EAAI1jD,GAAKlB,EAAGqwD,SAAS/vD,EAAKY,GAG9BzB,GAAY2R,KAAKpR,EAAG6V,IAAK3D,EAAKo+C,UAAU1L,EAAK5kD,EAAGgwD,aAC/CvvD,KAAK,SAASH,GACPA,GACAnB,EAAQoG,KAAKjF,EAAKkF,YAAYlF,EAAKmF,WAM/C,QAAS8qD,KACL,GAAIjwD,GAAON,EAAGqwD,SACVxO,EAAI,EACJ1gD,EAASnB,EAAGkb,QAAQ/Z,OACpBqvD,KACA5L,KACA6L,IAEJ,KAAK,GAAIvvD,KAAKZ,GAAM,CAChB,GAAIoQ,GAAMxP,EAAEgE,MAAM,IAClBwL,GAAI/G,QACJ+G,EAAMA,EAAIo2B,KAAK,KACf8d,EAAIl0C,GAAOpQ,EAAKY,GAChB2gD,IACIA,EAAI1gD,GAAU,IACdqvD,EAAS1qD,KAAK8+C,GACd6L,EAAS3qD,KAAK4qD,EAAY9L,IAC1BA,MAGRplC,QAAQK,IAAI4wC,GACXhwD,KAAK,SAAU8R,GACZ,IAAK,GAAIrR,KAAKqR,GACV,GAAIA,EAASrR,MAAO,EAEhB,KADA/B,GAAQ0G,MAAM,kDACR,GAAI9C,OAAM,kCAGxB5D,GAAQwiB,QAAQ,kCAIxB,QAAS+uC,GAAYpwD,GACjB,MAAO,IAAIkf,SAAQ,SAAUC,EAASK,GAClCrgB,EAAY2R,KAAKpR,EAAG6V,IAAK3D,EAAKo+C,UAAUhwD,EAAMN,EAAGgwD,aAChDvvD,KAAK,SAASH,GACPA,EACAmf,GAAQ,GAERK,GAAO,KALfrgB,SAOS,WACLqgB,GAAO,OAKnB,QAAS6wC,GAAMtoD,EAAOhC,GAClBrG,EAAGmqC,IAAI9hC,EAAOhC,GAGlB,QAASuqD,GAAYvoD,EAAOhC,GACxBmH,EAAM6B,QAAQ,+DAAgE,WAC1E5P,EAAAA,UAAoBO,EAAG6V,IAAM3D,EAAK69C,MAAM1pD,EAAMrG,EAAGgwD,aAChDvvD,KAAK,WACFtB,EAAQwiB,QAAQ,yCAChB3hB,EAAGmwD,aAHP1wD,SAKO,WACHN,EAAQ0G,WAEb,KAAMwC,GAGb,QAASyiB,GAAQziB,EAAO8hC,EAAKvnC,GACzBnD,EAAYe,IAAKR,EAAG6V,IAAKjT,GAAM5C,EAAGy1C,QAAU,YAAcz1C,EAAGy1C,QAAS,KACrEh1C,KAAK,SAASH,GACTA,GAAQA,EAAKK,MAAMuR,EAAK69C,MAAMzvD,EAAMN,EAAGgwD,YAAY,MACjD1vD,EAAKK,MAAMgF,sBAAwB3F,EAAG4V,QACtCtV,EAAKK,MAAM6U,oBAAsB,GAAIvG,MACrCmhD,EAAW/nD,EAAO8hC,EAAKj4B,EAAK2+C,WAAWvwD,EAAKK,WAKxD,QAASyvD,GAAW/nD,EAAO8hC,EAAK9jC,GAC5B,GAAI6D,IACA7B,MAAOA,EACP/H,KAAM+F,EACN8U,MAAOgvB,EAAM,UAAY,SACzBA,IAAKA,EACLr0B,OAAQ9V,EAAGgwD,WACXc,OAAQ9wD,EAAG8wD,QAAU,EACrBvmD,YAAcvK,EAAGkH,UAAY,iDAC7B6pD,KAAO,SAAUC,EAAQr/C,GACP,QAAVq/C,UACO3qD,GAAKkP,sBACLlP,GAAKmP,oBACZ/V,EAAY2R,KAAMpR,EAAG6V,IAAK3D,EAAKo+C,UAAUjqD,EAAMrG,EAAGgwD,aACjDvvD,KAAK,SAASH,GACPA,IACAnB,EAAQoG,KAAKjF,EAAKkF,YAAY,GAAI,KAAM,GACxCmM,EAAU8D,OACVzV,EAAGmwD,WACCnwD,EAAGixD,WACHjxD,EAAGixD,UAAU3wD,QAOjCN,GAAG+V,mBACH7L,EAAOG,WAAarK,EAAG+V,kBAE3BvI,EAAMjI,KAAK2E,GAGf,QAASmiB,KAIL,GAHIrsB,EAAGy1C,UACHz1C,EAAGkxD,MAAMzb,QAAUz1C,EAAGy1C,SAEtBz1C,EAAG2e,WACH,IAAK,GAAIpc,KAAKvC,GAAG2e,WACb3e,EAAGkxD,MAAM3uD,GAAKvC,EAAG2e,WAAWpc,EAGpC,IAAGvC,EAAGmxD,WAAW,CACbnxD,EAAGkxD,MAAM,OAAY,EACrB,KAAK,GAAIhwD,GAAI,EAAGA,EAAIlB,EAAG8V,OAAO3U,OAAQD,IAClClB,EAAGkxD,MAAM,QAAalxD,EAAG8V,OAAO5U,GAAG,GAEvClB,GAAGkxD,MAAM,OAAYlxD,EAAGkxD,MAAM,OAAUrrB,UAAU,EAAG7lC,EAAGkxD,MAAM,OAAU/vD,OAAO,GAiCnF,MA/BGnB,GAAGoxD,eACCpxD,EAAGqxD,gBAAgBlwD,OAAO,EAAGnB,EAAGkxD,MAAM,OAAYlxD,EAAGqxD,gBAAgB7/B,iBAC5DxxB,GAAGkxD,MAAM,QAGtBlxD,EAAGsxD,YACFtxD,EAAGkxD,MAAM,UAAe,EACxBlxD,EAAGkxD,MAAM,QAAalxD,EAAGuxD,cACJ,SAAlBvxD,EAAGuxD,eAA4C,aAAlBvxD,EAAGuxD,cACV,SAAlBvxD,EAAGuxD,gBACFvxD,EAAGkxD,MAAM,SAAclxD,EAAGwxD,mBAAmB/pD,MAAQzH,EAAGkb,QAAQ,GAAGzT,aAGhEzH,GAAGkxD,MAAM,cACTlxD,GAAGkxD,MAAM,eACTlxD,GAAGkxD,MAAM,MAEjBlxD,EAAGyxD,cACGzuC,EAAS2pC,OAAO3sD,EAAG0xD,gBACpB1xD,EAAG0xD,aAAe,GAAIziD,MAAK+T,EAAS2uC,aAAa,GAAI1iD,MAAQ,OAC7D+T,EAAS2pC,OAAO3sD,EAAG4xD,eACnB5xD,EAAG4xD,YAAc,GAAI3iD,OACzBjP,EAAGkxD,MAAM,KAAUlxD,EAAG0xD,aACtB1xD,EAAGkxD,MAAM,KAAU,GAAIjiD,MAAK+T,EAAS6uC,QAAQ7xD,EAAG4xD,YAAa,IAC7D5xD,EAAGkxD,MAAM,KAAQY,SAAS,GAC1B9xD,EAAGkxD,MAAM,KAAQY,SAAS,WAEnB9xD,GAAGkxD,MAAM,WACTlxD,GAAGkxD,MAAM,OAGjBzxD,EAAY40C,KAAMr0C,EAAG6V,IAAK7V,EAAGkxD,OACnCzwD,KAAK,SAASH,GACX,GAAIA,EAAM,CACN,GAAIH,MACAQ,EAAQL,EAAKK,KAEjBR,GAAM8E,MAAQtE,EAAMa,MACpBrB,EAAM64C,QAAUr4C,EAAMyN,UACtBjO,EAAMG,KAAOyxD,EAAYpxD,EAAMyN,WAC/BpO,EAAGG,MAAQA,EACRpB,QAAQgnD,WAAW/lD,EAAG2gB,gBAAgB3gB,EAAG2gB,cAAckvC,QAKtE,QAASA,KACP,GAAImC,GAAO,EACPtxD,GAAY,CAKhB,OAJAV,GAAGG,MAAMG,KAAK+a,IAAK,SAAUhV,GACxBA,EAAKub,YAAa,GAAMowC,MAE1BA,EAAO,IAAGtxD,GAAY,GAClBA,EAGT,QAASivD,KACLlwD,EAAYqW,OAAO9V,EAAG6V,KACrBpV,KAAK,SAASH,GACX,GAAIA,EAAM,CACNN,EAAGgwD,WAAa99C,EAAK+/C,aAAa3xD,EAAMN,EAAG8V,QAC3C9V,EAAGgwD,WAAa99C,EAAKggD,oBAAoBlyD,EAAGgwD,WAAYhwD,EAAGmyD,OAE3D,IAAIxhD,IAAO,oBAAoB,wBAAwB,kBAAkB,sBACzE,KAAK,GAAIzP,KAAKlB,GAAGgwD,WAAY,CAC3B,GAAIoC,GAASpyD,EAAGgwD,WAAW9uD,GACvBmxD,EAAW1hD,EAAInO,QAAQ4vD,EAAO1hD,IAClC,IAAI2hD,MACFD,EAAO3pD,gBAAgB6pD,UAAW,EAClCF,EAAO3pD,gBAAgBw1C,UAAW,EACnB,GAAZoU,IAAeD,EAAO3pD,gBAAgB0R,MAAQ,qBAClC,GAAZk4C,IAAeD,EAAO3pD,gBAAgB0R,MAAQ,6BAC7C,IAAmC,MAAhCi4C,EAAO3pD,gBAAgB0R,MAC9Bi4C,EAAO3pD,gBAAgB6pD,UAAW,MAC9B,IAAkC,GAA9BF,EAAO1hD,IAAIlO,QAAQ,QAAc,CACzC,GAAI+vD,MACA7pD,EAAU0pD,EAAO3pD,gBAAgBC,OACrC,KAAK,GAAInG,KAAKmG,GACZ6pD,EAAO7pD,EAAQnG,GAAGoG,OAASD,EAAQnG,GAAGkF,IAExC2qD,GAAO3pD,gBAAgB+pD,MAAQD,GAInCE,EAAkBzyD,EAAGgwD,WAAYhwD,EAAG0yD,gBACpCjzD,EAAYkzD,UAAU3yD,EAAGgwD,YAEzB4C,EAAW5yD,EAAGgwD,YACVhwD,EAAG6yD,WACH7yD,EAAG8yD,MAAQ5gD,EAAK6gD,QAAQ/yD,EAAGgwD,aAE3BhwD,EAAGgX,aACHhX,EAAGgzD,YAAcj0D,QAAQghC,MAAM//B,EAAGgzD,YAAahzD,EAAGgX,aAElDhX,EAAGizD,cACHjzD,EAAGkxD,MAAQnyD,QAAQghC,MAAM//B,EAAGkxD,MAAOlxD,EAAGizD,cAE1CjzD,EAAGmwD,cAKf,QAASsC,GAAkBnyD,EAAMoI,GAC7B,IAAK,GAAIxH,KAAKZ,GACV,GAAoB,UAAhBA,EAAKY,GAAGE,KAAkB,CAC1B,GAAIiF,GAAO6L,EAAKghD,YAAYxqD,EAASpI,EAAKY,GAAGwP,IACzCrK,IACAzG,EAAU2H,OAAOjH,EAAKY,GAAGuH,gBAAgBC,QAAS,GAC9CjB,KAAMpB,EAAKuf,MAAQ,aACnBjd,MAAOtC,EAAKsC,OAAS,MAOzC,QAASopD,GAAYzxD,GACjB,GAAIwV,GAA6B,mBAAb9V,GAAG8V,OACnBq9C,EAAuB,mBAAVnzD,GAAGmzD,IAChBC,IACJ,KAAK,GAAIlyD,KAAKZ,GAAM,CAChB,IAAK,GAAI0F,KAAK1F,GAAKY,GACf,GAAI4U,GAAU9V,EAAG8V,OAAOtT,QAAQwD,aACrB1F,GAAKY,GAAG8E,OAEf,IAA0B,mBAAfhG,GAAG6yD,SACV,GAAyB,iBAAdvyD,GAAKY,GAAG8E,GACf1F,EAAKY,GAAG8E,GAAK1F,EAAKY,GAAG8E,GAAK,uBAAyB,wBAChD,IAAImtD,GAAOnzD,EAAGmzD,IAAI3wD,QAAQwD,OAC7B,GAA+B,SAA3BkM,EAAKmhD,OAAO/yD,EAAKY,GAAG8E,IAAgB,CACpC,GAAIq2B,GAAInqB,EAAKohD,cAActzD,EAAGgwD,WAAYhqD,EAC1C,IAAIq2B,EAAI,GAAKA,GAAK/7B,EAAKY,GAAG8E,GAAG7E,OACzBb,EAAKY,GAAG8E,GAAK,YACV,CACH,GAAI4f,KAEJtlB,GAAKY,GAAG8E,GAAGqV,IAAI,SAAUkiB,EAAGr8B,GAEzB0kB,EAAK9f,KAAKoM,EAAKqhD,UAAUvzD,EAAGgwD,WAAYhqD,EAAGu3B,MAE9Cj9B,EAAKY,GAAG8E,GAAK4f,EAAKkhB,KAAK,WAG3BxmC,GAAKY,GAAG8E,GAAKkM,EAAKqhD,UAAUvzD,EAAGgwD,WAAYhqD,EAAG1F,EAAKY,GAAG8E,QAE9B,gBAAd1F,GAAKY,GAAG8E,KAAmB,aAAaksB,KAAK5xB,EAAKY,GAAG8E,KAAO,iCAAiCksB,KAAK5xB,EAAKY,GAAG8E,KAA4B,IAArB1F,EAAKY,GAAG8E,GAAG7E,OAC1Ib,EAAKY,GAAG8E,GAAKkM,EAAKshD,WAAWlzD,EAAKY,GAAG8E,IACH,SAA3BkM,EAAKmhD,OAAO/yD,EAAKY,GAAG8E,IAC3B1F,EAAKY,GAAG8E,GAAK1F,EAAKY,GAAG8E,GAAG,GACI,gBAAd1F,GAAKY,GAAG8E,KAAmB,aAAaksB,KAAK5xB,EAAKY,GAAG8E,KAAO,sDAAsDksB,KAAK5xB,EAAKY,GAAG8E,KAA4B,GAArB1F,EAAKY,GAAG8E,GAAG7E,SACjKb,EAAKY,GAAG8E,GAAKytD,EAAWnzD,EAAKY,GAAG8E,IAK9CotD,GAAMttD,KAAK4tD,EAAUpzD,EAAKY,GAAIlB,EAAGgwD,WAAY9uD,IAEjD,MAAOkyD,GAGX,QAASM,GAAUpzD,EAAMwV,EAAQ69C,GAE7B,GAAqB,mBAAV79C,IAA0C,GAAjBA,EAAO3U,OACvC,MAAOb,EAGX,IAAI+F,KAEJ,KAAK,GAAInF,KAAK4U,GAAQ,CAClB,GAAIiqC,GAAQjqC,EAAO5U,GAAGwP,GACtB,IAA0B,mBAAfpQ,GAAKy/C,GACZ,GAAI//C,EAAG6yD,SAAU,CACb,GAA0B,gBAAfvyD,GAAKy/C,KAAuB,aAAa7tB,KAAK5xB,EAAKy/C,KAAW,iCAAiC7tB,KAAK5xB,EAAKy/C,KAAiC,IAAtBz/C,EAAKy/C,GAAO5+C,OAAc,CACrJ,GAAI4c,GAAOzd,EAAKy/C,GAAO76C,MAAM,IAC7BlF,GAAGqwD,SAASsD,EAAM,IAAM5T,GAAS,GAAI9wC,MAAK8O,EAAK,GAAIA,EAAK,GAAG,EAAGA,EAAK,QAEnE/d,GAAGqwD,SAASsD,EAAM,IAAM5T,GAASz/C,EAAKy/C,EAE1C15C,GAAK05C,GAAS4T,EAAM,IAAM5T,MAE1B15C,GAAK05C,GAASz/C,EAAKy/C,GAK/B,MAAO15C,GAGX,QAASotD,GAAWrgC,GAEhB,MADAA,GAAOA,EAAKluB,MAAM,MACVkuB,EAAK,GAAIA,EAAK,IAAI0T,KAAK,KAGnC,QAAS8rB,GAAWtyD,GAChB,GAAI4a,MACA4J,EAA2B,mBAAZ9kB,GAAG8kB,KACtB,KAAK,GAAI5jB,KAAKZ,GACV4a,EAAQpV,MACJ2B,KAAMnH,EAAKY,GAAGwP,IACdyK,MAAO7a,EAAKY,GAAGuH,gBAAgB0R,MAC/B2K,MAAOA,GAAU9kB,EAAG8kB,OAAS9kB,EAAG8kB,MAAMtiB,QAAQlC,EAAKY,GAAGwP,UAG9D1Q,GAAGkb,QAAUA,EAGjB,QAAS04C,GAAMvrD,EAAOhC,GAClB5G,EAAYoU,IAAI7T,EAAG6V,IAAM,SAAW3D,EAAK69C,MAAM1pD,EAAMrG,EAAGgwD,YAAc,KACrEvvD,KAAK,SAAUH,GACZkN,EAAMjI,MACF8C,MAAOA,EACP/H,KAAMA,EAAKuV,IACXsF,MAAO,YACP5Q,YAAc,2CACdF,YAAa,SAAU,YAAa,OAAQ,QAASwpD,OAKjE,QAASA,GAAcrpD,EAAQmH,EAAWrR,EAAM6a,GAC5C,GAAInb,GAAKwK,CAETxK,GAAGmb,MAAQA,EACXnb,EAAGM,KAAOA,EACVN,EAAGyV,KAAO9D,EAAU8D,KACpBzV,EAAG8R,OAASH,EAAUG,OAG1B,QAASgiD,KACL9zD,EAAGkgC,OAAO36B,MAAO,EACjBiP,EAAS,WACLzV,QAAQ8H,QAAQ,qBAAqB03B,SACtC,KAGP,QAASw1B,KACL/zD,EAAGkgC,OAAO36B,MAAO,EACjBvF,EAAGkxD,MAAMhxB,OAAS,GAClBlgC,EAAGuxD,cAAc,QAEdvxD,EAAGkgC,OAAOyY,KAAKqb,QACdh0D,EAAGkgC,OAAOyY,KAAKsb,eAqBvB,QAASC,GAAY7rD,EAAOhC,EAAMqxC,GAC9BA,EAASrvC,EAAO6J,EAAK69C,MAAM1pD,EAAMrG,EAAGgwD,aA3gBxC,GACImE,GADAn0D,EAAK+I,KAELqrD,EAAQ,EAEZp0D,GAAGkb,WACHlb,EAAGG,MAAQ,KACXH,EAAGqG,KAAO,KAEVrG,EAAGuxD,cAAc,QACjBvxD,EAAGwxD,sBACHxxD,EAAGqxD,mBAEHrxD,EAAGkwD,QAAUA,EACblwD,EAAG8vD,iBAAmBA,EACtB9vD,EAAGmqC,IAAMA,EACTnqC,EAAG2wD,KAAOA,EACV3wD,EAAAA,UAAY4wD,EACZ5wD,EAAG4zD,MAAQA,EACX5zD,EAAGoR,KAAOA,EACVpR,EAAGuwD,QAAUA,EACbvwD,EAAG+zD,aAAeA,EAClB/zD,EAAG8zD,WAAaA,EAChB9zD,EAAGmwD,SAAWA,EACdnwD,EAAGk0D,YAAcA,EACjBl0D,EAAGqwD,YACHrwD,EAAGmnB,aAAc,EACjBnnB,EAAGiwD,iBAAmBA,EACtBjwD,EAAG4vD,cAAgBA,EAEnB5vD,EAAGq0D,SAAW,cAAe,aAAc,cAAe,YAAa,WAAW7xD,QAAQktD,EAAO4E,QAAQz+C,UAEzG7V,EAAGgzD,aACC/7C,QAAQ,EACRs9C,MAAM,EACNr9C,QAAQ,EACRC,UAAQ,EACRy8C,OAAO,EACP1zB,QAAQ,GAGZlgC,EAAGw0D,cAAgBJ,EAAO,GAAI,IAG9Bp0D,EAAG0I,SACC+rD,cAAc,EACdC,aAAa,EACbC,YAAY,EACZC,YAAY,EACZC,iBAAiB,EACjBC,eAAe,EACfC,aAAa,EACbC,YAAY,GAGhBh1D,EAAGkxD,OACCpsC,MAAQ9kB,EAAG8V,OAAOtT,QAAQ,uBAAyB,uBAAwB,GAC3E4xD,MAAOA,EACPv5C,KAAM,EACNqlB,OAAQ,IAGZlgC,EAAGkgC,QACCx3B,SACI6iD,SAAU,MAIlB3gC,IAsbApgB,EAAOojB,OAAO,kBAAmB,SAAUC,EAAUw/B,GAC7CA,IACA8G,EAAWn0D,EAAGkxD,MAAMr2C,MAGrBgT,IAAaw/B,IACZrtD,EAAGkxD,MAAMr2C,KAAO,GAGhBgT,IACA7tB,EAAGkxD,MAAMr2C,KAAOs5C,GAGpBn0D,EAAGmwD,aA/iBXpxD,QACCC,OAAO,OACP24B,UAAU,aACPptB,YAAc,0CACdF,YAAc,SAAU,cAAe,UAAW,QAAS,OAAQ,WAAY,YAAa,WAAY,SAAUolD,GAClH73B,aAAc,KACdC,UACIhiB,IAAK,IACLC,OAAQ,IACRq9C,IAAK,IACL9E,WAAY,IACZnnD,SAAU,IACV8P,WAAY,IACZ85C,OAAQ,IACRqB,OAAQ,IACRU,SAAU,IACV5B,UAAW,IACXl7C,iBAAkB,IAClB+O,MAAO,IACP4tC,eAAgB,IAChBO,YAAa,IACb77C,QAAS,IACTI,cAAe,IACfy9C,OAAQ,IACRxf,QAAS,IACT92B,WAAY,IACZ/I,QAAS,IACTs/C,kBAAmB,IACnBn+C,SAAU,IACVo6C,WAAY,IACZG,UAAW,IACXF,aAAc,IACd1uC,eAAgB;AAChBviB,MAAO,KACPsiB,mBAAoB,IACpB4c,KAAM,IACN1e,cAAc,UAuhB1B,WACI,YAEA5hB,SACKC,OAAO,OACPsvD,SAAS,cACN9zC,IACI26C,KAAM,yBACNx6C,KAAM,yBACNL,SAAU,yBACV86C,QAAS,yBACTC,KAAM,0BACNC,QAAS,yBACT56C,MAAO,2BAEXL,IACI86C,KAAM,uBACNx6C,KAAM,yBACNL,SAAU,yBACV86C,QAAS,yBACTC,KAAM,0BACNC,QAAS,yBACT56C,MAAO,6BAGd0d,UAAU,cAAe,WAAY,UAAW,SAAU5jB,EAAUmD,GACjE,GAAI49C,IACApd,MACIqd,QACIC,QACIC,OACIC,aAAY,KAGpBC,QACIF,OACIG,UAAU,MAItBC,QACI77C,QACI87C,SAAU,KAGlBC,UACIC,KAAM,WAGdC,KACIJ,QACI77C,QACI87C,SAAU,KAGlBP,QACIC,QACIC,OACIC,aAAY,KAGpBC,QACIF,OACIG,UAAU,OAQ9B,QACIx9B,OACIP,MAAO,IACPC,KAAM,IACN1wB,KAAM,IACN1G,MAAO,IACP+c,WAAY,IACZ9C,UAAW,IACXpS,SAAU,KAEd8vB,SAAU,IACVC,KAAM,SAAU5K,EAAI6K,EAAKC,EAAOpuB,GAC5BmK,EAAS,WAWL,QAAS4Q,KAAa,MAAOrmB,SAAQ+D,UAAU6U,EAAQyF,aAEvD,QAAS1P,KACF0X,MACIuI,EAAGmK,MAAM,MAAKnK,EAAGmK,MAAM,KACvBnK,EAAGoK,KAAK,MAAKpK,EAAGoK,KAAK,MAE5BS,EAAInQ,SAASyQ,IAAI,QAAUnL,EAAG,OAAQ,KACtC6K,EAAInQ,SAASyQ,IAAI,SAAWnL,EAAG,MAAO,KACtC6K,EAAI5kB,KAAK,0CAA0C+Z,EAAGmK,MAAM,IAAM,KAAK,cAAcnK,EAAGoK,KAAK,IAAI,KAAK,gCACtGo+B,EAAS39B,EAAI/R,SAAS,OAAOA,SAAS,UACtC0vC,EAAOzvB,KAAK,QAAS/Y,EAAGmK,MAAM,IAAI,KAClCq+B,EAAOzvB,KAAK,SAAU/Y,EAAGoK,KAAK,IAAI,KAClCq+B,EAAS,GAAIC,OAAMF,GACf/0D,KAAMusB,EAAGtmB,MAAQ,OACjB/G,KAAMqtB,EAAGhtB,MACT+H,QAASilB,EAAGnlB,UAAY+sD,EAAgB5nC,EAAGtmB,MAAQ,UA1B3D,GAAI8uD,GAAQC,CACZ59B,GAAI8wB,KAAK,eACT9wB,EAAInQ,SAASyQ,IAAI,WAAW,QAI5BprB,IAiCAigB,EAAGC,OAAO,aAAc,WAAiB7uB,QAAQ+D,UAAU6qB,EAAGjQ,aAAa04C,EAAOl/C,WAIlFyW,EAAGC,OAAO,YAAa,WAAiB7uB,QAAQ+D,UAAU6qB,EAAG/S,YAAYlN,gBAWjG3O,QACCC,OAAO,OACPo5B,UAAU,kBAAkB,UAAU,SAASzgB,GAC9C,GAAI2+C,IACF9sB,WAAY7xB,EAAQ4+C,aAAc5+C,EAAQ6+C,0BAC1CC,UAAU,SAASC,GACjB,MAAOA,GAAKp6B,MAAMo6B,EAAKC,YAAY,KAAK,IAI5C,QACEr+B,SAAS,IACTpxB,SAAS,YACTqxB,KAAK,SAASF,EAAMxxB,EAAQwgC,GAC1B,GAAIqB,GAAOrQ,EAAMu+B,MAAMvvB,EAAWwvB,gBAC9BV,EAAStvD,EAAQqhB,KAAK,UACtBsP,GAAU,MAAM,MAAM,OAAO,MAAM,OAEnCi/B,EAAUH,EAAOG,UAAU/tB,EAAOrd,KAEtC,IAAGmM,EAASh1B,QAAQi0D,MAAe,CAEjC,GAAIpyB,GAAM,GAAIuhB,MACdvhB,GAAIkK,IAAI7F,EAAOrd,KACfirC,EAAOG,UAAU/tB,EAAOrd,MACxBgZ,EAAIwhB,OAAO,WACT,GAAIvR,GAAQ5L,EAAO4L,OAASvrC,KAAKurC,MAAQvrC,KAAKglB,OAAS2a,EAAO3a,OAC1DA,EAAS2a,EAAO3a,QAAUhlB,KAAKglB,OAAShlB,KAAKurC,MAAQ5L,EAAO4L,KAChE6hB,GAAOzvB,MAAM4N,MAAMA,EAAOvmB,OAAOA,IACjCooC,EAAO,GAAGW,WAAW,MAAMC,UAAU1yB,EAAI,EAAE,EAAEiQ,EAAMvmB,UAe7DhvB,QACKC,OAAO,OACPo5B,UAAU,WAAY,UAAW,SAASzgB,GACvC,GAAI2+C,IACA9sB,WAAY7xB,EAAQ4+C,aAAc5+C,EAAQ6+C,0BAC1CQ,OAAQ,SAAS3wD,GACb,MAAOtH,SAAQkD,SAASoE,IAASA,YAAgBsR,GAAQs/C,MAE7DC,QAAS,SAAShT,GACd,GAAI9iD,GAAQ,IAAM8iD,EAAK9iD,KAAKk7B,MAAM4nB,EAAK9iD,KAAKu1D,YAAY,KAAO,GAAK,GACpE,OAAO,yBAAyBn0D,QAAQpB,SAIhD,QACIk3B,SAAU,IACVpxB,SAAU,YACVqxB,KAAM,SAASF,EAAOxxB,EAASwgC,GAc3B,QAAS8vB,GAAW9uD,GAChB,GAAIg8B,GAAM,GAAIuhB,MACdvhB,GAAIwhB,OAASuR,EACb/yB,EAAIkK,IAAMlmC,EAAMs3C,OAAO/e,OAG3B,QAASw2B,KACL,GAAI9iB,GAAQ5L,EAAO4L,OAASvrC,KAAKurC,MAAQvrC,KAAKglB,OAAS2a,EAAO3a,OAC1DA,EAAS2a,EAAO3a,QAAUhlB,KAAKglB,OAAShlB,KAAKurC,MAAQ5L,EAAO4L,KAChE6hB,GAAOzvB,MAAO4N,MAAOA,EAAOvmB,OAAQA,IACpCooC,EAAO,GAAGW,WAAW,MAAMC,UAAUhuD,KAAM,EAAG,EAAGurC,EAAOvmB,GAvB5D,GAAKuoC,EAAO9sB,QAAZ,CAEA,GAAId,GAASrQ,EAAMu+B,MAAMvvB,EAAWgwB,QAEpC,IAAKf,EAAOU,OAAOtuB,EAAOwb,OACrBoS,EAAOY,QAAQxuB,EAAOwb,MAA3B,CAEA,GAAIiS,GAAStvD,EAAQqhB,KAAK,UACtBovC,EAAS,GAAIf,WAEjBe,GAAOzR,OAASsR,EAChBG,EAAOC,cAAc7uB,EAAOwb,aAiB5C,WACI,YAmBA,SAASsT,GAA2BhtD,EAAQ9K,EAASD,EAAaL,EAASg4B,EAAa5pB,GAEpF,GAAIxN,GAAK+I,IACT/I,GAAG65B,SAAW,GAAIzC,IAAcvhB,IAAK,KACrC7V,EAAGN,QAAQA,EACXM,EAAGy3D,iBAEa,MAAbz3D,EAAGwzB,SACFxzB,EAAGwzB,SAAWxzB,EAAG65B,SAAS69B,MAE1B13D,EAAG65B,SAAS69B,MAAQ13D,EAAGwzB,SAE3BxzB,EAAG23D,SAAW33D,EAAG43D,WAAWp8C,QAAQ,UAAW,KAAKhK,aACpD,IAAIqoB,GAAW75B,EAAG65B,QAClBA,GAASg+B,QAAQ/xD,MACT2B,KAAM,aACNqwD,GAAI,SAAUzxD,GACV,GAAIjF,GAAO,IAAMiF,EAAKjF,KAAKk7B,MAAMj2B,EAAKjF,KAAKu1D,YAAY,KAAO,GAAK,GACnE,OAAO32D,GAAG43D,WAAWp1D,QAAQpB,WAKzCpB,EAAG+3D,QAAU,WACTh5D,QAAQ8H,QAAQ,sBAAsBg+B,QAAQ,UAIlD7kC,EAAGg4D,SAAY,SAAS9T,GAChB,GAAI9iD,GAAQ,IAAM8iD,EAAK9iD,KAAKk7B,MAAM4nB,EAAK9iD,KAAKu1D,YAAY,KAAO,GAAK,GACpE,OAAO,yBAAyBn0D,QAAQpB,SAIhDpB,EAAGg4B,SAAW,SAAST,GAErB/pB,EAAM6B,QAAQ,uCAAwC,WACpD,GAAIka,GAAOvpB,EAAGob,QAAQ5Y,QAAQ+0B,EAG1BhO,QAEFvpB,EAAGob,QAAQnS,OAAOsgB,EAAQ,GAE1BvpB,EAAGy3D,cAAc3xD,KAAKyxB,OA7DhCx4B,QACCC,OAAO,OACP24B,UAAU,oBACPptB,YAAc,wDACdF,YAAc,SAAU,UAAW,cAAe,UAAW,eAAe,QAASmtD,GACrF5/B,aAAc,KACdC,UACIrE,SAAU,IACVokC,WAAY,IACZK,eAAgB,IAChBC,cAAe,IACfC,aAAc,IACdC,sBAAuB,IACvBh9C,QAAQ,UA8DpB,WACI,YAMA,SAAS6L,KAEL,GAAIgS,IACA5Q,OAAQ,GACRisC,QAAS,GACTvsC,UAAW,SAAUM,GACjBtf,KAAKsf,OAASA,GAElBL,WAAY,SAAUssC,GAClBvrD,KAAKurD,QAAUA,GAEnB+D,UAAW,WACP,MAAOtvD,MAAKsf,QAEhBiwC,WAAY,WACR,MAAOvvD,MAAKurD,SAIpB,OAAOr7B,GAvBXl6B,QACCC,OAAO,OACPi6B,QAAQ,oBAAqBhS,MA0BlC,WACI,YAcA,SAASsxC,GAAqBn5D,EAASE,EAAW2nB,EAAmB/U,GAQjE,QAAS0Y,KACL,GAAIxrB,EAAQ4sD,MAAM,QAAS,CACvB,GAAInxC,GAAO3I,EAAK4V,cAAc1oB,EAAQyO,WAAW,QAASvO,EAAUoG,OAAO8V,QAAQ,IAAK,IACxFyL,GAAkBc,UAAUlN,EAAK,IACjCoM,EAAkBe,WAAWnN,EAAK,KAI1C,QAASw9C,KACL,MAAOpxC,GAAkBoxC,YAG7B,QAASC,KACL,MAAOrxC,GAAkBqxC,aApB7B,GAAIt4D,GAAK+I,IAET/I,GAAGq4D,UAAYA,EACfr4D,EAAGs4D,WAAaA,EAEhB1tC,IAiBJ2tC,EAAqBjrD,SAAW,UAAW,YAAa,oBAAqB,QAnC7EvO,QACCC,OAAO,OACP24B,UAAU,cACPptB,YAAc,4CACdF,YAAc,UAAW,YAAa,oBAAqB,OAAQkuD,GACnE1gC,iBAmCR,WACI,YAOA,SAAS2gC,KAuBL,QAASn4D,GAAYgH,GACjB,MAAOoxD,GAAM1vD,KAAK2vD,UAAUrxD,GAAMH,UAGtC,QAAS6F,GAAQsrC,GACb,MAAOxlB,QAAOC,KAAKulB,GAAGl3C,OAE1B,QAASgM,GAAmBtH,GACxB,IAAK,GAAItD,KAAKsD,GACV,IAAK,GAAI3E,GAAI,EAAGA,EAAI2E,EAAMtD,GAAGpB,OAAQD,IAC9BnC,QAAQ+D,UAAU+C,EAAMtD,GAAGrB,GAAGy3D,aAC7B9yD,EAAMtD,GAAGrB,GAAGy3D,YAAa,EACzBxrD,EAAmBtH,EAAMtD,GAAGrB,GAAG+L,SAE5BpH,EAAMtD,GAAGrB,GAAG03D,aACX/yD,EAAMtD,GAAGrB,GAAG03D,aAAY,GAW5C,QAAS12D,GAAW5B,EAAM0J,GAIlB,IAAK,GAHLkiD,GACA2M,KACA/lC,KACS5xB,EAAI,EAAGA,EAAIZ,EAAKa,OAAQD,IAC/B,GAAkB,UAAdZ,EAAKY,GAAGE,KACR,IAAK,GAAI4E,GAAI,EAAGA,EAAI1F,EAAKY,GAAG+E,WAAW9E,OAAQ6E,IAC3CkmD,EAAOhmD,EAAc5F,EAAKY,GAAG+E,WAAWD,IACxC8yD,EAAU5M,EAAMp5B,EAAM9oB,EAAO6uD,OAGjC3M,GAAOhmD,EAAc5F,EAAKY,IAC1B43D,EAAU5M,EAAMp5B,EAAM9oB,EAAO6uD,EAGvC,OAAOA,GAUX,QAASC,GAAU5M,EAAMp5B,EAAM9oB,EAAO6uD,GAChC95D,QAAQ2K,YAAYopB,EAAKo5B,EAAK9qD,QAC9B0xB,EAAKo5B,EAAK9qD,MAAQ,EAClB8qD,EAAKx7C,IAAMw7C,EAAK9qD,KAAO,OAEvB8qD,EAAKx7C,IAAMw7C,EAAK9qD,KAAM,IAAK0xB,EAAKo5B,EAAK9qD,MACrC0xB,EAAKo5B,EAAK9qD,SAEVrC,QAAQ+D,UAAUkH,EAAMkiD,EAAKx7C,QAAOmoD,EAAU3M,EAAKx7C,KAAO3R,QAAQuD,KAAK0H,EAAMkiD,EAAKx7C,OAQxF,QAASqoD,GAAYC,EAAiBC,GAClC,IAAK,GAAIjzD,GAAI,EAAGA,EAAIgzD,EAAgB73D,OAAQ6E,IAGxC,GAA+B,cAA3BgzD,EAAgBhzD,GAAG5E,KAAsB,CACzC,GAAIb,GAASy4D,EAAgBhzD,GAAGyC,gBAAgB0R,KAC7C8+C,GAAcxmC,eAAelyB,KAC5B04D,EAAc14D,GAAU,GAAI0O,MAAKgqD,EAAc14D,MAU/D,QAASyB,GAAW1B,EAAM0J,GAItB,IAAK,GAHDkiD,GACAvT,KACA7lB,KACK5xB,EAAI,EAAGA,EAAIZ,EAAKa,OAAQD,IAC7B,GAAkB,UAAdZ,EAAKY,GAAGE,KAAgB,CACxB,GAAI83D,GAAKT,EAAMn4D,EAAKY,IAChBi4D,EAAQ,SAAS/iB,SAAS,IAAI8iB,EAAGjxD,kBAAkB,mBAChDixD,GAAG93D,WACH83D,GAAGjxD,kBAAkB,YAC5BixD,EAAGjzD,aACH,KAAK,GAAID,GAAI,EAAGA,EAAI1F,EAAKY,GAAG+E,WAAW9E,OAAQ6E,IAC3CkmD,EAAOhmD,EAAc5F,EAAKY,GAAG+E,WAAWD,IACxCkmD,EAAKkN,WAAaD,EAClBE,EAAcnN,EAAMp5B,EAAM9oB,GAC1BkvD,EAAGjzD,WAAWH,KAAKomD,EAEvBvT,GAAK7yC,KAAKozD,OAEVhN,GAAOhmD,EAAc5F,EAAKY,IAC1Bm4D,EAAcnN,EAAMp5B,EAAM9oB,GAC1B2uC,EAAK7yC,KAAKomD,EAIlB,OAAOvT,GAOX,QAASnqC,GAAYlO,EAAMsG,GACvB7H,QAAQ0oB,QAAQnnB,EAAM,SAASy/C,GAC3B,GAAIhhD,QAAQ+D,UAAUi9C,EAAM95C,YACxB,IAAK,GAAI/E,GAAI,EAAGA,EAAI6+C,EAAM95C,WAAW9E,OAAQD,IACtC6+C,EAAM95C,WAAW/E,GAAGuH,kBACnBs3C,EAAM95C,WAAW/E,GAAGuH,gBAAgBw1C,SAAWr3C,OAGpDm5C,GAAMt3C,kBACLs3C,EAAMt3C,gBAAgBw1C,SAAWr3C,KAYjD,QAASyyD,GAAcnN,EAAMp5B,EAAM9oB,GAqB/B,GApBGjL,QAAQ2K,YAAYopB,EAAKo5B,EAAK9qD,QAC7B0xB,EAAKo5B,EAAK9qD,MAAQ,EAClB8qD,EAAKx7C,IAAMw7C,EAAK9qD,KAAO,OAEvB8qD,EAAKx7C,IAAMw7C,EAAK9qD,KAAM,IAAK0xB,EAAKo5B,EAAK9qD,MACrC0xB,EAAKo5B,EAAK9qD,SAEG,UAAd8qD,EAAK9qD,OACJ8qD,EAAKzjD,gBAAgB2wD,UAAY,sBAEpB,eAAdlN,EAAK9qD,MAAyBrC,QAAQ+D,UAAUkH,IAAUjL,QAAQ+D,UAAUkH,EAAMkiD,EAAKx7C,QACtF1G,EAAMkiD,EAAKx7C,KAAO,GAAIzB,MAAKjF,EAAMkiD,EAAKx7C,OAKzB,aAAdw7C,EAAK9qD,OACJ8qD,EAAKzjD,gBAAgB6wD,MAAO,GAG7BpN,EAAKzjD,gBAAgB,CACpB,GAAIjB,IAAc+xD,YAIlB,IAHGrN,EAAKzjD,gBAAgB6pD,WACpB9qD,EAAW+xD,SAASjH,SAAW,6BAEnB,UAAZpG,EAAK9qD,KAAe,CACpB,GAAIo4D,IACAC,uBAAwB,mEACxBC,OAAQ,yCACRC,0BAA2B,wEAC3BC,0KAA2K,uCAC3KC,sCAAsC,4DAEvC3N,GAAKzjD,gBAAgBoE,UAASrF,EAAW+xD,SAAS1sD,QAAU2sD,EAAItN,EAAKzjD,gBAAgBoE,UAExFrF,EAAWjC,MAAO,EAClB2mD,EAAK1kD,WAAaA,IAU9B,QAASsyD,GAAWd,EAAiB9uD,GASjC,IAAK,GAPD6vD,GAAe7vD,EAAO8vD,UAAY,EAElCb,EAAM,cAAgB/iB,SAAS,IAAI2jB,GAEnCE,EAAY7jB,SAAU4iB,EAAgB73D,OAAS44D,GAAiB,EAEhEG,KACKh5D,EAAI,EAAGA,EAAI+4D,EAAW/4D,IAC3Bg5D,EAAWp0D,MACPmC,mBACIkyD,eAAgB,MAChBtuD,OAAU,SACVuuD,qBAAsB,aAE1Bn0D,eAGR/E,GAAI,CAEJ,KADA,GAAIqB,GAAI,EACArB,EAAI83D,EAAgB73D,QAAS,CAEjC,IADA,GAAI6E,GAAI,EACD9E,EAAI83D,EAAgB73D,QAAU6E,EAAI+zD,GAAe,CAoBpD,GAlBAf,EAAgB93D,GAAGk4D,UAAYD,EAGiB,KAA7CH,EAAgB93D,GAAGuH,gBAAgB0R,OAA6D,OAA7C6+C,EAAgB93D,GAAGuH,gBAAgB0R,MACrF6+C,EAAgB93D,GAAGwP,IAAMsoD,EAAgB93D,GAAGuH,gBAAgBgwC,YAE3DugB,EAAgB93D,GAAGwP,IAAMsoD,EAAgB93D,GAAGuH,gBAAgB0R,MAGlC,UAA5B6+C,EAAgB93D,GAAGE,OAClB43D,EAAgB93D,GAAGuH,gBAAgB2wD,UAAY,sBAGhDlvD,EAAOmwD,aACNrB,EAAgB93D,GAAGuH,gBAAgBw1C,UAAW,EAE9C+a,EAAgB93D,GAAGuH,gBAAgBw1C,UAAW,EAE/C/zC,EAAOowD,eACyB,UAA5BtB,EAAgB93D,GAAGE,KAAiB,CACnC,GAAIm5D,GAAU,UAAYvB,EAAgB93D,GAAGwP,IAAM,eAAiBsoD,EAAgB93D,GAAGwP,IAAM,kBAC7FsoD,GAAgB93D,GAAGuH,gBAAgB+xD,QAAUD,EAIlDrwD,EAAOuwD,aACyB,UAA5BzB,EAAgB93D,GAAGE,MAAgD,eAA5B43D,EAAgB93D,GAAGE,OACzD43D,EAAgB93D,GAAGsG,YACf+xD,UACIjH,SAAU,gCAO1B4H,EAAW33D,GAAG0D,WAAWH,KAAKI,EAAc8yD,EAAgB93D,KAC5DA,IACA8E,IAEJzD,IAGJ,MAAO23D,GAMX,QAASh0D,GAAcG,GACnB,GAAc,UAAXA,EAAKjF,KAAgB,MAAOq3D,GAAMpyD,EACrC,IAAIu+C,IACAxjD,KAAMiF,EAAKjF,KACXsP,IAAKrK,EAAKqK,IACV0oD,UAAWX,EAAMpyD,EAAK+yD,WACtB3wD,gBAAiBgwD,EAAMpyD,EAAKoC,iBAC5BjB,WAAYixD,EAAMpyD,EAAKmB,YACvBkzD,qBAAsBjC,EAAMpyD,EAAKq0D,sBACjCrwD,WAAYouD,EAAMpyD,EAAKgE,YAE3B,OAAOu6C,GAKX,QAAS6T,GAAMn4D,GACX,MAAOvB,SAAQ+B,SAAS/B,QAAQ0D,OAAOnC,IAG3C,QAASq6D,KAEL1hC,EAAQy/B,WACJ3sD,OACI7E,UACI9F,KAAM,QACNsP,IAAK,YACLjI,iBACIrH,KAAM,OACN+Y,MAAO,iBACP8jC,UAAU,KAItBjyC,OACI9E,UACI9F,KAAM,QACNsP,IAAK,aACLjI,iBACI0R,MAAO,mBACPygD,UAAW,QACXC,UAAW,KACXC,UAAS,EACTpyD,UACKC,MAAO,WAAY/F,GAAI,aACvB+F,MAAO,WAAY/F,GAAI,gBAKxCqJ,QACI/E,UACI9F,KAAM,SACNsP,IAAK,cACLjI,iBACI0R,MAAO,qBACPyE,UAAU,EACVg8C,UAAW,QACXC,UAAW,KACXE,UAAU,EACVryD,UACKC,MAAO,WAAY/F,GAAI,aACvB+F,MAAO,WAAY/F,GAAI,gBAKxCsJ,iBACIhF,UACI9F,KAAM,SACNsP,IAAK,cACLjI,iBACI0R,MAAO,qBACPyE,UAAU,EACVg8C,UAAW,QACXC,UAAW,KACXnyD,UACMC,MAAO,WAAY/F,GAAI,aACvB+F,MAAO,WAAY/F,GAAI,gBAKzCuJ,UACIjF,UACI9F,KAAM,WACNsP,IAAK,gBAELjI,iBACI0R,MAAO,gBACPnV,KAAM,EACNs0D,MAAM,KAIlBltD,UACIlF,UACI9F,KAAM,WACNsP,IAAK,gBACLjI,iBACI0R,MAAO,0BACP8jC,UAAU,KAItB5xC,YACInF,UACI9F,KAAM,aACNsP,IAAK,kBACLjI,iBACI0R,MAAO,gBAenB7N,QACIpF,UACI9F,KAAM,SACNsP,IAAK,cACLjI,iBACI0R,MAAO,aACP6c,IAAK,EACLxP,IAAK,EACLwzC,KAAM,GACNC,UAAU,KAItB1uD,UACIrF,UACI9F,KAAM,SACNsP,IAAK,cACLjI,iBACI0R,MAAO,iBAInB3N,OACItF,UACI9F,KAAM,QACNsP,IAAK,aACLjI,iBACI0R,MAAO,iBACPs+B,YAAa,YACbyiB,qBAAsB,kBACtBC,kBAAmB,SACnBC,WAAY,oBAUxB3vD,QACIvE,UACI9F,KAAM,QACNsP,IAAK,QACLjI,iBACI0R,MAAO,SACP9S,KAAM,KACN+xD,UAAW,eACXiC,MAAM,EACNC,MAAM,KAIlB5vD,WACIxE,UACI9F,KAAM,QACNsP,IAAK,QACLjI,iBACI0R,MAAO,YACP9S,KAAM,KACN+xD,UAAW,eACXiC,MAAM,EACNC,MAAM,KAIlB3vD,SACIzE,UACI9F,KAAM,QACNsP,IAAK,UACLjI,iBACI0R,MAAO,0JACP9S,KAAM,IACN+xD,UAAW,kBACXiC,MAAM,EACNC,MAAM,KAIlB1vD,OACI1E,UACI9F,KAAM,QACNsP,IAAK,QACLjI,iBACI0R,MAAO,qBACPi/C,UAAW,eACX/xD,KAAM,KACN0zD,UAAU,EACVryD,SACI,aACA,iBAKhB2C,gBACInE,UACI9F,KAAM,iBACNsP,IAAK,iBACLjI,iBACI8yD,OAAQ,GACRC,SAAU,QACVT,UAAU,EACVx1D,MACIqJ,MAAM,EACNC,KAAK,EACL4sD,IAAI,EACJv1B,KAAK,MAKrBw1B,YACEx0D,UACE9F,KAAM,aACNsP,IAAK,aACLjI,iBACE8yD,OAAQ,GACRC,SAAU,QACVj2D,MACEqJ,MAAM,EACNC,KAAK,EACL4sD,IAAI,EACJv1B,KAAK,MAKb16B,wBACItE,UACI9F,KAAM,yBACNsP,IAAK,yBACLjI,iBACE8yD,OAAQ,GACRphD,MAAO,kBAIjBxN,gBACIzF,UACI9F,KAAM,iBACNsP,IAAK,iBACLjI,iBACI8yD,OAAQ,GACRphD,MAAO,yBAInBkW,kBACInpB,UACI9F,KAAM,mBACNsP,IAAK,mBACLjI,iBACE8yD,OAAQ,GACRphD,MAAO,kBAIjBwhD,WACIz0D,UACI9F,KAAM,YACNsP,IAAK,YACLjI,iBACI8yD,OAAQ,GACRphD,MAAO,iBAInBka,SACIntB,UACI9F,KAAM,UACNsP,IAAK,UACLjI,iBACI0R,MAAO,gBAInB/D,MACIlP,UACI9F,KAAM,OACNqH,iBACImzD,UAAW,OACXC,WAAY,QACZx0D,KAAM,UACNy0D,iBAAiB,QACjBC,SAAS,YAIrBzwD,QACIpE,UACI9F,KAAM,SACNqH,iBACI8yD,OAAQ,GACRS,OAAQ,aAIpBzwD,aACIrE,UACI9F,KAAM,cACNqH,iBACI0R,MAAO,YAInBtO,QACI3E,UACI9F,KAAQ,SACR6G,mBACIg0D,WAAY,IACZC,eAAgB,YAChBrwD,OAAU,OAEd5F,gBAGR6F,OACI5E,UACI9F,KAAM,QACNqH,iBACIslB,OAAQ,EACRD,YAIZrhB,WACIvF,UACI9F,KAAM,YACNqH,iBACIpB,KAAM,aAIlBqF,2BACExF,UACE9F,KAAM,4BACNqH,iBACE0R,MAAO,gDAnoBrB,GAAI8e,IACA/yB,cAAeA,EACfuyD,MAAOA,EACPqB,WAAYA,EACZf,YAAaA,EACb14D,YAAaA,EACb2B,WAAYA,EACZ+K,QAASA,EACTI,mBAAoBA,EACpBqB,YAAaA,EACbtM,WAAYA,EAKhB,OAFAy4D,KAEO1hC,EAtBXl6B,QACCC,OAAO,OACPi6B,QAAQ,aAAcu/B,MAkpB3B,WACI,YAOA,SAAS2D,GAAYxkD,EAASykD,GA4C1B,QAASC,GAAMn1D,EAAU5G,GACrB,MAAO4G,GAASsU,QAAQ,iBAAkB,SAAUmV,EAAKjgB,GAErD,IAAK,GADDoiB,GAAOpiB,EAAIxL,MAAM,KAAMyd,EAAIriB,EAAKwyB,EAAKnpB,SAChCzI,EAAI,EAAGm7B,EAAIvJ,EAAK3xB,OAAOD,EAAIm7B,EAAEn7B,IAClCyhB,EAAIA,EAAEmQ,EAAK5xB,GACf,OAAqB,mBAANyhB,IAA2B,OAANA,EAAcA,EAAI,KAI9D,QAAS0wC,GAAQzO,GACb,SAAYpzB,SAAS2K,KAAKyoB,GAAKvf,MAAM,iBAAiB,GAAG8B,cAG7D,QAASm1B,GAAQ12C,GACb,MAAO,gBAAgBsM,KAAKtM,EAAKpK,QAAQ,mBAAoB,KACzDA,QAAQ,mEAAoE,KAC5EA,QAAQ,uBAAwB,KAGxC,QAAS+gD,GAAU32C,EAAMzkB,GACrB,MAAOykB,GAAKzkB,OAASA,EAAUykB,EAAKigB,UAAU,EAAGhoB,KAAKmZ,IAAI71B,EAAQykB,EAAKzkB,SAAW,MAASykB,EAG/F,QAAS42C,GAAU3qC,GACf,MAAOA,GAAMrW,QAAQ,gBAAgB,IAGzC,QAASihD,GAAW71C,EAAG8rB,GACnB,GAAIxT,GAAQtY,EAAEsY,MAAMw9B,aACpBC,EAAS/1C,EAAE+1C,OAAOD,YAElB91C,GAAEsY,MAAMkQ,SAAWxoB,EAAEsY,MAAMkQ,UAAY,EACvCxoB,EAAE+1C,OAAOvtB,SAAWxoB,EAAE+1C,OAAOvtB,UAAY,CAEzC,IAAIhuC,GAAOiyD,EAAO3gB,EAAK9rB,EAAEsY,MAAMkQ,UAY/B,OAXY,aAARhuC,IACIA,GAAQwlB,EAAEsY,MAAM99B,MAChB89B,EAAQwT,EAAK9rB,EAAEsY,MAAMkQ,UACrButB,EAAStJ,EAAO3gB,EAAK9rB,EAAE+1C,OAAOvtB,YAAcxoB,EAAE+1C,OAAOv7D,KAAOsxC,EAAK9rB,EAAE+1C,OAAOvtB,UAAYxoB,EAAE+1C,OAAOD,cAE3Ft7D,GAAQwlB,EAAE+1C,OAAOv7D,OACjB89B,EAAQm0B,EAAO3gB,EAAK9rB,EAAE+1C,OAAOvtB,YAAcxoB,EAAEsY,MAAM99B,KAAOsxC,EAAK9rB,EAAE+1C,OAAOvtB,UAAYxoB,EAAEsY,MAAMw9B,aAC5FC,EAASjqB,EAAK9rB,EAAEsY,MAAMkQ,aAK9BlQ,MAAQA,EACRy9B,OAASA,GAIjB,QAAS/I,GAAOhgD,EAAMklB,GAClB,GAAkB,gBAAPA,GACP/5B,QAAQ8H,QAAQrG,IAAIs4B,EAAK,SAAUvmB,GAC/B,GAAIqqD,GAAQjlD,EAAQge,KAAK,GAAI,QAC7BinC,GAAMx/B,SAASy/B,MAAMR,EAAKS,GAAax+B,KAAO1qB,EAAMklB,IAAMvmB,KAC1DqqD,EAAMx/B,SAASryB,QACf6xD,EAAMr+B,QACNq+B,EAAMhJ,QACNgJ,EAAM7xD,cAEP,CACH,GAAI6xD,GAAQjlD,EAAQge,KAAK,GAAI,QAC7BinC,GAAMx/B,SAASy/B,MAAMR,EAAKS,GAAax+B,KAAO1qB,EAAMklB,IAAMA,KAC1D8jC,EAAMx/B,SAASryB,QACf6xD,EAAMr+B,QACNq+B,EAAMhJ,QACNgJ,EAAM7xD,QAGV,OAAO,EAGX,QAAS6xD,GAAM/mD,GACX8B,EAAQge,KAAK9f,EAAK,SAGtB,QAASq4C,KACA6O,EAAUC,mBACVD,EAAUE,sBAAyBF,EAAUG,yBAA4BH,EAAUI,oBAWhFJ,EAAUK,eACVL,EAAUK,iBACHL,EAAUM,iBACjBN,EAAUM,mBACHN,EAAUO,oBACjBP,EAAUO,sBACHP,EAAUQ,sBACjBR,EAAUQ,uBAjBVR,EAAUS,gBAAgBC,kBAC1BV,EAAUS,gBAAgBC,oBACnBV,EAAUS,gBAAgBE,oBACjCX,EAAUS,gBAAgBE,sBACnBX,EAAUS,gBAAgBG,qBACjCZ,EAAUS,gBAAgBG,uBACnBZ,EAAUS,gBAAgBI,yBACjCb,EAAUS,gBAAgBI,wBAAwBC,QAAQC,sBAetE,QAAS7L,GAAa3xD,EAAMwV,GACxB,GAAqB,mBAAVA,IAA0C,GAAjBA,EAAO3U,OACvC,MAAOb,EAEX,IAAI4/B,KACJ,KAAK,GAAIh/B,KAAK4U,GAAQ,CAClB,GAAIiqC,GAAQmT,EAAY5yD,EAAMwV,EAAO5U,GACjC6+C,IACA7f,EAAOp6B,KAAKi6C,GAGpB,MAAO7f,GAGX,QAASgzB,GAAYp9C,EAAQiqC,GACzB,IAAK,GAAI7+C,KAAK4U,GACV,GAAIA,EAAO5U,GAAGwP,KAAOqvC,EACjB,MAAOjqC,GAAO5U,EAGtB,OAAO,MAGX,QAASgxD,GAAoB5xD,EAAM6xD,GAC/B,GAAqB,mBAAVA,IAA0C,GAAjBA,EAAOhxD,OACvC,MAAOb,EAEX,KAAK,GAAIY,KAAKZ,GAAM,CAChB,GAAIy/C,GAAQmT,EAAYf,EAAQ7xD,EAAKY,GAAGwP,IACpCqvC,KAEAz/C,EAAKY,GAAKnC,QAAQ8H,QAAQi1B,QAAO,KAAUx7B,EAAKY,GAAI6+C,IAG5D,MAAOz/C,GAGX,QAAS80B,GAAKwvB,GACV,MAAO/xB,QAAOC,KAAK8xB,GAAKzjD,OAG5B,QAASmvD,GAAUhwD,EAAM6xD,GACrB,GAAInvC,GAAWo5C,EAAU57D,IAAI,YACzB6F,IACJ,KAAK,GAAInF,KAAKZ,GACa,QAAnB+yD,EAAO/yD,EAAKY,IACZmF,EAAKnF,GAAK8hB,EAASkC,OAAO5kB,EAAKY,GAAI,cAEb,gBAAXZ,GAAKY,IAA8B,QAAXZ,EAAKY,IAA2B,SAAXZ,EAAKY,GAGzDmF,EAAKnF,GAAKZ,EAAKY,GAFfmF,EAAKnF,GAAgB,QAAXmF,EAAKnF,EAO3B,OADAmF,GAAKzD,GAAKmtD,EAAM1pD,EAAM8rD,GACf9rD,EAGX,QAAS0pD,GAAM1pD,EAAM8rD,EAAQzhD,GACzB,GAAIrK,EACA,IAAK,GAAInF,KAAKixD,GACV,GAAIA,EAAOjxD,GAAGuH,gBAAgB0R,OAA4C,MAAnCg4C,EAAOjxD,GAAGuH,gBAAgB0R,MAC7D,MAAIzJ,GACOyhD,EAAOjxD,GAAGwP,IAEVrK,EAAK8rD,EAAOjxD,GAAGwP,IAKtC,OAAO,MAGX,QAAS6iD,GAAUvD,EAAYt/C,EAAK/H,GAUhC,MATAqnD,GAAW9vB,OAAO,SAAU3C,GACpBA,EAAE7sB,KAAOA,GAAO6sB,EAAE90B,gBAAgBC,SAClC60B,EAAE90B,gBAAgBC,QAAQw3B,OAAO,SAASgsB,GAClCA,EAAKvjD,OAASA,IACdA,EAAQujD,EAAKzkD,UAKtBkB,EAQX,QAASo1D,GAAUC,GACf,GAAI/rC,KACJ,KAAK,GAAI/wB,KAAK88D,GACV/rC,EAAOnsB,KAAK5E,EAAI,IAAM88D,EAAK98D,GAE/B,OAAO+wB,GAAO6U,KAAK,KAGvB,QAASm3B,GAAgBD,EAAME,GAC3B,GAAIjsC,KACJ,KAAK,GAAI/wB,KAAK88D,GAAM,CAChB,GAAGE,EACC,IAAK,GAAIl4D,KAAKg4D,GAAK98D,GACE,MAAZ88D,EAAK98D,GAAG8E,IAAwByN,QAAZuqD,EAAK98D,GAAG8E,IAA6B,IAAZg4D,EAAK98D,GAAG8E,UAC/Cg4D,GAAK98D,GAAG8E,EAIxB6sB,QAAOC,KAAKkrC,EAAK98D,IAAIC,OAAS,GAC7B8wB,EAAOnsB,KAAK5E,EAAI,IAAMnC,QAAQ0D,OAAOu7D,EAAK98D,KAElD,MAAO+wB,GAAO6U,KAAK,KAGvB,QAAShf,GAAcR,EAAMzR,GACzB,IAAK,GAAI3U,KAAKomB,GACV,GAA8B,mBAAnBA,GAAKpmB,GAAG6qD,QAAwB,CACvC,GAAIoS,GAAQ72C,EAAKpmB,GAAG6qD,OACpB,KAAK,GAAI/lD,KAAKm4D,GACV,GAAIA,EAAMn4D,GAAG6P,KAAOA,EAChB,OAAQyR,EAAKpmB,GAAGiZ,MAAOgkD,EAAMn4D,GAAGmU,OAKhD,IAAK,GAAI5X,KAAK+kB,GACV,GAAIA,EAAK/kB,GAAGsT,KAAOA,EACf,OAAQyR,EAAK/kB,GAAG4X,OAAO,EAG/B,SAAQ,GAAM,GAGlB,QAASm5C,GAAchzD,EAAMoQ,GACzB,IAAK,GAAIxP,KAAKZ,GACV,GAAIA,EAAKY,GAAGwP,KAAOA,GAAOpQ,EAAKY,GAAGuH,iBAAmBnI,EAAKY,GAAGuH,gBAAgBC,QACzE,MAAOpI,GAAKY,GAAGuH,gBAAgBC,QAAQvH,MAG/C,OAAO,GAGX,QAASqyD,GAAWz1C,GAEhB,MADAA,GAAOA,EAAK7Y,MAAM,MACV6Y,EAAK,GAAIA,EAAK,GAAIA,EAAK,IAAI+oB,KAAK,KAG5C,QAAS+pB,GAAWvwD,GAChB,GAAI0iB,GAAWo5C,EAAU57D,IAAI,WAC7B,KAAK,GAAIU,KAAKZ,GACY,gBAAXA,GAAKY,KACR8hB,EAAS2pC,OAAOrsD,EAAKY,IAClB,aAAegxB,KAAK5xB,EAAKY,MAC5BZ,EAAKY,GAAK,GAAI+N,QACN,aAAaijB,KAAK5xB,EAAKY,KAAO,sDAAsDgxB,KAAK5xB,EAAKY,KAAyB,GAAlBZ,EAAKY,GAAGC,SACrHb,EAAKY,GAAKuyD,EAAWnzD,EAAKY,KAItC,OAAOZ,GAGX,QAASmzD,GAAWrgC,GAEhB,MADAA,GAAOA,EAAKluB,MAAM,MACVkuB,EAAK,GAAIA,EAAK,IAAI0T,KAAK,KAGnC,QAASisB,GAAQzyD,GACb,GAAIwyD,KAMJ,OAJAxyD,GAAK+a,IAAI,SAASkU,GACdujC,EAAMvjC,EAAG7e,KAAO6e,IAGbujC,EASX,QAAS7+C,GAAW4B,EAAKuoD,GAGrB,QAASC,GAAWxjD,GAChB,GAAIyjD,GAAWzjD,EAAK0jD,YAAYC,GAC5BrI,EAAS/4B,SAASqhC,cAAc,UAChC9rB,EAAMwjB,EAAOW,WAAW,MACxB4H,GACAC,cAAehsB,EACf2rB,SAAUA,EAEdnI,GAAOpoC,OAASuwC,EAASvwC,OACzBooC,EAAO7hB,MAAQgqB,EAAShqB,MACxB6hB,EAAOroC,MAAQ,2BAEfsP,SAASwhC,cAAcR,GAAmB3uB,YAAY0mB,GACtDt7C,EAAKwjC,OAAOqgB,GAGhB,QAASG,GAAYC,GACjB,IAAI,GAAI35D,GAAM,EAAGA,GAAO25D,EAAOC,SAAU55D,IACrC25D,EAAOE,QAAQ75D,GAAK1E,KAAK49D,GApBjCY,MAAMC,UAAY9C,EAAU57D,IAAI,WAAa,2BAC7C,IAAIg+D,GAAO,GAqBXS,OAAME,eAAgB,EACtBF,MAAMG,YAAYvpD,GAAKpV,KAAKo+D,GAlWhC,GAAI9B,GAAYplD,EAAQylB,SAEpB0/B,EAAY,2IAWZ7jC,GACAo6B,OAAQA,EACRiJ,OAAQA,EACRG,UAAWA,EACX7I,MAAOA,EACP1F,WAAYA,EACZmO,KAAMA,EACNO,MAAOA,EACP3K,aAAcA,EACdC,oBAAqBA,EACrB98B,KAAMA,EACNm+B,UAAWA,EACXwK,UAAWA,EACXE,gBAAiBA,EACjBn2C,cAAeA,EACforC,YAAaA,EACbI,cAAeA,EACfE,WAAYA,EACZ3C,WAAYA,EACZkC,QAASA,EACThD,MAAOA,EACPO,UAAWA,EACXiM,SAAUA,EACVtoD,WAAYA,EACZuoD,UAAWA,EAGf,OAAOvjC,GAXXkjC,EAAY7uD,SAAW,UAAW,aApClCvO,QACCC,OAAO,OACPi6B,QAAQ,QAAS,UAAW,YAAakjC,OA6W9C,WACI,YAOA,SAASkD,GAAe1nD,EAAS2nD,GA2B7B,QAAS53C,GAAQL,GACbhZ,EAAW,OAAQgZ,GAGvB,QAASja,KACL,MAAOS,GAAW,QAGtB,QAASw9C,KACL,MAAOkU,GAAa,QAGxB,QAASC,KACLnuD,EAAc,QAGlB,QAASouD,KACL,MAAOC,GAAO50C,QAAQw0C,EAAU,UAIpC,QAASK,GAAIjvD,EAAK/H,GACd+2D,EAAOp0C,QAAQg0C,EAAU,IAAM5uD,EAAK3R,QAAQ0D,OAAOkG,IAGvD,QAASnI,GAAIkQ,GACT,MAAO3R,SAAQ+B,SAAS4+D,EAAO50C,QAAQw0C,EAAU,IAAM5uD,IAG3D,QAASozB,GAAOpzB,GACZgvD,EAAO51D,WAAWw1D,EAAU,IAAM5uD,GAGtC,QAAS1F,KACL,IAAI,GAAIgpB,KAAK0rC,GACTA,EAAO51D,WAAWkqB,GAG1B,QAASg4B,GAAMt7C,GACX,MAAqD,mBAAvCgvD,GAAO50C,QAAQw0C,EAAU,IAAM5uD,IAA8D,MAAvCgvD,EAAO50C,QAAQw0C,EAAU,IAAM5uD,IAAuD,aAAvCgvD,EAAO50C,QAAQw0C,EAAU,IAAM5uD,GAItJ,QAASrC,GAAWqC,EAAK/H,GACrBi3D,EAASt0C,QAAQg0C,EAAU,IAAM5uD,EAAK3R,QAAQ0D,OAAOkG,IAGzD,QAASkF,GAAW6C,GAChB,MAAO3R,SAAQ+B,SAAS8+D,EAAS90C,QAAQw0C,EAAU,IAAM5uD,IAG7D,QAASW,GAAcX,GACnBkvD,EAAS91D,WAAWw1D,EAAU,IAAM5uD,GAExC,QAASkb,KACL,IAAI,GAAIoI,KAAK4rC,GACTA,EAAS91D,WAAWkqB,GAG5B,QAASurC,GAAa7uD,GAClB,MAAuD,mBAAzCkvD,GAAS90C,QAAQw0C,EAAU,IAAM5uD,IAAgE,MAAzCkvD,EAAS90C,QAAQw0C,EAAU,IAAM5uD,IAAyD,aAAzCkvD,EAAS90C,QAAQw0C,EAAU,IAAM5uD,GArF5J4uD,EAAUA,GAAW,KAErB,IAAII,GAAS/nD,EAAQkT,aACjB+0C,EAAWjoD,EAAQkoD,eAEnB5mC,GACAz4B,IAAKA,EACLm/D,IAAKA,EACL77B,OAAQA,EACR94B,QAASA,EACTghD,MAAOA,EACPn+C,WAAYA,EACZQ,WAAYA,EACZgD,cAAeA,EACfua,eAAgBA,EAChB2zC,aAAcA,EACd73C,QAASA,EACTta,QAASA,EACTi+C,UAAWA,EACXmU,WAAYA,EACZC,SAAUA,EAGd,OAAOxmC,GAOXomC,EAAe/xD,SAAW,UAAW,WArCrCvO,QACCC,OAAO,OACPi6B,QAAQ,WAAY,UAAW,UAAWomC,OA+F/C,WACI,YAOA,SAASS,GAAsBC,EAAY3gE,EAASD,EAASsO,GAQzD,QAASlF,KACLw3D,EAAWC,IAAI,oBAAqBC,GAUxC,QAASA,GAAmBt+D,EAAIu+D,EAASC,EAAUC,GAE/C,GAAsB,MAAlBA,EAAUvqD,KAA6B,WAAdqqD,EAAQrqD,KAAgC,eAAdqqD,EAAQrqD,IAAoB,CAI/E,GAAIwR,GAAOjoB,EAAQgO,UACfizD,EAA0B,OAATh5C,EAGjB1S,EAAQvV,EAAQyO,WAAW,QAC3ByyD,GAAgB,CAEpB,IAAmB,WAAhBF,EAAUvqD,KAAgC,WAAdqqD,EAAQrqD,MAAmBwqD,EAGtD,MAFAlhE,GAAQ0G,MAAM,yDACdlE,GAAGyoC,gBAQH,IALAk2B,EAAiC,MAAhBJ,EAAQrqD,IACR,aAAdqqD,EAAQrqD,MAAkByqD,GAAgB,GAC5B,eAAdJ,EAAQrqD,MAAoByqD,GAAgB,GAC9B,YAAdJ,EAAQrqD,MAAiByqD,GAAgB,GAEzCD,IAAkBC,EACjB,IAAK,GAAIp/D,GAAI,EAAGA,EAAIyT,EAAMxT,OAAQD,IAC9B,IAAK,GAAI8E,GAAI,EAAGA,EAAI2O,EAAMzT,GAAG6qD,QAAQ5qD,OAAQ6E,IAEtCu6D,EAAa5rD,EAAMzT,GAAG6qD,QAAQ/lD,GAAG6P,IAAKqqD,EAAQrqD,OAC7CyqD,GAAgB,EAQhC,IAFiB,4BAAdJ,EAAQrqD,KAAiCpI,EAAe+yD,gBAEvDH,IAAkBC,EAGlB,MAFAnhE,GAAQ0G,MAAM,yDACdlE,GAAGyoC,kBAOnB,QAASm2B,GAAal1C,EAAMo1C,GAExB,GAAIC,IACAC,YACIC,eAAe,EACfC,2BAA2B,GAE/BjrD,SACIkrD,YAAY,EACZC,WAAW,GAEf7rD,KACI8rD,QAAQ,GAEZ15C,MACI25C,SAAS,GAEb/kD,YACIglD,eAAe,EACfC,2BAA2B,GAE/BC,YACIC,eAAe,GAEnBC,UACIC,aAAa,GAEjBC,WACIC,cAAc,GAElBC,UACIC,aAAa,GAEjB3vD,QACI4vD,WAAW,GAEfC,WACIC,cAAc,GAElBzzC,WACE0zC,cAAc,GAGpB,UAAGhjE,QAAQ+D,UAAU49D,EAAcr1C,MAC5BtsB,QAAQ+D,UAAU49D,EAAcr1C,GAAMo1C,MAC9BC,EAAcr1C,GAAMo1C,GA3GvC,GAAIxnC,IACA1wB,KAAMA,EAGV,OAAO0wB,GA2BX6mC,EAAsBxyD,SAAW,aAAc,UAAW,UAAW,kBAtCrEvO,QACCC,OAAO,OACPi6B,QAAQ,kBAAmB,aAAc,UAAW,UAAW,iBAAkB6mC,OAwHtF,WACI,YAOA,SAASkC,GAAav3D,EAAUsyD,GAQ5B,QAASx3D,GAAK2E,GAGV,GAAIklC,GAAW,IAGXA,GADDllC,EAAO7B,MACKoC,EAASw3D,mBACnBC,WAAWh4D,EAAO7B,MAAMke,eACxB47C,iBAAiB13D,EAAS23D,UAAUC,UAAW53D,EAAS63D,UAAUC,OAExD93D,EAASw3D,mBAAmBO,WAAWC,QAItD,IAAIC,GAAmB,gDAEnB1U,GACI2U,SAAU5jE,QAAQ8H,QAAQk2D,EAAU,GAAGz+B,MACvCj0B,WAAYH,EAAOG,aAAe,SAAU,OAAQu4D,GACpDr4D,YAAaL,EAAOK,aAAem4D,EACnCG,WAAY,WACZzzB,SAAUA,EACV0zB,QACIxiE,KAAM4J,EAAO5J,MAAQ,IAEzByiE,SAAU74D,EAAO7B,MACjB8B,sBAAqBpL,QAAQ2K,YAAYQ,EAAOC,sBAA8BD,EAAOC,oBACrFC,gBAAerL,QAAQ2K,YAAYQ,EAAOC,sBAA8BD,EAAOC,oBAC/E64D,aAAa,EAIjB94D,GAAO7B,QACP2lD,EAASiV,YAAc/4D,EAAO7B,OAGlCoC,EAASkrB,KAAKq4B,GA4BlB,QAAS4U,GAAgBp4D,EAAQjL,GAC7BA,EAAK+zB,KAAK,2DAvEd,GAAI2F,IACA1zB,KAAOA,EAGX,OAAO0zB,GA4BX+oC,EAAa10D,SAAW,WAAY,aAvCpCvO,QACCC,OAAO,OACPi6B,QAAQ,SAAU,WAAY,YAAY+oC,OAuH/C,WACI,YAOA,SAASkB,KAaL,QAAS36D,GAAK46D,GAEVA,EAAaC,SACT37D,KAAM,QACN8C,YAAa,qDAEjB44D,EAAaC,SACX37D,KAAM,QACN8C,YAAa,uDAEf44D,EAAaC,SACT37D,KAAM,QACN8C,YAAa,mDACbF,WAAY,sBAEhB84D,EAAaC,SACT37D,KAAM,OACN8C,YAAa,iDACbF,WAAY,qBAEhB84D,EAAaC,SACT37D,KAAM,SACN8C,YAAa,uDAEjB44D,EAAaC,SACT37D,KAAM,cACN8C,YAAa,iEAEjB44D,EAAaC,SACX37D,KAAM,iBACN8C,YAAa,qEACbF,WAAY,+BAEd84D,EAAaC,SACX37D,KAAM,aACN8C,YAAa,6DACbF,WAAY,2BAEd84D,EAAaC,SACX37D,KAAM,yBACN8C,YAAa,qFACbF,WAAY,uCAEd84D,EAAaC,SACX37D,KAAM,mBACN8C,YAAa,yEACbF,WAAY,iCAEd84D,EAAaC,SACX37D,KAAM,YACN8C,YAAa,2DACbF,WAAY,gCAEd84D,EAAaC,SACX37D,KAAM,UACN8C,YAAa,uDACbF,WAAY,wBAEd84D,EAAaC,SACX37D,KAAM,YACN8C,YAAa,2DACbF,WAAY,0BAEd84D,EAAaC,SACX37D,KAAM,4BACN8C,YAAa,6FAEf44D,EAAaC,SACX37D,KAAM,iBACN8C,YAAa,qEACbF,WAAY,+BAjFlB,GAAI4uB,IACA1wB,KAAMA,EAGV,OAAO0wB,GAXXl6B,QACCC,OAAO,OACPi6B,QAAQ,iBAAkBiqC,MAkG/B,WACI,YAOA,SAASG,GAAa1xD,GAUlB,QAASpM,GAAK2E,GACV,GAAI8jD,IACA3jD,WAAYH,EAAO6L,kBAAoB7L,EAAOG,aAAe,SAAU,YAAa,OAAQ,SAAU,QAAS,MAAO,SAAU,OAAQi5D,GACxI/4D,YAAaL,EAAOK,aAAe,GACnC8d,OAAQtpB,QAAQ8H,QAAQ,QACxBsD,oBAAyD,mBAA9BD,GAAOC,qBAA4CD,EAAOC,oBACrFC,cAA6C,mBAAxBF,GAAOE,eAAsCF,EAAOE,cACzE04D,QACIxiE,KAAM4J,EAAO5J,MAAQ,GACrBwV,OAAQ5L,EAAO4L,QAAU,GACzBqF,MAAOjR,EAAOiR,OAAS,GACvBgvB,IAAKjgC,EAAOigC,KAAO,GACnB2mB,OAAQ5mD,EAAO4mD,QAAU,EACzBC,KAAM7mD,EAAO6mD,MAAQ,cAGzB7mD,GAAO7B,QACP2lD,EAASiV,YAAc/4D,EAAO7B,OAElCsJ,EAAUpM,KAAKyoD,GACdvtD,KAAK,aAAgB,WACdyJ,EAAOa,OACPb,EAAOa,UAKnB,QAASu4D,GAAiB94D,EAAQmH,EAAWrR,EAAMwV,EAAQqF,EAAOgvB,EAAK2mB,EAAQC,GAC3E,GAAI/wD,GAAKwK,CAETxK,GAAGM,KAAOA,EACVN,EAAG8V,OAASA,EACZ9V,EAAGmb,MAAQA,EACXnb,EAAGmqC,IAAMA,EACTnqC,EAAG8wD,OAASA,EACZ9wD,EAAGyV,KAAO9D,EAAU8D,KACpBzV,EAAG8R,OAASH,EAAUG,OAEtB9R,EAAGgxD,OAAS,SAASA,GACjBD,EAAKC,EAAQr/C,IAIrB,QAASkV,GAAMjB,EAAMvd,GACjB,GAAIk7D,GAAS5xD,EAAUkV,QAClB1c,qBAAoB,GACpBgR,MAAM,UACNqoD,YAAY59C,GACZ69C,UAAU,UACVC,GAAG,UAEJr7D,IACAk7D,EAAON,YAAY56D,GAEvBsJ,EAAUpM,KAAKg+D,GAGnB,QAASl0D,GAAQuW,EAAMmrC,EAAMj/C,EAAQzJ,GACjC,GAAIs7D,GAAWhyD,EAAUtC,UACpB8L,MAAM,aACNyoD,YAAYh+C,GACZ69C,UAAU,aACVC,GAAG,WACH5xD,OAAO,WAERzJ,IACAs7D,EAASV,YAAY56D,GAGzBsJ,EAAUpM,KAAKo+D,GACdljE,KAAK,WACEswD,GACAA,KAEL,WACKj/C,GACAA,MApFZ,GAAImnB,IACA1zB,KAAOA,EACPshB,MAAQA,EACRxX,QAAUA,EAGd,OAAO4pB,GA2BXoqC,EAAa/1D,SAAW,aAxCxBvO,QACCC,OAAO,OACPi6B,QAAQ,SAAU,YAAaoqC,OAiGpC,WACI,YAOA,SAASQ,GAAeC,GAWpB,QAASv+D,GAAKnE,EAAM+jD,EAAKhqC,EAAO4oD,GAC5B,GAAIC,IACFC,MAAS,QACTC,MAAS,QACTC,YAAe,UACfC,YAAe,QAGbC,GACFJ,MAAS,yCACTC,MAAS,6CACTC,YAAe,oDACfC,YAAe,wFAGbE,GACFL,MAAS,WACTC,MAAS,QACTC,YAAe,cACfC,YAAe,eAGbG,GACFN,MAAS,UACTC,MAAS,SACTC,YAAe,UACfC,YAAe,QAGb9jE,GACAgX,KAAO0sD,EAAS5iE,GAChBsG,QAAUy9C,GAAOkf,EAAejjE,GAChC+Z,MAAQA,GAASmpD,EAAaljE,GAC9BA,KAAOmjE,EAAUnjE,GACjB2iE,QAASA,EAGb1lB,GAAO/9C,GAIX,QAASqhB,GAAQwjC,EAAKhqC,EAAO4oD,GACzB,GAAIzjE,IACAgX,KAAO,QACP5P,QAAUy9C,GAAO,yCACjBhqC,MAAQA,GAAS,WACjB/Z,KAAO,UACP2iE,QAASA,EAGb1lB,GAAO/9C,GAGX,QAASuF,GAAMs/C,EAAKhqC,EAAO4oD,GACvB,GAAIzjE,IACAgX,KAAO,QACP5P,QAAUy9C,GAAO,6CACjBhqC,MAAQA,GAAS,QACjB/Z,KAAO,SACP2iE,QAASA,EAGb1lB,GAAO/9C,GAGX,QAASme,GAAQ0mC,EAAKhqC,EAAO4oD,GACzB,GAAIzjE,IACAgX,KAAO,UACP5P,QAAUy9C,GAAO,oDACjBhqC,MAAQA,GAAS,cACjB/Z,KAAO,UACP2iE,QAASA,EAGb1lB,GAAO/9C,GAGX,QAAS+9C,GAAO/9C,GACZwjE,EAASv+D,MACL8E,WAAYm6D,EACZj6D,YAAa,2CACb8d,OAAStpB,QAAQ8H,QAAQ,yBACzB49D,UAAkC,mBAAhBnkE,GAAKyjE,QAA0C,GAAhBzjE,EAAKyjE,QAAe,QAAczjE,EAAKyjE,QAAW,IACnG30B,SAAU,YACV0zB,OAAQxiE,IAIhB,QAASkkE,GAAgBh6D,EAAQs5D,EAAUxsD,EAAM5P,EAASyT,EAAO/Z,GAC7D,GAAIpB,GAAKwK,CAETxK,GAAGsX,KAAOA,EACVtX,EAAG0H,QAAUA,EACb1H,EAAGmb,MAAQA,EACXnb,EAAGoB,KAAOA,EAEVpB,EAAG+K,MAAQ,WACP+4D,EAASruD,QAhEjB+uD,EAAgBl3D,SAAW,SAAU,WAAY,OAAQ,UAAW,QAAS,OA1C7E,IAAI2rB,IACAtX,QAAUA,EACVlD,QAAUA,EACV5Y,MAAQA,EACRN,KAAMA,EAGV,OAAO0zB,GA2BX4qC,EAAev2D,SAAW,YAzC1BvO,QACCC,OAAO,OACPi6B,QAAQ,WAAY,WAAY4qC,OAqHrC,WACI,YAOA,SAASa,GAAe/yD,GAoBpB,QAASpM,GAAK2E,GACPA,EAAO5J,OAAMqkE,EAAWz6D,EAAO5J,KAClC,IAAI0tD,IACA3jD,WAAYH,EAAO6L,kBAAoB7L,EAAOG,aAAe,SAAU,YAAa,OAAQ,SAAU,QAAS,MAAO,SAAUi5D,GAChI/4D,YAAaL,EAAOK,aAAe,sCAAuC,GAC1E8d,OAAQtpB,QAAQ8H,QAAQ,QAExBuD,eAAe,EACf04D,QAEIxiE,KAAOqkE,EACP7uD,OAAQ5L,EAAO4L,QAAU,GACzBqF,MAAOjR,EAAOiR,OAAS,GACvBgvB,IAAKjgC,EAAOigC,KAAO,GACnB2mB,OAAQ5mD,EAAO4mD,QAAU,GAI7B5mD,GAAO7B,QACP2lD,EAASiV,YAAc/4D,EAAO7B,OAElCsJ,EAAUpM,KAAKyoD,GACdvtD,KAAK,aAAgB,WACdyJ,EAAOa,OAGPb,EAAOa,UAInB,QAAS8G,KAEPF,EAAU8D,OAGZ,QAASwL,GAAQtgB,GAEVA,EAAM8E,UAASk/D,EAAUl/D,QAAU9E,EAAM8E,SACxC9E,EAAM0G,OAAMs9D,EAAUt9D,KAAOu9D,EAASjkE,EAAM0G,OAGpD,QAASi8D,GAAiB94D,EAAQmH,EAAWrR,EAAMwV,EAAQqF,EAAOgvB,EAAK2mB,GACnE,GAAI9wD,GAAKwK,CACTxK,GAAGM,KAAOA,EACVN,EAAG8V,OAASA,EACZ9V,EAAGmb,MAAQA,EACXnb,EAAGmqC,IAAMA,EACTnqC,EAAG8wD,OAASA,EACZ9wD,EAAGyV,KAAO9D,EAAU8D,KAlExB,GAAIwjB,IACA1zB,KAAOA,EACPsM,OAASA,EACToP,QAASA,GAET2jD,GACAnmD,QAAS,iBACT5Y,MAAO,eACP8b,QAAS,iBACT2R,KAAM,eAENqxC,GACAl/D,QAAS,cACT4B,KAAMu9D,EAASnmD,QAGnB,OAAOwa,GAoBXyrC,EAAep3D,SAAW,aA3C1BvO,QACCC,OAAO,OACPi6B,QAAQ,WAAY,YAAayrC,OAiFtC,WACI,YAOA,SAASG,GAAuB/lD,EAAI1f,EAASM,GAQzC,QAASolE,GAAQjvC,GACb,GAAGA,EAAIhgB,IAAIrT,QAAQ9C,QAAgB,CAC/B,GAAI+6D,IACAsK,MAAM,EACNv8C,MAAOppB,EAAQqgE,WAEnB5pC,GAAI3a,QAAQ,WAAgB8pD,EAAajmE,QAAQ0D,OAAOg4D,IAE5D,MAAO5kC,GAOX,QAASmvC,GAAap/C,GAElB,GAAI,qBAAqBsM,KAAKtM,GAC1B,KAAM,IAAI7iB,OAAM,4CAQpB,KALA,GAEIkiE,GAAK38C,EAAM48C,EAFXC,EAAS,mEACTjkE,EAAI,EAEJ0/B,KAEE1/B,EAAI0kB,EAAKzkB,QAAO,CAKlB,OAHA8jE,EAAMr/C,EAAK0sB,WAAWpxC,GACtBgkE,EAAUhkE,EAAI,GAGV,IAAK,GACD0/B,EAAO96B,KAAKq/D,EAAO3iC,OAAOyiC,GAAO,GACjC,MAEJ,KAAK,GACDrkC,EAAO96B,KAAKq/D,EAAO3iC,QAAe,EAAPla,IAAa,EAAK28C,GAAO,GACpD,MAEJ,KAAK,GACDrkC,EAAO96B,KAAKq/D,EAAO3iC,QAAe,GAAPla,IAAgB,EAAK28C,GAAO,IACvDrkC,EAAO96B,KAAKq/D,EAAO3iC,OAAa,GAANyiC,IAIlC38C,EAAO28C,EACP/jE,IAWJ,MARe,IAAXgkE,GACAtkC,EAAO96B,KAAKq/D,EAAO3iC,QAAe,EAAPla,IAAa,IACxCsY,EAAO96B,KAAK,OACM,GAAXo/D,IACPtkC,EAAO96B,KAAKq/D,EAAO3iC,QAAe,GAAPla,IAAgB,IAC3CsY,EAAO96B,KAAK,MAGT86B,EAAOkG,KAAK,IAhEvB,GAAI7N,IACA6rC,QAASA,EAGb,OAAO7rC,GAiCX4rC,EAAuBv3D,SAAW,KAAM,UAAW,WA5CnDvO,QACCC,OAAO,OACPi6B,QAAQ,mBAAoB,KAAM,UAAW,UAAW4rC,OA2E7D,WACA,YAOA,SAASO,GAAiB3lE,EAAaC,EAASG,EAASmjB,EAAU9jB,EAAYsO,EAAOmK,EAASrY,EAAWF,EAASG,GAe/G,QAASsD,GAAmB6tB,GACxBA,EAASA,EAAOlV,QAAQ,cAAe,GAIvC,KAAK,GAHDmV,GAAMD,EAAOlf,cACbof,EAAMD,EAAIzrB,MAAM,KAChBtE,EAAc,GACTM,EAAI,EAAGA,EAAI0vB,EAAIzvB,OAAQD,IACd,OAAX0vB,EAAI1vB,IAA0B,SAAX0vB,EAAI1vB,IAA4B,MAAX0vB,EAAI1vB,IAAyB,OAAX0vB,EAAI1vB,IACzDnC,QAAQ+D,UAAU8tB,EAAI1vB,GAAG,MACzBN,GAA4BgwB,EAAI1vB,GAAG,GAI/C,OAAON,GAIX,QAAS6V,GAASlW,GACd,GAAI0U,IAAgB1U,OAAOA,EAAQqT,KAAK,yEACpCyxD,EAAW/lE,EAAUgmE,QACzBrwD,GAAYqB,oBAAqB,EACjC+uD,EAAUA,EAAQx/B,UAAU,EAAGw/B,EAAQ7iE,QAAQ,MAAM,GACrDpD,EAAQiP,WAAW,eAAgB4G,GACnC0C,EAAQge,KAAK0vC,EAAQ,aAQzB,QAAS/0D,GAAU1C,EAAc23D,GAC7B9lE,EAAYe,IAAId,EAAU,8BAA8BkO,GACvDnN,KAAK,SAAUC,GACZwM,EAAQxM,EAAUC,MAAMM,UAAWP,EAAUC,MAAMI,gBAAiBL,EAAUC,MAAMJ,OAAQglE,EAAQ33D,KAW5G,QAASV,GAAQjM,EAAWF,EAAiBR,EAAQglE,EAAO33D,GACxD,GAAI43D,KAAkBzmE,QAAQ2K,YAAY67D,IAAiBA,EACvDtwD,GAAejG,OACnBiG,GAAY3F,aAAevQ,QAAQ+B,SAASC,EAC5C,IAAIiJ,GAAQiL,EAAY3F,YACpBtF,GAAM,WAAaA,EAAM,UAAU,QACnCA,EAAM,UAAU,MAAWgZ,EAASkC,OAAOlb,EAAM,UAAU,MAAU,sBACzEiL,EAAYxG,YAAcvP,EAAW8C,WAAWjD,QAAQ+B,SAASG,GAAY+I,GAC7EiL,EAAYjG,IAAIzO,OAASA,EACzB0U,EAAYjG,IAAI/N,UAAYA,EAC5BxB,EAAY6F,KAAK5F,EAAS,qCAAqCuV,GAC9DxU,KAAK,SAASC,GAGX,GAFAuU,GAAgBrB,KAAMlT,EAAUC,MAAMiT,KAAMrT,OAAQG,EAAUC,MAAMJ,QACpE0U,EAAYjB,mBAAqBilB,EAAQ7T,WACtCogD,EAEC/lE,EAAYoU,IAAInU,EAAQ,kCAAkC0W,KAAMnB,EAAY1U,SAC3EE,KAAK,SAAU4V,GACd,GAAIA,EAGF,MAFApB,GAAYpB,IAAMwC,EAAaR,IAC/BZ,EAAYf,WAAamC,EAAa/V,KAClB,OAAjBsN,GAAyBA,GAC1BrO,EAAKqC,IAAI,qBACFnC,EAAYe,IAAId,EAAS,qBAAqBkO,IAFvD,SAMHnN,KAAK,SAAUglE,GACXA,IAAQxwD,EAAYwwD,OAASA,EAAO9kE,UACvC,IAAIuJ,IACF5J,KAAM2U,EACN1K,YAAa,yCACbF,YAAa,OAAQ,SAAU,YAAa,OAAQgT,GAEtD7P,GAAMjI,KAAK2E,SAEX,CACF,GAAIm7D,GAAW/lE,EAAUgmE,QACzBD,GAAUA,EAAQx/B,UAAU,EAAGw/B,EAAQ7iE,QAAQ,MAAM,GACrDpD,EAAQiP,WAAW,eAAgB4G,GACnC0C,EAAQge,KAAK0vC,EAAQ,gBAKjC,QAASjgD,KAAa,MAAOrmB,SAAQ+D,UAAU6U,EAAQyF,cAChD0yB,UAAUY,UAAUrL,MAAM,aAC1ByK,UAAUY,UAAUrL,MAAM,WAC1ByK,UAAUY,UAAUrL,MAAM,YAC1ByK,UAAUY,UAAUrL,MAAM,UAC1ByK,UAAUY,UAAUrL,MAAM,UAC1ByK,UAAUY,UAAUrL,MAAM,gBAC1ByK,UAAUY,UAAUrL,MAAM,kBASjC,QAAShoB,GAAoB/c,EAAMkK,EAAQmH,EAAWO,GAElD,GAAIN,GAAMpH,CACVoH,GAAItR,QACJsR,EAAItR,KAAKsT,KAAKtT,EAAKsT,KACnBhC,EAAItR,KAAKuT,IAAIvT,EAAKuT,IAClBjC,EAAItR,KAAKwT,WAAU,EACnBlC,EAAItR,KAAKmlE,OAAOnlE,EAAKmlE,WACrB7zD,EAAItR,KAAKyT,UAAUzT,EAAK0T,mBACpB1T,EAAK0T,oBACL9B,EAAK+B,WAAW3T,EAAK4T,WAAY,oBAIrCtC,EAAI4E,WAAa,SAAU5T,EAAIqO,GAAQA,EAAIwF,EAAS7T,GAAU0N,EAAU1N,GAAI,IAC5EgP,EAAIC,OAAS,WAAaF,EAAUG,UACpCF,EAAI2E,QAAU,WAAY3E,EAAItR,KAAKwT,WAAU,GAC7ClC,EAAI9E,OAAS,WAAY8E,EAAItR,KAAKwT,WAAU,GAUhD,QAAS4xD,GAAa/jE,EAAI0O,GACtB5Q,EAAYe,IAAId,EAAU,kBAAkB2Q,GAC3C5P,KAAK,SAAUC,GACZ,GAAGA,EAAU,CACTilE,EAASjlE,EAAUC,MACnB,IAAIuJ,IACA7B,MAAO1G,EACPrB,MAAQsC,GAAIyN,EAAQ1P,MAAOD,EAAUC,OACrC4J,YAAa,+CACbF,YAAa,SAAS,YAAa,OAAQu7D,GAE/Cp4D,GAAMjI,KAAK2E,MAMvB,QAASy7D,GAASh1D,GACdA,EAAI8W,QAAQ,SAAUwD,GAGlB,OAFAA,EAAG46C,UAAY7iD,EAAS8iD,YAAY76C,EAAG1V,iBACvC0V,EAAG86C,SAAW/iD,EAASoQ,KAAKnI,EAAG1V,iBACvB0V,EAAGxF,QACP,IAAK,UACLwF,EAAGrN,IAAM,QACTqN,EAAG3T,KAAO,OACV2T,EAAG+6C,SAAW,OACd,MACA,KAAK,WACL/6C,EAAGrN,IAAM,SACTqN,EAAG3T,KAAO,WACV2T,EAAG+6C,SAAW,SACd,MACA,KAAK,YACL/6C,EAAGrN,IAAM,UACTqN,EAAG3T,KAAO,QACV2T,EAAG+6C,SAAW,SACd/6C,EAAG7W,YAAc6W,EAAG7W,YAAYyxB,UAAU5a,EAAG7W,YAAY5R,QAAQ,kBAAmByoB,EAAG7W,YAAYjT,OACnG,MACA,KAAK,WACL8pB,EAAGrN,IAAM,SACTqN,EAAG3T,KAAO,gBACV2T,EAAG+6C,SAAW,OACd,MACA,KAAK,UACL/6C,EAAGrN,IAAM,QACTqN,EAAG3T,KAAO,uBACV2T,EAAG+6C,SAAW,SACd,MACA,KAAK,SACL/6C,EAAGrN,IAAM,YACTqN,EAAG3T,KAAO,OACV2T,EAAG+6C,SAAW,SACd,MACA,KAAK,YACL/6C,EAAGrN,IAAM,UACTqN,EAAG3T,KAAO,QACV2T,EAAG+6C,SAAW,QACd,MACA,KAAK,QACL/6C,EAAGrN,IAAM,QACTqN,EAAG3T,KAAO,cACV2T,EAAG+6C,SAAW,OACd,MACA,KAAK,UACL/6C,EAAGrN,IAAM,QACTqN,EAAG3T,KAAO,SACV2T,EAAG+6C,SAAW,QACd,MACA,SACA/6C,EAAGrN,IAAM,gBACTqN,EAAG3T,KAAO,aACV2T,EAAG+6C,SAAW,UAK1B,QAAS5nD,GAAgBzc,EAAI0O,GACzB5Q,EAAYe,IAAId,EAAU,kBAAkB2Q,EAAO,YAClD5P,KAAK,SAAUC,GACZ,GAAGA,EAAU,CACTilE,EAASjlE,EAAUC,MACnB,IAAIuJ,IACA7B,MAAO1G,EACPrB,MAAQsC,GAAIyN,EAAQ1P,MAAOD,EAAUC,OACrC4J,YAAa,+CACbF,YAAa,SAAS,YAAa,OAAQu7D;CAE/Cp4D,GAAMjI,KAAK2E,MAOvB,QAAS07D,GAAgBp7D,EAAQmH,EAAWrR,GAOxC,QAASuR,KAAUF,EAAUG,SAC7B,QAAS1B,GAAaC,GAAUC,EAAUD,GAAQ,GAPlD,GAAIuB,GAAMpH,CACVoH,GAAItR,KAAOA,EAGXsR,EAAIC,OAASA,EACbD,EAAIxB,aAAeA,EArPvB,GAAI6oB,IACA3oB,UAAWA,EACXpD,QAASA,EACTuJ,SAAUA,EACVivD,aAAcA,EACdtnD,gBAAiBA,EACjBvb,mBAAoBA,EACpBuiB,SAAUA,EAId,OAAO6T,GA2BXmsC,EAAiB93D,SAAW,cAAe,UAAW,UAAW,WAAY,aAAc,QAAS,UAAW,YAAa,UAAW,QA7CvIvO,QACCC,OAAO,OACPi6B,QAAQ,YAAamsC,MAoQtB,WACI,YAOA,SAASa,GAAsB7mE,EAASD,EAAS+mE,EAAWl/C,EAAO1nB,EAAWqS,EAAWlS,EAAaC,GAgClG,QAAS6I,KACFxJ,QAAQ2K,YAAYy8D,EAAIC,YACvBD,EAAI/yC,KAA2B,GAApBizC,IACXF,EAAIC,SAAWF,EAAU,WACrBC,EAAI/yC,OACY,IAAZ+yC,EAAI/yC,MAAc9zB,EAAUuW,MAAMrT,QAAQ,gBAAkBzD,QAAQ+D,UAAUqjE,EAAIG,mBAAmBH,EAAIh4D,SAAQ,GAAO,IACxHg4D,EAAI/yC,MAAQ,GAAwC,GAAnC9zB,EAAUuW,MAAMrT,QAAQ,YAAeg0B,GAAO,IACpE,MAIX,QAAS6vC,KACJ,MAAOtnE,SAAQ+D,UAAUkkB,EAAMu/C,cAAev/C,EAAMu/C,aAAaC,OAAS,EAG/E,QAASC,KACF1nE,QAAQ+D,UAAUqjE,EAAIC,YACrBF,EAAUp0D,OAAOq0D,EAAIC,UACrBD,EAAIC,SAAW3yD,QAIvB,QAAS+sD,KACFzhE,QAAQ+D,UAAUqjE,EAAIG,oBACrBJ,EAAUp0D,OAAOq0D,EAAIG,kBACrBH,EAAIG,iBAAmB7yD,QAI/B,QAASvF,GAAaw4D,EAAgBx1D,GAClCi1D,EAAIh4D,QAAUpP,QAAQgnD,WAAW2gB,GAAiBA,EAAgB,SAAS1yC,EAAEhW,KAC1Ejf,QAAQ2K,YAAYy8D,EAAIG,oBAEvBH,EAAIG,iBAAmBJ,EAAU,WAC7BC,EAAIh4D,SAAQ,GAAO,IACpB,MAEJ+C,GAASsvD,IACZmG,IAOJ,QAASnwC,GAAQowC,GACbT,EAAIM,eACDG,GAAaznE,EAAQsf,QAAQ,wDAA0D4nD,IAAsB,uCAAwC,KAAM,GAC9Jr/C,EAAMwP,SACL/1B,KAAK,WACFnB,EAAUoG,KAAK,SACfiM,EAAU8D,SAIlB,QAASkxD,KACF5nE,QAAQ+D,UAAUqjE,EAAIC,WACrB3mE,EAAYe,IAAId,EAAQ,aACvBe,KAAK,SAAUC,GACT3B,QAAQ+D,UAAUpC,KACjBsmB,EAAMuB,SAAS7nB,EAAU8nB,OACzB29C,EAAI/yC,KAA2B,GAApBizC,OA7E3B,GAAIptC,IACAmtC,SAAU3yD,OACV2f,KAAM,KACN7qB,KAAMA,EACNk+D,aAAcA,EACdE,aAAcA,EACdx4D,QAASsF,OACT6yD,iBAAkB7yD,OAClBvF,aAAcA,EACdsyD,aAAcA,EACd6F,kBAAmBA,EACnB7vC,OAAQA,GAER2vC,EAAMltC,CACV,OAAOA,GAWXgtC,EAAsB34D,SAAW,UAAW,UAAW,YAAa,QAAS,YAAa,YAAa,cAAe,WA9CtHvO,QACCC,OAAO,OACPi6B,QAAQ,kBAAmB,UAAW,UAAW,YAAa,QAAS,YAAa,YAAa,cAAe,UAAWgtC,OAyGhI,WACI,YAOA,SAASY,KAQL,QAASrrD,GAASoK,EAAMsC,EAAM1M,GAC1B,IAAK,GAA4BsrD,GAAxB5lE,EAAI,EAAGm7B,EAAInU,EAAK/mB,OAAeD,EAAIm7B,EAAGn7B,IAC3C4lE,EAAQ,GAAI91B,QAAO9oB,EAAKhnB,GAAI,KAC5B0kB,EAAOA,EAAKpK,QAAQsrD,EAAOtrD,EAAQta,GAEvC,OAAO0kB,GAUX,QAASlf,GAAOiK,EAAKo2D,EAAWC,EAASC,GACrC,GAAI5gE,GAAOsK,EAAIo2D,EACfp2D,GAAI1H,OAAO89D,EAAW,GACnBhoE,QAAQ+D,UAAUmkE,GACjBA,EAAKh+D,OAAO+9D,EAAS,EAAG3gE,GAExBsK,EAAI1H,OAAO+9D,EAAS,EAAG3gE,GAS/B,QAASkB,GAAQoJ,EAAKq2D,EAAS3gE,GAC3BsK,EAAI1H,OAAO+9D,EAAS,EAAG3gE,GAU3B,QAASmoB,GAAU7d,EAAKu2D,EAAQtgE,EAAKugE,GACjC,IAAK,GAAIjmE,GAAI,EAAGA,EAAIyP,EAAIxP,OAAQD,IAC5B,GAAGyP,EAAIzP,GAAGgmE,IAAWtgE,EAAK,OAAO,GAAU+J,EAAIzP,EAEnD,SAAO,GAAU,KApDrB,GAAI+3B,IACAzd,QAASA,EACTjU,OAAQA,EACRb,MAAOA,EACP8nB,UAAWA,EAmDf,OAAOyK,GAKX,QAASmuC,GAAgBl1D,EAAMtS,GAkD3B,QAASme,GAAKspD,EAAOtzB,GACjB,GAAIh2B,GAAOspD,EAAM,GAAGniE,MAAM6uC,GAAa,IAEvC,OAAO,IAAI9kC,MAAK8O,EAAK,GAAGA,EAAK,GAAG,EAAEA,EAAK,IAG3C,QAAS06C,GAAM16C,EAAMg2B,GACjB,OAAQh2B,EAAKrF,cAAeqF,EAAK1F,WAAW,EAAG0F,EAAKsT,WAAWyV,KAAKiN,GAAa,KAGrF,QAASuzB,KACL,GAAIvpD,GAAO,GAAI9O,KACf,OAAO,IAAIA,MAAK8O,EAAKrF,cAAeqF,EAAK1F,WAAY,GAGzD,QAASkvD,GAAiBjnE,GACtBA,EAAOA,GAAQ,CACf,IAAIyd,GAAO,GAAI9O,MACX29C,EAAM7uC,EAAKsT,UACXw7B,EAAQ9uC,EAAK1F,WACby0C,EAAO/uC,EAAKrF,aAShB,OAPIk0C,GAAMtsD,IACNusD,IACIA,EAAQ,IACRA,EAAQ,GACRC,MAGD,GAAI79C,MAAK69C,EAAMD,EAAOvsD,GAGjC,QAASqsD,GAAQ5uC,GAIb,MAHyB,UAArB7L,EAAKmhD,OAAOt1C,KACZA,EAAOypD,EAAQzpD,IAEZ0pD,EAAQ1pD,GAGnB,QAAS0pD,GAAS1pD,GACd,MAAyB,QAArB7L,EAAKmhD,OAAOt1C,KAERnC,MAAMmC,EAAK2pD,WAGvB,QAASC,GAAY5pD,GACjB,MAAO6pD,GAAa7pD,IAAQ,GAAK9O,OAAQy4D,UAG7C,QAASG,GAAgB9pD,EAAMzd,GAC3B,MAAOsnE,GAAa7pD,GAAQ4zC,EAAa,GAAI1iD,MAAQ3O,GAGzD,QAASwnE,GAAe/pD,GACpB,MAAO6pD,GAAa7pD,IAAQ,GAAK9O,OAAQy4D,UAG7C,QAASK,GAAmBhqD,EAAMzd,GAC9B,MAAOsnE,GAAa7pD,GAAQ8zC,EAAQ,GAAI5iD,MAAQ3O,GAGpD,QAASuxD,GAAS9zC,EAAMgvC,GACpB,MAAO6a,GAAa7pD,GAAoB,IAAXgvC,GAAQ,GAAM,GAAG,GAAG,IAGrD,QAAS4E,GAAc5zC,EAAMgvC,GACzB,MAAO6a,GAAa7pD,GAAoB,IAAXgvC,GAAQ,GAAM,GAAG,GAAG,IAGrD,QAASib,GAAMC,EAAOC,GAClB,MAAON,GAAaK,GAASL,EAAaM,GAG9C,QAASN,GAAc7pD,GAInB,MAHyB,UAArB7L,EAAKmhD,OAAOt1C,KACZA,EAAOypD,EAAQzpD,IAEZA,EAAK2pD,UAGhB,QAASF,GAASzpD,GAEd,MADAA,GAAOA,EAAK7Y,MAAM,KACG,cAAdsuD,EAA6B,GAAIvkD,MAAK8O,EAAK,GAAIA,EAAK,GAAG,EAAGA,EAAK,IACxD,cAAdy1C,EAA6B,GAAIvkD,MAAK8O,EAAK,GAAIA,EAAK,GAAG,EAAGA,EAAK,IAC/D,GAAI9O,MAAK8O,EAAK,GAAIA,EAAK,GAAG,EAAGA,EAAK,IAGtC,QAASoqD,GAAejjD,GACpBsuC,EAAatuC,EAGjB,QAAS+nC,GAAK/nC,GACV,MAAO1J,GAAQ,GAAIvM,MAAQiW,GAAUsuC,GAGzC,QAASsS,GAAa/nD,GAClB,MAAOmH,GAAOnH,EAAM,sBAGxB,QAASqV,GAAMrV,GACX,MAAOmH,GAAOnH,EAAM,SAGxB,QAASqqD,GAAYh1C,EAAMi1C,GACvB,GAAIziD,GAAO,EACX,IAAmB,gBAARwN,GACP,MAAY,IAARA,EACO,IAGPxN,EADAwN,EAAO,GACAA,EAAO,IACPA,EAAO,KACPvV,KAAKyqD,MAAMl1C,EAAO,IAAM,MAAQA,EAAO,GAAK,EAAKA,EAAO,GAAK,IAAO,IAEpEvV,KAAKyqD,MAAMl1C,EAAO,MAAQ,MAAQA,EAAO,KAAO,EAAKvV,KAAKyqD,MAAMl1C,EAAO,IAAM,KAAQ,KAAOA,EAAO,GAAK,EAAKA,EAAO,GAAK,IAAO,KAEnIi1C,GAAO,IAAMziD,EAErB,IAAmB,GAAfwN,EAAKjyB,OACL,MAAO,EAEXiyB,GAAOA,EAAKluB,MAAM,IAClB,IAAIqjE,GAAQn1C,EAAK,GACbo1C,EAAUp1C,EAAK,EAYnB,OAVIgjB,UAASmyB,GAAS,IAClB3iD,GAAQwwB,SAASmyB,GAAS,MAE1BnyB,SAASoyB,GAAW,IACpB5iD,GAAQwwB,SAASoyB,GAAW,MAEb,GAAfp1C,EAAKjyB,QAAei1C,SAAShjB,EAAK,IAAM,IACxCxN,GAAQwwB,SAAShjB,EAAK,IAAM,MAGxBi1C,GAAO,IAAMziD,EAI7B,QAAS6iD,GAAWr1C,GAChBA,EAAOA,EAAKluB,MAAM,IAClB,IAAIqjE,GAAQn1C,EAAK,GACbo1C,EAAUp1C,EAAK,GACf5xB,EAAQ,CAYZ,OAVI40C,UAASmyB,GAAS,IAClB/mE,GAAyB,KAAhB40C,SAASmyB,IAElBnyB,SAASoyB,GAAW,IACpBhnE,GAA2B,GAAlB40C,SAASoyB,IAEH,GAAfp1C,EAAKjyB,QAAei1C,SAAShjB,EAAK,IAAM,IACxC5xB,GAAS40C,SAAShjB,EAAK,KAGpB5xB,EAGX,QAAS8qB,GAAiBvO,GACtB,MAAOmH,GAAOnH,EAAM,yCAGxB,QAASmH,GAAQnH,EAAMmH,GACnB,GAAIwjD,GAAI,GAAIz5D,MAAK8O,EACjB,OAAI4uC,GAAO+b,GACAltD,EAAQktD,EAAGxjD,GAAUsuC,GAEzBz1C,EAGX,QAAS4qD,GAAS5qD,EAAMmH,GACpB,GAAI9jB,GAAO8Q,EAAKmhD,OAAOt1C,EACvB,IAAY,QAAR3c,EACA,MAAO2c,EAEX,IAAY,UAAR3c,EAAkB,CAClB8jB,EAASA,GAAUsuC,CACnB,IAAIzf,GAAYh2B,EAAKvb,QAAQ,SAAa,IAAM,GAChDub,GAAOA,EAAK7Y,MAAM6uC,GACJ,cAAV7uB,GAAoC,cAAVA,IAC1BnH,EAAOA,EAAK,GAAKg2B,EAAYh2B,EAAK,GAAKg2B,EAAYh2B,EAAK,IAE9C,cAAVmH,GAAoC,cAAVA,IAC1BnH,EAAOA,EAAK,GAAKg2B,EAAYh2B,EAAK,GAAKg2B,EAAYh2B,EAAK,IAGhE,MAAO,IAAI9O,MAAK8O,GAGpB,QAASvC,GAASuC,EAAMmH,GACpBA,EAASA,GAAUsuC,EACnBz1C,EAAO4qD,EAAQ5qD,EAAMmH,EACrB,IAAI0jD,GAAe1jD,EAAO1iB,QAAQ,UAClC,OAAO5C,GAAU4b,QAAQ0J,GACrB,OAAQ,MAAO,KAAM0jD,EAAe,MAAQ,KAAM,OAAQ,KAAM,KAAM,OAEtEC,EAAS9qD,EAAK+qD,UACd/b,EAAKhvC,EAAK+qD,WACT/qD,EAAKsT,UAAY,GAAK,IAAM,IAAMtT,EAAKsT,UACxCu3C,EAAe5b,EAAOjvC,EAAK1F,aAAgB0F,EAAK1F,WAAa,EAAI,GAAK,IAAM,KAAO0F,EAAK1F,WAAa,GACrG0F,EAAKrF,eACJqF,EAAKgrD,WAAa,GAAK,IAAM,IAAMhrD,EAAKgrD,YACxChrD,EAAKirD,aAAe,GAAK,IAAM,IAAMjrD,EAAKirD,cAC1CjrD,EAAK0qD,aAAe,GAAK,IAAM,IAAM1qD,EAAK0qD,eAInD,QAAS5oC,GAAM9hB,GACX,GAAIkvC,GAAM,GAAIh+C,MACV89C,EAAOkc,EAAoBlrD,EAAMkvC,EACrC,IAAIF,EAAO,GACP,MAAO+Y,GAAY/nD,EAEnB,IAAIgvC,EAAO,EAAG,CACV,GAAImc,GAAQ9yB,SAAS2W,EAAO,EAC5B,OAAO,QAAUmc,EAAQ,WAAaA,EAAQ,EAAI,IAAM,IAExD,GAAInc,GAAQ,EACR,MAAO7nC,GAAOnH,EAAM,oBAEpB,IAAIwqD,GAAQY,EAAqBprD,EAAMkvC,EACvC,IAAImc,EAAYrrD,EAAMwqD,GAClB,MAAO,gBAAkBn1C,EAAKrV,EAE9B,IAAIwqD,GAAS,EACT,MAAO,QAAUA,EAAQ,SAAWA,EAAQ,EAAI,IAAM,GAEtD,IAAIC,GAAUa,EAAuBtrD,EAAMkvC,EAC3C,IAAIub,GAAW,EACX,MAAO,QAAUA,EAAU,WAAaA,EAAU,EAAI,IAAM,GAE5D,IAAIc,GAAUC,EAAuBxrD,EAAMkvC,EAC3C,OAAO,QAAUqc,EAAU,YAAcA,EAAU,EAAI,IAAM,IASzF,QAASC,GAAwBrB,EAAOD,EAAOzF,GAC3C,MAAOgH,GAAgBtB,EAAOD,EAAO,IAAKzF,GAG9C,QAAS6G,GAAwBnB,EAAOD,EAAOzF,GAC3C,MAAOgH,GAAgBtB,EAAOD,EAAO,IAAKzF,GAG9C,QAAS2G,GAAsBjB,EAAOD,EAAOzF,GACzC,MAAOgH,GAAgBtB,EAAOD,EAAO,IAAKzF,GAG9C,QAASyG,GAAqBf,EAAOD,EAAOzF,GACxC,MAAOgH,GAAgBtB,EAAOD,EAAO,IAAKzF,GAG9C,QAASgH,GAAiBtB,EAAOD,EAAO7mE,EAAMohE,GAC1C,GAAI1P,IAAS2W,EAAI,IAAMvoE,EAAI,IAASo0B,EAAI,KAAYozC,EAAI,OACpDV,EAAO5xB,UAAUuyB,EAAQV,GAAOP,UAAYiB,EAAQT,GAAOR,WAAW5U,EAAM1xD,GAEhF,OAAwB,mBAAbohE,IAA4BA,KAAa,EACzC3kD,KAAK6rD,IAAI1B,GAEbA,EAGX,QAASoB,GAAarrD,EAAMwqD,GACxB,GAAI5b,EAAO5uC,GAAO,CACdA,EAAOA,EAAK7Y,MAAM,IAClB,IAAIkuB,GAAOrV,EAAK,GAAG7Y,MAAM,IACzB,OAAOqjE,IAASnyB,SAAShjB,EAAK,IAElC,OAAO,EAGX,QAASu2C,GAAU5rD,GACf,OAAQA,EAAKsT,UAAWtT,EAAK1F,WAAa,EAAG0F,EAAKrF,eAAeouB,KAAK,KAG1E,QAAS8iC,GAAgB7rD,GACrB,OAAQA,EAAKrF,cAAcqF,EAAK1F,WAAW,EAAE0F,EAAKsT,WAAWyV,KAAK,KAzUtE,GAAI0sB,GAAa,aACjBxG,GAAU,QAAS,UAAW,QAAS,QAAS,OAAQ,QAAS,QAAS,SAAU,aAAc,UAAW,YAAa,aAC1HD,GAAQ,MAAO,MAAO,MAAO,MAAQ,MAAO,MAAQ,OACpD8b,GAAY,UAAW,QAAS,SAAU,YAAc,SAAU,UAAY,UAE1E5vC,GACA0zB,OAAQA,EACR8a,QAASA,EACTE,WAAYA,EACZE,eAAgBA,EAChBC,cAAeA,EACfC,kBAAmBA,EACnBlW,QAASA,EACTF,aAAcA,EACdqW,KAAMA,EACNJ,aAAcA,EACdJ,QAASA,EACTW,cAAeA,EACflb,IAAKA,EACL6Y,YAAaA,EACb1yC,KAAMA,EACNg1C,YAAaA,EACb97C,gBAAiBA,EACjBpH,OAAQA,EACRujD,WAAYA,EACZE,QAASA,EACTntD,QAASA,EACTqkB,KAAMA,EACN0pC,uBAAwBA,EACxBF,uBAAwBA,EACxBF,qBAAsBA,EACtBF,oBAAqBA,EACrBO,gBAAiBA,EACjBJ,YAAaA,EACbO,UAAWA,EACXC,gBAAiBA,EACjBtC,UAAWA,EACX7O,MAAQA,EACRjF,WAAYA,EACZxG,OAAQA,EACRD,KAAMA,EACNwa,iBAAkBA,EAClBxpD,KAAMA,EACN8qD,SAAUA,EAGd,OAAO5vC,GAnEXmuC,EAAgB95D,SAAW,OAAQ,aA/CnCvO,QACCC,OAAO,OACPi6B,QAAQ,YAAa,OAAQ,YAAamuC,IAC1CnuC,QAAQ,YAAa4tC,MAiZ1B,WACI,YAUA,SAASgD,GAAgB/qD,EAAIxf,EAAW88D,GAEpC,GAAI0N,IACAhF,QAAS,SAAS56D,GAEd,MADAnL,SAAQ8H,QAAQ,qBAAqBtB,OAC9B2E,GAEX6/D,aAAc,SAAS7/D,GAEnB,MADAnL,SAAQ8H,QAAQ,qBAAqB4O,OAC9BvL,GAEXqI,SAAU,SAASA,GAEf,MADAxT,SAAQ8H,QAAQ,qBAAqB4O,OAC9BlD,GAAYuM,EAAGkrD,KAAKz3D,IAE/B03D,cAAe,SAASC,GACpB,GAAyB,MAArBA,EAAU1oD,QAAuC,MAArB0oD,EAAU1oD,OAAgB,CAEtD,GAAIpiB,GAAUg9D,EAAU57D,IAAI,WACxBiN,EAAiB2uD,EAAU57D,IAAI,iBAEnCpB,GAAQiP,WAAW,OAAQ/O,EAAUoG,QACrC+H,EAAe+oB,SAEnB,MAAO1X,GAAGgB,OAAOoqD,IAiBzB,OAAOJ,GADXD,EAAgBv8D,SAAW,KAAM,YAAa,aAhD9CvO,QACCC,OAAO,OACPi6B,QAAQ,kBAAmB4wC,GAC3B3/D,QAAA,gBAAO,SAASigE,GACbA,EAAcC,aAAatkE,KAAK,yBAkDxC,WACE,YASA,SAASrG,GAAYu1B,EAAO71B,EAAS+S,EAAMgE,EAAM3W,GA6B/C,QAAS80C,GAAKx+B,EAAKq7C,GACjB,MAAOl8B,GAAMx0B,IAAIqV,GAAOq7C,EAAQ,IAAMh/C,EAAK6rD,UAAU7M,GAAS,KAC7DzwD,KAAK,SAAU8R,GACd,MAAGA,GAASjS,KACHiS,EAASjS,SAEhBf,GAAKqwC,KAAK,+BALP5a,SAOE,SAAUnvB,GACjBwkE,EAASxkE,KAIb,QAASuL,GAAKyE,EAAKvV,GACjB,MAAO00B,GAAM10B,EAAKsC,GAAK,MAAQ,QAAQiT,GAAOvV,EAAKsC,GAAKtC,EAAKsC,GAAK,IAAK,IAAKtC,GAC3EG,KAAK,SAAU8R,GACd,MAAGA,GAASjS,KACHiS,EAASjS,SAEhBf,GAAKqwC,KAAK,+BALP5a,SAOE,SAAUnvB,GACjBwkE,EAASxkE,KAIb,QAASD,GAAIiQ,EAAKvV,GAChB,MAAO00B,GAAMpvB,IAAIiQ,GAAOvV,EAAKsC,GAAKtC,EAAKsC,GAAK,IAAK,IAAKtC,GACrDG,KAAK,SAAU8R,GACd,MAAGA,GAASjS,KACHiS,EAASjS,SAEhBf,GAAKqwC,KAAK,8BALP5a,SAOE,SAAUnvB,GACjBwkE,EAASxkE,KAIb,QAASykE,GAAaz0D,EAAKvV,GACzB,GAAI4J,IACFgR,SACEsZ,eAAgB/gB,QAGpB,OAAOuhB,GAAMpvB,IAAIiQ,EAAKvV,EAAM4J,GAC3BzJ,KAAK,SAAU8R,GACd,MAAGA,GAASjS,KACHiS,EAASjS,SAEhBf,GAAKqwC,KAAK,uCALP5a,SAOE,SAAUnvB,GACjBwkE,EAASxkE,KAIb,QAAS0kE,GAAM10D,EAAKvV,GAClB,MAAO00B,GAAMu1C,MAAM10D,GAAOvV,EAAKsC,GAAKtC,EAAKsC,GAAK,IAAK,IAAKtC,GACvDG,KAAK,SAAU8R,GACd,MAAGA,GAASjS,KACHiS,EAASjS,SAEhBf,GAAKqwC,KAAK,gCALP5a,SAOE,SAAUnvB,GACjBwkE,EAASxkE,KAIb,QAASP,GAAKuQ,EAAKvV,GACjB,MAAO00B,GAAM1vB,KAAKuQ,EAAKvV,GACtBG,KAAK,SAAU8R,GACd,MAAGA,GAASjS,KACHiS,EAASjS,SAEhBf,GAAKqwC,KAAK,+BALP5a,SAOE,SAAUnvB,GACjBwkE,EAASxkE,KAIb,QAAS2kE,GAAc30D,EAAKvV,GAC1B,GAAI4J,IACFgR,SACEsZ,eAAgB/gB,QAGpB,OAAOuhB,GAAM1vB,KAAKuQ,EAAKvV,EAAM4J,GAC5BzJ,KAAK,SAAU8R,GACd,MAAGA,GAASjS,KACHiS,EAASjS,SAEhBf,GAAKqwC,KAAK,wCALP5a,SAOE,SAAUnvB,GACjBwkE,EAASxkE,KAIb,QAASi+B,GAAOjuB,EAAKjT,GACnB,MAAOoyB,GAAAA,UAAanf,EAAMjT,EAAK,KAC9BnC,KAAK,SAAU8R,GACd,MAAGA,GAASjS,KACHiS,EAASjS,SAEhBf,GAAKqwC,KAAK,iCALP5a,SAOE,SAAUnvB,GACjBwkE,EAASxkE,KAIb,QAASrF,GAAIqV,EAAKjT,GAChB,MAAOoyB,GAAMx0B,IAAIqV,GAAOjT,EAAKA,EAAK,IAAM,KACvCnC,KAAK,SAAU8R,GACd,MAAGA,GAASjS,KACHiS,EAASjS,SAEhBf,GAAKqwC,KAAK,8BALP5a,SAOE,SAAUnvB,GACjBwkE,EAASxkE,KAIb,QAASiQ,GAAOD,GACd,MAAOmf,IAAOy1C,OAAQ,UAAW50D,IAAKA,IACrCpV,KAAK,SAAU8R,GACd,MAAGA,GAASjS,KACHiS,EAASjS,SAEhBf,GAAKqwC,KAAK,iCALP5a,SAOE,SAAUnvB,GACjBwkE,EAASxkE,KAIb,QAASgO,GAAIgC,EAAKvV,GAChB,MAAO00B,GAAM1vB,KAAKuQ,EAAKvV,OAAaoqE,aAAa,gBAChDjqE,KAAK,SAAU8R,GACd,GAAIA,EAASjS,KAAM,CACjB,GAAI4jD,GAAO,GAAIpS,OAAMv/B,EAASjS,OAAQc,KAAM,oBACxCupE,EAAUC,IAAIC,gBAAgB3mB,EAClC,QAAS5jD,KAAMiS,EAASjS,KAAMuV,IAAKK,EAAK40D,mBAAmBH,IAE7D,MAAO,QAPF31C,SAQE,SAAUnvB,GACdgQ,EAAIrT,QAAQ,0BACb6nE,EAASxkE,KAKf,QAASq+C,GAAKruC,EAAKvV,EAAMc,GAEvB,MAAO4zB,GAAMx0B,IAAIqV,EAAKvV,OACrBG,KAAK,SAAU8R,GACd,GAAIA,EAASjS,KAAM,CAGjB,GAAIu3C,GAAO,GAAI/F,OAAMv/B,EAASjS,OAASc,KAAOA,GAAQ,gBAAiB,GACvEy2C,GAAOA,EAKT,OAAO,IAXF7iB,SAYE,SAAUnvB,GACjBwkE,EAASxkE,KAIb,QAAS8sD,GAAUryD,GACjB6xD,EAAS7xD,EAGX,QAASyqE,GAAWllE,GAClB,GAAI6B,KACJ,IAAI7B,EAAO,CACT,GAAIA,EAAMmlE,QAAUnlE,EAAMA,OAASA,EAAMolE,iBACvC,MAAOplE,GAAMmlE,QAAUnlE,EAAMA,OAASA,EAAMolE,gBAE9C,KAAK,GAAI/pE,KAAK2E,GAAO,CACnB,GAAIsU,GAAQjZ,CACRixD,IACFA,EAAOjyB,OAAO,SAAU3Q,GAClBA,EAAG7e,KAAOxP,IACZiZ,EAAQoV,EAAG9mB,gBAAgB0R,SAIjCzS,EAAQ5B,KAAK,WAAaqU,EAAQ,eAA0C,SAAzBjI,EAAKmhD,OAAOxtD,EAAM3E,IAAiB2E,EAAM3E,GAAG4lC,KAAK,MAAQjhC,EAAM3E,KAEpH,MAAOwG,GAAQo/B,KAAK,QAEtB,MAAO,MAGT,QAASujC,GAASxkE,GAChB,GAAqB,MAAjBA,EAAM2b,OACR,GAAG3b,EAAMvF,KAAKkC,QAAQ,wCAA0C,CAC9D,GAAI0oE,GAAOrlE,EAAMvF,KAAKulC,UAAUhgC,EAAMvF,KAAKkC,QAAQ,KAAMqD,EAAMvF,KAAKkC,QAAQ,MACxE2oE,EAAQD,EAAKrlC,UAAU,EAAEqlC,EAAKvU,YAAY,KAC9Cx3D,GAAQ0G,MAAM,YAAYslE,EAAM,yCAE7B,IAAGtlE,EAAMvF,KAAKkC,QAAQ,kCAAoC,CAC7D,GAAI8E,GAAezB,EAAMvF,KAAK4E,MAAM,KAAM+D,OAAO,GAAI69B,KAAK,KACtDvd,EAAOjiB,EAAa9E,QAAQ,OAChC8E,GAAaA,EAAau+B,UAAU,EAAEtc,GACtCpqB,EAAQ0G,MAAMyB,OAGhBnI,GAAQ0G,MAAMulE,OACY,OAAjBvlE,EAAM2b,OACfriB,EAAQ0G,MAAMwlE,GACY,MAAjBxlE,EAAM2b,OACfriB,EAAQ0G,MAAMylE,GACY,MAAjBzlE,EAAM2b,OACfriB,EAAQ0G,MAAM0lE,GACY,MAAjB1lE,EAAM2b,OACfriB,EAAQoG,KAAMM,EAAMvF,KAAKkF,aAAe,QAAWK,EAAMvF,KAAKmF,SAAW,oCAEzEtG,EAAQ0G,MAAMklE,EAAWllE,EAAMvF,OAASkrE,GA5P5C,GAAIrZ,GAAS,KACTqZ,EAAkB,kDAClBJ,EAAW,2DACXC,EAAW,mCACXC,EAAW,oCACXC,EAAW,oCAEXx2C,GACFsf,KAAMA,EACNx0B,IAAKw0B,EACLl9B,SAAQ2sB,EACR1yB,KAAMA,EACN5Q,IAAKA,EACLoF,IAAKA,EACL2kE,MAAOA,EACPjlE,KAAMA,EACNklE,cAAeA,EACfF,aAAcA,EACdx0D,OAAQA,EACR21D,OAAQ31D,EACRjC,IAAKA,EACLqwC,KAAMA,EACNyO,UAAWA,EAGb,OAAO59B,GAeTt1B,EAAY6N,SAAW,QAAS,UAAW,OAAQ,OAAQ,QAjD3DvO,QACCC,OAAO,OACP+1B,QAAQ,eAAgB,QAAS,UAAW,OAAQ,OAAQ,OAAQt1B,OA2QvE,WACI,YAEAV,SACCC,OAAO,OACPkhC,OAAO,YAAa,WAAY,SAASld,GAEtC,MAAO,UAASjF,EAAMmH,GAElB,GAAIA,EAAQ,CACR,GAAc,WAAVA,EACA,MAAOlC,GAAS8iD,YAAY/nD,EAEhC,IAAc,QAAVmH,EACA,MAAOlC,GAASiqC,IAAI,OAExB,IAAc,eAAV/nC,EACA,MAAOlC,GAASolD,YAAYrqD,EAEhC,IAAc,SAAVmH,EAEA,MADAnH,GAAOA,EAAK7Y,MAAM,MACV6Y,EAAK,GAAIA,EAAK,IAAI+oB,KAAK,KAIvC,MAAO/oB,UAInB,WACE,YAOE,SAAS2tD,GAAYC,GAEjBA,EAAmBC,MAAM,WAChBC,eAAe,QACfC,cAAc,UAyC3BJ,EAAYp+D,SAAW,sBAlDzBvO,QACGC,OAAO,OACPkL,OAAOwhE,MAcZ,WACE,YAOE,SAASK,GAAS3sE,EAASE,EAAWC,EAAMysE,EAAar0D,EAASqL,EAAUrR,EAAWs6D,EAAgB9I,EAAc+I,EAAgBz+D,GA8BjI,QAASu+C,GAAMtmD,GACX,GAAIymE,GAAQH,CACZ,KAAK,GAAI9qE,KAAKirE,GACV,GAAoC,GAAhCzmE,EAAKlD,QAAQ,IAAM2pE,EAAMjrE,KAAkD,GAAtCwE,EAAKlD,QAAQ,IAAM2pE,EAAMjrE,GAAK,KACnE,OAAO,CAGf,QAAO,EAIX,QAASkrE,KACLrtE,QAAQ8H,QAAQ,QAAQshB,YAAY,cAzCxC8jD,EAAe1jE,OACf2jE,EAAe3jE,KAAK46D,EACpB,IAAIjc,GAAanoD,QAAQ8H,QAAQ,mBAC7Bk2D,EAAYplD,EAAQylB,QAGxB8pB,GAAWh4B,GAAG,QAAS,iBAAkB,WACrC,GAAImU,GAAMtkC,QAAQ8H,QAAQkC,KAC1Bs6B,GAAIhb,SAASA,SAAS7B,OAAO6lC,cAC7BhpB,EAAIob,YAAY,WAGpB,IAAI4tB,GAAUttE,QAAQ8H,QAAQ,wBAM9B,IALAwlE,EAAQn9C,GAAG,QAAS,kBAAmB,WACnCnwB,QAAQ8H,QAAQkC,MAAMsf,SAASA,SAASA,SAASI,YAIhDrpB,EAAQisD,YAQT59C,EAAelF,WARO,CACtB,GAAI7C,GAAOpG,EAAUoG,MAEhBsmD,GAAMtmD,KACHA,EAAKvE,QAAQ/B,EAAQiP,WAAW,OAAQ3I,EAAK8V,QAAQ,IAAK,KAC3B,cAA/Bpc,EAAQyO,WAAW,SAAyBvO,EAAUoG,KAAK,UAqBvE3G,QAAQ8H,QAAQ8Q,EAAQylB,UAAUlO,GAAG,QAAS,SAASqO,GAClC,IAAbA,EAAE+uC,SACFF,MAIRrP,EAAUwP,iBAAiB,sBAAuB,WACzCxP,EAAUyP,eACXJ,MAEL,GATPL,EAASz+D,SAAW,UAAW,YAAa,OAAQ,cAAe,UAAW,WAAY,YAAa,iBAAkB,eAAgB,iBAAkB,kBAnD7JvO,QACGC,OAAO,OACPytE,IAAIV,MAgET,WACE,YAOA,SAASW,GAAaC,EAAgBC,GACpCD,EACG99B,MAAM,QACLh5B,IAAK,IACLtL,YAAa,kCACbF,WAAY,iBACZutB,aAAc,SAEfiX,MAAM,WACLh5B,IAAK,WACLtL,YAAa,yDACbF,WAAY,qBACZutB,aAAc,aAEfiX,MAAM,QACLh5B,IAAK,QACLtL,YAAa,yDACbF,WAAY,iBACZutB,aAAc,SAEfiX,MAAM,OACLh5B,IAAK,OACLtL,YAAa,uDACbF,WAAY,gBACZutB,aAAc,QAEfiX,MAAM,SACLh5B,IAAK,SACLtL,YAAa,mDACbF,WAAY,kBACZutB,aAAc,UAEfiX,MAAM,UACLh5B,IAAK,UACLtL,YAAa,yCACbF,WAAY,oBACZutB,aAAc,YAEfiX,MAAM,aACLh5B,IAAK,aACLtL,YAAa,kDACbF,WAAY,sBACZutB,aAAc,cAEfiX,MAAM,WACLh5B,IAAK,WACLtL,YAAa,uDACbF,WAAY,oBACZutB,aAAc,YAEfiX,MAAM,aACLh5B,IAAK,aACLtL,YAAa,iFACbF,WAAY,sBACZutB,aAAc,cAEfiX,MAAM,cACLh5B,IAAK,cACLtL,YAAa,mFACbF,WAAY,uBACZutB,aAAc,eAEfiX,MAAM,aACLh5B,IAAK,0BACLtL,YAAa,uGACbF,WAAY,sBACZutB,aAAc,cAEfiX,MAAM,cACLh5B,IAAK,cACLtL,YAAa,mFACbF,WAAY,uBACZutB,aAAc,eAEfiX,MAAM,aACLh5B,IAAK,0BACLtL,YAAa,uGACbF,WAAY,sBACZutB,aAAc,cAEfiX,MAAM,cACLh5B,IAAK,cACLtL,YAAa,mFACbF,WAAY,uBACZutB,aAAc,eAEfiX,MAAM,aACLh5B,IAAK,aACLtL,YAAa,iFACbF,WAAY,sBACZutB,aAAc,cAEfiX,MAAM,YACLh5B,IAAK,YACLtL,YAAa,+EACbF,WAAY,qBACZutB,aAAc,aAEfiX,MAAM,WACLh5B,IAAK,YACLtL,YAAa,6EACbF,WAAY,oBACZutB,aAAc,YAEfiX,MAAM,UACLh5B,IAAK,UACLtL,YAAa,2EACbF,WAAY,mBACZutB,aAAc,WAEfiX,MAAM,YACLh5B,IAAK,aACLtL,YAAa,+EACbF,WAAY,qBACZutB,aAAc,aAEfiX,MAAM,aACLh5B,IAAK,aACLtL,YAAa,iFACbF,WAAY,sBACZutB,aAAc,cAElBg1C,EAAmBC,UAAU,KA3E/BH,EAAap/D,SAAW,iBAAkB,sBApD1CvO,QACGC,OAAO,OACPkL,OAAOwiE,MAmIZ,WACE,YAEA3tE,SACGC,OAAO,OACPsvD,SAAS,SAAUwe,QACnBxe,SAAS,UAAW,OACpBA,SAAS,eAAgB,UACzBA,SAAS,UAAW,0BACpBA,SAAS,UAAW,uBACpBA,SAAS,UAAW,mBAGzB,WACE,YAOE,SAASpkD,GAAO6iE,EAAcC,EAAettE,EAASutE,EAAS3N,EAAS4N,EAAuBJ,EAAQ3C,EAAegD,GAElHJ,EAAaK,cAAa,GAE1BD,EAAgBE,kBAGhBL,EAAcM,SAAWL,EAEzBD,EAAcO,UAAY,QAC1BP,EAAcQ,YAAclO,EAC5B0N,EAAcS,YAAc,iBAG5BP,EAAsB1Z,WAAa,SAASz1C,GACxC,MAAIA,GACO+uD,EAAO/uD,GAAMmH,OAAO,cAExB,MAGXgoD,EAAsBvD,UAAY,SAAS+D,GACvC,GAAIzvD,GAAI6uD,EAAOY,EAAY,cAAc,EACzC,OAAOzvD,GAAEwpD,UAAYxpD,EAAE0vD,SAAW,GAAI1+D,MAAK2+D,MAG/CzD,EAAcC,aAAatkE,KAAK,mBAI3BqkE,EAAc0D,SAAS3yD,QAAQ1a,MAChC2pE,EAAc0D,SAAS3yD,QAAQ1a,QAEnC2pE,EAAc0D,SAAS3yD,QAAQ1a,IAAI,iBAAmB,+CACtD2pE,EAAc0D,SAAS3yD,QAAQ1a,IAAI,OAAY,WAG/C2pE,EAAc0D,SAAS3yD,QAAQ1a,IAAI,qBAAuB,gCAW9D0J,EAAOoD,SAAW,eAAgB,gBAAiB,UAAW,UAAW,UAAW,wBAAyB,SAAU,gBAAiB,mBArD1IvO,QACGC,OAAO,OACPkL,OAAOA,MA+CZnL,QAAQC,OAAO,OAAOytE,KAAK,iBAAkB,SAASqB,GAAiBA,EAAeloE,IAAI,4CAA4C,yJACtIkoE,EAAeloE,IAAI,wDAAwD,w3EAC3EkoE,EAAeloE,IAAI,0CAA0C,w0VAC7DkoE,EAAeloE,IAAI,iDAAiD;AACpEkoE,EAAeloE,IAAI,2CAA2C,0eAC9DkoE,EAAeloE,IAAI,4DAA4D,0xCAC/EkoE,EAAeloE,IAAI,wCAAwC,mgCAC3DkoE,EAAeloE,IAAI,oCAAoC,onDACvDkoE,EAAeloE,IAAI,kDAAkD,o7BACrEkoE,EAAeloE,IAAI,4CAA4C,myBAC/DkoE,EAAeloE,IAAI,sCAAsC,ghDACzDkoE,EAAeloE,IAAI,yDAAyD,wNAC5EkoE,EAAeloE,IAAI,kDAAkD,ojBACrEkoE,EAAeloE,IAAI,+CAA+C,wkEAClEkoE,EAAeloE,IAAI,yCAAyC,w+CAC5DkoE,EAAeloE,IAAI,qCAAqC,6OACxDkoE,EAAeloE,IAAI,2CAA2C,oTAC9DkoE,EAAeloE,IAAI,gDAAgD,4FACnEkoE,EAAeloE,IAAI,kCAAkC,2CACrDkoE,EAAeloE,IAAI,6CAA6C,2+FAChEkoE,EAAeloE,IAAI,kDAAkD,25FACrEkoE,EAAeloE,IAAI,uDAAuD,g1CAC1EkoE,EAAeloE,IAAI,2DAA2D,iwIAC9EkoE,EAAeloE,IAAI,6DAA6D,0kBAChFkoE,EAAeloE,IAAI,2DAA2D,+JAC9EkoE,EAAeloE,IAAI,2FAA2F,2hBAC9GkoE,EAAeloE,IAAI,iDAAiD,gpCACpEkoE,EAAeloE,IAAI,yEAAyE,i4CAC5FkoE,EAAeloE,IAAI,qEAAqE;AACxFkoE,EAAeloE,IAAI,qFAAqF,m4CACxGkoE,EAAeloE,IAAI,+DAA+D,mEAClFkoE,EAAeloE,IAAI,6DAA6D,i9KAChFkoE,EAAeloE,IAAI,qDAAqD,ugBACxEkoE,EAAeloE,IAAI,qEAAqE,w9CACxFkoE,EAAeloE,IAAI,qDAAqD,qWACxEkoE,EAAeloE,IAAI,mDAAmD,65BACtEkoE,EAAeloE,IAAI,mDAAmD,uEACtEkoE,EAAeloE,IAAI,4CAA4C,44BAC/DkoE,EAAeloE,IAAI,mDAAmD,kkCACtEkoE,EAAeloE,IAAI,gDAAgD,y+DACnEkoE,EAAeloE,IAAI,uDAAuD,s8MAC1EkoE,EAAeloE,IAAI,iDAAiD,+hHACpEkoE,EAAeloE,IAAI,8CAA8C,g7CACjEkoE,EAAeloE,IAAI,yDAAyD,0PAC5EkoE,EAAeloE,IAAI,yCAAyC,gzBAC5DkoE,EAAeloE,IAAI,yDAAyD;AAC5EkoE,EAAeloE,IAAI,mFAAmF,iVACtGkoE,EAAeloE,IAAI,+DAA+D,8zJAClFkoE,EAAeloE,IAAI,iFAAiF,wRACpGkoE,EAAeloE,IAAI,gEAAgE,k+BACnFkoE,EAAeloE,IAAI,mFAAmF,uVACtGkoE,EAAeloE,IAAI,6EAA6E,gOAChGkoE,EAAeloE,IAAI,2EAA2E,giBAC9FkoE,EAAeloE,IAAI,iFAAiF,8UACpGkoE,EAAeloE,IAAI,8DAA8D,wnCACjFkoE,EAAeloE,IAAI,mEAAmE,q6CACtFkoE,EAAeloE,IAAI,iFAAiF;AACpGkoE,EAAeloE,IAAI,mFAAmF,kVACtGkoE,EAAeloE,IAAI,+EAA+E,s/BAClGkoE,EAAeloE,IAAI,yDAAyD,qIAC5EkoE,EAAeloE,IAAI,4CAA4C,s5FAC/DkoE,EAAeloE,IAAI,uDAAuD,iNAC1EkoE,EAAeloE,IAAI,qEAAqE,mpCACxFkoE,EAAeloE,IAAI,uGAAuG,44FAC1HkoE,EAAeloE,IAAI,2EAA2E,wYAC9FkoE,EAAeloE,IAAI,oEAAoE,m/gBACvFkoE,EAAeloE,IAAI,uGAAuG","file":"../../scripts/app-59b069f03f.js","sourcesContent":["(function() {\n  'use strict';\n\n  angular\n    .module('app', [\n      'ngSanitize',\n      'ui.router',\n      'ngMaterial',\n      'md.data.table',\n      'formlyMaterial',\n      'satellizer',\n      'dndLists',\n      'angularFileUpload',\n      'leaflet-directive',\n      'rzModule',\n      'angular-timeline',\n      'naif.base64',\n      'angular-bind-html-compile',\n      'ngCsv'\n    ]);\n\n})();\n\n(function() {\r\n\r\n  'use strict';\r\n\r\n  angular\r\n    .module('app')\r\n    .controller('PlantillaController', PlantillaController);\r\n\r\n  /** @ngInject */\r\n  function PlantillaController( UtilFormly, Message, Storage, $stateParams, $location, $log, $mdSidenav, DataService, restUrl, Panel, ArrayUtil, backUrl,  Documento) {\r\n    var vm = this;\r\n\r\n    var init_index = null; // indice del item que inicia el efecto dnd\r\n    var to_index = null; // indice al que apunta el efecto dnd\r\n\r\n    var init_index_l = null; // indice del item que inicia el efecto dnd y esta dentro de un layout\r\n    var to_index_l = null; // indice al que apunta el efecto dnd y apunta a una posicion dentro de un layout\r\n    var drop_layout = false; // true: indica si se dropeo dentro de un layout, para que dropCallback no se active\r\n    var item_fg = null; // Objeto de referencia para fieldGroup del layout que inicia el efecto dnd\r\n    var data_fg = null; // Objeto de referencia limpio(que tiene la estructura minima de los templates) para fieldGroup del layout que inicia el efecto dnd\r\n    var to_item_fg = null; // Objeto de referencia para fieldGroup del layout al que se esta dropeando\r\n    var to_data_fg = null; // Objeto de referencia limpio(que tiene la estructura minima de los templates) para fieldGroup del layout al que se esta dropeando\r\n    var to_item_fg_num_cols = null; // Numero de columnas que puede soportar el layout al que se esta dropeando\r\n\r\n    var cuenta = Storage.getUser();\r\n    vm.id_plantilla = $stateParams.idPlantilla;\r\n    vm.form_model = {};\r\n    vm.items = [];\r\n    vm.data = [];\r\n    vm.existe_documento = false;\r\n    vm.existe_datosGenerales = false;\r\n    vm.existe_certificacionComprometido = false;\r\n    vm.url_img = null;\r\n\r\n    //cargamos funciones\r\n    vm.funcionAgregar = funcionAgregar;\r\n    vm.editItem = editItem;\r\n    vm.removeItem = removeItem;\r\n    vm.openEditItem = openEditItem;\r\n    vm.cancelEditItem = cancelEditItem;\r\n    vm.dropCallback = dropCallback;\r\n    vm.endCallback = endCallback;\r\n    vm.startCallback = startCallback;\r\n    vm.dropLayoutCallback = dropLayoutCallback;\r\n    vm.endLayoutCallback = endLayoutCallback;\r\n    vm.startLayoutCallback = startLayoutCallback;\r\n    vm.guardarPlantilla = guardarPlantilla;\r\n    vm.vistaPrevia = vistaPrevia;\r\n    vm.verPdf = verPdf;\r\n    vm.openMenu = openMenu;\r\n    vm.togglePalette = togglePalette;\r\n\r\n    inicializarPlantilla();\r\n    function inicializarPlantilla() {\r\n        if ( vm.id_plantilla == 0 ) {\r\n            // Nuevo\r\n            vm.implicados = [];\r\n            vm.items = [ newItem(UtilFormly.newTemplate('cite')) ];\r\n            vm.data = [  UtilFormly.newTemplate('cite') ];\r\n            vm.nombre = \"Nueva plantilla\";\r\n        } else {\r\n            DataService.get(restUrl + 'plantillasFormly/plantilla_formly/' + vm.id_plantilla)\r\n            .then(function (respuesta) {\r\n                vm.nombre = respuesta.datos.nombre;\r\n                vm.abreviacion = respuesta.datos.abreviacion;\r\n                vm.form_model = angular.fromJson(respuesta.datos.plantilla_valor);\r\n                vm.items = transformGet(angular.fromJson(respuesta.datos.plantilla));\r\n                vm.data = angular.fromJson(respuesta.datos.plantilla);\r\n                for (var i = 0; i < vm.data.length; i++) {\r\n                    if( vm.data[i].type=='datosGenerales' ) vm.existe_datosGenerales = true;\r\n                    if( vm.data[i].type=='certificacionComprometido' ) vm.existe_certificacionComprometido = true;\r\n                }\r\n                actualizarPagina(vm.data[0]);\r\n                return DataService.get(restUrl + 'plantillasFormly/documento/?abreviacion='+vm.abreviacion)\r\n            })\r\n            .then(function (respuesta) {\r\n                if(respuesta.datos.total>0){\r\n                    vm.existe_documento = true;\r\n                }\r\n            })\r\n        }\r\n    }\r\n\r\n    function togglePalette(ev) {\r\n        $log.log(\"evento toggle-> \",ev);\r\n        $mdSidenav('right').toggle();\r\n    }\r\n\r\n    function vistaPrevia() {\r\n        vm.form_previo = UtilFormly.dataToView(vm.data);\r\n        // console.log(vm.form_previo);\r\n        if (angular.isObject(vm.form_model)) vm.form_model = UtilFormly.clearModel(vm.data, vm.form_model);\r\n        vm.vista_previa = true;\r\n    }\r\n\r\n    function guardarPlantilla() {\r\n        var xplantilla_valor = angular.copy(vm.form_model);\r\n        var abreviacion;\r\n        if(vm.nombre){\r\n            for (var k in xplantilla_valor) {\r\n                if(k.indexOf(\"editorTexto\")===-1 &&  k.indexOf(\"textarea\")===-1){\r\n                    delete xplantilla_valor[k];\r\n                }else if(xplantilla_valor[k]==''){\r\n                    delete xplantilla_valor[k];\r\n                }\r\n            }\r\n\r\n            var plantilla = {\r\n                nombre: vm.nombre,\r\n                plantilla: angular.toJson(vm.data),\r\n                plantilla_valor: angular.toJson(xplantilla_valor),\r\n                _usuario_creacion: cuenta.id\r\n            };\r\n\r\n            abreviacion = (vm.existe_documento)? vm.abreviacion : Documento.generarAbreviacion(vm.nombre);\r\n\r\n            DataService.get(restUrl+\"plantillasFormly/plantilla_formly/abreviacion/\"+abreviacion)\r\n            .then(function (respuesta) {\r\n                // console.log(respuesta);\r\n                if(respuesta && angular.isDefined(respuesta.datos))\r\n                    return respuesta.datos;\r\n                else\r\n                    throw new Error('sin respuesta');\r\n            })\r\n            .then(function (resp) {\r\n                var abc = ['', 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z' ];\r\n                var xabc = { 'A':1, 'B':2, 'C':3, 'D':4, 'E':5, 'F':6, 'G':7, 'H':8, 'I':9, 'J':10, 'K':11, 'L':12, 'M':13, 'N':14, 'O':15, 'P':16, 'Q':17, 'R':18, 'S':19, 'T':20, 'U':21, 'V':22, 'W':23, 'X':24, 'Y':25, 'Z':26 };\r\n\r\n                var sub_arr, max_num, pun;\r\n                max_num=-1;\r\n                pun = false\r\n                if(resp.rows.count){\r\n                    sub_arr = resp.rows.rows[0].abreviacion.split('-');\r\n                    max_num = xabc[sub_arr[1]];\r\n                    for (var i = 0; i < resp.rows.rows.length; i++) {\r\n                        sub_arr = resp.rows.rows[i].abreviacion.split('-');\r\n                        resp.rows.rows[i].num = sub_arr[1];\r\n                        if( xabc[sub_arr[1]] > max_num )\r\n                            max_num = xabc[sub_arr[1]];\r\n                        if( resp.rows.rows[i].abreviacion==vm.abreviacion )\r\n                            pun = true;\r\n\r\n                    }\r\n                    max_num++;\r\n                    abreviacion+='-'+abc[max_num];\r\n                }\r\n\r\n                if( vm.id_plantilla>0 && resp.row.rows[0] && resp.row.rows[0].id_plantilla_formly==vm.id_plantilla ){\r\n                    abreviacion = vm.abreviacion;\r\n                }\r\n                if( vm.id_plantilla>0 && pun){\r\n                    abreviacion = vm.abreviacion;\r\n                }\r\n                if( vm.id_plantilla==0 && max_num==-1 && resp.row.count==1 )\r\n                    abreviacion += '-A';\r\n                plantilla.abreviacion = abreviacion;\r\n\r\n                if (vm.id_plantilla == 0) {\r\n                    //nuevo\r\n                    plantilla._usuario_creacion = cuenta.id;\r\n                    DataService.post(restUrl + \"plantillasFormly/plantilla_formly\", plantilla)\r\n                    .then(function (respuesta) {\r\n                        Message.show(respuesta.tipoMensaje, respuesta.mensaje);\r\n                        $location.path('plantillas');\r\n                    });\r\n                }else {\r\n                    //editando\r\n                    plantilla._usuario_modificacion = cuenta.id;\r\n                    DataService.put(restUrl + \"plantillasFormly/plantilla_formly/\" + vm.id_plantilla, plantilla)\r\n                    .then(function (respuesta) {\r\n                        Message.show(respuesta.tipoMensaje, respuesta.mensaje);\r\n                        $location.path('plantillas');\r\n                    });\r\n                }\r\n            })\r\n\r\n        }else {\r\n            Message.error('Debe llenar nombre y abreviacion');\r\n        }\r\n\r\n    }\r\n\r\n    function transformGet(data) {\r\n        var items = [];\r\n        for (var i = 0; i < data.length; i++) {\r\n            if( data[i].type!==\"layout\" ){\r\n                items.push(newItem(data[i]));\r\n            }else {\r\n                var elements = [];\r\n                for (var j = 0; j < data[i].fieldGroup.length; j++) {\r\n                    elements.push(newItem( UtilFormly.getConfigItem(data[i].fieldGroup[j]) ));\r\n                }\r\n                data[i].fieldGroup = elements;\r\n                items.push(newItem(data[i]));\r\n            }\r\n        }\r\n        return items;\r\n    }\r\n\r\n    /**\r\n        El orden en que se activan las funciones es diferente y para cada uno se construyo un camino\r\n        CG: Contenedor General\r\n        draguear: levantar\r\n        dropear: dejar, poner, añadir\r\n        * En los movimientos Drag And Drop (dnd)\r\n            1.- cuando se jala de la paleta se puede activar dropCallback o bien dropLayoutCallback solo uno\r\n            2.- Si se draguea del CG se activa startCallback y se puede dropear al CG o a un Layout. una vez que se termine de dropear automaticamente se activa endCallback\r\n            3.- Si se draguea de un Layout se activa startLayoutCallback y se puede dropear al CG, al mismo layout o a otr layout, una vezque se termine de dropear automaticamente se activa endLayoutCallback\r\n        * si se añade elementos con el boton + de la paleta, este solo añadira al CG\r\n    */\r\n\r\n    // cargamos los templates\r\n    // for (var i = 0; i < vm.data.length; i++) {\r\n    //   var item = newItem();\r\n    //   item.val.element.push(UtilFormly.getConfigItem(vm.data[i]));\r\n    //   vm.items.push(item);\r\n    // }\r\n\r\n\r\n    /**\r\n      Funcion que guardara los datos de un elemento que se empieza a mover con dnd\r\n      @param {Integer} index Indice del item que se clickeo para drag\r\n      @param {Objeto} item Objeto item que tiene la forma de newItem\r\n    */\r\n    function startCallback(index, item){\r\n        // console.log(\"startCallback-\"+index);\r\n        // console.log(item);\r\n        item.notvisualize = true;\r\n        init_index = index;\r\n    }\r\n    /**\r\n      Funcion que se encarga de mover los items\r\n    */\r\n    function endCallback(){\r\n        // console.log(\"endCallback\");\r\n        if( to_index!==null ){\r\n            // console.log(\"moviendo a el contenedor general\");\r\n            if( init_index < to_index ) to_index--;\r\n            ArrayUtil.mover( vm.items, init_index, to_index );\r\n            ArrayUtil.mover( vm.data, init_index, to_index );\r\n            delete vm.items[to_index].notvisualize;\r\n            init_index = null;\r\n            to_index = null;\r\n        }else {\r\n            if( to_index_l!==null ){\r\n                // console.log(\"moviendo a layout\");\r\n                // console.log(to_item_fg);\r\n                // console.log(to_data_fg);\r\n                if( vm.items[init_index].val.element[0].type!==\"layout\" ){\r\n                    if( to_item_fg.length < to_item_fg_num_cols ){\r\n                        if( to_item_fg.length==0 ) to_index_l = 0;\r\n                        ArrayUtil.mover( vm.items, init_index, to_index_l, to_item_fg );\r\n                        ArrayUtil.mover( vm.data, init_index, to_index_l, to_data_fg );\r\n                        delete to_item_fg[to_index_l].notvisualize;\r\n                    }else {\r\n                        delete vm.items[init_index].notvisualize;\r\n                        Message.error(\"No puede añadir mas elementos\");\r\n                    }\r\n                }else {\r\n                    delete vm.items[init_index].notvisualize;\r\n                    Message.error(\"No puede añadir contenedores dentro de contenedores\");\r\n                }\r\n            }else {\r\n                delete vm.items[init_index].notvisualize;\r\n            }\r\n            init_index = null;\r\n            to_index_l = null;\r\n        }\r\n    }\r\n\r\n    /**\r\n      Funcion que se ejecuta cuando se dropea un elemento a la lista general\r\n      @param {Integer} index Indice del item que se clickeo para drag\r\n      @param {Objeto} template Objeto que es el template del item que se movio\r\n    */\r\n    function dropCallback(index, template) {\r\n        if(!drop_layout){\r\n            \r\n            if( init_index==null && init_index_l==null ){\r\n                // si se esta jalando desde la paleta\r\n                var tipo = template;\r\n                try {\r\n                    var mensajeError = \"La plantilla solo puede tener un elemento \";\r\n                  if (vm.existe_datosGenerales && tipo == 'datosGenerales') {\r\n                    throw Error(mensajeError + tipo)\r\n                  }\r\n                  if (vm.existe_certificacionComprometido && tipo == 'certificacionComprometido') {\r\n                    throw Error(mensajeError + tipo)\r\n                  }\r\n        \r\n                  if (tipo == 'datosGenerales') vm.existe_datosGenerales = true;\r\n                  if (tipo == 'certificacionComprometido') vm.existe_certificacionComprometido = true;\r\n                  template = UtilFormly.newTemplate(tipo);\r\n                  var item = newItem(template);\r\n                  if( vm.data.length==0 ) index = 0;\r\n                  ArrayUtil.insert( vm.items, index, item );\r\n                  ArrayUtil.insert( vm.data, index, UtilFormly.getConfigItem(template) );\r\n                  delete vm.data[index].validation;\r\n                } catch (error) {\r\n                  if (error.name == 'Error') Message.error(error.message);\r\n                }\r\n\r\n            }else {\r\n                // console.log(\"guardando index--\"+index);\r\n                to_index = index;\r\n            }\r\n        } else {\r\n            drop_layout = false;\r\n        }\r\n    }\r\n\r\n    /**\r\n      Funcion que guardara los datos de un elemento que se empieza a mover con dnd\r\n      @param {Integer} index Indice del item que se clickeo para drag\r\n      @param {Objeto} item Objeto item que tiene la forma de newItem\r\n      @param {Integer} index_l Indice del layout que se clickeo para drag\r\n    */\r\n    function startLayoutCallback(index, item, index_l){\r\n        // console.log(\"startLayoutCallback--\"+index+\"--\"+index_l);\r\n        // console.log(item);\r\n        item.notvisualize = true;\r\n        init_index_l = index;\r\n        item_fg = vm.items[index_l].val.element[0].fieldGroup;\r\n        data_fg = vm.data[index_l].fieldGroup;\r\n        // console.log(item_fg);\r\n        // console.log(data_fg);\r\n    }\r\n    /**\r\n      Funcion que guardara los datos de un elemento que se empieza a mover con dnd\r\n    */\r\n    function endLayoutCallback(){\r\n        if( to_index_l!==null ){\r\n            if( to_item_fg===item_fg ){\r\n                // console.log(\"moviendo de layout a si mismo\");\r\n                if( init_index_l < to_index_l ) to_index_l--;\r\n                ArrayUtil.mover( item_fg, init_index_l, to_index_l );\r\n                ArrayUtil.mover( data_fg, init_index_l, to_index_l );\r\n                delete item_fg[to_index_l].notvisualize;\r\n            }else {\r\n                // console.log(\"moviendo de layout a layout\");\r\n                if( to_item_fg.length==0 ) to_index_l = 0;\r\n                ArrayUtil.mover( item_fg, init_index_l, to_index_l, to_item_fg );\r\n                ArrayUtil.mover( data_fg, init_index_l, to_index_l, to_data_fg );\r\n                delete to_item_fg[to_index_l].notvisualize;\r\n            }\r\n            init_index_l = null;\r\n            to_index_l = null;\r\n        }else {\r\n            if( to_index!==null ){\r\n                // console.log(\"moviendo a afuera de layout\");\r\n                ArrayUtil.mover( item_fg, init_index_l, to_index, vm.items );\r\n                ArrayUtil.mover( data_fg, init_index_l, to_index, vm.data );\r\n                delete vm.items[to_index].notvisualize;\r\n            }else {\r\n                delete item_fg[init_index_l].notvisualize;\r\n            }\r\n            init_index_l = null;\r\n            to_index = null;\r\n        }\r\n    }\r\n\r\n    /**\r\n      Funcion que se ejecuta cuando se dropea un elemento a la lista\r\n      @param {Integer} index Indice del item que se clickeo para drag\r\n      @param {Objeto} template Objeto que es el template del item que se movio\r\n      @param {Integer} index_l Indice del layout al que se esta dropeando\r\n    */\r\n    function dropLayoutCallback(index, template, index_l){\r\n        // console.log(\"dropLayoutCallback--\"+index);\r\n        // console.log(template);\r\n        // console.log(index_l);\r\n        drop_layout = true;\r\n        to_item_fg = vm.items[index_l].val.element[0].fieldGroup;\r\n        to_data_fg = vm.data[index_l].fieldGroup;\r\n        to_item_fg_num_cols = vm.items[index_l].val.element[0].elementAttributes['num-cols'];\r\n        if( init_index_l == null && init_index == null ){\r\n            // si se esta jalando desde la paleta\r\n            var tipo = template;\r\n            template = UtilFormly.newTemplate(tipo);\r\n            var item = newItem(template);\r\n            if( tipo!=\"layout\" ){\r\n                if( to_item_fg.length < to_item_fg_num_cols ){\r\n                    if(to_item_fg.length==0) index = 0;\r\n                    ArrayUtil.insert( to_item_fg , index, item );\r\n                    ArrayUtil.insert( to_data_fg, index, UtilFormly.getConfigItem(template) );\r\n                    delete to_data_fg[index].validation;\r\n                }else {\r\n                    Message.error(\"No puede añadir mas elementos\");\r\n                }\r\n            }else {\r\n                Message.error(\"No puede añadir contenedores dentro de contenedores\");\r\n            }\r\n        }else {\r\n            to_index_l = index;\r\n        }\r\n    }\r\n\r\n    /**\r\n      Funcion que se dispara al añadir un elemento desde la paleta\r\n      @param {String} tipo Tipo de template que se quiere añadir\r\n    */\r\n    function funcionAgregar(tipo) {\r\n        try {\r\n            if (vm.existe_datosGenerales && tipo == 'datosGenerales') {\r\n                throw Error(\"La plantilla solo puede tener un elemento \" + tipo)\r\n            }\r\n            if (vm.existe_certificacionComprometido && tipo == 'certificacionComprometido') {\r\n                throw Error(\"La plantilla solo puede tener un elemento \" + tipo)\r\n            }\r\n            \r\n            if(tipo=='datosGenerales') vm.existe_datosGenerales = true;\r\n            if(tipo=='certificacionComprometido') vm.existe_certificacionComprometido = true;\r\n            var template = UtilFormly.newTemplate(tipo);\r\n            var item = newItem(template);\r\n            vm.items.push( item );\r\n            vm.data.push( UtilFormly.getConfigItem(template) );\r\n            delete vm.data[vm.data.length-1].validation;\r\n        } catch (error) {            \r\n            if (error.name == 'Error') Message.error(error.message);\r\n        }\r\n    }\r\n\r\n    /**\r\n      Funcion que abre un panel para poder editar\r\n      Si es un elemento radio o select modifica sus funciones al añadir o borrar elementos de los chips que son sus opciones\r\n      @param {Objeto} item Objeto item que tiene la forma de newItem\r\n      @param {Servicio} mdOpenMenu Servicio de angular material para abrir el menu\r\n      @param {Evento} event Evento del servicio mdOpenMenu\r\n    */\r\n\r\n    function openEditItem(item, $mdOpenMenu, event){\r\n        var ik;\r\n        if(angular.isDefined($mdOpenMenu)) $mdOpenMenu(event);\r\n        item.init = UtilFormly.getConfigItem(item.val.element[0]);\r\n        if(item.val.element[0].type == \"radio\" || item.val.element[0].type == \"select\"){\r\n            item.val.element[0].opciones = [];\r\n            for (ik in item.val.element[0].templateOptions.options) {\r\n                item.val.element[0].opciones.push(item.val.element[0].templateOptions.options[ik].value);\r\n            }\r\n            item.val.element[0].opciones.push = function() {\r\n                Array.prototype.push.apply(this, arguments); // eslint-disable-line angular/controller-as-vm\r\n                item.val.element[0].templateOptions.options.push({\r\n                    value: arguments[0],\r\n                    id: arguments[0]\r\n                });\r\n            };\r\n            item.val.element[0].opciones.splice = function() {\r\n                Array.prototype.splice.apply(this, arguments); // eslint-disable-line angular/controller-as-vm\r\n                item.val.element[0].templateOptions.options.splice(arguments[0],arguments[1]);\r\n            };\r\n        }\r\n        if(item.val.element[0].type == \"lista\"){\r\n            item.val.element[0].opciones = [];\r\n            for (ik in item.val.element[0].templateOptions.options) {\r\n                item.val.element[0].opciones.push(item.val.element[0].templateOptions.options[ik]);\r\n            }\r\n            item.val.element[0].opciones.push = function() {\r\n                Array.prototype.push.apply(this, arguments); // eslint-disable-line angular/controller-as-vm\r\n                item.val.element[0].templateOptions.options.push( arguments[0] );\r\n            };\r\n            item.val.element[0].opciones.splice = function() {\r\n                Array.prototype.splice.apply(this, arguments); // eslint-disable-line angular/controller-as-vm\r\n                item.val.element[0].templateOptions.options.splice(arguments[0],arguments[1]);\r\n            };\r\n        }\r\n    }\r\n\r\n    function actualizarPagina(template_cite) {\r\n        var to = template_cite.templateOptions;\r\n        switch (to.tipoMembrete) {\r\n            case 'sin membrete':\r\n                vm.url_img = null;\r\n            break;\r\n            case 'externo':\r\n                vm.url_img = backUrl+'public/membrete.png';\r\n            break;\r\n            default:\r\n                vm.url_img = null;\r\n            break;\r\n        }\r\n    }\r\n\r\n    /**\r\n      Funcion que actualizara la configuracion del template de un item\r\n      @param {Objeto} item Objeto item que tiene la forma de newItem\r\n      @param {Integer} i Indice del item que se clickeo para drag\r\n      @param {Integer} i_l Indice del item que se clickeo para drag\r\n    */\r\n    function editItem(item, i, i_l){\r\n        var xdata, xitem;\r\n        // console.log(item);\r\n        if(angular.isUndefined(i_l)){\r\n            // Si se esta editando elemento del contenedor gral\r\n            xdata = vm.items.splice(i, vm.data.length);\r\n            xdata.shift();\r\n\r\n            xitem = newItem();\r\n            xitem.val.element.push(UtilFormly.getConfigItem(item.val.element[0]));\r\n            xdata.unshift(xitem);\r\n            vm.items = vm.items.concat(xdata);\r\n\r\n            vm.data[i] = UtilFormly.getConfigItem(item.val.element[0]);\r\n            if(vm.data[i].type==\"layout\"){\r\n                // console.log(\"entra a actualizarse\");\r\n                var elements = [];\r\n                for (var j = 0; j < vm.data[i].fieldGroup.length; j++) {\r\n                    elements.push(UtilFormly.getConfigItem(vm.data[i].fieldGroup[j].val.element[0]));\r\n                    delete elements[elements.length-1].validation;\r\n                }\r\n                vm.data[i].fieldGroup = elements;\r\n            }\r\n            delete vm.data[i].validation;\r\n            if(vm.data[i].type==\"cite\") actualizarPagina(vm.data[i]);\r\n        }else {\r\n            // si se esta editando elemento dentro de un layout\r\n            xdata = vm.items[i_l].val.element[0].fieldGroup.splice(i, vm.data[i_l].fieldGroup.length);\r\n            xdata.shift();\r\n\r\n            xitem = newItem();\r\n            xitem.val.element.push(UtilFormly.getConfigItem(item.val.element[0]));\r\n            xdata.unshift(xitem);\r\n            vm.items[i_l].val.element[0].fieldGroup = vm.items[i_l].val.element[0].fieldGroup.concat(xdata);\r\n\r\n            vm.data[i_l].fieldGroup[i] = UtilFormly.getConfigItem(item.val.element[0]);\r\n            delete vm.data[i_l].fieldGroup[i].validation;\r\n            if(vm.data[i_l].fieldGroup[i].type==\"cite\") actualizarPagina(vm.data[i_l].fieldGroup[i]);\r\n        }\r\n\r\n    }\r\n\r\n    /**\r\n    Funcioon que elimina un item en la posicion\r\n    @param {Objeto} item Objeto item que tiene la forma de newItem\r\n    @param {Integer} i Indice del item que se clickeo para eliminar\r\n    @param {Integer} i_l Indice del layout en que se encuentra un item\r\n    */\r\n    function removeItem(item, i, i_l){\r\n        if(angular.isUndefined(i_l)){\r\n            // Si se esta eliminando elemento del contenedor gral\r\n            if( vm.data[i].type=='datosGenerales' )\r\n                vm.existe_datosGenerales = false;\r\n            if( vm.data[i].type=='certificacionComprometido' )\r\n                vm.existe_certificacionComprometido = false;\r\n            vm.items.splice(i, 1);\r\n            vm.data.splice(i, 1);\r\n        }else {\r\n            // si se esta eliminando elemento dentro de un layout\r\n            if( vm.data[i_l].fieldGroup[i].type=='datosGenerales' )\r\n                vm.existe_datosGenerales = false;\r\n            if (vm.data[i].type == 'certificacionComprometido')\r\n                vm.existe_certificacionComprometido = false;\r\n            vm.items[i_l].val.element[0].fieldGroup.splice(i, 1);\r\n            vm.data[i_l].fieldGroup.splice(i, 1);\r\n        }\r\n    }\r\n\r\n    /**\r\n        Funcion que no actualizara la configuracion del template de un item\r\n        @param {Objeto} item Objeto item que tiene la forma de newItem\r\n    */\r\n    function cancelEditItem(item){\r\n        item.val.element.shift();\r\n        item.val.element.push(item.init);\r\n    }\r\n\r\n    /**\r\n        Funcion que retorna un nuevo objeto con forma de item, si se manda template lo crea junto a el\r\n        @param {Objeto} template Objeto template formly\r\n    */\r\n    function newItem(template) {\r\n        return { val:{ element: (template)? [template] : [] , model:{} }, init: {} };\r\n    }\r\n\r\n    function openMenu(item, event, index, index_l) {\r\n        var data = {\r\n            item: item,\r\n            index: index,\r\n            index_l: index_l\r\n        }\r\n\r\n        var config = {\r\n            event: event,\r\n            data: data,\r\n            clickOutsideToClose: false,\r\n            escapeToClose:false,\r\n            controller: ['$scope', '$mdPanel', 'data', 'mdPanelRef',PanelItemController],\r\n            templateUrl: 'app/modules/plantillasFormly/plantillas/plantilla/item.panel.html'\r\n        };\r\n        Panel.show(config);\r\n    }\r\n\r\n    function PanelItemController($scope, $mdPanel, data, mdPanelRef) {\r\n        var vmp = $scope;\r\n        vmp.item = data.item;\r\n        vmp.input_valid = null;\r\n        vmp.validaciones = null;\r\n        vmp.titulos = {\r\n            datosGenerales: 'Datos generales',\r\n            inputt: 'Asunto',\r\n            editorTexto: 'Editor de texto',\r\n            documentosRelacionados: 'Documentos relacionados',\r\n            titulo: 'Título',\r\n            subtitulo: 'Subtítulo',\r\n            parrafo: 'Párrafo',\r\n            lista: 'Lista',\r\n            layout: 'Contenedor',\r\n            vacio: 'Espacio',\r\n            input: 'Campo de texto ',\r\n            radio: 'Selección radio',\r\n            select: 'Selección simple',\r\n            select_multiple: 'Selección multiple',\r\n            textarea: 'Area de texto',\r\n            checkbox: 'Checkbox',\r\n            datepicker: 'Calendario',\r\n            slider: 'Deslizador',\r\n            switch: 'Interruptor',\r\n            chips: 'Palabras clave',\r\n            cajachica: 'Caja chica',\r\n            certificacionComprometido: 'Certificación comprometido',\r\n            listaContactos: 'Lista de contactos',\r\n            calendario: 'Mi calendario'\r\n        };\r\n\r\n        //cargamos funciones\r\n        vmp.xeditItem = xeditItem;\r\n        vmp.xremoveItem = xremoveItem;\r\n        vmp.xcancelEditItem = xcancelEditItem;\r\n\r\n        //iniciamos la edicion\r\n        vm.openEditItem(vmp.item);\r\n        vmp.validaciones = [\r\n            { name: \"Ninguno\", pattern: \"\" },\r\n            { name: \"Solo texto\", pattern: \"([a-zA-Zñáéíóú]+ ?)+\" },\r\n            { name: \"Solo números\", pattern: \"\\\\d+\" },\r\n            { name: \"Texto y números\", pattern: \"([a-zA-Z0-9ñáéíóú]+ ?)+\" },\r\n            { name: \"Hora 24hrs\", pattern: '^(0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]$' },\r\n            { name: \"Email\", pattern: '^(([^<>()\\\\[\\\\]\\\\\\\\.,;:\\\\s@\"]+(\\\\.[^<>()\\\\[\\\\]\\\\\\\\.,;:\\\\s@\"]+)*)|(\".+\"))@((\\\\[[0-9]{1,3}\\\\.[0-9]{1,3}\\\\.[0-9]{1,3}\\\\.[0-9]{1,3}])|(([a-zA-Z\\\\-0-9]+\\\\.)+[a-zA-Z]{2,}))$' }\r\n        ];\r\n\r\n        // console.log(data);\r\n        function xeditItem() {\r\n            vm.editItem(data.item, data.index, data.index_l);\r\n            closePanel();\r\n        }\r\n        function xremoveItem() {\r\n            vm.removeItem(data.item, data.index, data.index_l);\r\n            closePanel();\r\n        }\r\n        function xcancelEditItem() {\r\n            // console.log($mdPanel);\r\n            // console.log(mdPanelRef);\r\n            vm.cancelEditItem(data.item);\r\n            closePanel();\r\n        }\r\n        function closePanel() {\r\n            mdPanelRef && mdPanelRef.close().then(function() { mdPanelRef.destroy(); });\r\n        }\r\n    }\r\n\r\n    function verPdf(){\r\n        if( UtilFormly.sizeObj(vm.formu_prueba.$error)==0 ){\r\n            Documento.showPdf(angular.toJson(vm.data), angular.toJson(vm.form_model), 'prueba');\r\n        }else {\r\n            UtilFormly.recursiveShowError(vm.formu_prueba.$error);\r\n        }\r\n    }\r\n\r\n  }\r\n})();\r\n\n(function() {\n  'use strict';\n\n  angular\n    .module('app')\n    .controller('DocumentoController', DocumentoController);\n\n  /** @ngInject */\n  function DocumentoController(DataService, restUrl, Modal, Message, UtilFormly, Storage, $stateParams, $location, backUrl, Panel, Documento, ExpirationTime) {\n    var vm = this;\n    var cuenta = Storage.getUser();\n\n    vm.id_documento = $stateParams.idDocumento;\n    vm.load = false;\n    vm.model_actual = {};\n    vm.form_actual = [];\n    vm.doc = {};\n    vm.sw_enviado = true;\n    vm.sw_rechazado = false;\n    vm.url_img = null;\n\n    // cargamos funciones\n    vm.cargarPlantilla = cargarPlantilla;\n    vm.guardarDocumento = guardarDocumento;\n    vm.enviarMultiple = enviarMultiple;\n    vm.vistaPrevia = vistaPrevia;\n    vm.firmar = firmar;\n    vm.volverAtras = volverAtras;\n    vm.verObservaciones = verObservaciones;\n    vm.verDocumento = verDocumento;\n    vm.copearDocumento = copearDocumento;\n\n    iniciar();\n\n    function iniciar() {\n      vm.enviarEjecutandose=0;\n        if (vm.id_documento==0) {\n            // console.log(Storage.getSession('pl'));\n            if(Storage.getSession(\"pl\")!=null){\n                cargarPlantilla(Storage.getSession(\"pl\"));\n                vm.sw_enviado = false;\n                verificarZonaHoraria();\n                vm.load = true;\n                ExpirationTime.initAutoSave(guardar, false);\n                Message.show('INFORMACION', 'No olvide guardar sus cambios cada 40 minutos, de lo contrario se perderán.');\n            } else $location.path('documentos');\n        }else {\n            // console.log(restUrl + 'plantillasFormly/documento/'+vm.id_documento);\n            DataService.get(restUrl + 'plantillasFormly/documento/'+vm.id_documento)\n            .then(function (resultado) {\n                Storage.setSession('pl', resultado.datos);\n                if(resultado.datos._usuario_creacion!=cuenta.id)\n                    $location.path('documentos');\n                cargarPlantilla(resultado.datos, true);\n                vm.sw_rechazado = (resultado.datos.estado==\"RECHAZADO\")? true : false;\n                vm.sw_enviado = ( resultado.datos.estado!=\"NUEVO\" && !vm.sw_rechazado)? true : false;\n                // deshabilitamos todos los campos para\n                UtilFormly.disableForm(vm.form_actual, vm.sw_enviado);\n                if(vm.sw_enviado){\n                    var flujo = {\n                        via_actual: resultado.datos.via_actual,\n                        para: angular.fromJson(resultado.datos.para),\n                        via: angular.fromJson(resultado.datos.via)\n                    };\n                    Storage.setSession('flujo_doc',flujo);\n                }\n                ExpirationTime.initAutoSave(guardar, vm.sw_enviado);\n                Message.show('INFORMACION', 'No olvide guardar sus cambios cada 40 minutos, de lo contrario se perderán.');\n                verificarZonaHoraria();\n                vm.load = true;\n            });\n        }\n    }\n    function verificarZonaHoraria() {\n      var es_zona_horaria_bolivia = true, offset;\n      var data = angular.fromJson(vm.doc.plantilla);\n      for (var i = 0; i < data.length; i++) {\n        if (data[i].type==\"layout\") {\n            for (var j = 0; j < data[i].fieldGroup.length; j++) {\n              if (vm.form_actual[i].fieldGroup[j].type=='datepicker'){\n                offset = new Date().getTimezoneOffset();\n                es_zona_horaria_bolivia = (offset==240);\n              }\n            }\n        } else {\n          if (vm.form_actual[i].type=='datepicker'){\n            offset = new Date().getTimezoneOffset();\n            es_zona_horaria_bolivia = (offset==240);\n          }\n        }\n        if (!es_zona_horaria_bolivia) break;\n      }\n\n      if (!es_zona_horaria_bolivia && !vm.sw_enviado) abrirDialogError('timeZone');\n    }\n\n    function copearDocumento() {\n        Modal.confirm('¿Esta seguro de que quiere crear otro documento igual a este?', function () {\n            var model = angular.copy(vm.model_actual);\n            delete model['cite-0'];\n            \n            if (model['listaContactos-0'] && model['listaContactos-0'].contacto) {\n                delete model['listaContactos-0'].contacto;\n            }\n            \n            var pl = {\n                nombre: vm.doc.nombre_plantilla,\n                nombre_plantilla: vm.doc.nombre_plantilla,\n                abreviacion: vm.doc.abreviacion,\n                plantilla: vm.doc.plantilla,\n                plantilla_valor: angular.toJson(model),\n                observaciones: null\n            };\n            \n            \n            var verificar = {\n              nombre: pl.nombre,\n              abreviacion: pl.abreviacion,\n              plantilla: pl.plantilla\n            };\n            \n            DataService.post(restUrl + 'plantillasFormly/plantilla_formly/verificar', verificar)\n            .then(function respuesta (respuesta) {\n              if(respuesta.datos.valido === true) {\n                Storage.setSession('pl',pl);\n                $location.path('documento/0');\n              }\n              else {\n                Message.show('ERROR', 'La plantilla ya no existe o no se encuetra activa. El documento no se puede duplicar.');\n              }\n            });\n        });\n    }\n\n    function cargarPlantilla(pl, model) {\n\n        vm.model_actual = (pl.plantilla_valor==null)? {} : angular.fromJson(pl.plantilla_valor);\n        if(model)\n            vm.form_actual = UtilFormly.dataToView(angular.fromJson(pl.plantilla), vm.model_actual);\n        else\n            vm.form_actual = UtilFormly.dataToView(angular.fromJson(pl.plantilla));\n\n        actualizarPagina(vm.form_actual[0]);\n\n        vm.doc.nombre = (model)? pl.nombre : pl.nombre+' - '+cuenta.first_name+' '+cuenta.last_name;\n        vm.doc.nombre_plantilla = (model)? pl.nombre_plantilla : pl.nombre;\n        vm.doc.abreviacion = pl.abreviacion;\n        vm.doc.plantilla = pl.plantilla;\n        vm.doc.observaciones = (model)? pl.observaciones : null;\n        vm.sw_es_respuesta = pl.documento_padre || false;\n        if(vm.sw_es_respuesta) {\n            vm.doc.documento_padre = pl.documento_padre;\n        }\n\n        vm.sw_grupo = pl.grupo || false;\n        if(vm.sw_grupo) {\n            // obtener documentos de grupo\n            DataService.get(restUrl + 'plantillasFormly/documento/?fields=id_documento,nombre,nombre_plantilla&estado=DERIVADO,CERRADO,APROBADO&sort=_fecha_creacion&grupo='+pl.grupo)\n            .then(function (resultado) {\n                vm.docs_grupo = resultado.datos.resultado;\n            });\n        }\n\n    }\n\n    function verDocumento(id_doc) { Documento.showPdfId(id_doc, false); }\n\n    function actualizarPagina(template_cite) {\n        var to = template_cite.templateOptions || 'sin membrete';\n        switch (to.tipoMembrete) {\n            case 'sin membrete':\n                vm.url_img = null;\n            break;\n            case 'externo':\n                vm.url_img = backUrl+'public/membrete.png';\n            break;\n        }\n    }\n\n    function agregarFlujo(documento, enviar) {\n        if(enviar){\n            var k, key, arr, i;\n            k = key = \"para\";\n            documento[k] = angular.toJson([vm.model_actual[\"datosGenerales-0\"][key].id_usuario]);\n\n            k = key = \"via\";\n            arr = vm.model_actual[\"datosGenerales-0\"][key] || [];\n            documento[k] = [];\n            for (i = 0; i < arr.length; i++) {\n                documento[k].push(arr[i].id_usuario);\n            }\n            documento[k] = angular.toJson(documento[k].reverse());\n\n            k = key = \"de\";\n            arr = vm.model_actual[\"datosGenerales-0\"][key];\n            documento[k] = [];\n            for (i = 0; i < arr.length; i++) {\n                documento[k].push(arr[i].id_usuario);\n            }\n            documento[k] = angular.toJson(documento[k]);\n\n            k = \"referencia\" ; key = \"ref\";\n            documento[k] = vm.model_actual[\"datosGenerales-0\"][key];\n        }\n    }\n    function transformarModel(model) {\n        // archivos\n        var i = 0, arch;\n        while (i!=-1) {\n            arch = model['archivo-'+i];\n            if(angular.isUndefined(arch)) break;\n            if(angular.isUndefined(arch.length)){\n                model['archivo-'+i] = [arch];\n            }\n            i++;\n        }\n        return angular.toJson(model);\n    }\n\n    function guardar(enviar, sw_location){\n      if(vm.enviarEjecutandose > 1) {\n        return;\n      }\n      var documento = {\n          nombre: vm.doc.nombre,\n          nombre_plantilla: vm.doc.nombre_plantilla,\n          abreviacion: vm.doc.abreviacion,\n          plantilla: vm.doc.plantilla,\n          plantilla_valor: transformarModel(angular.copy(vm.model_actual))\n      };\n\n      if(vm.sw_es_respuesta) {\n        documento.documento_padre = vm.doc.documento_padre;\n      }\n\n      if (!vm.sw_enviado) agregarFlujo(documento, enviar);\n      // console.log(documento);\n      if ( vm.id_documento==0 ) {\n          documento._usuario_creacion = cuenta.id;\n      }else {\n          documento._usuario_modificacion = cuenta.id;\n          documento.id = vm.id_documento;\n      }\n      documento.sw = {\n          enviar: enviar,\n          enviado: vm.sw_enviado,\n          es_respuesta: vm.sw_es_respuesta\n      };\n\n      DataService.save( restUrl+'plantillasFormly/documento/', documento)\n      .then(function (respuesta) {\n          if(!sw_location){\n              Message.show(respuesta.tipoMensaje, respuesta.mensaje);\n              $location.path('documentos');\n              Storage.removeSession('pl');\n          }else if(vm.id_documento==0) $location.path('documento/'+respuesta.datos.id_documento);\n          vm.enviarEjecutandose=0;\n      });\n    }\n\n    function guardarDocumento(enviar) {\n      vm.enviarEjecutandose += 1;\n        // Valida si es para enviar.\n        if(enviar){\n          if( UtilFormly.sizeObj(vm.formu.$error)==0 ){\n              guardar(enviar);\n          }else {\n            UtilFormly.recursiveShowError(vm.formu.$error);\n            Message.show(\"ERROR\", 'Debe llenar todos los campos marcados con rojo porque son requeridos'.toUpperCase());\n            abrirDialogError('formu');\n            vm.enviarEjecutandose=0;\n          }\n        }\n        else{\n          guardar();\n\n        }\n\n    }\n    \n    function enviarMultiple() {\n        if (vm.enviarEjecutandose > 1) {\n          return;\n        }\n        var documento = {\n          nombre: vm.doc.nombre,\n          nombre_plantilla: vm.doc.nombre_plantilla,\n          abreviacion: vm.doc.abreviacion,\n          plantilla: vm.doc.plantilla,\n          plantilla_valor: transformarModel(angular.copy(vm.model_actual))\n        };\n\n        if (vm.sw_es_respuesta) {\n          documento.documento_padre = vm.doc.documento_padre;\n        }\n\n        if (!vm.sw_enviado) agregarFlujo(documento, true);\n        // console.log(documento);\n        if (vm.id_documento == 0) {\n          documento._usuario_creacion = cuenta.id;\n        } else {\n          documento._usuario_modificacion = cuenta.id;\n          documento.id = vm.id_documento;\n        }\n        documento.sw = {\n          enviar: true,\n          enviado: vm.sw_enviado,\n          es_respuesta: vm.sw_es_respuesta\n        };\n\n        DataService.save(restUrl + 'plantillasFormly/documento/', documento)\n        .then(function (respuesta) {\n            // if (!sw_location) {\n            //     Message.show(respuesta.tipoMensaje, respuesta.mensaje);\n            //     $location.path('documentos');\n            //     Storage.removeSession('pl');\n            // } else \n            if (vm.id_documento == 0) $location.path('documento/' + respuesta.datos.id_documento);\n            vm.enviarEjecutandose = 0;\n        });\n    }\n\n\n    function abrirDialogError(tipo){\n      var config = {\n        data: tipo,\n        templateUrl: 'app/modules/plantillasFormly/documentos/documento/dialogError.html',\n        controller: ['data', '$scope', '$mdDialog', DialogErrorController]\n      }\n      Modal.show(config);\n    }\n\n    function DialogErrorController(data, $scope, $mdDialog){\n      var vmd = $scope;\n      vmd.data={tipo:data};\n\n      vmd.cerrar= function(){\n        $mdDialog.cancel();\n      }\n    }\n\n    function volverAtras() {\n        $location.path('documentos');\n    }\n\n    function vistaPrevia(){\n        if( UtilFormly.sizeObj(vm.formu.$error)==0 ){\n            Documento.showPdf(vm.doc.plantilla, angular.toJson(vm.model_actual), vm.doc.nombre);\n        }else {\n            Message.show('INFORMACION', 'Antes de visualizar el documento debe llenar todos los campos requeridos.');\n            UtilFormly.recursiveShowError(vm.formu.$error);\n        }\n    }\n\n    function firmar(){\n        var config = {\n            data: \"\", //datosEnviar,\n            templateUrl: 'app/modules/firmador/modules.firmador.html',\n            controller: ['data', '$scope', '$mdDialog', 'Util', 'DemofiService', DialogFirmadorController]\n        }\n        Modal.show(config);\n    }\n\n    function DialogFirmadorController(data, $scope, $mdDialog, Util, DemofiService){\n        var vmd = $scope;\n        vmd.data={};\n\n        //valores para firma digital\n        vmd.iniciado = false;\n        vmd.pin = undefined;\n        vmd.tokens = [];\n        vmd.certificados = [];\n          //this.$scope.firmados = 0;\n        vmd.iniciado = false;\n        vmd.iniciando = false;\n        vmd.certificado_seleccionado = undefined;\n          //this.$scope.solicitudes = data.solicitudes;\n        vmd.autenticado = false;\n        vmd.autenticando = false;\n          //this.$scope.firmando = false;\n        vmd.demofi_ejecutandose = false;\n        vmd.token_conectado = false;\n        vmd.boton_autenticar_habilitado = false;\n        vmd.mostrar_progress = false;\n\n\n        vmd.data.html=data.html;\n        vmd.data.pdf=data.pdf;\n        vmd.data.flag_html=true;\n        vmd.data.show_pdf=!data.esDispositivoMovil;\n        if (data.esDispositivoMovil) {\n            Util.loadCanvas(data.pdf_buffer, '#canvasContainer');\n        }\n\n        //funciones\n\n        /*vmd.cerrar = function (){ $mdDialog.cancel(); }\n        vmd.verHtml = function(){ vmd.data.flag_html=true; }\n        vmd.verPdf = function(){ vmd.data.flag_html=false; }*/\n\n\n        vmd.verificarTokenConectado = verificarTokenConectado;\n        vmd.autenticar = autenticar;\n        vmd.cancelar = cancelar;\n        vmd.verificarServidor = verificarServidor;\n\n        verificarTokenConectado();\n\n        function verificarTokenConectado() {\n            if (vmd.iniciando === false) {\n                vmd.iniciando = true;\n                DemofiService.listTokens()\n                .then( function (response) {\n                    // this.$log.log('verificarTokenConectado-then', response)\n                    vmd.iniciando = false;\n                    vmd.iniciado = true;\n                    vmd.demofi_ejecutandose = true;\n                    vmd.tokens = response.datos;\n                    vmd.token_conectado = response.datos.length > 0;\n                })\n                .catch( function () {\n                    // this.$log.log('verificarTokenConectado-catch', error)\n                    vmd.iniciando = false;\n                    vmd.iniciado = true;\n                    vmd.token_conectado = false;\n                    vmd.demofi_ejecutandose = false;\n                });\n\n                /*vmd.iniciando = false;\n                vmd.iniciado = true;\n                vmd.demofi_ejecutandose = true;\n                vmd.tokens = [\"FT ePass2003Auto\"]; //{\"datos\":[\"FT ePass2003Auto\"],\"finalizado\":true,\"mensaje\":\"Tokens detectados\"};\n                vmd.token_conectado = true; //response.datos.length > 0; */\n            }\n        }\n\n        function autenticar() {\n            vmd.mostrar_progress = true;\n            vmd.autenticando = true;\n            //this.cancelInterval();\n            //this.Loading.show('Cargando', true);\n            DemofiService.login(vmd.pin)\n            .then(function (respLogin) {\n                //this.$log.log(respLogin);\n                vmd.mostrar_progress = false;\n                vmd.autenticando = false;\n                if (respLogin.finalizado === true) {\n                    vmd.boton_autenticar_habilitado = false;\n                    // Obtener certificados\n                    vmd.autenticado = true;\n                    // Una ves autenticado actualizamos la lista de certificados\n                    DemofiService.listCertificates()\n                    .then(function (respCert) {\n                        vmd.certificados = respCert.datos;\n                        if (vmd.certificados[0]) {\n                            vmd.certificado_seleccionado = vmd.certificados[0];\n                        }\n                    });\n                }\n            })\n            .catch( function () {\n                // this.$log.log(error);\n                vmd.mostrar_progress = false;\n                vmd.autenticando = false;\n                vmd.pin = undefined;\n                vmd.autenticado = false;\n                vmd.boton_autenticar_habilitado = true;\n                //this.Message.warning(error.mensaje);\n                //this.initInterval();\n            });\n        }\n\n        function verificarServidor() {\n            DemofiService.verificarServidor();\n        }\n\n        function cancelar() {\n            $mdDialog.cancel();\n        }\n    }\n\n\n    function verObservaciones(event) {\n        var data = {\n            observacion: vm.doc.observaciones || 'El documento esta mal'\n        }\n        var config = {\n            event: event,\n            data: data,\n            controller: ['$scope', 'data', 'mdPanelRef',PanelItemController],\n            templateUrl: 'app/modules/plantillasFormly/documentos/documento/observacion.panel.html'\n        };\n        Panel.show(config);\n    }\n\n    function PanelItemController($scope, data, mdPanelRef) {\n        var vmp = $scope;\n        vmp.observacion = data.observacion;\n\n        //cargamos funciones\n        vmp.closePanel = closePanel;\n\n        function closePanel() {\n            mdPanelRef && mdPanelRef.close().then(function() { mdPanelRef.destroy(); });\n        }\n    }\n\n\n  }\n})();\n\n(function() {\r\n  'use strict';\r\n\r\n  angular\r\n    .module('app')\r\n    .controller('RolController', RolController);\r\n\r\n  /** @ngInject */\r\n  function RolController(restUrl, Storage) {\r\n    var vm = this;\r\n\r\n    var cuenta=Storage.getUser();\r\n    vm.usuario = cuenta.id;\r\n\r\n    //config para crudTable\r\n    vm.url = restUrl+'seguridad/rol/';\r\n    vm.fields = ['id_rol','nombre','descripcion','peso','estado','_fecha_creacion','_fecha_modificacion'];\r\n    vm.titulo = \"Roles\";\r\n    vm.dialogController = ['data', 'Message', '$scope', '$mdDialog', 'DataService', 'restUrl', '$timeout', DialogRolController];\r\n    vm.template = 'app/modules/seguridad/rol/dialog.rol.html';\r\n\r\n    function DialogRolController(data, Message, $scope, $mdDialog, DataService, restUrl, $timeout) {\r\n        var vmd = $scope;\r\n\r\n        vmd.cerrar = cerrar;\r\n        vmd.registrarRol = registrarRol;\r\n        vmd.data = data;\r\n        vmd.estados = [{id:\"ACTIVO\", name: \"ACTIVO\"},{id:\"INACTIVO\", name: \"INACTIVO\"}];\r\n\r\n        // console.log(data);\r\n\r\n        if (!vmd.data.id_rol) vmd.data._fecha_creacion = new Date();\r\n        vmd.data._fecha_modificacion = new Date();\r\n        obtenerMenus();\r\n        function obtenerMenus() {\r\n            if(vmd.data.id_rol){\r\n                DataService.get(restUrl+\"seguridad/menu?limit=1000&estado=ACTIVO\")\r\n                .then(function(respuesta){\r\n                    vmd.menus = respuesta.datos.resultado;\r\n                    // console.log(\"id_rol->\"+vmd.data.id_rol);\r\n                    return DataService.get(restUrl+\"seguridad/rol/\"+vmd.data.id_rol+\"/menu\");\r\n                })\r\n                .then(function(respuesta){\r\n                    vmd.rol_menus = respuesta.datos;\r\n                    // console.log(vmd.rol_menus);\r\n                    for (var i = 0; i < vmd.rol_menus.length; i++) {\r\n                        for (var j = 0; j < vmd.menus.length; j++) {\r\n                            if(vmd.rol_menus[i].fid_menu == vmd.menus[j].id_menu){\r\n                                vmd.menus[j].checked = (vmd.rol_menus[i].estado == 'ACTIVO')? true : false;\r\n                                j = vmd.menus.length;\r\n                            }\r\n                        }\r\n                    }\r\n                });\r\n\r\n            }else {\r\n                DataService.get(restUrl+\"seguridad/menu?limit=1000&estado=ACTIVO\")\r\n                .then(function(respuesta){\r\n                    vmd.menus = respuesta.datos.resultado;\r\n                })\r\n            }\r\n\r\n        }\r\n\r\n        function registrarRol() {\r\n            var datosEnviar = {\r\n                rol: {\r\n                    id_rol: vmd.data.id_rol,\r\n                    nombre: vmd.data.nombre,\r\n                    descripcion: vmd.data.descripcion,\r\n                    peso: vmd.data.peso,\r\n                    estado: vmd.data.estado\r\n                },\r\n                menus: []\r\n            };\r\n            // console.log(datosEnviar);\r\n            if (vmd.data.id_rol) {\r\n                datosEnviar.rol._usuario_modificacion = cuenta.id;\r\n                datosEnviar.menus_nuevos = [];\r\n                for (var i = 0; i < vmd.menus.length; i++) {\r\n                    var existe = false;\r\n                    for (var j = 0; j < vmd.rol_menus.length; j++) {\r\n                        if(vmd.menus[i].id_menu == vmd.rol_menus[j].fid_menu)\r\n                        {\r\n                            // console.log(vmd.rol_menus[j]);\r\n                            vmd.rol_menus[j].estado = (vmd.menus[i].checked)? 'ACTIVO' : 'INACTIVO';\r\n                            vmd.rol_menus[j]._usuario_modificacion = cuenta.id;\r\n                            delete vmd.rol_menus[j]._fecha_creacion;\r\n                            delete vmd.rol_menus[j]._fecha_modificacion;\r\n                            datosEnviar.menus.push(angular.fromJson(angular.toJson(vmd.rol_menus[j])));\r\n                            existe = true;\r\n                            j = vmd.rol_menus.length;\r\n                        }\r\n                    }\r\n                    if(!existe && vmd.menus[i].checked){\r\n                        datosEnviar.menus_nuevos.push(vmd.menus[i].id_menu);\r\n                    }\r\n                }\r\n\r\n                DataService.put(restUrl+\"seguridad/rol/\"+vmd.data.id_rol+\"/menu\", datosEnviar)\r\n                .then(function (respuesta) {\r\n                    Message.show(respuesta.tipoMensaje,respuesta.mensaje);\r\n                    $mdDialog.hide();\r\n                    $timeout(function () {\r\n                        angular.element('#btn-refresh-crudtable').click();\r\n                    }, 500);\r\n                });\r\n            }else{\r\n                datosEnviar.rol._usuario_creacion = cuenta.id;\r\n\r\n                for (i = 0; i < vmd.menus.length; i++) {\r\n                    if(vmd.menus[i].checked){\r\n                        datosEnviar.menus.push(vmd.menus[i].id_menu);\r\n                    }\r\n                }\r\n                DataService.post(restUrl+\"seguridad/rol/0/menu\", datosEnviar)\r\n                .then(function (respuesta) {\r\n                    Message.show(respuesta.tipoMensaje,respuesta.mensaje);\r\n                    $mdDialog.hide();\r\n                    $timeout(function () {\r\n                        angular.element('#btn-refresh-crudtable').click();\r\n                    }, 500);\r\n                });\r\n            }\r\n\r\n        }\r\n        function cerrar() {\r\n            $mdDialog.cancel();\r\n        }\r\n\r\n    }\r\n\r\n  }\r\n})();\r\n\n(function() {\r\n  'use strict';\r\n\r\n  angular\r\n    .module('app')\r\n    .controller('MenuController', MenuController);\r\n\r\n    /** @ngInject */\r\n    function MenuController(Storage, restUrl) {\r\n\r\n        var vm=this;\r\n\r\n        vm.url = restUrl + 'seguridad/menu/';\r\n        vm.fields = [\r\n            'id_menu', \r\n            'fid_menu_padre',\r\n            'nombre', \r\n            'descripcion', \r\n            'orden', \r\n            'ruta', \r\n            'icono', \r\n            'estado',\r\n            '_fecha_creacion',\r\n            '_fecha_modificacion'\r\n        ];\r\n        \r\n        vm.titulo = \"Menús\";\r\n\r\n        var cuenta=Storage.getUser();\r\n        vm.usuario = cuenta.id;\r\n        \r\n    }\r\n})();\r\n\n(function() {\r\n  'use strict';\r\n\r\n  angular\r\n    .module('app')\r\n    .controller('VistaPdfController', VistaPdfController);\r\n\r\n  /** @ngInject */\r\n  function VistaPdfController($scope, DataService, restUrl, Storage, $sce, $location, Documento, Util) {\r\n      var vm = this;\r\n      var datos_enviar = Storage.getSession('datos_enviar');\r\n\r\n      if(datos_enviar==null) $location.path('/documentos');\r\n      else {\r\n          DataService.pdf(restUrl+'plantillasFormly/documentoPDF/',{cite: datos_enviar.nombre})\r\n          .then(function (respuestaPdf) {\r\n            if(!respuestaPdf) return;\r\n              datos_enviar.pdf = respuestaPdf.url;\r\n              datos_enviar.pdf_buffer = respuestaPdf.data;\r\n\r\n            //   if(angular.isUndefined(respuestaPdf)) $location.path('/documentos');\r\n              vm.html=datos_enviar.html;\r\n              vm.pdf=datos_enviar.pdf;\r\n              vm.flag_html=true;\r\n              if (datos_enviar.esDocumentoExterno) vm.flag_html=false;\r\n              vm.show_pdf=!datos_enviar.esDispositivoMovil;\r\n               if (datos_enviar.esDispositivoMovil) {\r\n                Util.loadCanvas(datos_enviar.pdf_buffer, '#canvasContainer');\r\n            }\r\n              //funciones\r\n              vm.verHtml = function(){ vm.flag_html=true; }\r\n              vm.verPdf = function(){ vm.flag_html=false; }\r\n              vm.load = true;\r\n          })\r\n      }\r\n\r\n      $scope.mostrarPdf = function (id, sw){ if(sw) Documento.showPdfx(id); else Documento.showPdfId(id, false); } // eslint-disable-line angular/controller-as\r\n  }\r\n})();\r\n\n(function() {\r\n  'use strict';\r\n\r\n  angular\r\n    .module('app')\r\n    .controller('PlantillasController', PlantillasController);\r\n\r\n  /** @ngInject */\r\n\r\n  function PlantillasController(restUrl, Storage, $location) {\r\n    var vm = this;\r\n    vm.titulo = \"Bandeja de plantillas\";\r\n    vm.url = restUrl + \"plantillasFormly/plantilla_formly/\";\r\n    var cuenta = Storage.getUser();\r\n    vm.usuario=cuenta.id;\r\n    vm.estadoSw=true;\r\n    vm.permission ={\r\n      create:false,\r\n      update:false,\r\n      delete:true\r\n    };\r\n    vm.fields = [\r\n      \"id_plantilla_formly\",\r\n      \"nombre\",\r\n      \"abreviacion\",\r\n      \"estado\",\r\n      \"_fecha_creacion\",\r\n      \"_fecha_modificacion\"\r\n    ];\r\n\r\n    vm.buttons = [\r\n      {\r\n        tooltip: 'Editar',\r\n        icon: 'checked',\r\n        onclick: irPlantilla\r\n      }\r\n    ];\r\n    vm.buttonAgregar = {\r\n        tooltip: 'Añadir',\r\n        icon: 'add',\r\n        onclick: nuevaPlantilla\r\n    };\r\n    function nuevaPlantilla(event) { irPlantilla(event, 0); }\r\n\r\n    function irPlantilla(pEvento, pIdentificador){\r\n      $location.path('plantilla/' + pIdentificador);\r\n    }\r\n\r\n  }\r\n})();\r\n\n(function () {\r\n  'use strict';\r\n\r\n  angular\r\n    .module('app')\r\n    .controller('MonitoreoController', MonitoreoController);\r\n\r\n  /** @ngInject */\r\n  function MonitoreoController(charColors, DataService, restUrl, Modal, $window, $filter, Documento) {\r\n    var vm = this,\r\n      fecha_actual = new Date(),\r\n      limite_inferior = 1990,\r\n      limite_inferior_contable = 2018,\r\n      limite_superior = 2130;\r\n      \r\n\r\n    iniciar();\r\n    reiniciarChart();\r\n    vm.refrescarChart = refrescarChart;\r\n    vm.reiniciarChart = reiniciarChart;\r\n    vm.paginar = paginar;\r\n    vm.mostrarOcultar = mostrarOcultar;\r\n    vm.generarPDF = generarPDF;\r\n    var date = new Date(),\r\n      y = date.getFullYear(),\r\n      m = date.getMonth();\r\n    vm.fechaInicial = new Date(y, m, 1);\r\n    vm.fechaFinal = new Date();\r\n    vm.cabeceraPresupuesto = cabeceraPresupuesto;\r\n    vm.generarNombre = generarNombre;\r\n    vm.filasPresupuesto = filasPresupuesto;\r\n    vm.consultarComprometido = consultarComprometido;\r\n    vm.consultarPagado = consultarPagado;\r\n    vm.vistaPrevia = vistaPrevia;\r\n    vm.busqueda = {};\r\n\r\n    function iniciar() {\r\n      vm.chart = {};\r\n\r\n      vm.graficos = [\r\n        { cod: 0, nombre: 'Cantidad de documentos por mes', labelChart: '# Visitas por día', tipoChart: 'line' },\r\n        // { cod: 1, nombre: 'Usuarios que más documentos ven', labelChart: 'Usuarios más concurrentes', tipoChart: 'bar' },\r\n        // { cod: 2, nombre: 'Documentos más vistos', labelChart: 'Documentos más vistos', tipoChart: 'bar' },\r\n        // { cod: 3, nombre: 'Documentos más vistos por usuario', labelChart: 'Documentos más visitados', tipoChart: 'bar' },\r\n        { cod: 4, nombre: 'Presupuesto', labelChart: 'Presupuesto', tipoChart: 'presupuesto' },\r\n        { cod: 5, nombre: 'Documentos por estado y usuario', labelChart: 'estados', tipoChart: 'estados' },\r\n        { cod: 6, nombre: 'Documentos pendientes por usuario', labelChart: 'pendientes', tipoChart: 'pendientes' },\r\n        { cod: 7, nombre: 'Comprometido', labelChart: 'Comprometido', tipoChart: 'comprometido' },\r\n        { cod: 8, nombre: 'Pagado', labelChart: 'Pagado', tipoChart: 'pagado' },\r\n        { cod: 9, nombre: 'Reporte contable', labelChart: 'Reporte contable', tipoChart: 'reporteContable' }\r\n      ];\r\n      vm.grafico = vm.graficos[0];\r\n      vm.mes = fecha_actual.getMonth();\r\n      vm.meses = [\"Enero\", \"Febrero\", \"Marzo\", \"Abril\", \"Mayo\", \"Junio\", \"Julio\", \"Agosto\", \"Septiembre\", \"Octubre\", \"Noviembre\", \"Diciembre\"];\r\n      vm.docsContables = ['IPBS', 'IPV', 'IPSPCL-A'];\r\n      vm.tipoInformePago = 1;\r\n      vm.anio = fecha_actual.getFullYear() - limite_inferior;\r\n      vm.anios = [];\r\n      vm.aniosContables = [];\r\n      for (var i = limite_inferior - 1; i < limite_superior; i++) vm.anios.push(i + 1);\r\n      for (var j = limite_inferior_contable - 1; j < fecha_actual.getFullYear(); j++) vm.aniosContables.push(j + 1);\r\n      \r\n      vm.anioContable = vm.aniosContables.length -1;\r\n      DataService.get(restUrl + 'seguridad/usuario/?fields=id_usuario,usuario,nombres,apellidos&order=nombres&estado=ACTIVO')\r\n        .then(function (respuesta) {\r\n          vm.usuarios = respuesta.datos.resultado;\r\n          vm.usuario = vm.usuarios[0].id_usuario;\r\n        })\r\n\r\n      DataService.get(restUrl + 'presupuesto/gestiones')\r\n        .then(function (respuesta) {\r\n          vm.gestiones = respuesta.datos;\r\n          vm.gestionActual = vm.anio + limite_inferior;\r\n          vm.gestion = 0;\r\n        })\r\n    }\r\n\r\n    function reiniciarChart() {\r\n      vm.busqueda = {};\r\n      vm.ordenInverso = false;\r\n      vm.chart.tipo = vm.grafico.tipoChart;\r\n      vm.gestion = 0;\r\n      if (vm.chart.tipo === 'presupuesto') {\r\n        vm.ordenarPor = 'descripcion';\r\n        consultarPresupuesto(vm.gestionActual - vm.gestion);\r\n      } else if (vm.chart.tipo === 'estados') {\r\n        vm.ordenarPor = 'nombres';\r\n        consultarDocumentosUsuarioEstados(vm.fechaInicial, vm.fechaFinal);\r\n      } else if (vm.chart.tipo === 'pendientes') {\r\n        vm.ordenarPor = 'nombres';\r\n        consultarDocumentosPendientes();\r\n      } else if (vm.chart.tipo === 'comprometido') {\r\n        vm.ordenarPor = 'descripcion';\r\n        consultarComprometido(vm.gestionActual - vm.gestion);\r\n      } else if (vm.chart.tipo === 'pagado') {\r\n        vm.ordenarPor = 'descripcion';\r\n        consultarPagado(vm.gestionActual - vm.gestion);\r\n      } else if (vm.chart.tipo === 'reporteContable') {\r\n        vm.ordenarPor = '-cite';\r\n        consultarReporteContable(vm.tipoInformePago, vm.anioContable);\r\n\r\n      } else {\r\n        vm.chart.datos = {\r\n          labels: [],\r\n          datasets: [\r\n            {\r\n              label: vm.grafico.labelChart + ' total.',\r\n              data: [],\r\n              backgroundColor: charColors.bg.amarillo,\r\n              borderColor: charColors.bo.amarillo,\r\n              borderWidth: 1\r\n            },\r\n            {\r\n              label: vm.grafico.labelChart + ' con relación.',\r\n              data: [],\r\n              backgroundColor: charColors.bg.verde,\r\n              borderColor: charColors.bo.verde,\r\n              borderWidth: 1\r\n            },\r\n            {\r\n              label: vm.grafico.labelChart + ' sin relación.',\r\n              data: [],\r\n              backgroundColor: charColors.bg.azul,\r\n              borderColor: charColors.bo.azul,\r\n              borderWidth: 1\r\n            }\r\n          ]\r\n        };\r\n        vm.chart.reiniciar = !vm.chart.reiniciar;\r\n        vm.page = 1;\r\n        vm.page_cant = 20;\r\n        vm.page_text = '' + ((vm.page - 1) * vm.page_cant + 1) + '-' + (vm.page * vm.page_cant);\r\n        vm.page_tot = 1;\r\n        refrescarChart();\r\n      }\r\n    }\r\n\r\n    function consultarPresupuesto(gestion) {\r\n      DataService.get(restUrl + 'presupuesto/saldos?gestion=' + gestion)\r\n      .then(function (respuesta) {\r\n        vm.headers = [\r\n          { name: 'numero', title: 'Número', mostrar: true },\r\n          { name: 'descripcion', title: 'Descripción', mostrar: true },\r\n          { name: 'inicial', title: 'Inicial', mostrar: true },\r\n          { name: 'comprometido', title: 'Comprometido', mostrar: true },\r\n          { name: 'pagado', title: 'Pagado', mostrar: true },\r\n          { name: 'modificado', title: 'Modificado', mostrar: true },\r\n          { name: 'vigente', title: 'Vigente', mostrar: true },\r\n          { name: 'saldo', title: 'Saldo', mostrar: true }\r\n        ];\r\n        vm.items = [];\r\n        respuesta.datos.map(function (item) {\r\n          vm.items.push({\r\n            comprometido: $filter('number')(parseFloat(item.comprometido), 2).replace(/,/g, \"\").replace(\".\", \",\"),\r\n            descripcion: item.descripcion == null ? '-' : item.descripcion,\r\n            inicial: $filter('number')(parseFloat(item.inicial), 2).replace(/,/g, \"\").replace(\".\", \",\"),\r\n            modificado: $filter('number')(parseFloat(item.modificado), 2).replace(/,/g, \"\").replace(\".\", \",\"),\r\n            numero: !isNaN(item.numero) ? $filter('number')(parseFloat(item.numero), 2).replace(/,/g, \"\").replace(\".\", \",\") : item.numero,\r\n            pagado: $filter('number')(parseFloat(item.pagado), 2).replace(/,/g, \"\").replace(\".\", \",\"),\r\n            saldo: $filter('number')(parseFloat(item.saldo), 2).replace(/,/g, \"\").replace(\".\", \",\"),\r\n            vigente: $filter('number')(parseFloat(item.vigente), 2).replace(/,/g, \"\").replace(\".\", \",\")\r\n          })\r\n        });\r\n      })\r\n    }\r\n\r\n    function consultarReporteContable(tipoInforme, gestion) {\r\n      var datosConsulta = {\r\n        tipoInforme: vm.docsContables[tipoInforme],\r\n        gestion: vm.aniosContables[gestion]\r\n      };\r\n      \r\n      DataService.post(restUrl + 'reportes/contables', datosConsulta)\r\n      .then(function (respuesta) {\r\n        vm.headers = [\r\n          { name: 'cite', title: 'Cite', mostrar: true },\r\n          { name: 'detalle', title: 'Detalle', mostrar: true },\r\n          { name: 'c31', title: 'C-31', mostrar: true },\r\n          { name: 'importe', title: 'Importe', mostrar: true }\r\n        ];\r\n        vm.items = respuesta.datos.documentos;\r\n      });\r\n    }\r\n\r\n    function generarNombre() {\r\n      var nombre = 'reporte_' + vm.docsContables[vm.tipoInformePago];\r\n      return nombre;\r\n    }\r\n\r\n    function cabeceraPresupuesto() {\r\n      var cabecera = [];\r\n      for (var i = 0; i < vm.headers.length; i++) {\r\n        if (vm.headers[i].mostrar) cabecera.push(vm.headers[i].title);\r\n      }\r\n      return cabecera;\r\n    }\r\n\r\n    function filasPresupuesto() {\r\n      vm.filas = [];\r\n      vm.items.map(function (item) {\r\n        var nuevo = {};\r\n        for (var i = 0; i < vm.headers.length; i++) {\r\n          if (vm.headers[i].mostrar) {\r\n            if (!isNaN(item[vm.headers[i].name])) {\r\n              nuevo[vm.headers[i].name] = $filter('number')(item[vm.headers[i].name], 2);\r\n            } else {\r\n              nuevo[vm.headers[i].name] = item[vm.headers[i].name];\r\n            }\r\n          }\r\n        }\r\n        vm.filas.push(nuevo);\r\n      });\r\n      return vm.filas;\r\n    }\r\n\r\n    function mostrarOcultar(columna) {\r\n      for (var i = 0; i < vm.headers.length; i++) {\r\n        if (vm.headers[i].name === columna) return vm.headers[i].mostrar;\r\n      }\r\n      return true;\r\n    }\r\n\r\n    function consultarDocumentosUsuarioEstados(fechaInicial, fechaFinal) {\r\n      DataService.get(restUrl + 'monitoreo/estados?fechaInicial=' + fechaInicial + '&&fechaFinal=' + fechaFinal)\r\n      .then(function (respuesta) {\r\n        vm.estados = respuesta.datos;\r\n      })\r\n    }\r\n\r\n    function consultarDocumentosPendientes() {\r\n      DataService.get(restUrl + 'monitoreo/pendientes')\r\n      .then(function (respuesta) {\r\n        vm.pendientes = [];\r\n        respuesta.datos[0].map(function (item) {\r\n          vm.pendientes.push({\r\n            nombres: item.nombres,\r\n            apellidos: item.apellidos,\r\n            ENVIADO: item.ENVIADO,\r\n            RECHAZADO: item.RECHAZADO,\r\n            DERIVADO: item.DERIVADO,\r\n            total: (item.ENVIADO + item.RECHAZADO + item.DERIVADO)\r\n          })\r\n        });\r\n      });\r\n    }\r\n\r\n    function consultarComprometido(gestion) {\r\n      DataService.get(restUrl + 'presupuesto/comprometido?gestion=' + gestion)\r\n        .then(function (respuesta) {\r\n          vm.comprometido = [];\r\n          respuesta.datos.map(function (item) {\r\n            vm.comprometido.push({\r\n              _fecha_creacion: $filter('date')(item._fecha_creacion, \"dd/MM/yyyy\"),\r\n              cite: item.cite,\r\n              descripcion: item.descripcion == null ? '-' : item.descripcion,\r\n              id_documento: item.id_documento,\r\n              monto: $filter('number')(parseFloat(item.monto), 2).replace(/,/g, \"\").replace(\".\", \",\"),\r\n              numero: item.numero\r\n            })\r\n          });\r\n        })\r\n    }\r\n\r\n    function consultarPagado(gestion) {\r\n        DataService.get(restUrl + 'presupuesto/pagado?gestion=' + gestion)\r\n        .then(function (respuesta) {\r\n            vm.pagado = [];\r\n            respuesta.datos.map(function (item) {\r\n            vm.pagado.push({\r\n                _fecha_creacion: $filter('date')(item._fecha_creacion, \"dd/MM/yyyy\"),\r\n                cite: item.cite,\r\n                descripcion: item.descripcion == null ? '-' : item.descripcion,\r\n                id_documento: item.id_documento,\r\n                monto: $filter('number')(parseFloat(item.monto), 2).replace(/,/g, \"\").replace(\".\", \",\"),\r\n                numero: item.numero\r\n            })\r\n            });\r\n        })\r\n    }\r\n\r\n    function vistaPrevia(pIdentificador) {\r\n      Documento.showPdfId(pIdentificador);\r\n    }\r\n\r\n    function generarPDF() {\r\n      var presupuesto = {};\r\n      presupuesto.cabecera = cabeceraPresupuesto();\r\n      presupuesto.filas = filasPresupuesto();\r\n      presupuesto.gestion = vm.anio + limite_inferior;\r\n      var datosEnviar = {\r\n        doc: {}\r\n      };\r\n      datosEnviar.esDispositivoMovil = angular.isDefined($window.orientation);\r\n      DataService.pdf(restUrl + 'presupuesto/pdf', presupuesto)\r\n        .then(function (respuesta) {\r\n          datosEnviar.pdf = respuesta.url;\r\n          datosEnviar.pdf_buffer = respuesta.data;\r\n          var config = {\r\n            data: datosEnviar,\r\n            templateUrl: 'app/modules/plantillasFormly/monitoreo/dialogPresupuestoPDF.html',\r\n            controller: ['data', '$scope', '$mdDialog', 'Util', DialogPDFController]\r\n          }\r\n          Modal.show(config);\r\n        })\r\n    }\r\n\r\n    function DialogPDFController(data, $scope, $mdDialog, Util) {\r\n      var vmd = $scope;\r\n      vmd.data = {};\r\n      vmd.data.html = data.html;\r\n      vmd.data.pdf = data.pdf;\r\n      vmd.data.flag_html = false;\r\n      vmd.data.show_pdf = !data.esDispositivoMovil;\r\n      if (data.esDispositivoMovil) {\r\n        Util.loadCanvas(data.pdf_buffer, '#canvasContainer');\r\n      }\r\n\r\n      //funciones\r\n      /*vmd.mostrarPdf = function (id, sw){ \r\n          if(sw) showPdfx(id); \r\n          else showPdfId(id, \r\n          false); \r\n      }*/\r\n      vmd.cerrar = function () {\r\n        $mdDialog.cancel();\r\n      }\r\n      vmd.verHtml = function () {\r\n        vmd.data.flag_html = true;\r\n      }\r\n      vmd.verPdf = function () {\r\n        vmd.data.flag_html = false;\r\n      }\r\n    }\r\n\r\n    function refrescarChart() {\r\n      vm.busqueda = {};\r\n      vm.ordenInverso = false;\r\n      if (vm.chart.tipo === 'presupuesto') {\r\n        vm.ordenarPor = 'descripcion';\r\n        consultarPresupuesto(vm.gestionActual - vm.gestion);\r\n      } else if (vm.chart.tipo === 'estados') {\r\n        vm.ordenarPor = 'nombres';\r\n        consultarDocumentosUsuarioEstados(vm.fechaInicial, vm.fechaFinal);\r\n      } else if (vm.chart.tipo === 'pendientes') {\r\n        vm.ordenarPor = 'nombres';\r\n        consultarDocumentosPendientes();\r\n      } else if (vm.chart.tipo === 'comprometido') {\r\n        vm.ordenarPor = 'descripcion';\r\n        consultarComprometido(vm.gestionActual - vm.gestion);\r\n      } else if (vm.chart.tipo === 'pagado') {\r\n        vm.ordenarPor = 'descripcion';\r\n        consultarPagado(vm.gestionActual - vm.gestion);\r\n      } else if (vm.chart.tipo === 'reporteContable') {\r\n        vm.ordenarPor = 'cite';\r\n        consultarReporteContable(vm.tipoInformePago, vm.anioContable);\r\n      } else {\r\n        var anio = vm.anio + limite_inferior,\r\n          mes = vm.mes + 1;\r\n        \r\n        var url_get = [\r\n          restUrl + 'monitoreo/global/?anio=' + anio + '&mes=' + mes,\r\n          restUrl + 'monitoreo/usuario/?anio=' + anio + '&mes=' + mes + '&page=' + vm.page,\r\n          restUrl + 'monitoreo/documento/?anio=' + anio + '&mes=' + mes + '&page=' + vm.page,\r\n          restUrl + 'monitoreo/' + vm.usuario + '/documento/?anio=' + anio + '&mes=' + mes\r\n        ];\r\n        DataService.get(url_get[vm.grafico.cod])\r\n        .then(function (respuesta) {\r\n          vm.chart.datos.labels = respuesta.datos.nombres;\r\n          vm.chart.datos.datasets[0].data = respuesta.datos.global;\r\n          vm.chart.datos.datasets[1].data = respuesta.datos.relacionado;\r\n          vm.chart.datos.datasets[2].data = respuesta.datos.no_relacionado;\r\n          vm.chart.actualizar = !vm.chart.actualizar;\r\n          vm.page_tot = respuesta.datos.total;\r\n        });\r\n      }\r\n    }\r\n\r\n    function paginar(acc) {\r\n      if (acc == 'aa')\r\n        vm.page = 1;\r\n      if (acc == 'a')\r\n        vm.page--;\r\n      if (acc == 's')\r\n        vm.page++;\r\n      if (acc == 'ss')\r\n        vm.page = Math.ceil(vm.page_tot / vm.page_cant);\r\n      vm.page_text = '' + ((vm.page - 1) * vm.page_cant + 1) + '-' + (((vm.page * vm.page_cant) > vm.page_tot) ? vm.page_tot : vm.page * vm.page_cant);\r\n      refrescarChart();\r\n    }\r\n\r\n  }\r\n})();\r\n\n(function() {\r\n  'use strict';\r\n\r\n  angular\r\n    .module('app')\r\n    .controller('ImpresionController', ImpresionController);\r\n\r\n  /** @ngInject */\r\n  function ImpresionController(restUrl, Storage, Documento, Modal) {\r\n    var vm = this;\r\n    vm.titulo = \"Imprimir documentos\";\r\n    vm.url = restUrl + \"plantillasFormly/documento/\";\r\n    var cuenta = Storage.getUser();\r\n    vm.usuario = cuenta.id;\r\n\r\n    vm.queryExtra = {\r\n        estado: 'APROBADO,CERRADO,DERIVADO'\r\n    };\r\n\r\n    vm.permission = {\r\n        create: false,\r\n        update: false,\r\n        delete: false\r\n    };\r\n\r\n    vm.fields = [\r\n      \"id_documento\",\r\n      \"nombre\",\r\n      \"nombre_plantilla\",\r\n      \"fecha\",\r\n      \"impreso\",\r\n      \"_usuario_modificacion\",\r\n      \"_fecha_creacion\",\r\n      \"_fecha_modificacion\"\r\n    ];\r\n\r\n    vm.buttons = [\r\n      {\r\n        tooltip: 'Ver',\r\n        icon: 'remove_red_eye',\r\n        onclick: vistaPrevia\r\n      },\r\n      {\r\n        tooltip: 'Ver Historial',\r\n        icon: 'timeline',\r\n        onclick: verProgreso\r\n      }\r\n    ];\r\n    vm.multiple = {\r\n      tooltip: 'Impresion multiple',\r\n      icon: 'print',\r\n      onclick: impresionMultiple\r\n    };\r\n\r\n    function verProgreso(pEvento, pIdentificador) {\r\n      Documento.showProgressAll(pEvento, pIdentificador);\r\n    }\r\n\r\n    function vistaPrevia(pEvento, pIdentificador){\r\n      Documento.showPdfId(pIdentificador);\r\n    }\r\n\r\n    function impresionMultiple(evento) {\r\n      var config = {\r\n        event: evento,\r\n        templateUrl: 'app/modules/plantillasFormly/impresion/multiple.dialog.html',\r\n        controller: ['$scope', '$mdDialog', 'DataService', 'Message', 'restUrl', DialogImpresionMultiple]\r\n      };\r\n      Modal.show(config);      \r\n    }\r\n\r\n    function DialogImpresionMultiple($scope, $mdDialog, DataService, Message, restUrl) {\r\n      var vmd = $scope;\r\n      vmd.obtenerDocumento = obtenerDocumento;\r\n      vmd.cancel = cancel;\r\n\r\n      /**\r\n       * Función que obtiene el buffer de todos los documentos de un grupo multiple\r\n       */\r\n      function obtenerDocumento() {\r\n        if (angular.isUndefined(vmd.cite) || vmd.cite==\"\") {\r\n          Message.warning('Debe escribir un número de cite');\r\n          return;\r\n        }\r\n        \r\n        DataService.pdf(restUrl + 'plantillasFormly/multiple', { cite: vmd.cite })\r\n        .then(function (respuestaPdf) {\r\n          if (respuestaPdf){            \r\n            vmd.documentoAImprimir = respuestaPdf;\r\n          }\r\n        })\r\n        .catch(function () {\r\n          // console.log('Error en la obtencion del documento a imprimir', error);\r\n          return;\r\n        });\r\n        \r\n      }\r\n\r\n      /**\r\n       * Funcion que permite cancelar el modal\r\n       */\r\n      function cancel() {\r\n        \r\n        $mdDialog.cancel();\r\n        \r\n      }\r\n      \r\n    }\r\n\r\n  }\r\n})();\r\n\n(function() {\r\n  'use strict';\r\n\r\n  angular\r\n  .module('app')\r\n  .controller('FirmarController', FirmarController);\r\n\r\n  /** @ngInject */\r\n  function FirmarController(restUrl, Storage, Documento, Modal, $q, DataService, FirmaticService, $window, Message, Loading, $timeout) {\r\n\r\n    var vm = this;\r\n    var cuenta = Storage.getUser();\r\n    vm.cuenta = cuenta;\r\n    vm.usuario = cuenta.id;\r\n    vm.titulo = \"Documentos para firma digital\";\r\n    vm.url = restUrl + 'documento/firmar';\r\n    vm.firmarDocumentos = firmarDocumentos;\r\n    vm.items = {};\r\n    vm.habilitarSeleccion = true;\r\n\r\n    vm.permission = {\r\n      create: false,\r\n      update: false,\r\n      delete: false\r\n    };\r\n\r\n    vm.fields = [\r\n      \"id_documento\",\r\n      \"nombre\",\r\n      \"nombre_plantilla\",\r\n      \"estado\",\r\n      \"fecha\",\r\n      \"_fecha_creacion\",\r\n      \"_fecha_modificacion\"\r\n    ];\r\n\r\n    vm.estadoOpciones = [\r\n      { v:'cerra', t:'CERRADO'}\r\n    ];\r\n\r\n    vm.buttons = [\r\n      {\r\n        tooltip: 'Ver',\r\n        icon: 'remove_red_eye',\r\n        onclick: vistaPrevia\r\n      },\r\n      {\r\n        tooltip: 'Ver Historial',\r\n        icon: 'timeline',\r\n        onclick: verProgreso\r\n      }\r\n    ];\r\n    vm.habilitarBotonFirma = false;\r\n    vm.obtenerSeleccionados=obtenerNumeroSeleccionados;\r\n    vm.verificarSeleccionados = verificarSeleccionados;\r\n    vm.arrayBufferToBase64 = arrayBufferToBase64;\r\n    vm.obtenerDocumentos = obtenerDocumentos;\r\n    vm.guardarDocumentosFirmados = guardarDocumentosFirmados;\r\n    vm.docDic = {};\r\n    \r\n    /**\r\n     * Funcion que obtiene el número de documentos seleccionados.\r\n     * @param {Integer} cantidad Informacion respecto a la cantidad de documentos seleccionados.\r\n     */\r\n    function obtenerNumeroSeleccionados(cantidad) {\r\n      vm.habilitarBotonFirma = cantidad;\r\n    }\r\n\r\n    /**\r\n     * Funcion que permite carga la vista previa de un documento.\r\n     * @param {Function} pEvento Funcion de control del evento(click)\r\n     * @param {Integer} pIdentificador Identificador del documento.\r\n     */\r\n    function vistaPrevia(pEvento, pIdentificador){\r\n      Documento.showPdfId(pIdentificador);\r\n    }\r\n\r\n    /**\r\n     * Funcion que permite la carga del progreso del documento seleccionado\r\n     * @param {Function} pEvento Funcion de control del evento(click)\r\n     * @param {Integer} pIdentificador Identificador del documento\r\n     */\r\n    function verProgreso(pEvento, pIdentificador) {\r\n      Documento.showProgressAll(pEvento, pIdentificador);\r\n    }\r\n\r\n    \r\n    function obtenerDocumentos(lista) {      \r\n      var respuesta = {\r\n        obtenidos: [],\r\n        noObtenidos: []\r\n      };\r\n      var promesas = lista.map(function (item) {\r\n        return new Promise(function (resolve) {\r\n          return DataService.pdf(restUrl + 'documento/firmar', {\r\n              cite: item.nombre,\r\n              id_documento: item.id_documento\r\n            })\r\n            .then(function (respuestaPdf) {\r\n              if (!respuestaPdf || !respuestaPdf.data) throw Error('No se pudo obtener el documento');\r\n              return arrayBufferToBase64(respuestaPdf.data);\r\n            })\r\n            .then(function (base64) {\r\n              respuesta.obtenidos.push({\r\n                base64: 'data:application/pdf;base64,' + base64,\r\n                name: item.id_documento + '.pdf'\r\n              });\r\n              \r\n              return resolve();\r\n            })\r\n            .catch(function (errorObtener) {\r\n              // console.log('Error al obtener el base 64');\r\n              respuesta.noObtenidos.push({\r\n                documento: item.nombre,\r\n                error: errorObtener\r\n              });\r\n              return resolve();\r\n\r\n            });\r\n\r\n        });\r\n\r\n      });\r\n      return Promise.all(promesas)\r\n        .then(function () {\r\n          return Promise.resolve(respuesta);\r\n        })\r\n        .catch(function (error) {\r\n          // console.log('Error al ejecutar las promesas', error);\r\n          return Promise.reject(error);\r\n        });\r\n    }\r\n    function guardarDocumentosFirmados(lista) {\r\n      var respuesta = {\r\n        total: lista.length || 0,\r\n        guardado: [],\r\n        noGuardado: []\r\n      };\r\n      var promesas = lista.map(function(item) {\r\n        return new Promise(function (resolve) {\r\n          var nombreDocumento = item.name          \r\n          if (angular.isUndefined(vm.docDic[nombreDocumento])){\r\n            respuesta.noGuardado.push(nombreDocumento.replace('.pdf', ''));\r\n            return resolve();\r\n          }\r\n          return DataService.post(restUrl + 'documento/firmado/', {\r\n            base64: item.base64,\r\n            id_documento: vm.docDic[nombreDocumento]\r\n          })\r\n          .then(function (respGuardado) {\r\n            if(respGuardado.tipoMensaje !== 'EXITO') throw Error(respGuardado.mensaje);\r\n            respuesta.guardado.push(nombreDocumento);\r\n            return resolve();\r\n          })\r\n          .catch(function () {\r\n            respuesta.noGuardado.push(item.name);\r\n            return resolve();\r\n          });\r\n        });\r\n      });\r\n\r\n\r\n      return Promise.all(promesas)\r\n      .then(function () {\r\n        return Promise.resolve(respuesta);\r\n      })\r\n      .catch(function(error){\r\n        // console.log('Error al ejecutar las promesas de guardado', error);\r\n        \r\n        return Promise.reject(error);\r\n      })\r\n    }\r\n\r\n    function firmarDocumentos() {\r\n      var verificacion = {};\r\n      var configLoad = {\r\n        data:{\r\n          mensaje: 'Verificando firmador...',\r\n          tipo: 'info'\r\n        }\r\n      };\r\n      Loading.show(configLoad);\r\n      var documentosParaFirmar = vm.verificarSeleccionados(vm.items.data);\r\n      var control = {\r\n        seleccionados: documentosParaFirmar.length,\r\n        obtenidos: 0,\r\n        firmados: 0,\r\n        guardados: 0\r\n      };\r\n\r\n      FirmaticService.verificarEstado()\r\n      .then(function (respEstado) {\r\n        if(respEstado.activo === false) throw Error(respEstado.mensaje);\r\n        Loading.cambiar({\r\n          mensaje: 'Obteniendo documentos ...',\r\n          tipo: 'warning'\r\n        });\r\n        return DataService.get(restUrl + 'seguridad/virtual/verificar');\r\n      })\r\n      .then(function (respVerificar) {\r\n        if (angular.isDefined(respVerificar.datos.esVirtual) && respVerificar.datos.esVirtual) verificacion = respVerificar.datos;\r\n        return obtenerDocumentos(documentosParaFirmar);\r\n      })\r\n      .then(function (respDocumentos) {\r\n        if(!respDocumentos) throw Error('No se pudieron obtener documentos.');\r\n        if(!respDocumentos.obtenidos.length === 0) throw Error('No se obtuvieron documentos firmar');\r\n        control.obtenidos = respDocumentos.obtenidos.length || 0;\r\n        Loading.cambiar({\r\n          mensaje: 'Firmando documentos ...',\r\n          tipo: 'info'\r\n        });\r\n        var nroDocumento = cuenta.doc;\r\n        if (verificacion.esVirtual == true) nroDocumento = verificacion.nroDocumento;\r\n        return FirmaticService.firmarPdf(respDocumentos.obtenidos, nroDocumento);\r\n      })\r\n      .then(function (respuestaFirma) {\r\n        \r\n        if (!respuestaFirma || respuestaFirma.status !== 200) {\r\n          throw Error(\"No se pudo firmar el documento, revise que el firmador se encuentra en ejecución.\");\r\n        }\r\n        Loading.cambiar({\r\n          mensaje: 'Guardando documentos firmados ...',\r\n          tipo: 'success'\r\n        });\r\n        control.firmados = respuestaFirma.data.files.length || 0;\r\n        return guardarDocumentosFirmados(respuestaFirma.data.files);\r\n      })\r\n      .then(function (respGuardados) {\r\n        if(respGuardados.guardado.length === 0 && control.seleccionados.length > 0 ) throw Error('No se guardo ningun documento.');\r\n        control.guardados = respGuardados.guardado.length || 0;\r\n        \r\n        if(control.seleccionados === control.guardados) {\r\n          Message.success(control.seleccionados+' documentos firmados y guardados correctamente.');\r\n        }\r\n        else {\r\n          \r\n          Message.show('INFORMACION','De '+control.seleccionados+' se firmaron '+control.firmados+' y se guardaron '+control.guardados);\r\n        }\r\n        \r\n        Loading.cerrar();\r\n        $timeout(function () {\r\n          angular.element('#btn-refresh-crudtable').click();\r\n        });\r\n      })\r\n      .catch(function (error) {\r\n        Message.error(error.message);\r\n        Loading.cerrar();\r\n      });\r\n\r\n    }\r\n\r\n    function verificarSeleccionados(documentos) {\r\n      var respuesta = []\r\n      vm.docDic = {};\r\n      documentos.map(function (documento) {\r\n        if (documento.selected != null && documento.selected) {\r\n          documento.firmado = false;\r\n          respuesta.push(documento);\r\n          vm.docDic[documento.id_documento+'.pdf'] = documento.id_documento;\r\n        }\r\n      });\r\n\r\n      return respuesta;\r\n    }\r\n    /**\r\n     * Funcion que transforma un buffer en base64\r\n     * @param {Buffer} buffer buffer de un archivo\r\n     */\r\n    function arrayBufferToBase64(buffer) {\r\n      var defer = $q.defer();\r\n      var binary = '';\r\n      var bytes = new Uint8Array(buffer);\r\n      var len = bytes.byteLength;\r\n      for (var i = 0; i < len; i++) {\r\n        binary += String.fromCharCode(bytes[i]);\r\n      }\r\n      defer.resolve($window.btoa(binary));\r\n      return defer.promise;\r\n    }\r\n\r\n  }\r\n})();\r\n\n(function() {\r\n  'use strict';\r\n\r\n  angular\r\n    .module('app')\r\n    .controller('EnCursoController', EnCursoController);\r\n\r\n  /** @ngInject */\r\n  function EnCursoController(restUrl, Storage, Documento) {\r\n\r\n      var vm = this;\r\n      var cuenta = Storage.getUser();\r\n      vm.usuario = cuenta.id;\r\n      vm.titulo = \"Documentos en curso\";\r\n      vm.url = restUrl + \"plantillasFormly/documento/\"+cuenta.id+\"/encurso\";\r\n\r\n      vm.permission = {\r\n          create: false,\r\n          update: false,\r\n          delete: false\r\n      };\r\n\r\n      vm.fields = [\r\n          \"id_documento\",\r\n          \"nombre\",\r\n          \"nombre_plantilla\",\r\n          \"estado\",\r\n          \"fecha\",\r\n          \"_fecha_creacion\",\r\n          \"_fecha_modificacion\"\r\n      ];\r\n\r\n      vm.buttons = [\r\n        {\r\n          tooltip: 'Ver',\r\n          icon: 'remove_red_eye',\r\n          onclick: vistaPrevia\r\n        },\r\n        {\r\n            tooltip: 'Ver Historial',\r\n            icon: 'timeline',\r\n            onclick: verProgreso\r\n        }\r\n      ];\r\n\r\n      function vistaPrevia(pEvento, pIdentificador){\r\n          Documento.showPdfId(pIdentificador);\r\n      }\r\n      function verProgreso(pEvento, pIdentificador) {\r\n          Documento.showProgressAll(pEvento, pIdentificador);\r\n      }\r\n\r\n  }\r\n})();\r\n\n(function() {\r\n  'use strict';\r\n\r\n  angular\r\n    .module('app')\r\n    .controller('DocumentosController', DocumentosController);\r\n\r\n  /** @ngInject */\r\n  function DocumentosController(DataService, restUrl, Storage, Datetime, $location, Modal, Documento) {\r\n    var vm = this;\r\n    vm.titulo = \"Bandeja de documentos\";\r\n    var cuenta = Storage.getUser();\r\n\r\n    vm.usuario=cuenta.id;\r\n    vm.url = restUrl + 'plantillasFormly/documento/'+cuenta.id+'/misdocumentos/';\r\n    vm.permission = {\r\n      create:false,\r\n      update:false,\r\n      delete:true\r\n    };\r\n    vm.fields = [\r\n      \"id_documento\",\r\n      \"nombre\",\r\n      \"nombre_plantilla\",\r\n      \"fecha\",\r\n      \"estado\",\r\n      \"impreso\",\r\n      \"_fecha_creacion\",\r\n      \"_fecha_modificacion\"\r\n    ];\r\n\r\n    vm.estadoOpciones = [\r\n        { v:'nuevo', t:'NUEVO'},\r\n        { v:'firme', t:'FIRMÉ'},\r\n        { v:'envia', t:'ENVIADO'},\r\n        { v:'cerra', t:'CERRADO'},\r\n        { v:'deriv', t:'DERIVADO'},\r\n        { v:'derive', t:'DERIVE'},\r\n        { v:'respondi', t:'RESPONDI'}\r\n    ];\r\n    if(cuenta.es_jefe){\r\n        vm.estadoOpciones.push( { v:'aprobe', t:'APROBE'} );\r\n        vm.estadoOpciones.push( { v:'rechace', t:'RECHACE'} );\r\n    }\r\n\r\n    vm.buttons = [\r\n        {\r\n          multiple: true,\r\n          key_item: 'estado',\r\n          opcion: {\r\n            'NUEVO': { tooltip: 'Editar', icon: 'checked', onclick: irDocumento },\r\n            'ENVIADO': { tooltip: 'Editar', icon: 'checked', onclick: irDocumento},\r\n            'CERRADO': { tooltip: 'Editar', icon: 'checked', onclick: irDocumento},\r\n            'DERIVADO': { tooltip: 'Editar', icon: 'checked', onclick: irDocumento},\r\n            'DEFAULT': { tooltip: 'Ver', icon: 'remove_red_eye', onclick: irDocumento}\r\n          }\r\n        },\r\n        {\r\n            tooltip: 'Ver Historial',\r\n            icon: 'timeline',\r\n            onclick: verProgreso\r\n        }\r\n    ];\r\n    vm.buttonAgregar = {\r\n        tooltip: 'Añadir',\r\n        icon: 'add',\r\n        onclick: nuevoDocumento\r\n    };\r\n\r\n    function irDocumento(pEvento, pIdentificador){\r\n        DataService.get(restUrl+'plantillasFormly/documento/?id_documento='+pIdentificador+'&fields=_usuario_creacion')\r\n        .then(function (respuesta) {\r\n            if(respuesta.datos.resultado[0]._usuario_creacion==cuenta.id)\r\n                $location.path('documento/' + pIdentificador);\r\n            else\r\n                Documento.showPdfId(pIdentificador);\r\n        })\r\n    }\r\n    function verProgreso(pEvento, pIdentificador) {\r\n        Documento.showProgressAll(pEvento, pIdentificador);\r\n    }\r\n\r\n    function nuevoDocumento(pEvento){\r\n        var config = {\r\n            event: pEvento,\r\n            templateUrl: 'app/modules/plantillasFormly/documentos/documento.dialog.html',\r\n            controller: ['$scope','$mdDialog','DataService','Message','restUrl', 'Storage', DialogEscojerPlantilla]\r\n        };\r\n        Modal.show(config);\r\n    }\r\n\r\n    function DialogEscojerPlantilla( $scope, $mdDialog, DataService, Message, restUrl, Storage ) {\r\n        var vmd = $scope;\r\n\r\n        vmd.elegir = elegir;\r\n        vmd.urlBase = 'plantillasFormly/plantilla_formly/?fields=id_plantilla_formly,nombre,abreviacion&sort=nombre&estado=ACTIVO&limit=10000'\r\n        \r\n        iniciarDialog();\r\n\r\n        function iniciarDialog() {\r\n            DataService.get(restUrl + vmd.urlBase)\r\n            .then(function (data) {\r\n                vmd.plantillas_disponibles = data.datos.resultado;\r\n                vmd.plantilla_seleccionada = data.datos.resultado[0].id_plantilla_formly;\r\n            });\r\n        }\r\n\r\n        function elegir() {\r\n            DataService.get(restUrl + 'plantillasFormly/plantilla_formly/'+vmd.plantilla_seleccionada)\r\n            .then(function (data) {\r\n                Storage.setSession(\"pl\", data.datos);\r\n                $location.path('documento/0');\r\n                $mdDialog.cancel();\r\n            });\r\n        }\r\n    }\r\n\r\n  }\r\n})();\r\n\n(function () {\n  'use strict';\n\n  angular\n  .module('app')\n  .controller('ContactosController', ContactosController);\n\n  /** @ngInject */\n\n  function ContactosController(restUrl, Storage) {\n    var vm = this;\n    var cuenta = Storage.getUser();\n    vm.usuario = cuenta.id;\n    \n    vm.titulo = 'Bandeja de contactos';\n    vm.url = restUrl + 'plantillasFormly/contacto/';\n    vm.fields = [\n      'id_contacto',\n      'grado',\n      'nombres',\n      'apellidos',\n      'entidad',\n      'tipo_entidad',\n      'estado',\n      '_fecha_creacion',\n      '_fecha_modificacion'\n    ];\n    vm.permission = {\n      delete: false\n    };\n\n    vm.order= 'estado';\n    vm.dialogController = ['data', 'Message', '$scope', '$mdDialog', 'DataService', 'restUrl', '$timeout', DialogContactoController];\n    vm.template = 'app/modules/plantillasFormly/contactos/dialog.contactos.html';\n    function DialogContactoController(data, Message, $scope, $mdDialog, DataService, restUrl, $timeout) {\n      var vmd = $scope;\n      \n      vmd.obtenerTiposEntidad = obtenerTiposEntidad;\n      vmd.cerrar = cerrar;\n      vmd.registrarContacto = registrarContacto;\n      vmd.habilitarOtro = habilitarOtro;\n      vmd.data = data;\n      vmd.titulo = 'Editar';\n      vmd.otroEditar = false;\n      vmd.departamentos = [\n        { id: 'BENI', name: 'BENI'},\n        { id: 'CHUQUISACA', name: 'CHUQUISACA'},\n        { id: 'COCHABAMBA', name: 'COCHABAMBA'},\n        { id: 'LA PAZ', name: 'LA PAZ'},\n        { id: 'ORURO', name: 'ORURO'},\n        { id: 'PANDO', name: 'PANDO'},\n        { id: 'POTOSI', name: 'POTOSI'},\n        { id: 'SANTA CRUZ', name: 'SANTA CRUZ'},\n        { id: 'TARIJA', name: 'TARIJA'}\n      ];\n      vmd.estados = [\n        { id: 'ACTIVO', name: 'ACTIVO'},\n        { id: 'INACTIVO', name: 'INACTIVO'}\n      ];\n      if(vmd.data.id_contacto == null) {\n        vmd.titulo = 'Agregar';\n        vmd.data.estado = 'ACTIVO';\n        vmd.data.departamento = 'LA PAZ';\n      }\n      vmd.obtenerTiposEntidad();\n      \n      function registrarContacto() {\n        var datosEnviar = vmd.data;\n\n        if (vmd.otroEditar == true) {\n          datosEnviar.tipo_entidad = datosEnviar.otro_tipo;\n        }\n        // Modificar contacto\n        if(vmd.data.id_contacto) {\n          DataService.put(restUrl + 'plantillasFormly/contacto/' + vmd.data.id_contacto, datosEnviar)\n          .then(function (respContacto) {\n            Message.show(respContacto.tipoMensaje, respContacto.mensaje);\n            $mdDialog.hide();\n            $timeout(function (){\n              angular.element('#btn-refresh-crudtable').click();\n            }, 500);\n          });\n        }\n        // Crear contacto\n        else {\n          DataService.post(restUrl+'plantillasFormly/contacto', datosEnviar)\n          .then(function (respContacto) {\n            Message.show(respContacto.tipoMensaje, respContacto.mensaje);\n            $mdDialog.hide();\n            $timeout(function () {\n              angular.element('#btn-refresh-crudtable').click();\n            }, 500)\n          })\n        }\n      }\n      \n      function obtenerTiposEntidad() {\n        DataService.get(restUrl + 'plantillasFormly/contactos/tiposEntidad')\n        .then(function (respTipos) {\n          vmd.tiposEntidad = respTipos.datos;\n          vmd.tiposEntidad.push({tipo_entidad:'Otros...', otro:true});\n        })\n        \n      }\n\n      function habilitarOtro(item) {\n        if (angular.isDefined(item.otro) && item.otro == true) {\n          vmd.otroEditar = true;\n        }\n        else {\n          vmd.otroEditar = false;\n        }\n        \n      }\n\n      function cerrar() {\n        $mdDialog.cancel();\n      }\n      \n    }\n\n  }\n})();\n(function() {\r\n  'use strict';\r\n\r\n  angular\r\n    .module('app')\r\n    .controller('AprobacionController', AprobacionController);\r\n\r\n  /** @ngInject */\r\n  function AprobacionController(DataService, restUrl, backUrl, Storage, $location, Modal, UtilFormly, Datetime, Documento, Loading) {\r\n\r\n    var vm = this;\r\n    vm.titulo = \"Documentos pendientes\";\r\n    var cuenta = Storage.getUser();\r\n    vm.usuario=cuenta.id;\r\n    vm.url = restUrl + 'plantillasFormly/documento/'+cuenta.id+'/todo/';\r\n\r\n    //cargamos funciones\r\n    vm.vistaPrevia = vistaPrevia;\r\n\r\n    vm.permission ={\r\n      create:false,\r\n      update:false,\r\n      delete:true\r\n    };\r\n\r\n    vm.estadoOpciones = [{ v:'deriv', t:'DERIVADO'},{ v:'recha', t:'RECHAZADO'}];\r\n    if(cuenta.es_jefe){\r\n        vm.estadoOpciones.push({ v:'envia', t:'ENVIADO'});\r\n    }\r\n\r\n    vm.fields = [\r\n      \"id_documento\",\r\n      \"nombre\",\r\n      \"nombre_plantilla\",\r\n      \"fecha\",\r\n      \"estado\",\r\n      \"_fecha_creacion\",\r\n      \"_fecha_modificacion\"\r\n    ];\r\n\r\n    vm.buttons = [\r\n      {\r\n        multiple: true,\r\n        key_item: 'estado',\r\n        opcion: {\r\n          'RECHAZADO': {\r\n            tooltip: 'Editar',\r\n            icon: 'checked',\r\n            onclick: irDocumento\r\n          },\r\n          'DEFAULT': {\r\n            tooltip: 'Ver',\r\n            icon: 'remove_red_eye',\r\n            onclick: vistaPrevia\r\n          }\r\n        }\r\n      },\r\n      {\r\n          tooltip: 'Ver Historial',\r\n          icon: 'timeline',\r\n          onclick: verProgreso\r\n      }\r\n    ];\r\n\r\n    function irDocumento(pEvento, pIdentificador){\r\n        DataService.get(restUrl+'plantillasFormly/documento/?id_documento='+pIdentificador+'&fields=_usuario_creacion')\r\n        .then(function (respuesta) {\r\n            if(respuesta.datos.resultado[0]._usuario_creacion==cuenta.id)\r\n                $location.path('documento/' + pIdentificador);\r\n            else\r\n                Documento.showPdfId(pIdentificador);\r\n        });\r\n    }\r\n\r\n    function verProgreso(pEvento, pIdentificador) {\r\n        Documento.showProgressAll(pEvento, pIdentificador);\r\n    }\r\n\r\n    function vistaPrevia(pEvento, pIdentificador){\r\n      var datosEnviar = {doc:{}};\r\n      datosEnviar.doc = {};\r\n      var data;\r\n      DataService.get(restUrl + 'plantillasFormly/documento/'+pIdentificador)\r\n      .then(function (respuestaDocumento) {\r\n        // $log.log(\"revisando la obtencion de datos\", respuestaDocumento);\r\n        data = respuestaDocumento;\r\n        // var usuarioPara = JSON.parse(data.datos.para);\r\n        datosEnviar.model_actual = angular.fromJson(data.datos.plantilla_valor);\r\n        var model = datosEnviar.model_actual;\r\n        if( model[\"cite-0\"] && model[\"cite-0\"].fecha )\r\n        model[\"cite-0\"].fecha = Datetime.format(model[\"cite-0\"].fecha, 'dd de MMM de YYYY');\r\n        datosEnviar.form_actual = UtilFormly.dataToView(angular.fromJson(data.datos.plantilla), datosEnviar.model_actual);\r\n        datosEnviar.doc.nombre = data.datos.nombre;\r\n        datosEnviar.doc.plantilla = data.datos.plantilla;\r\n\r\n        return;\r\n\r\n      })\r\n      .then(function() {\r\n        return DataService.post(restUrl+ \"plantillasFormly/generarDocumento/\",datosEnviar);\r\n      })\r\n      .then(function (pRespuesta) {\r\n        datosEnviar = { html: pRespuesta.datos.html, nombre: pRespuesta.datos.nombre};\r\n        datosEnviar.esDispositivoMovil = Documento.isMobile();\r\n        return DataService.pdf(restUrl+'plantillasFormly/documentoPDF/',{cite: datosEnviar.nombre});\r\n      })\r\n      .then(function (respuesta) {\r\n        if(!respuesta) return;\r\n        datosEnviar.pdf = respuesta.url;\r\n        datosEnviar.pdf_buffer = respuesta.data;\r\n        var config = {\r\n          data: { id:data.datos.id_documento, dc: data.datos, cuenta: cuenta, pdf: datosEnviar },\r\n          templateUrl: 'app/modules/plantillasFormly/aprobacion/dialogPDF.html',\r\n          controller: ['data', '$scope', '$mdDialog', 'DataService', 'restUrl', '$timeout', 'Storage', 'Datetime', 'Documento', 'Message', 'Util', DialogPDFController]\r\n        };\r\n        Modal.show(config);\r\n      });\r\n\r\n    }\r\n\r\n    \r\n    function DialogPDFController(data, $scope, $mdDialog, DataService, restUrl, $timeout, Storage, Datetime, Documento, Message, Util){\r\n        var vmd = $scope;\r\n        vmd.data={};\r\n        vmd.data.dc=data.dc;\r\n        vmd.data.observaciones;\r\n        vmd.data.show_select = false;\r\n        vmd.data.datosEnviar=data.dc.datosEnviar;\r\n\r\n        vmd.data.html=data.pdf.html;\r\n        vmd.data.pdf=data.pdf.pdf;\r\n        vmd.data.flag_html=true;\r\n        vmd.data.show_pdf=!data.pdf.esDispositivoMovil;\r\n\r\n        //funciones\r\n        vmd.cerrar = cerrar;\r\n        vmd.aprobar = aprobar;\r\n        vmd.observar = observar;\r\n        vmd.derivar = derivar;\r\n        vmd.openSelect = openSelect;\r\n        vmd.crear = crear;\r\n        vmd.verDocumento = verDocumento;\r\n\r\n        vmd.mostrarPdf = function (id, sw){ if(sw) Documento.showPdfx(id); else Documento.showPdfId(id, false); }\r\n        vmd.verHtml=function(){ vmd.data.flag_html=true; }\r\n        vmd.verPdf=function(){ vmd.data.flag_html=false; }\r\n\r\n        iniciar();\r\n\r\n        function iniciar() {\r\n            if (angular.isString(vmd.data.dc.para)) {\r\n                vmd.data.dc.para = angular.fromJson(vmd.data.dc.para);\r\n            }\r\n            vmd.data.es_derivar = (vmd.data.dc.estado=='DERIVADO');\r\n            vmd.data.es_para = (vmd.data.dc.para.indexOf(data.cuenta.id)!=-1 && !vmd.data.es_derivar);\r\n            vmd.data.sw_es_respuesta = vmd.data.dc.grupo || false;\r\n            if(vmd.data.sw_es_respuesta) {\r\n                // obtener documentos de grupo\r\n                DataService.get(restUrl + 'plantillasFormly/documento/?fields=id_documento,nombre,nombre_plantilla&estado=DERIVADO,CERRADO,APROBADO&sort=_fecha_creacion&grupo='+vmd.data.dc.grupo)\r\n                .then(function (resultado) {\r\n                    vmd.data.docs_grupo = resultado.datos.resultado;\r\n                });\r\n            }\r\n            if (data.pdf.esDispositivoMovil) {\r\n                Util.loadCanvas(data.pdf.pdf_buffer, '#canvasContainer');\r\n            }\r\n\r\n            DataService.get(restUrl + 'seguridad/usuario/'+vmd.data.dc._usuario_creacion)\r\n            .then(function (respuesta) {\r\n                vmd.data.nombres =  respuesta.datos.nombres;\r\n                vmd.data.apellidos =  respuesta.datos.apellidos;\r\n                if(vmd.data.es_para || vmd.data.es_derivar)\r\n                    return DataService.get(restUrl + 'seguridad/usuario/'+cuenta.id+'/informacion');\r\n                return;\r\n            })\r\n            .then(function (respuesta) {\r\n                if(respuesta){\r\n                    vmd.data.accion='observar';\r\n                    vmd.data.usuarios = respuesta.datos.resultado;\r\n                }\r\n                if(vmd.data.es_derivar || vmd.data.es_para)\r\n                    return DataService.get(restUrl + 'plantillasFormly/plantilla_formly/?fields=id_plantilla_formly,nombre,abreviacion&sort=nombre&estado=ACTIVO&limit=10000');\r\n                return;\r\n            })\r\n            .then(function (respuesta) {\r\n                if(respuesta){\r\n                    vmd.data.plantillas_disponibles = respuesta.datos.resultado;\r\n                }\r\n            });\r\n\r\n            if(vmd.data.es_derivar){\r\n                DataService.get(restUrl + 'historialFlujo/'+vmd.data.dc.id_documento+'/ultimo')\r\n                .then(function (resultado) {\r\n                    vmd.data.usuario_proveido = resultado.datos.nombres+' '+resultado.datos.apellidos;\r\n                });\r\n            }\r\n\r\n        }\r\n\r\n        function aprobar(text) {\r\n            var datos = { usuario: cuenta.id };\r\n            var sw_crear = text=='crear';\r\n            var mensajeLoad = 'Espere...';\r\n            if(vmd.data.es_para) {\r\n\r\n                datos.usuario_derivar = vmd.data._usuario_seleccionado;\r\n                if(text=='aprobar') {\r\n                    text = 'aprobar y cerrar';\r\n                    mensajeLoad = ' Aprobando y cerrando...';\r\n                    datos.derivar = false;\r\n                }\r\n                if(text=='derivar'){\r\n                    text = 'aprobar y derivar';\r\n                    mensajeLoad = 'Aprobando y derivando...'\r\n                    datos.observaciones = vmd.data.observaciones;\r\n                    datos.derivar = true;\r\n                }\r\n                if(sw_crear){\r\n                    text = 'aprobar y luego crear documento';\r\n                    datos.usuario_derivar = datos.usuario;\r\n                    datos.observaciones = '';\r\n                    datos.derivar = true;\r\n                }\r\n            }\r\n            Modal.confirm('¿Esta seguro de que quiere '+text+'?', function () {\r\n                var configLoad = {\r\n                    data: {\r\n                        mensaje: mensajeLoad,\r\n                        tipo: 'info'\r\n                    }\r\n                };\r\n                Loading.show(configLoad);\r\n                Loading.cambiar({tipo:'info'});\r\n                DataService.put( restUrl+'plantillasFormly/documento/'+data.id+\"/aprobar\", datos)\r\n                .then(function (respuesta) {\r\n                    Message.show(respuesta.tipoMensaje, respuesta.mensaje);\r\n                    if (sw_crear) {\r\n                      DataService.get(restUrl + 'plantillasFormly/plantilla_formly/'+vmd.data._plantilla_seleccionada.id_plantilla_formly)\r\n                      .then(function (respuesta) {\r\n                        respuesta.datos.documento_padre = data.id;\r\n                        respuesta.datos.grupo = data.dc.grupo;\r\n                        Storage.setSession(\"pl\", respuesta.datos);\r\n                        $location.path('documento/0');\r\n                        $mdDialog.cancel();\r\n                        Loading.cerrar();\r\n                    });\r\n                    $timeout(function(){ angular.element('#btn-refresh-crudtable').click(); });\r\n                    cerrar();\r\n                    }else{\r\n                        $timeout(function(){ angular.element('#btn-refresh-crudtable').click(); });\r\n                        cerrar();\r\n                        Loading.cerrar();\r\n                    }\r\n                });\r\n            });\r\n        }\r\n\r\n        function observar() {\r\n            var datos = {\r\n                usuario: cuenta.id,\r\n                observaciones: vmd.data.observaciones,\r\n                observado_por: cuenta.first_name+' '+cuenta.last_name\r\n            };\r\n            \r\n            Modal.confirm('¿Esta seguro de que quiere observar?', function(){\r\n              DataService.put( restUrl+'plantillasFormly/documento/'+data.id+\"/rechazar\", datos)\r\n              .then(function (respuesta) {\r\n                Message.show(respuesta.tipoMensaje, respuesta.mensaje);\r\n                $timeout(function(){ angular.element('#btn-refresh-crudtable').click(); });\r\n                cerrar();\r\n              });\r\n            });\r\n        }\r\n\r\n        function derivar(){\r\n            Modal.confirm('¿Esta seguro de que quiere derivar?', function(){\r\n                var datos = {\r\n                    usuario: cuenta.id,\r\n                    destino: vmd.data._usuario_seleccionado,\r\n                    observaciones: vmd.data.observaciones\r\n                };\r\n                DataService.put( restUrl+'plantillasFormly/documento/'+data.id+\"/derivar\", datos)\r\n                .then(function (respuesta) {\r\n                    Message.show(respuesta.tipoMensaje, respuesta.mensaje);\r\n                    $timeout(function(){ angular.element('#btn-refresh-crudtable').click(); });\r\n                    cerrar();\r\n                });\r\n            });\r\n        }\r\n\r\n        function openSelect(ev){\r\n            angular.element(ev.currentTarget).next().children()[0].click();\r\n            vmd.data.show_select = true;\r\n        }\r\n\r\n        function crear(p) {\r\n            DataService.get(restUrl+'plantillasFormly/documento/?documento_padre='+data.id)\r\n            .then(function (respuesta) {\r\n                if(respuesta.datos.total==0){\r\n                  if(angular.isDefined(p) && p){\r\n                    aprobar('crear');\r\n                  }\r\n                  else {\r\n                    Modal.confirm('¿Esta seguro de que quiere crear '+vmd.data._plantilla_seleccionada.nombre+'?', function () {\r\n                      DataService.get(restUrl + 'plantillasFormly/plantilla_formly/'+vmd.data._plantilla_seleccionada.id_plantilla_formly)\r\n                      .then(function (respuesta) {\r\n                          respuesta.datos.documento_padre = data.id;\r\n                          respuesta.datos.grupo = data.dc.grupo;\r\n                          Storage.setSession(\"pl\", respuesta.datos);\r\n                          $location.path('documento/0');\r\n                          $mdDialog.cancel();\r\n                      });\r\n                      cerrar();\r\n                    });\r\n                  }\r\n\r\n                }\r\n\r\n                else{\r\n                    var doc = respuesta.datos.resultado[0];\r\n                    var html = '';\r\n                    html+= 'El documento ya tiene respuesta!!<br>';\r\n                    html+= 'Si quiere crear otra tiene que borrar la actual <br>';\r\n                    html+= 'Nombre: '+doc.nombre+' <br>';\r\n                    html+= 'Tipo de documento: '+doc.nombre_plantilla+' <br>';\r\n                    html+= 'Estado: '+doc.estado+' <br>';\r\n                    html+= 'Fecha de creación: '+Datetime.format(doc._fecha_creacion)+' <br>';\r\n                    Modal.alert(html);\r\n                    $location.path('documentos');\r\n                }\r\n\r\n\r\n            })\r\n\r\n\r\n\r\n        }\r\n\r\n        function verDocumento(id_doc) { Documento.showPdfId(id_doc, false); }\r\n        function cerrar(){ $mdDialog.cancel(); }\r\n    }\r\n\r\n  }\r\n})();\r\n\n(function () {\n  'use strict';\n\n  angular\n  .module('app')\n  .controller('VirtualController', VirtualController);\n\n  /** @ngInject */\n  function VirtualController($location, Message, DataService, restUrl, SideNavFactory, ExpirationTime, Storage, Loading, $timeout, $auth, Util, BreadcrumbFactory) {\n  \n    var vm = this;\n    vm.usuariosVirtuales = [];\n\n    vm.seleccionar = function (item) {\n      Loading.show({\n        data: {\n          mensaje: 'Cambiando de usuario...',\n          tipo: 'success'\n        }\n      });\n      \n      DataService.get(restUrl + 'seguridad/virtual/cambiar/' + item.id_usuario)\n      .then(function (respVirtual) {\n        // TODO: controlar si no se pudo obtener los datos de activacion del usuario virtual.\n        if(angular.isUndefined(respVirtual)) {\n          throw Error('Error en el cambio de usuario.');\n        }\n        var user = respVirtual.datos.user;\n        var menu = respVirtual.datos.menu;\n        var roles = respVirtual.datos.roles;\n        var path = Storage.getSession('path');\n        user.es_jefe = false;\n        if(path == null ) {\n          var max = 10;\n          roles.forEach(function(item) {\n            if (item.rol.peso < max && item.rol.peso !== 0) max = item.rol.peso;\n            if (item.rol.nombre == 'JEFE')  user.es_jefe = true;\n          });\n          path = ['documentos', 'aprobacion', 'impresion', 'documentos', 'documentos'][max];\n        }\n        SideNavFactory.setUser(user);\n        Storage.setUser(user);\n        SideNavFactory.setMenu(menu.menu);\n        Storage.setSession('menu', SideNavFactory.getMenu());\n        if(path) {\n          var route = path.replace('/', '');\n          var page = Util.getMenuOption(Storage.getSession('menu'), route);\n          BreadcrumbFactory.setParent(page[0]);\n          BreadcrumbFactory.setCurrent(page[1]);\n        }\n        $timeout(function () {\n          var $sidenav = angular.element('#sidenav')\n          $sidenav.find('.md-button-href').removeClass('active');\n          $sidenav.find('.sidenav-sublist').hide();\n          $sidenav.find(\".md-button-href[data-url='\" + route + \"']\")\n          .addClass('active').parent().parent().prev().click();\n        });\n        $auth.setToken(respVirtual.datos.token);\n        $timeout(ExpirationTime.init(), 800);\n        angular.element('#toast-container-main').find('md-toast').fadeOut();\n        $timeout($location.path(path && path.indexOf('login') == -1 ? path : '/'), 10000);\n        $timeout(Loading.cerrar(), 8000);\n      })\n      .catch(function(){\n        Message.show('ERROR', 'Error en el cambio de usuario.');\n      });\n    };\n\n    vm.obtenerVirtuales = function () {\n      DataService.get(restUrl + 'seguridad/virtual')\n      .then(function (respVirtual) {\n        if (angular.isUndefined(respVirtual)) {\n          $location.path(\"documentos\");          \n          return;\n        }\n        Message.show(respVirtual.tipoMensaje, respVirtual.mensaje);\n        vm.usuariosVirtuales = respVirtual.datos.resultado;\n      })\n      .catch(function () {\n        Message.show('ERROR', 'Error en la obtencion de datos virtuales');\n      })\n    };\n    vm.obtenerVirtuales();\n  }\n\n})();\n(function() {\r\n    'use strict';\r\n\r\n    angular\r\n    .module('app')\r\n    .controller('UsuariosController',UsuariosController);\r\n\r\n\r\n    /** @ngInject */\r\n    function UsuariosController(restUrl, Modal, DataService, Util, Message, Storage, $log) {\r\n        var vm = this;\r\n\r\n        vm.title = 'Usuarios';\r\n        vm.url = restUrl + 'seguridad/usuario/';\r\n        vm.fields = ['id_usuario','usuario','numero_documento','nombres','apellidos','cargo','email','estado','_fecha_creacion','_fecha_modificacion'];\r\n        vm.dialogController = [ 'data', 'Message', '$scope', '$mdConstant', '$mdDialog', 'Modal', 'DataService', 'restUrl', '$timeout', DialogUsuarioController];\r\n        vm.template = 'app/modules/admin/usuarios/dialog.usuario.html'; // TODO: Es necesario crear???.\r\n        var cuenta=Storage.getUser();\r\n        vm.usuario=cuenta.id;\r\n\r\n        vm.permission ={\r\n          create:true,\r\n          update:true,\r\n          delete:false\r\n        };\r\n\r\n        vm.buttonAgregar = {\r\n            tooltip: 'Syncronizar todos los datos con ldap',\r\n            icon: 'cached',\r\n            onclick: Syncronizar\r\n        };\r\n\r\n        function Syncronizar(ev) {\r\n            $log.log(\"Sin servicio\", ev);\r\n        }\r\n\r\n        function DialogUsuarioController(data, Message, $scope,$mdConstant,$mdDialog,Modal,DataService,restUrl,$timeout){\r\n\r\n          var vmd=$scope;\r\n\r\n          vmd.data = data;\r\n          // funciones\r\n          vmd.cerrar = cerrar;\r\n          vmd.registrarUsuario = registrarUsuario;\r\n          // vmd.eliminarVirtual = eliminarVirtual;\r\n          // vmd.agregarVirtual = agregarVirtual;\r\n\r\n          var flagEditar=(data.id_usuario)?true:false; // true: editar, false:crear.\r\n          iniciarDialog();\r\n\r\n          // TODO: Abstraer un nivel mas los metodos iniciarDialog y obtener Usuarios.\r\n          function iniciarDialog(){\r\n            var roles=[];\r\n            var rolesEnviar=[];\r\n            var virtuales = [];\r\n            DataService.get(restUrl+\"seguridad/rol\")\r\n            .then(function(response){\r\n              roles=response.datos.resultado;\r\n              if(flagEditar){\r\n                var rolesAsignados=data.usuario_rol;\r\n                roles.forEach(function(itemGlobal,indiceGlobal){\r\n                  var rol={\r\n                    id_rol:itemGlobal.id_rol,\r\n                    nombre:itemGlobal.nombre,\r\n                    valor:false\r\n                  }\r\n\r\n                  if(rolesAsignados!=null && rolesAsignados.length>0){\r\n                    rolesAsignados.forEach(function(item,indice){\r\n                      if(itemGlobal.id_rol==item.rol.id_rol) rol.valor=true;\r\n                      if(indice==rolesAsignados.length-1){\r\n                        rolesEnviar.push(rol);\r\n                        if(indiceGlobal==roles.length-1) vmd.data.roles=rolesEnviar;\r\n                      }\r\n                    });\r\n                  }else{\r\n                    vmd.data.roles = roles;\r\n                  }\r\n\r\n                });\r\n              }\r\n              else{\r\n                // Agrega valor, por defecto en false.\r\n                roles.forEach(function(item,indice){\r\n\r\n                  var rol={\r\n                    id_rol:item.id_rol,\r\n                    nombre:item.nombre,\r\n                    valor:false\r\n                  }\r\n                  rolesEnviar.push(rol);\r\n                  if(indice==roles.length-1) vmd.data.roles=rolesEnviar;\r\n                });\r\n\r\n              }\r\n            })\r\n\r\n            DataService.get(restUrl + \"seguridad/virtual/todos\")\r\n            .then(function (response) {\r\n              if (angular.isUndefined(response.datos.resultado)) virtuales = [];\r\n              virtuales = response.datos.resultado;\r\n              var procesado = [];\r\n              // vmd.data.virtuales = virtuales;\r\n              if (flagEditar && flagEditar === false) {\r\n                vmd.data.virtuales = virtuales;\r\n                return;                \r\n              }\r\n              \r\n              var enUso = vmd.data.virtuales || [];\r\n              virtuales.forEach(function (dispItem) {\r\n                var objTemp = {\r\n                  id_usuario: dispItem.id_usuario,\r\n                  cargo: dispItem.cargo,\r\n                  nombres: dispItem.nombres,\r\n                  libre: dispItem.libre,\r\n                  valor: false,\r\n                  titular: dispItem.titular\r\n                };\r\n                if(enUso.length == 0) {\r\n                  procesado.push(objTemp);\r\n                }\r\n                var idProcesado = [];\r\n                enUso.forEach(function (usoItem) {\r\n                  if (dispItem.id_usuario == usoItem.fid_usuario_virtual) {\r\n                    idProcesado.push(dispItem.id_usuario);\r\n                    objTemp.id_virtual = usoItem.id_virtual;\r\n                    if ( usoItem.estado == 'ACTIVO') {\r\n                      objTemp.libre = true;\r\n                      objTemp.valor = true;\r\n                    } else {\r\n                      // objTemp.libre = true;\r\n                      objTemp.valor = false;\r\n                    }\r\n\r\n                    procesado.push(objTemp);\r\n                  }\r\n                });\r\n                \r\n                if(idProcesado.indexOf(dispItem.id_usuario)=== -1 && enUso.length > 0) {\r\n                  procesado.push(objTemp)\r\n                }\r\n              })\r\n\r\n              vmd.data.virtuales = procesado;\r\n\r\n            })\r\n\r\n            DataService.get(restUrl+\"seguridad/unidad?fields=id_unidad,nombre,abreviacion\")\r\n            .then(function (respuesta) {\r\n                vmd.data.unidades = respuesta.datos.resultado;\r\n            })\r\n\r\n          }\r\n\r\n          function cerrar(){\r\n            $mdDialog.cancel();\r\n          }\r\n\r\n\r\n          function registrarUsuario(){\r\n\r\n            var roles=[];\r\n            for(var i in vmd.data.roles){\r\n              if(vmd.data.roles[i].valor==true) roles.push(vmd.data.roles[i].id_rol);\r\n            }\r\n            var oficinas=[];\r\n            for(var j in vmd.data.oficinas){\r\n\r\n              if(vmd.data.oficinas[j].valor==true) oficinas.push(vmd.data.oficinas[j].id_oficina);\r\n            }\r\n\r\n            var usuario={\r\n              usuario:vmd.data.usuario,\r\n              fid_unidad:vmd.data.fid_unidad,\r\n              contrasena:\" \",//vmd.data.contrasena, //Se utiliza la contraseña del LDAP\r\n              numero_documento:vmd.data.numero_documento,\r\n              nombres:vmd.data.nombres,\r\n              apellidos:vmd.data.apellidos,\r\n              cargo:vmd.data.cargo,\r\n              email:vmd.data.email,\r\n              estado:vmd.data.estado,\r\n              roles:roles,\r\n              oficinas:oficinas,\r\n              virtuales: vmd.data.virtuales\r\n              // virtuales: vmd.data.virtuales\r\n            }\r\n\r\n            if(flagEditar){\r\n              usuario.id_usuario=vmd.data.id_usuario;\r\n              usuario._usuario_modificacion=cuenta.id;\r\n              usuario._fecha_modificacion=new Date();\r\n            }\r\n            else{\r\n              usuario._usuario_creacion=cuenta.id;\r\n              usuario._fecha_creacion= new Date();\r\n            }\r\n\r\n            if(flagEditar){\r\n              DataService.put(restUrl+\"seguridad/usuario/\"+usuario.id_usuario, usuario)\r\n              .then(function(respuesta){\r\n                //console.log(\"Verificando la modificacion\",respuesta);\r\n                Message.success();\r\n                if(respuesta!=undefined ){\r\n                  $mdDialog.hide();\r\n\r\n                  $timeout(function(){\r\n                    angular.element('#btn-refresh-crudtable').click();\r\n                  },500)\r\n                }\r\n\r\n              });\r\n            }\r\n            else{\r\n              DataService.post(restUrl+\"seguridad/usuario\", usuario)\r\n              .then(function(respuesta){\r\n                //console.log(\"Verificando la creacion\",respuesta);\r\n                Message.success();\r\n                if(respuesta!=undefined){\r\n                  $mdDialog.hide();\r\n                  $timeout(function(){\r\n                    angular.element('#btn-refresh-crudtable').click();\r\n                  },500)\r\n                }\r\n\r\n              });\r\n            }\r\n\r\n          }\r\n\r\n        } // Fin DialogUsuarioController.\r\n\r\n\r\n\r\n    }\r\n})();\r\n\n(function() {\r\n    'use strict';\r\n\r\n    angular\r\n    .module('app')\r\n    .controller('LoginController', LoginController);\r\n\r\n    /** @ngInject */\r\n    function LoginController($auth, $location, Message, SideNavFactory, Storage, $timeout, Util, BreadcrumbFactory, $window, Datetime, $mdDialog, Modal, ExpirationTime, backUrl, DataService) {\r\n\r\n        var vm = this;\r\n        vm.login = login;\r\n        vm.iniciarSesion= iniciarSesion;\r\n        vm.irAVerificar= irAVerificar;\r\n        vm.backUrl = backUrl;\r\n        Storage.destroySession();\r\n        activate();\r\n            \r\n        function activate() {\r\n            angular.element('body').addClass('no-login');\r\n            angular.element('body').removeClass('principal');\r\n            //TODO: Mostrar para ver errores cuando se bloquea ciudania digital\r\n            if ($window.localStorage.getItem('error') != null && $window.localStorage.getItem('error') != undefined) {\r\n                Message.error($window.localStorage.getItem('error'));\r\n                $window.localStorage.removeItem('error');\r\n            }\r\n        }\r\n\r\n        function login () {\r\n            $auth.login({\r\n                username: vm.username,\r\n                password: vm.password\r\n            })\r\n            .then(function(response) {\r\n                var user = response.data.datos.user;\r\n                var menu = response.data.datos.menu;\r\n                var roles = response.data.datos.roles;\r\n\r\n                angular.element('body').removeClass('no-login');\r\n                angular.element('body').addClass('principal');\r\n\r\n                var path = Storage.getSession('path');\r\n                user.es_jefe=false;\r\n                if(path==null){\r\n                    var max = 10;\r\n                    roles.forEach(function (it) {\r\n                        if(it.rol.peso<max && it.rol.peso!==0){ max = it.rol.peso; }\r\n                        if(it.rol.nombre=='JEFE') user.es_jefe=true;\r\n                    })\r\n                    path = ['documentos','aprobacion','aprobacion', 'impresion', 'documentos', 'documentos'][max];\r\n                }\r\n\r\n                // Set user\r\n                SideNavFactory.setUser(user);\r\n                Storage.setUser(user);\r\n\r\n\r\n                // Set Menu\r\n                SideNavFactory.setMenu(menu);\r\n                Storage.setSession('menu', SideNavFactory.getMenu());\r\n\r\n\r\n                if (path) {\r\n                    var route = path.replace('/', '');\r\n\r\n                    // Set breadcrumb\r\n                    var page = Util.getMenuOption(Storage.getSession('menu'), route);\r\n                    BreadcrumbFactory.setParent(page[0]);\r\n                    BreadcrumbFactory.setCurrent(page[1]);\r\n\r\n                    // Select menu option\r\n                    $timeout(function () {\r\n                        var $sidenav = angular.element('#sidenav')\r\n                        $sidenav.find('.md-button-href').removeClass('active');\r\n                        $sidenav.find('.sidenav-sublist').hide();\r\n                        $sidenav.find(\".md-button-href[data-url='\" + route + \"']\")\r\n                                .addClass('active').parent().parent().prev().click();\r\n                    });\r\n\r\n                }\r\n                ExpirationTime.init();\r\n\r\n                angular.element('#toast-container-main').find('md-toast').fadeOut();\r\n\r\n                // Redirect to dashboard\r\n                $location.path(path && path.indexOf('login') == -1? path : '/');\r\n\r\n            })\r\n            .catch(function(error) {\r\n                if (error.status == 400 || error.status == 401) {\r\n                    Message.error('Nombre de usuario y/o contraseña no válidos.');\r\n                }\r\n                if(error.status == 412){\r\n                    Message.show(error.data.tipoMensaje,error.data.mensaje);\r\n                }\r\n\r\n                if (error.status == -1) {\r\n                    Message.error('Servidor no Disponible.');\r\n                }\r\n            });\r\n        }\r\n\r\n\r\n        vm.abrirDialog= function(pEvento){\r\n\r\n          var config={\r\n            event: pEvento,\r\n            title: 'Recuperar contraseña',\r\n            templateUrl: 'app/modules/admin/login/recuperar.dialog.html',\r\n            controller: ['$scope','$mdDialog','DataService','Message','restUrl', DialogRecuperarController]\r\n          };\r\n          Modal.show(config);\r\n        }\r\n\r\n        /**\r\n         Funcion Controlador para el dialogo de recuperacion de contraseña.\r\n         */\r\n        function DialogRecuperarController($scope,$mdDialog, DataService, Message, restUrl){\r\n          var vmd=$scope;\r\n          vmd.usuario=null;\r\n          vmd.email=null;\r\n          vmd.numero_documento=null;\r\n\r\n          // Funcion que recupera los datos y los envia al servicio rest.\r\n          vmd.recuperar=function(){\r\n\r\n            var datosEnviar={\r\n              usuario:vmd.usuario,\r\n              email:vmd.email,\r\n              numero_documento:vmd.numero_documento\r\n            }\r\n\r\n            DataService.put(restUrl+\"seguridad/recuperar/\", datosEnviar)\r\n            .then(function(pRespuesta){\r\n              Message.show(pRespuesta.tipoMensaje,pRespuesta.mensaje);\r\n              vmd.cerrar();\r\n            })\r\n\r\n          }\r\n          vmd.cerrar= function(){\r\n            $mdDialog.cancel();\r\n          }\r\n        }\r\n\r\n      function iniciarSesion() {\r\n          var ruta =  vm.backUrl + 'codigo';\r\n          DataService.get(ruta)\r\n          .then(function(response) {\r\n            if (response) {\r\n              $window.localStorage.setItem('oauth2_state', response.datos.codigo);\r\n              $window.location.href = response.datos.url;\r\n            }\r\n\r\n        })\r\n        .catch(function (err) {\r\n          Message.error(err);\r\n        });\r\n      }\r\n\r\n      function irAVerificar() {\r\n          $location.path('verificar');\r\n      }\r\n    }\r\n\r\n})();\r\n\n(function() {\r\n\t'use strict';\r\n\r\n\tangular\r\n\t.module('app')\r\n\t.controller('ProfileController', ProfileController);\r\n\r\n\t/** @ngInject */\r\n\tfunction ProfileController(Storage, SideNavFactory, Datetime, DataService, restUrl, Message) {\r\n\t\tvar vm = this;\r\n\r\n\t\tvm.getColor = function () {\r\n\t\t\treturn SideNavFactory.userColor;\r\n\t\t}\r\n\r\n\t\tvm.getName = function () {\r\n\t\t\tvar user = SideNavFactory.getUser();\r\n\t\t\treturn user.first_name + ' ' + user.last_name;\r\n\t\t}\r\n\r\n\t\tvm.getEmail = function () {\r\n\t\t\treturn SideNavFactory.getUser().email;\r\n\t\t}\r\n\r\n\t\tvm.getInitial = function () {\r\n\t\t\tvar firstName = SideNavFactory.getUser().first_name;\r\n\t\t\treturn firstName.length ? firstName[0].toUpperCase() : '?';\r\n\t\t}\r\n\r\n\t\tvm.getData = function (key) {\r\n\r\n\t\t\tvar value = SideNavFactory.getUser()[key];\r\n\t\t\tif (['last_login', 'date_joined'].indexOf(key) != -1) {\r\n\t\t\t\treturn Datetime.datetimeLiteral(new Date(value));\r\n\t\t\t}\r\n\r\n\t\t\treturn value;\r\n\t\t}\r\n\r\n\t\tvm.getEsJefe = function () {\r\n\t\t\treturn SideNavFactory.getUser().es_jefe || false;\r\n\t\t}\r\n\r\n\t\tvm.abrirEditar = function (acc){\r\n\t\t\tif(acc=='editar_notificaciones'){\r\n\t\t\t\tDataService.get(restUrl + \"notificacion/conf_notificacion/?fields=id_conf_notificacion,canal,enviado,celular,observado,aprobado,derivado&fid_usuario=\"+vm.getData('id'))\r\n\t\t\t\t.then(function (respuesta) {\r\n\t\t\t\t\tvm.swEditarCuenta = acc;\r\n\t\t\t\t\tvm.ca = respuesta.datos.resultado[0];\r\n\t\t\t\t\tvm.ca.email = vm.getEmail();\r\n\t\t\t\t})\r\n\r\n\t\t\t}else {\r\n\t\t\t\tDataService.get(restUrl + \"seguridad/usuario/\", vm.getData('id'))\r\n\t\t\t\t.then(function (respuesta) {\r\n\t\t\t\t\tif(respuesta.datos){\r\n\t\t\t\t\t\t// console.log(respuesta);\r\n\t\t\t\t\t\tvm.numero_documento = respuesta.datos.numero_documento;\r\n\t\t\t\t\t\tvm.nombre_usuario = respuesta.datos.usuario;\r\n\t\t\t\t\t\tvm.email = respuesta.datos.email;\r\n\t\t\t\t\t\tvm.nombres = respuesta.datos.nombres;\r\n\t\t\t\t\t\tvm.apellidos = respuesta.datos.apellidos;\r\n\t\t\t\t\t\tif(acc == \"editar_cuenta\"){\r\n\t\t\t\t\t\t\tvm.contrasena = respuesta.datos.contrasena;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvm.swEditarCuenta = acc;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t\tvm.editarCuenta = function (){\r\n\t\t\tvar usuario_enviar = {\r\n\t\t\t\tid_usuario: vm.getData('id'),\r\n\t\t\t\tnumero_documento: vm.numero_documento,\r\n\t\t\t\tusuario: vm.nombre_usuario,\r\n\t\t\t\temail: vm.email,\r\n\t\t\t\tnombres: vm.nombres,\r\n\t\t\t\tapellido_paterno: vm.apellidos,\r\n\t\t\t\t_usuario_modificacion: vm.getData('id')\r\n\t\t\t}\r\n\t\t\tvar swPut = true;\r\n\t\t\tif (vm.swEditarCuenta == \"editar_cuenta\") {\r\n\t\t\t\tusuario_enviar.contrasena = vm.contrasena;\r\n\t\t\t}else if (vm.swEditarCuenta == \"editar_contrasena\") {\r\n\t\t\t\tif(vm.contrasena_nueva !== vm.contrasena_confirm){\r\n\t\t\t\t\tMessage.error(\"Las contraseña a confirmar no coincide con la contraseña nueva!!\");\r\n\t\t\t\t\tswPut = false;\r\n\t\t\t\t}\r\n\t\t\t\tusuario_enviar.verificarContrasena = vm.contrasena;\r\n\t\t\t\tusuario_enviar.contrasena = vm.contrasena_nueva;\r\n\t\t\t}\r\n\t\t\tif(swPut){\r\n\t\t\t\tDataService.put(restUrl + \"seguridad/usuario/\"+vm.getData('id'), usuario_enviar)\r\n\t\t\t\t.then(function (respuesta) {\r\n\t\t\t\t\tif(respuesta.datos){\r\n\t\t\t\t\t\t// console.log(respuesta);\r\n\t\t\t\t\t\tvm.numero_documento = null;\r\n\t\t\t\t\t\tvm.nombre_usuario = null;\r\n\t\t\t\t\t\tvm.email = null;\r\n\t\t\t\t\t\tvm.nombres = null;\r\n\t\t\t\t\t\tvm.apellidos = null;\r\n\r\n\t\t\t\t\t\tvm.contrasena = null;\r\n\t\t\t\t\t\tvm.contrasena_nueva = null;\r\n\t\t\t\t\t\tvm.contrasena_confirm = null;\r\n\t\t\t\t\t\tvar user_set={\r\n\t\t\t\t\t\t\tid: respuesta.datos.id_usuario,\r\n\t\t\t\t\t\t\tusername: respuesta.datos.usuario,\r\n\t\t\t\t\t\t\tfirst_name: respuesta.datos.nombres,\r\n\t\t\t\t\t\t\tlast_name: respuesta.datos.apellido_paterno+\" \"+respuesta.datos.apellido_materno,\r\n\t\t\t\t\t\t\tcargo: respuesta.datos.cargo,\r\n\t\t\t\t\t\t\tdoc: respuesta.datos.numero_documento,\r\n\t\t\t\t\t\t\temail: respuesta.datos.email,\r\n\t\t\t\t\t\t\tdate_joined: respuesta.datos._fecha_creacion\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// Set user\r\n\t\t\t\t\t\tSideNavFactory.setUser(user_set);\r\n\t\t\t\t\t\tStorage.setUser(user_set);\r\n\t\t\t\t\t\tvm.swEditarCuenta = null;\r\n\t\t\t\t\t\tMessage.show(respuesta.tipoMensaje, respuesta.mensaje);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t\tvm.editarConfiguracion = function () {\r\n\t\t\tvar conf_enviar = angular.copy(vm.ca)\r\n\t\t\tDataService.put(restUrl + \"notificacion/conf_notificacion/\"+conf_enviar.id_conf_notificacion, conf_enviar)\r\n\t\t\t.then(function (respuesta) {\r\n\t\t\t\tMessage.show(respuesta.tipoMensaje, respuesta.mensaje);\r\n\t\t\t\tvm.swEditarCuenta = null;\r\n\t\t\t})\r\n\t\t}\r\n\r\n\r\n\t\tvm.cancelarEditar = function () {\r\n\t\t\tvm.numero_documento = null;\r\n\t\t\tvm.nombre_usuario = null;\r\n\t\t\tvm.email = null;\r\n\t\t\tvm.nombres = null;\r\n\t\t\tvm.apellidos = null;\r\n\r\n\t\t\tvm.contrasena = null;\r\n\t\t\tvm.contrasena_nueva = null;\r\n\t\t\tvm.contrasena_confirm = null;\r\n\r\n\t\t\tvm.swEditarCuenta=null;\r\n\t\t}\r\n\r\n\t}\r\n})();\r\n\n(function() {\n  'use strict';\n\n  angular\n    .module('app')\n    .controller('fcVacioController', CiteController);\n\n  /** @ngInject */\n  function CiteController($scope) {\n        var vm = this;\n        var sc = $scope;\n        sc.vm = vm;\n        sc.$watch('to.height', function (newValue) {\n            if( newValue<0 ) sc.to.style.height = '0cm';\n            else if( newValue>30 ) sc.to.style.height = '30cm';\n            else if(sc.to.style) sc.to.style.height = sc.to.height+'cm';\n        });\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n  .module('app')\n  .controller('fcListaContactosController', listaContactos);\n\n  /** @ngInject */\n  function listaContactos($scope, DataService, restUrl, ArrayUtil) {\n    var vm = this;\n    var sc = $scope;\n    var tempContactos;\n    \n    sc.vm = vm;\n    vm.buscarContacto = \"\";\n    vm.mostrarContacto = false;\n    vm.contactos = [];\n\n    vm.abrirSelector = abrirSelector;\n    vm.cerrarSelector = cerrarSelector;\n    if (angular.isUndefined(sc.model[sc.options.key])) sc.model[sc.options.key]={};\n    if (angular.isUndefined(sc.model[sc.options.key].lista)) sc.model[sc.options.key].lista=[];\n\n    sc.$watch('vm.buscarContacto', function () {\n      var contador;\n      var vector = [];\n      vm.contactos = [];\n      tempContactos = sc.model[sc.options.key].lista || [];\n      \n      for (contador = 0; contador < tempContactos.length; contador++) {\n        vm.contactos.push(tempContactos[contador]);\n      }\n\n      if(vm.buscarContacto != \"\") {\n        DataService.get(restUrl + 'plantillasFormly/contactos?filter='+vm.buscarContacto)\n        .then(function (respuesta) {\n          vm.contactos = [];\n          vector = respuesta.datos.resultado;\n          for (contador = 0; contador < tempContactos; contador ++) vm.contactos.push(tempContactos[contador]);\n          for (contador = 0; contador < vector.length; contador++) {\n            if(!ArrayUtil.buscarObj(tempContactos, 'id_contacto', vector[contador].id_contacto)) {\n              vm.contactos.push(vector[contador]);\n            }\n          }\n        })\n      }\n    });\n    \n    function abrirSelector(evento, mostrar) {\n      angular.element(evento.currentTarget).parent().next().children()[1].click();\n      switch (mostrar) {\n        case 'contacto': vm.mostrarContacto = true; break;\n      }\n    }\n\n    function cerrarSelector() {\n      vm.buscarContacto = '';\n      vm.mostrarContacto = false;\n    }\n\n  }\n})();\n(function() {\n  'use strict';\n\n  angular\n    .module('app')\n    .controller('fcEncabezadoController', EncabezadoController);\n\n  /** @ngInject */\n  function EncabezadoController($scope, DataService, restUrl, $timeout, Storage, Datetime, ArrayUtil) {\n    var vm = this;\n    var sc = $scope;\n    sc.vm = vm;\n    var cuenta = Storage.getUser();\n\n    vm.buscar_para = \"\";\n    vm.buscar_via = \"\";\n    vm.buscar_de = \"\";\n    vm.show_para = false;\n    vm.show_via = false;\n    vm.show_de = false;\n\n    //cargamos funciones\n    vm.openSelect = openSelect;\n    vm.moverUsuario = moverUsuario;\n\n    $timeout(iniciarController);\n\n    function iniciarController() {\n        var xu, u, i, arr, xde, xpara, xvia, fd;\n        var form_nuevo = angular.isUndefined(sc.model[sc.options.key]);\n\n        xu = {\n            id_usuario: cuenta.id,\n            nombres: cuenta.first_name,\n            apellidos: cuenta.last_name,\n            cargo: cuenta.cargo\n        };\n\n        // cambiamos evento de los inputs\n        angular.element('input.header-searchbox').on('keydown', function(ev) {\n            ev.stopPropagation();\n        });\n\n        if(form_nuevo){\n            sc.model[sc.options.key] = {};\n            sc.model[sc.options.key][\"de\"] = [xu];\n        }else {\n            // delete sc.model[sc.options.key][\"para\"].$$mdSelectId;\n            xpara = sc.model[sc.options.key][\"para\"] || {id_usuario:-1};\n            xde = sc.model[sc.options.key][\"de\"] || {id_usuario:-1};\n            xvia = sc.model[sc.options.key][\"via\"] || {id_usuario:-1};\n            vm.usuarios_check = {};\n            fd = Storage.getSession('flujo_doc');\n\n            if(fd!=null){\n                if(angular.isDefined(fd.via)){\n                    for (i = 0; i < fd.via.length; i++) {\n                        if(fd.via[i]!==fd.via_actual)\n                        vm.usuarios_check[fd.via[i]] = true;\n                    }\n                }\n                if(sc.model['cite-0'] && sc.model['cite-0']['cite'])\n                    vm.usuarios_check[fd.para[0]] = true;\n            }\n        }\n\n        DataService.get(restUrl + 'seguridad/usuario_rol/')\n        .then(function (resultado) {\n            vm.usuarios = [];\n            vm.usuarios_jefes = [];\n            arr = resultado.datos;\n            // console.log(arr);\n            if(form_nuevo){\n                for (i = 0; i < arr.length; i++) {\n                    u = newUser(arr[i]);\n                    vm.usuarios.push( (xu.id_usuario==u.id_usuario)? xu : u );\n                    vm.usuarios_jefes.push(u);\n                }\n            }else {\n                for (i = 0; i < arr.length; i++) {\n                    u = newUser(arr[i]);\n                    if(xpara && ArrayUtil.buscarObj(xpara, 'id_usuario', u.id_usuario)){\n                        vm.usuarios_jefes.push(ArrayUtil.buscarObj(xpara, 'id_usuario', u.id_usuario, true));\n                        vm.usuarios.push(u);\n                    }else if(xvia && ArrayUtil.buscarObj(xvia, 'id_usuario', u.id_usuario)) {\n                        vm.usuarios_jefes.push(ArrayUtil.buscarObj(xvia, 'id_usuario', u.id_usuario, true));\n                        vm.usuarios.push(u);\n                    }else if(ArrayUtil.buscarObj(xde, 'id_usuario', u.id_usuario)) {\n                        vm.usuarios.push(ArrayUtil.buscarObj(xde, 'id_usuario', u.id_usuario, true));\n                    }else {\n                        vm.usuarios_jefes.push(u);\n                        vm.usuarios.push(u);\n                    }\n                }\n            }\n        });\n    }\n\n    function newUser(el) {\n        return {\n            id_usuario: el.id_usuario,\n            nombres: el.nombres,\n            apellidos: el.apellidos,\n            cargo: el.cargo\n        };\n    }\n\n    function moverUsuario(index, dir, nom) {\n        var arr = sc.model[sc.options.key][ nom||'via' ];\n        if(dir==\"down\") ArrayUtil.mover(arr, index, index+1);\n        else if(dir==\"up\") ArrayUtil.mover(arr, index, index-1);\n    }\n\n\n    function openSelect(ev, show) {\n        // console.log($(ev.currentTarget).next().children()[1]);\n        angular.element(ev.currentTarget).parent().next().children()[1].click();\n        switch (show) {\n            case 'para': vm.show_para = true; break;\n            case 'via': vm.show_via = true; break;\n            case 'de': vm.show_de = true; break;\n        }\n    }\n\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('app')\n    .controller('fcDocumentosRelacionadosController', documentosRelacionados);\n\n  /** @ngInject */\n  function documentosRelacionados($scope, DataService, restUrl, ArrayUtil, Documento) {\n    var vm = this,\n        sc = $scope,\n        xdocs;\n    sc.vm = vm;\n    vm.buscar_doc = \"\";\n    vm.show_doc = false;\n    vm.documentos = [];\n\n    //cargamos funciones\n    vm.openSelect = openSelect;\n    vm.mostrarPdf = mostrarPdf;\n    vm.closeSelectDoc = closeSelectDoc;\n\n    sc.$watch('vm.buscar_doc', function () {\n        var i, arr;\n        vm.documentos = [];\n        xdocs = sc.model[sc.options.key] || [];\n        for (i = 0; i < xdocs.length; i++) vm.documentos.push(xdocs[i]);\n\n        if (vm.buscar_doc!=\"\") {\n            // DataService.get( restUrl+'plantillasFormly/documento?fields=id_documento,nombre,fecha' )\n            DataService.get( restUrl+'plantillasFormly/documento?fields=id_documento,nombre,fecha&estado=APROBADO,CERRADO,DERIVADO&page=1&order=-fecha&limit=20&searchPro=1&tipoBus=campo&campoSel=nombre&filter='+vm.buscar_doc)\n            .then(function (respuesta) {\n                vm.documentos = [];\n                arr = respuesta.datos.resultado;\n                for (i = 0; i < xdocs.length; i++) vm.documentos.push(xdocs[i]);\n                for (i = 0; i < arr.length; i++) {\n                    if(!ArrayUtil.buscarObj(xdocs, 'id_documento', arr[i].id_documento))\n                        vm.documentos.push( arr[i] );\n                }\n            })\n        }\n    })\n\n    function openSelect(ev, show) {\n        angular.element(ev.currentTarget).parent().next().children()[1].click();\n        switch (show) {\n            case 'doc': vm.show_doc = true; break;\n        }\n    }\n\n    function closeSelectDoc() {\n        vm.buscar_doc='';\n        vm.show_doc=false;\n    }\n\n    function mostrarPdf(pIdentificador){\n        Documento.showPdfId(pIdentificador);\n    }\n\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n  .module('app')\n  .controller('fcDocumentosAnularController', documentosAnular);\n\n  /** @ngInject */\n  function documentosAnular($scope, DataService, restUrl, ArrayUtil, Documento) {\n    var vm = this,\n    sc = $scope,\n    xdocs;\n    sc.vm = vm;\n    vm.buscar_doc = \"\";\n    vm.show_doc = false;\n    vm.documentos = [];\n\n    //cargamos funciones\n    vm.openSelect = openSelect;\n    vm.mostrarPdf = mostrarPdf;\n    vm.closeSelectDoc = closeSelectDoc;\n\n    sc.$watch('vm.buscar_doc', function () {\n      var i, arr;\n      vm.documentos = [];\n      xdocs = sc.model[sc.options.key] || [];\n      for (i = 0; i < xdocs.length; i++) vm.documentos.push(xdocs[i]);\n\n      if (vm.buscar_doc!=\"\") {\n        // TODO: No es necesario evitar el listado de documentos anulados?\n        DataService.get( restUrl+'plantillasFormly/documento?fields=id_documento,nombre,fecha&estado=APROBADO,CERRADO,DERIVADO&page=1&order=-fecha&limit=20&searchPro=1&tipoBus=campo&campoSel=nombre&filter='+vm.buscar_doc)\n        .then(function (respuesta) {\n          vm.documentos = [];\n          arr = respuesta.datos.resultado;\n          for (i = 0; i < xdocs.length; i++) vm.documentos.push(xdocs[i]);\n          for (i = 0; i < arr.length; i++) {\n            if(!ArrayUtil.buscarObj(xdocs, 'id_documento', arr[i].id_documento))\n            vm.documentos.push( arr[i] );\n          }\n        });\n      }\n    });\n\n    function openSelect(ev, show) {\n      angular.element(ev.currentTarget).parent().next().children()[1].click();\n      switch (show) {\n        case 'doc': vm.show_doc = true; break;\n      }\n    }\n\n    function closeSelectDoc() {\n      vm.buscar_doc='';\n      vm.show_doc=false;\n    }\n\n    function mostrarPdf(pIdentificador){\n      Documento.showPdfId(pIdentificador);\n    }\n\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('app')\n    .controller('fcDatosGeneralesController', DatosGeneralesController);\n\n  /** @ngInject */\n  function DatosGeneralesController($scope, DataService, restUrl, $timeout, Storage, Datetime, ArrayUtil) {\n    var vm = this;\n    var sc = $scope;\n    sc.vm = vm;\n    var cuenta = Storage.getUser();\n\n    vm.buscar_para = \"\";\n    vm.buscar_via = \"\";\n    vm.buscar_de = \"\";\n    vm.show_para = false;\n    vm.show_via = false;\n    vm.show_de = false;\n\n    //cargamos funciones\n    vm.openSelect = openSelect;\n    vm.moverUsuario = moverUsuario;\n\n    $timeout(iniciarController);\n\n    function iniciarController() {\n        var xu, u, i, j, arr, xde, xpara, xvia, rol, fd, push_gral, push_jefe;\n        var form_nuevo = angular.isUndefined(sc.model[sc.options.key]);\n\n        xu = {\n            id_usuario: cuenta.id,\n            nombres: cuenta.first_name,\n            apellidos: cuenta.last_name,\n            cargo: cuenta.cargo\n        };\n\n        // cambiamos evento de los inputs\n        angular.element('input.header-searchbox').on('keydown', function(ev) {\n            ev.stopPropagation();\n        });\n\n        if(form_nuevo){\n            sc.model[sc.options.key] = {};\n            sc.model[sc.options.key][\"de\"] = [xu];\n        }else {\n            // delete sc.model[sc.options.key][\"para\"].$$mdSelectId;\n            xpara = sc.model[sc.options.key][\"para\"] || {id_usuario:-1};\n            xde = sc.model[sc.options.key][\"de\"] || {id_usuario:-1};\n            xvia = sc.model[sc.options.key][\"via\"] || {id_usuario:-1};\n            vm.usuarios_check = {};\n            fd = Storage.getSession('flujo_doc');\n\n            if(angular.isDefined(fd) && fd!=null){\n                if(fd.via!=null){\n                    for (i = 0; i < fd.via.length; i++) {\n                        if(fd.via[i]!==fd.via_actual)\n                        vm.usuarios_check[fd.via[i]] = true;\n                    }\n                }\n                if(sc.model['cite-0'] && sc.model['cite-0']['cite'])\n                    vm.usuarios_check[fd.para[0]] = true;\n            }\n        }\n\n        DataService.get(restUrl + 'seguridad/usuario_rol/')\n        .then(function (resultado) {\n            vm.usuarios = [];\n            vm.usuarios_jefes = [];\n            arr = resultado.datos;\n            // console.log(arr);\n            if(form_nuevo){\n                for (i = 0; i < arr.length; i++) {\n                    u = newUser(arr[i]);\n                    push_jefe = false;\n                    for (j = 0; j < arr[i].usuario_rol.length; j++) {\n                        rol = arr[i].usuario_rol[j].rol.nombre;\n                        if(rol===\"JEFE\" ||rol ==\"CORRESPONDENCIA\")\n                            push_jefe=true;\n                    }\n                    vm.usuarios.push( (xu.id_usuario==u.id_usuario)? xu : u );\n                    if(push_jefe && xu.id_usuario!=u.id_usuario) vm.usuarios_jefes.push(u);\n                }\n            }else {\n                for (i = 0; i < arr.length; i++) {\n                    push_gral = false;\n                    push_jefe = false;\n                    u = newUser(arr[i]);\n                    if( u.id_usuario==xpara.id_usuario ){\n                        vm.usuarios_jefes.push(xpara);\n                        if(!push_gral) vm.usuarios.push(u);\n                        push_gral = true;\n                        push_jefe = true;\n                    }\n                    if(xvia && ArrayUtil.buscarObj(xvia, 'id_usuario', u.id_usuario)) {\n                        vm.usuarios_jefes.push(ArrayUtil.buscarObj(xvia, 'id_usuario', u.id_usuario, true));\n                        if(!push_gral) vm.usuarios.push(u);\n                        push_gral = true;\n                        push_jefe = true;\n                    }\n                    if(ArrayUtil.buscarObj(xde, 'id_usuario', u.id_usuario)) {\n                        vm.usuarios.push(ArrayUtil.buscarObj(xde, 'id_usuario', u.id_usuario, true));\n                        push_gral = true;\n                    }\n\n                    {\n                        if(!push_gral) vm.usuarios.push(u);\n\n                        push_gral = false; // usamos para ver si en sus roles es jefe o CORRESPONDENCIA\n                        if(!push_jefe)\n                            for (j = 0; j < arr[i].usuario_rol.length; j++) {\n                                rol = arr[i].usuario_rol[j].rol.nombre;\n                                if(rol===\"JEFE\" ||rol ==\"CORRESPONDENCIA\")\n                                    push_gral = true;\n                            }\n\n                        if(push_gral && xu.id_usuario!=u.id_usuario &&  !push_jefe) vm.usuarios_jefes.push(u);\n                    }\n                }\n            }\n        });\n    }\n\n    function newUser(el) {\n        return {\n            id_usuario: el.id_usuario,\n            nombres: el.nombres,\n            apellidos: el.apellidos,\n            cargo: el.cargo\n        };\n    }\n\n    function moverUsuario(index, dir) {\n        var arr = sc.model[sc.options.key][\"via\"];\n        if(dir==\"down\") ArrayUtil.mover(arr, index, index+1);\n        else if(dir==\"up\") ArrayUtil.mover(arr, index, index-1);\n    }\n\n\n    function openSelect(ev, show) {\n        // console.log($(ev.currentTarget).next().children()[1]);\n        angular.element(ev.currentTarget).parent().next().children()[1].click();\n        switch (show) {\n            case 'para': vm.show_para = true; break;\n            case 'via': vm.show_via = true; break;\n            case 'de': vm.show_de = true; break;\n        }\n    }\n\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('app')\n    .controller('fcCiteController', CiteController);\n\n  /** @ngInject */\n  function CiteController($scope, Datetime) {\n    var vm = this;\n    var sc = $scope;\n    sc.vm = vm;\n\n    if(sc.model[sc.options.key] && sc.model[sc.options.key]['fecha'])\n        sc.model[sc.options.key][\"fecha\"] = Datetime.format(sc.model[sc.options.key][\"fecha\"], 'dd de MMM de YYYY');\n\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('app')\n    .controller('fcConCopiaArchivoController', ConCopiaArchivoController);\n\n  /** @ngInject */\n  function ConCopiaArchivoController($scope, $timeout, Storage) {\n    var vm = this;\n    var sc = $scope;\n    sc.vm = vm;\n    var cuenta = Storage.getUser();\n\n    $timeout(iniciarController);\n\n    function iniciarController() {\n        if(angular.isUndefined(sc.model[sc.options.key])){\n            sc.model[sc.options.key] = generarAbreviacion(cuenta.first_name + \" \" + cuenta.last_name);\n            sc.model[sc.options.key] += '\\nCc.:archivo';    \n        }\n    }\n        \n    function generarAbreviacion(cadena) {        \n        cadena = cadena.replace(/[^a-zA-Z ]/g, \"\");\n        var str = cadena.toUpperCase();\n        var res = str.split(\" \");\n        var abreviacion = \"\";\n        for (var i = 0; i < res.length; i++) {            \n            abreviacion = abreviacion + res[i][0];            \n        }\n        return abreviacion;\n    }\n  }\n})();\n\n  (function (){\n    'use strict';\n    angular\n    .module('app')\n    .controller('fcCalendarioController', calendario);\n\n    /** @ngInject */\n    function calendario($scope, $log) {\n      var vm = this;\n      var sc = $scope;\n      $log.log('Iniciando el controlador del componente calendario', sc);\n      sc.vm = vm;\n      vm.minDate= '';\n      vm.maxDate= '';\n      \n      \n      sc.actualizarLimites = function(diasAntes, diasDespues) {        \n        var fechaActualMin = new Date();\n        var fechaActualMax = new Date();\n        if (diasAntes!= undefined && diasAntes >= 0) {\n          sc.to.minDate= new Date(fechaActualMin.setDate(fechaActualMin.getDate()- (diasAntes)));\n        }\n        if (diasDespues != undefined && diasDespues >= 0) {\n          sc.to.maxDate = new Date(fechaActualMax.setDate(fechaActualMax.getDate() + (diasDespues)));\n        }\n        \n      }\n\n      sc.actualizarLimites(sc.to.diasAntes, sc.to.diasDespues);\n\n      // var fechasBlockeadas = [new Date('2018-12-14'.toString())];\n      // sc.onlyWeekendsPredicate = function(date) {\n      //   // console.log('Revisando los datos', date);\n      //   // TODO: el $filter no es reconocido por el int\n      //   // return $filter('filterBookings')(date, fechasBlockeadas);\n      // }\n      sc.filterBookings = function() {\n        return function (date, bookedDates) {\n          for (var i = 0; i < bookedDates.length; i++) {\n            return date.toString() !== bookedDates[i];\n          }\n        };\n      }\n    }\n  })();\n(function() {\n  'use strict';\n\n  angular\n    .module('app')\n    .controller('fcCajaChicaController', CajaChicaController);\n\n  /** @ngInject */\n  function CajaChicaController($scope, $timeout, DataService, restUrl) {\n    var vm = this;\n    var sc = $scope;\n    var model, to;\n    sc.vm = vm;\n\n    vm.buscar = {};\n    vm.alert = {};\n\n    vm.addRow = addRow;\n    vm.deleteRow = deleteRow;\n    vm.buscarDocumentos = buscarDocumentos;\n    vm.buscarPartidas = buscarPartidas;\n    vm.cargarPartidas = cargarPartidas;\n    vm.obtenerSaldo = obtenerSaldo;\n    vm.calcularTotal = calcularTotal;\n\n    $timeout(iniciarController);\n\n    function iniciarController() {\n        to = sc.options.templateOptions;\n        vm.documentos = [];\n        if (angular.isUndefined(sc.model[sc.options.key])) {\n            sc.model[sc.options.key] = { rows: [], monto_total:0 };\n            sc.model[sc.options.key].tipo = to.tipo=='GESTION'? 'MODIFICADO': to.tipo;\n        }else {\n          calcularTotal();\n        }\n        model = sc.model[sc.options.key];\n    }\n\n    function buscarPartidas(texto) {\n      var url = restUrl+'presupuesto/partidas/';\n      if (texto) { url += '?filter='+texto; }\n      return DataService.get(url)\n      .then(function (respuesta) {\n        return respuesta.datos || [];\n      })\n    }\n\n    function calcularTotal(row) {\n      if (row) row.monto = isFloat(row.monto)? parseFloat(row.monto).toFixed(2) : '0.00';\n\n      sc.model[sc.options.key].monto_total = 0;\n      sc.model[sc.options.key].rows.forEach(function (it) {\n        if (isFloat(it.monto)) sc.model[sc.options.key].monto_total+=toFloat(it.monto);\n      })\n      sc.model[sc.options.key].monto_total = parseFloat(sc.model[sc.options.key].monto_total).toFixed(2);\n    }\n    function toFloat(string) { return parseFloat(parseFloat(string).toFixed(2)); }\n    function isFloat(string) { return /(?:\\d*\\.)?\\d+/.test(string); }\n\n    function obtenerSaldo(multiple) {\n        var url = restUrl+'presupuesto/partidas/?saldo='+multiple;\n        DataService.get(url)\n        .then(function (respuesta) {\n          if (respuesta) {\n            if (respuesta.tipoMensaje=='EXITO')\n              showALert('info', ' El saldo actual del comprometido es '+respuesta.datos.monto);\n            if (respuesta.tipoMensaje=='ADVERTENCIA')\n              showALert('warning', ' '+respuesta.mensaje);\n          }\n        })\n    }\n\n    function cargarPartidas(cite) {\n      if (cite) {\n        var url = restUrl+'presupuesto/partidas/?cite='+cite;\n        DataService.get(url)\n        .then(function (respuesta) {\n          if (respuesta){\n            if (respuesta.tipoMensaje=='EXITO'){\n              if (model.rows) {\n                vm.ids_comprometidos = {};\n                model.rows.forEach(function (it) { vm.ids_comprometidos[it.id_comprometido] = !it.pago_multiple; })\n\n                for (var k in respuesta.datos) {\n                  if (respuesta.datos.hasOwnProperty(k) && !vm.ids_comprometidos[k]) {\n                      model.rows.push({\n                        cite: angular.copy(vm.buscar.doc_seleccionado),\n                        partida: angular.copy(respuesta.datos[k].partida),\n                        descripcion: angular.copy(respuesta.datos[k].descripcion),\n                        id_comprometido: angular.copy(respuesta.datos[k].id),\n                        comprometido: angular.copy(respuesta.datos[k].monto),\n                        pago_multiple: angular.copy(respuesta.datos[k].pago_multiple),\n                        monto: '0.00'\n                      })\n                      vm.ids_comprometidos[k] = !respuesta.datos[k].pago_multiple;\n                  }\n                }\n                if (Object.keys(respuesta.datos)==0) showALert('warning', 'El documento ya no tiene partidas disponibles.')\n              }\n            } else if (respuesta.tipoMensaje=='ADVERTENCIA') showALert('warning', respuesta.mensaje);\n          }\n          vm.buscar.doc_seleccionado = null;\n        })\n      }\n    }\n\n    function buscarDocumentos(texto) {\n      var url = restUrl+'plantillasFormly/documento?fields=id_documento,nombre,fecha&estado=APROBADO,CERRADO,DERIVADO&page=1&order=-fecha&limit=20';\n      if (texto) {\n        url += '&searchPro=1&tipoBus=campo&campoSel=nombre&filter='+texto;\n      }\n      return DataService.get(url)\n      .then(function (respuesta) {\n        if (respuesta){\n          vm.documentos = respuesta.datos.resultado;\n        }\n        return respuesta.datos.resultado || [];\n      })\n    }\n\n    function addRow(tipo, button) {\n      if (tipo=='MODIFICADO'||tipo=='COMPROMETIDO') {\n        if (button) {\n          if (vm.buscar.par_seleccionado)\n            model.rows.push({ partida: angular.copy(vm.buscar.par_seleccionado), monto:'0.00' });\n          else showALert('warning', 'Seleccione una partida para adicionar');\n        }\n        else if (vm.buscar.par_seleccionado) model.rows.push({ partida: angular.copy(vm.buscar.par_seleccionado), monto:'0.00' });\n      }\n      else if ( tipo=='INICIAL' )\n        model.rows.push({monto:'0.00'});\n      calcularTotal();\n    }\n    function deleteRow(i) { model.rows.splice(i, 1); calcularTotal(); }\n    function showALert(tipo, mensaje, time) {\n      var icons = {\n        'info': 'info',\n        'warning': 'warning'\n      }\n      vm.alert.show = true;\n      vm.alert.tipo = tipo;\n      vm.alert.mensaje = mensaje;\n      vm.alert.icono = icons[tipo];\n      vm.alert.time = time || 0;\n    }\n  }\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('app')\n    .controller('fcArchivoController', archivos);\n\n  /** @ngInject */\n  function archivos($scope, $timeout, Documento) {\n    var vm = this;\n    var sc = $scope;\n    sc.vm = vm;\n\n    //funciones\n    vm.elegirPdf = elegirPdf;\n    vm.limpiarPdf = limpiarPdf;\n    vm.showPdf = showPdf;\n    vm.redondear = redondear;\n    vm.onLoadModel = onLoadModel;\n\n    $timeout(iniciarController);\n\n    function iniciarController() {\n        vm.form_nuevo = angular.isUndefined(sc.model[sc.options.key]);\n        if(!vm.form_nuevo){\n            if(!sc.to.multiple){\n                sc.model[sc.options.key] = sc.model[sc.options.key][0];\n            }\n        }\n    }\n\n    function showPdf(nombre) { Documento.showPdfx(nombre); }\n    \n\n    function elegirPdf(ev) {\n        angular.element(ev.currentTarget).next().click();\n    }\n\n    function onLoadModel(ev, afiles) {\n        afiles.forEach(function (f, i, arr) {\n            if(f.filetype!=\"application/pdf\"){\n                arr.splice(i, 1);\n                if(sc.to.multiple){\n                    sc.model[sc.options.key].splice(i,1);\n                }else {\n                    delete sc.model[sc.options.key];\n                }\n            }\n        })\n    }\n\n    function limpiarPdf(index) {\n        if(!sc.to.multiple){\n            delete sc.model[sc.options.key]\n        }else {\n            if (index) {\n                sc.model[sc.options.key].splice(index, 1);\n            }else {\n                sc.model[sc.options.key].splice(0, 1);\n            }\n        }\n    }\n\n    function redondear(x, a) {\n        return Math.round(x*Math.pow(10,a))/Math.pow(10,a);\n    }\n\n  }\n})();\n\n(function () {\n  'use strict';\n\n  angular\n  .module('app')\n  .service('FirmaticService', ['$log', '$q',  FirmaticService]);\n\n  /** @ngInject */\n  function FirmaticService($log, $q) {\n    var urlFirmatic = 'https://localhost:4637';\n    var service = {\n      firmarPdf: firmarPdf,\n      verificarEstado: verificarEstado\n    };\n    return service;\n\n    function firmarPdf(documentos, ci) {\n      // $log.log('Iniciando el proceso de firma', documentos);\n      var datos = {\n        archivo: documentos,\n        format: 'pades',\n        language: 'es'\n      };\n      if(angular.isDefined(ci)) datos.ci = ci;\n      var cabeceras = {\n        headers: {\n          'Content-Type': 'application/json'\n          // 'Content-Type': 'application/x-www-form-urlencoded'\n        }\n      };\n      var urlFirma = urlFirmatic + '/sign';\n      return $q(function (resolve, reject) {\n        axios.post(urlFirma, datos, cabeceras)\n        .then(function (respFirma) {\n          // $log.log('Revisando la respuesta de la firma', respFirma);\n          return resolve(respFirma);\n        })\n        .catch(function (errorFirma) {\n          // $log.log('#error en la firma', errorFirma.response);\n          return reject({\n            finalizado: false,\n            message: (errorFirma.response.data.message || errorFirma.response.data) + ' (Error en el firmador.)'\n          });\n        });\n      });\n    }\n\n    function verificarEstado() {\n      var respuesta = {\n        activo: false,\n        mensaje: ''\n      }\n      return $q(function (resolve) {\n        axios.get(urlFirmatic)\n        .then(function (respEstado) {\n          // $log.log('Revisando la respuesta del estado', respEstado);\n          if(respEstado.status === 200) {\n            respuesta.activo = true;\n          }\n          else {\n            $log.log('Error no definido');\n          }\n          return resolve(respuesta);\n        })\n        .catch(function (errorEstado) {\n          respuesta.activo = false;\n          if(errorEstado.message.indexOf('Network Error' > -1)) {\n            respuesta.mensaje = 'El servicio del firmador no se encuentra iniciado.'\n          }\n\n          return resolve(respuesta);\n        });\n      });\n    }\n  }\n  \n})();\n(function() {\n    'use strict';\n    \n    angular\n    .module('app')\n    .service('DemofiService', ['$log', '$q', '$http', '$compile', 'Modal', '$window', 'Message', DemofiService]);\n\n    /** @ngInject */\n    function DemofiService($log, $q, $http, $compile, Modal, $window, Message) {\n\n        var url_demofi = 'https://localhost:3200';\n\n        var service = {\n            openModal: openModal,\n            verificarServidor: verificarServidor,\n            listTokens: listTokens,\n            login: login,\n            listCertificates: listCertificates,\n            sign: sign,\n            logout: logout\n        };\n\n        return service;\n\n        function openModal(solicitudes, config) {\n            //import templateModal from './demofi.modal.html';\n            //import controllerModal from './demofi.modal.controller';\n            return Modal.show({\n                template: './demofi.modal.html', //templateModal,\n                controller: './demofi.modal.controller', //controllerModal,\n                data: { solicitudes: solicitudes, config: config },\n                size: 'lg'\n            });\n        }\n\n        function verificarServidor() {\n            var w = 800;\n            var h = 400;\n            var y = $window.outerHeight / 2 + $window.screenY - (h / 2);\n            var x = $window.outerWidth / 2 + $window.screenX - (w / 2);\n            $window.open(url_demofi,'_blank', 'toolbar=no,status=no,menubar=no,scrollbars=yes,left='+x+', top='+y+', width='+w+', height='+h+', visible=none', '');\n        }\n\n        function listTokens() {\n            var req = url_demofi+'/tokens';\n            return callRequest(req);\n        }\n\n        function login(pinToken) {\n            var req = url_demofi+'/start?pin='+pinToken;\n            return callRequest(req);\n        }\n\n        function listCertificates() {\n            var req = url_demofi+'/certs';\n            return callRequest(req);\n        }\n\n        function sign(solicitudFirma, aliasParaFirmar) {\n            var dataSend = {\n                nombre_archivo: solicitudFirma.codigo_archivo,\n                pdf_base64: solicitudFirma.pdf_base64,\n                alias: aliasParaFirmar\n            };\n\n            return $q(function(resolve, reject) {\n                axios.post(url_demofi+'/sign', dataSend,  {\n                    headers: { 'Content-Type': 'application/x-www-form-urlencoded' }\n                    })\n                  .then(function (response) {\n                    //console.log(response);\n                    resolve(response.data);\n                    return;\n                  })\n                  .catch(function (error) {\n                    //console.log(error);\n                    reject({ finalizado: false, mensaje: \"Demofi no se esta ejecutando en su equipo\" + error });\n                  });\n            });\n        }\n\n        function logout() {\n            var req =  url_demofi + '/finish';\n            return callRequest(req);\n        }\n\n        function callRequest(req) {\n            return $q(function(resolve, reject) {\n                axios.get(req)\n                .then(function (response) {\n                    if (response.data.finalizado === false) {\n                        reject(response.data);\n                        return;\n                    }\n                    resolve(response.data);\n                })\n                .catch(function (error) {\n                    if (error) {\n                        Message.error('Demofi no se esta ejecutando en su equipo.');\n                        reject({ finalizado: false, mensaje: \"Demofi no se esta ejecutando en su equipo\" });\n                    }\n                    else {\n                        Message.error('No se puede conectar con Demofi. Verifique que el programa se este ejecutando en su maquina.');\n                        reject({ finalizado: false, mensaje: \"No se puede conectar con Demofi. Verifique que el programa se este ejecutando en su maquina.\" });\n                    }\n                });\n            });\n        }\n\n    }\n\n})();\n\n\n(function () {\n  'use strict';\n\n  angular\n  .module('app')\n  .controller('VerificarController', VerificarController);\n\n\n  function VerificarController(Message, backUrl, DataService, $log, Documento, Util, $location) {\n    \n    \n    activate();\n    var vm = this;\n    vm.currentNavItem= 'verificar';\n    vm.goto= function(page) {\n      vm.status = 'Go to '+page;\n    };\n\n    vm.data = {\n      selectedIndex: 0\n    };\n\n    vm.next = function () {\n      vm.data.selectedIndex = Math.min(vm.data.selectedIndex +1, 2);\n    };\n    vm.previous = function () {\n      vm.data.selectedIndex = Math.max(vm.data.selectedIndex -1, 0);\n    };\n\n\n    vm.esMovil = Documento.isMobile();\n    \n    \n    vm.buscar = buscar;\n    vm.irInicio = irInicio;\n\n    function activate() {\n      angular.element('body').addClass('no-login');\n      angular.element('body').removeClass('principal');\n    }\n    \n    function buscar() {\n      if(vm.datosDocumento) {\n        vm.datosDocumento = {};\n        vm.pdf = null;\n        vm.pdf_buffer = null;\n      }\n      vm.datos.codigo = vm.datos.codigo.toUpperCase();\n      DataService.post(backUrl + 'verificar', vm.datos)\n      .then(function (respPost) {\n        if(respPost && respPost.tipoMensaje !== 'ERROR') {\n          vm.datosDocumento = respPost.datos;\n          vm.datos.token = respPost.datos.token;\n        }\n        if(respPost ) {\n          DataService.pdf(backUrl + 'pdfVerificado', vm.datos)\n          .then(function (response) {\n            if(response) {\n              vm.pdf = response.url;\n              vm.pdf_buffer = response.data;\n              if (vm.esMovil) {\n                Util.loadCanvas(response.data, '#canvasContainerVerificado');\n              }\n            }\n          })\n        }\n      })\n      .catch(function (error) {\n        Message.error(error);\n      })\n    }\n\n    function irInicio() {\n      $location.path('login');\n    }\n  }\n})();\n\n(function() {\n    'use strict';\n\n    angular\n    .module('app')\n    .controller('MainController', MainController);\n\n    /** @ngInject */\n    function MainController() {\n\n        // var vm = this;        \n\n    }\n\n})();\n\n(function() {\n    'use strict'\n\n    angular\n    .module('app')\n    .component('visorImagenes', {\n        templateUrl : 'app/components/visorImagenes/visorImagenes.html',\n        controller : ['$scope', 'restUrl', 'DataService', 'Storage', 'FileUploader','Modal', VisorImagenesController],\n        controllerAs: 'vm',\n        bindings: {\n            titulo: '=', \n            imagenes: '=', // Lista de archivos subidos\n            ancho: '=',\n            alto: '=',            \n            eliminar: '=',\n            imagenesEliminar: '='            \n        }\n    });\n\n    function VisorImagenesController($scope, restUrl, DataService, Storage, FileUploader,Modal) {\n\n        var vm = this;\n        vm.restUrl = restUrl;\n   \n        // Funcion que elimina una imagen   \n        vm.eliminarImagen = function(pArchivo){\n          // Despliega el modal de confirmacion para eliminar un elemento.\n          Modal.confirm('Se eliminará la foto, ¿Está seguro/a?.', function () {\n            var indice=vm.imagenes.indexOf(pArchivo);\n\n            // Si el elemento existe dentro del vector.\n            if (indice > -1) {\n              // Elimina el elemento, basado en su indice.\n              vm.imagenes.splice(indice, 1);\n              // Agrega el item eliminado a un vector.\n              vm.imagenesEliminar.push(pArchivo);\n            }\n\n          });\n\n        }\n        \n        vm.mostrarImagen = function (ruta) {\n            var config = {                \n                data: ruta,\n                templateUrl: 'app/components/visorImagenes/visorImagenes.dialog.html',\n                controller: ['data', '$scope', '$mdDialog', DialogImagenController]\n            };\n            Modal.show(config);           \n        }\n               \n        function DialogImagenController(data, $scope, $mdDialog) {\n            var vmd = $scope;\n            vmd.cerrar = cerrar;\n\n            vmd.data = data ? data : {};\n\n            // Funcion que cierra el modal.\n            function cerrar() {\n                $mdDialog.hide();\n            }\n        }\n\n\n    } //Fin del controller\n\n\n  })();\n\n(function() {\n    'use strict'\n\n    angular\n    .module('app')\n    .directive('tooltip', ['DataService', 'restUrl', linkTooltipController])\n\n\n    function linkTooltipController(DataService, restUrl){\n\n        var directive = {\n            scope: {\n                doc: '='\n            },\n            restrict: 'E',\n            link: function (sc, elm, attrs, controller) { // eslint-disable-line no-unused-vars\n                elm.hide();\n                DataService.get(restUrl+'plantillasFormly/documento/'+sc.doc.id_documento+'/info')\n                .then(function (respuesta) {\n                    if(respuesta){\n                        var $td = elm.parent().parent().parent().parent().parent().parent().parent();\n                        $td.append(createTooltip(respuesta.datos));\n                        var $card = $td.children('md-card');\n                        $card.hide();\n                        elm.parent().mouseover(function () {\n                            $card.show();\n                            elm.parent().css('cursor','pointer');\n                        })\n                        elm.parent().mouseout(function () {\n                            $card.hide();\n                            elm.parent().css('cursor','normal');\n                        })\n                    }\n\n                })\n            }\n        };\n        function createTooltip(html) {\n            var new_html = '';\n            new_html += '<md-card class=\"ap-tooltip\"><md-card-content>';\n            new_html += html;\n            new_html += '</md-card-content></md-card>';\n            return new_html;\n        }\n\n        return directive;\n    }\n\n  })();\n\n/* eslint-disable */\n/*!\n* Simditor v2.3.6\n* http://simditor.tower.im/\n* 2015-12-21\n*/\n(function (root, factory) {\n  if (typeof define === 'function' && define.amd) {\n    // AMD. Register as an anonymous module unless amdModuleId is set\n    define('simditor', [\"jquery\",\"simple-module\",\"simple-hotkeys\",\"simple-uploader\"], function ($, SimpleModule, simpleHotkeys, simpleUploader) {\n      return (root['Simditor'] = factory($, SimpleModule, simpleHotkeys, simpleUploader));\n    });\n  } else if (typeof exports === 'object') {\n    // Node. Does not work with strict CommonJS, but\n    // only CommonJS-like environments that support module.exports,\n    // like Node.\n    module.exports = factory(require(\"jquery\"),require(\"simple-module\"),require(\"simple-hotkeys\"),require(\"simple-uploader\"));\n  } else {\n    root['Simditor'] = factory(jQuery,SimpleModule,simple.hotkeys,simple.uploader);\n  }\n}(this, function ($, SimpleModule, simpleHotkeys, simpleUploader) {\n\nvar AlignmentButton, BlockquoteButton, BoldButton, Button, Clipboard, CodeButton, CodePopover, ColorButton, FontScaleButton, Formatter, HrButton, ImageButton, ImagePopover, IndentButton, Indentation, InputManager, ItalicButton, Keystroke, LinkButton, LinkPopover, ListButton, OrderListButton, OutdentButton, Popover, Selection, Simditor, StrikethroughButton, TableButton, TitleButton, Toolbar, UnderlineButton, UndoManager, UnorderListButton, Util,\n  extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },\n  hasProp = {}.hasOwnProperty,\n  indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; },\n  slice = [].slice;\n\nSelection = (function(superClass) {\n  extend(Selection, superClass);\n\n  function Selection() {\n    return Selection.__super__.constructor.apply(this, arguments);\n  }\n\n  Selection.pluginName = 'Selection';\n\n  Selection.prototype._range = null;\n\n  Selection.prototype._startNodes = null;\n\n  Selection.prototype._endNodes = null;\n\n  Selection.prototype._containerNode = null;\n\n  Selection.prototype._nodes = null;\n\n  Selection.prototype._blockNodes = null;\n\n  Selection.prototype._rootNodes = null;\n\n  Selection.prototype._init = function() {\n    this.editor = this._module;\n    this._selection = document.getSelection();\n    this.editor.on('selectionchanged', (function(_this) {\n      return function(e) {\n        _this.reset();\n        return _this._range = _this._selection.getRangeAt(0);\n      };\n    })(this));\n    return this.editor.on('blur', (function(_this) {\n      return function(e) {\n        return _this.reset();\n      };\n    })(this));\n  };\n\n  Selection.prototype.reset = function() {\n    this._range = null;\n    this._startNodes = null;\n    this._endNodes = null;\n    this._containerNode = null;\n    this._nodes = null;\n    this._blockNodes = null;\n    return this._rootNodes = null;\n  };\n\n  Selection.prototype.clear = function() {\n    var e;\n    try {\n      this._selection.removeAllRanges();\n    } catch (_error) {\n      e = _error;\n    }\n    return this.reset();\n  };\n\n  Selection.prototype.range = function(range) {\n    var ffOrIE;\n    if (range) {\n      this.clear();\n      this._selection.addRange(range);\n      this._range = range;\n      ffOrIE = this.editor.util.browser.firefox || this.editor.util.browser.msie;\n      if (!this.editor.inputManager.focused && ffOrIE) {\n        this.editor.body.focus();\n      }\n    } else if (!this._range && this.editor.inputManager.focused && this._selection.rangeCount) {\n      this._range = this._selection.getRangeAt(0);\n    }\n    return this._range;\n  };\n\n  Selection.prototype.startNodes = function() {\n    if (this._range) {\n      this._startNodes || (this._startNodes = (function(_this) {\n        return function() {\n          var startNodes;\n          startNodes = $(_this._range.startContainer).parentsUntil(_this.editor.body).get();\n          startNodes.unshift(_this._range.startContainer);\n          return $(startNodes);\n        };\n      })(this)());\n    }\n    return this._startNodes;\n  };\n\n  Selection.prototype.endNodes = function() {\n    var endNodes;\n    if (this._range) {\n      this._endNodes || (this._endNodes = this._range.collapsed ? this.startNodes() : (endNodes = $(this._range.endContainer).parentsUntil(this.editor.body).get(), endNodes.unshift(this._range.endContainer), $(endNodes)));\n    }\n    return this._endNodes;\n  };\n\n  Selection.prototype.containerNode = function() {\n    if (this._range) {\n      this._containerNode || (this._containerNode = $(this._range.commonAncestorContainer));\n    }\n    return this._containerNode;\n  };\n\n  Selection.prototype.nodes = function() {\n    if (this._range) {\n      this._nodes || (this._nodes = (function(_this) {\n        return function() {\n          var nodes;\n          nodes = [];\n          if (_this.startNodes().first().is(_this.endNodes().first())) {\n            nodes = _this.startNodes().get();\n          } else {\n            _this.startNodes().each(function(i, node) {\n              var $endNode, $node, $nodes, endIndex, index, sharedIndex, startIndex;\n              $node = $(node);\n              if (_this.endNodes().index($node) > -1) {\n                return nodes.push(node);\n              } else if ($node.parent().is(_this.editor.body) || (sharedIndex = _this.endNodes().index($node.parent())) > -1) {\n                if (sharedIndex && sharedIndex > -1) {\n                  $endNode = _this.endNodes().eq(sharedIndex - 1);\n                } else {\n                  $endNode = _this.endNodes().last();\n                }\n                $nodes = $node.parent().contents();\n                startIndex = $nodes.index($node);\n                endIndex = $nodes.index($endNode);\n                return $.merge(nodes, $nodes.slice(startIndex, endIndex).get());\n              } else {\n                $nodes = $node.parent().contents();\n                index = $nodes.index($node);\n                return $.merge(nodes, $nodes.slice(index).get());\n              }\n            });\n            _this.endNodes().each(function(i, node) {\n              var $node, $nodes, index;\n              $node = $(node);\n              if ($node.parent().is(_this.editor.body) || _this.startNodes().index($node.parent()) > -1) {\n                nodes.push(node);\n                return false;\n              } else {\n                $nodes = $node.parent().contents();\n                index = $nodes.index($node);\n                return $.merge(nodes, $nodes.slice(0, index + 1));\n              }\n            });\n          }\n          return $($.unique(nodes));\n        };\n      })(this)());\n    }\n    return this._nodes;\n  };\n\n  Selection.prototype.blockNodes = function() {\n    if (!this._range) {\n      return;\n    }\n    this._blockNodes || (this._blockNodes = (function(_this) {\n      return function() {\n        return _this.nodes().filter(function(i, node) {\n          return _this.editor.util.isBlockNode(node);\n        });\n      };\n    })(this)());\n    return this._blockNodes;\n  };\n\n  Selection.prototype.rootNodes = function() {\n    if (!this._range) {\n      return;\n    }\n    this._rootNodes || (this._rootNodes = (function(_this) {\n      return function() {\n        return _this.nodes().filter(function(i, node) {\n          var $parent;\n          $parent = $(node).parent();\n          return $parent.is(_this.editor.body) || $parent.is('blockquote');\n        });\n      };\n    })(this)());\n    return this._rootNodes;\n  };\n\n  Selection.prototype.rangeAtEndOf = function(node, range) {\n    var afterLastNode, beforeLastNode, endNode, endNodeLength, lastNodeIsBr, result;\n    if (range == null) {\n      range = this.range();\n    }\n    if (!(range && range.collapsed)) {\n      return;\n    }\n    node = $(node)[0];\n    endNode = range.endContainer;\n    endNodeLength = this.editor.util.getNodeLength(endNode);\n    beforeLastNode = range.endOffset === endNodeLength - 1;\n    lastNodeIsBr = $(endNode).contents().last().is('br');\n    afterLastNode = range.endOffset === endNodeLength;\n    if (!((beforeLastNode && lastNodeIsBr) || afterLastNode)) {\n      return false;\n    }\n    if (node === endNode) {\n      return true;\n    } else if (!$.contains(node, endNode)) {\n      return false;\n    }\n    result = true;\n    $(endNode).parentsUntil(node).addBack().each(function(i, n) {\n      var $lastChild, beforeLastbr, isLastNode, nodes;\n      nodes = $(n).parent().contents().filter(function() {\n        return !(this !== n && this.nodeType === 3 && !this.nodeValue);\n      });\n      $lastChild = nodes.last();\n      isLastNode = $lastChild.get(0) === n;\n      beforeLastbr = $lastChild.is('br') && $lastChild.prev().get(0) === n;\n      if (!(isLastNode || beforeLastbr)) {\n        result = false;\n        return false;\n      }\n    });\n    return result;\n  };\n\n  Selection.prototype.rangeAtStartOf = function(node, range) {\n    var result, startNode;\n    if (range == null) {\n      range = this.range();\n    }\n    if (!(range && range.collapsed)) {\n      return;\n    }\n    node = $(node)[0];\n    startNode = range.startContainer;\n    if (range.startOffset !== 0) {\n      return false;\n    }\n    if (node === startNode) {\n      return true;\n    } else if (!$.contains(node, startNode)) {\n      return false;\n    }\n    result = true;\n    $(startNode).parentsUntil(node).addBack().each(function(i, n) {\n      var nodes;\n      nodes = $(n).parent().contents().filter(function() {\n        return !(this !== n && this.nodeType === 3 && !this.nodeValue);\n      });\n      if (nodes.first().get(0) !== n) {\n        return result = false;\n      }\n    });\n    return result;\n  };\n\n  Selection.prototype.insertNode = function(node, range) {\n    if (range == null) {\n      range = this.range();\n    }\n    if (!range) {\n      return;\n    }\n    node = $(node)[0];\n    range.insertNode(node);\n    return this.setRangeAfter(node, range);\n  };\n\n  Selection.prototype.setRangeAfter = function(node, range) {\n    if (range == null) {\n      range = this.range();\n    }\n    if (range == null) {\n      return;\n    }\n    node = $(node)[0];\n    range.setEndAfter(node);\n    range.collapse(false);\n    return this.range(range);\n  };\n\n  Selection.prototype.setRangeBefore = function(node, range) {\n    if (range == null) {\n      range = this.range();\n    }\n    if (range == null) {\n      return;\n    }\n    node = $(node)[0];\n    range.setEndBefore(node);\n    range.collapse(false);\n    return this.range(range);\n  };\n\n  Selection.prototype.setRangeAtStartOf = function(node, range) {\n    if (range == null) {\n      range = this.range();\n    }\n    node = $(node).get(0);\n    range.setEnd(node, 0);\n    range.collapse(false);\n    return this.range(range);\n  };\n\n  Selection.prototype.setRangeAtEndOf = function(node, range) {\n    var $lastNode, $node, contents, lastChild, lastChildLength, lastText, nodeLength;\n    if (range == null) {\n      range = this.range();\n    }\n    $node = $(node);\n    node = $node[0];\n    if ($node.is('pre')) {\n      contents = $node.contents();\n      if (contents.length > 0) {\n        lastChild = contents.last();\n        lastText = lastChild.text();\n        lastChildLength = this.editor.util.getNodeLength(lastChild[0]);\n        if (lastText.charAt(lastText.length - 1) === '\\n') {\n          range.setEnd(lastChild[0], lastChildLength - 1);\n        } else {\n          range.setEnd(lastChild[0], lastChildLength);\n        }\n      } else {\n        range.setEnd(node, 0);\n      }\n    } else {\n      nodeLength = this.editor.util.getNodeLength(node);\n      if (node.nodeType !== 3 && nodeLength > 0) {\n        $lastNode = $(node).contents().last();\n        if ($lastNode.is('br')) {\n          nodeLength -= 1;\n        } else if ($lastNode[0].nodeType !== 3 && this.editor.util.isEmptyNode($lastNode)) {\n          $lastNode.append(this.editor.util.phBr);\n          node = $lastNode[0];\n          nodeLength = 0;\n        }\n      }\n      range.setEnd(node, nodeLength);\n    }\n    range.collapse(false);\n    return this.range(range);\n  };\n\n  Selection.prototype.deleteRangeContents = function(range) {\n    var atEndOfBody, atStartOfBody, endRange, startRange;\n    if (range == null) {\n      range = this.range();\n    }\n    startRange = range.cloneRange();\n    endRange = range.cloneRange();\n    startRange.collapse(true);\n    endRange.collapse(false);\n    atStartOfBody = this.rangeAtStartOf(this.editor.body, startRange);\n    atEndOfBody = this.rangeAtEndOf(this.editor.body, endRange);\n    if (!range.collapsed && atStartOfBody && atEndOfBody) {\n      this.editor.body.empty();\n      range.setStart(this.editor.body[0], 0);\n      range.collapse(true);\n      this.range(range);\n    } else {\n      range.deleteContents();\n    }\n    return range;\n  };\n\n  Selection.prototype.breakBlockEl = function(el, range) {\n    var $el;\n    if (range == null) {\n      range = this.range();\n    }\n    $el = $(el);\n    if (!range.collapsed) {\n      return $el;\n    }\n    range.setStartBefore($el.get(0));\n    if (range.collapsed) {\n      return $el;\n    }\n    return $el.before(range.extractContents());\n  };\n\n  Selection.prototype.save = function(range) {\n    var endCaret, endRange, startCaret;\n    if (range == null) {\n      range = this.range();\n    }\n    if (this._selectionSaved) {\n      return;\n    }\n    endRange = range.cloneRange();\n    endRange.collapse(false);\n    startCaret = $('<span/>').addClass('simditor-caret-start');\n    endCaret = $('<span/>').addClass('simditor-caret-end');\n    endRange.insertNode(endCaret[0]);\n    range.insertNode(startCaret[0]);\n    this.clear();\n    return this._selectionSaved = true;\n  };\n\n  Selection.prototype.restore = function() {\n    var endCaret, endContainer, endOffset, range, startCaret, startContainer, startOffset;\n    if (!this._selectionSaved) {\n      return false;\n    }\n    startCaret = this.editor.body.find('.simditor-caret-start');\n    endCaret = this.editor.body.find('.simditor-caret-end');\n    if (startCaret.length && endCaret.length) {\n      startContainer = startCaret.parent();\n      startOffset = startContainer.contents().index(startCaret);\n      endContainer = endCaret.parent();\n      endOffset = endContainer.contents().index(endCaret);\n      if (startContainer[0] === endContainer[0]) {\n        endOffset -= 1;\n      }\n      range = document.createRange();\n      range.setStart(startContainer.get(0), startOffset);\n      range.setEnd(endContainer.get(0), endOffset);\n      startCaret.remove();\n      endCaret.remove();\n      this.range(range);\n    } else {\n      startCaret.remove();\n      endCaret.remove();\n    }\n    this._selectionSaved = false;\n    return range;\n  };\n\n  return Selection;\n\n})(SimpleModule);\n\nFormatter = (function(superClass) {\n  extend(Formatter, superClass);\n\n  function Formatter() {\n    return Formatter.__super__.constructor.apply(this, arguments);\n  }\n\n  Formatter.pluginName = 'Formatter';\n\n  Formatter.prototype.opts = {\n    allowedTags: [],\n    allowedAttributes: {},\n    allowedStyles: {}\n  };\n\n  Formatter.prototype._init = function() {//mod-for-jl\n    this.editor = this._module;\n    this._allowedTags = $.merge(['br', 'span', 'a', 'img',' strong', 'strike', 'u', 'p', 'ol', 'li', 'blockquote', 'pre', 'code', 'h1', 'h2', 'h3', 'h4', 'hr'], this.opts.allowedTags);\n    this._allowedAttributes = $.extend({\n      img: ['src', 'alt', 'width', 'height', 'data-non-image'],\n      a: ['href', 'target'],\n      code: ['class']\n    }, this.opts.allowedAttributes);\n    this._allowedStyles = $.extend({\n      p: ['margin-left', 'text-align'],\n      h1: ['margin-left', 'text-align'],\n      h2: ['margin-left', 'text-align'],\n      h3: ['margin-left', 'text-align'],\n      h4: ['margin-left', 'text-align']\n    }, this.opts.allowedStyles);\n    return this.editor.body.on('click', 'a', function(e) {\n      return false;\n    });\n  };\n\n  Formatter.prototype.decorate = function($el) {\n    if ($el == null) {\n      $el = this.editor.body;\n    }\n    this.editor.trigger('decorate', [$el]);\n    return $el;\n  };\n\n  Formatter.prototype.undecorate = function($el) {\n    if ($el == null) {\n      $el = this.editor.body.clone();\n    }\n    this.editor.trigger('undecorate', [$el]);\n    return $el;\n  };\n\n  Formatter.prototype.autolink = function($el) {\n    var $link, $node, findLinkNode, k, lastIndex, len, linkNodes, match, re, replaceEls, subStr, text, uri;\n    if ($el == null) {\n      $el = this.editor.body;\n    }\n    linkNodes = [];\n    findLinkNode = function($parentNode) {\n      return $parentNode.contents().each(function(i, node) {\n        var $node, text;\n        $node = $(node);\n        if ($node.is('a') || $node.closest('a, pre', $el).length) {\n          return;\n        }\n        if (!$node.is('iframe') && $node.contents().length) {\n          return findLinkNode($node);\n        } else if ((text = $node.text()) && /https?:\\/\\/|www\\./ig.test(text)) {\n          return linkNodes.push($node);\n        }\n      });\n    };\n    findLinkNode($el);\n    re = /(https?:\\/\\/|www\\.)[\\w\\-\\.\\?&=\\/#%:,@\\!\\+]+/ig;\n    for (k = 0, len = linkNodes.length; k < len; k++) {\n      $node = linkNodes[k];\n      text = $node.text();\n      replaceEls = [];\n      match = null;\n      lastIndex = 0;\n      while ((match = re.exec(text)) !== null) {\n        subStr = text.substring(lastIndex, match.index);\n        replaceEls.push(document.createTextNode(subStr));\n        lastIndex = re.lastIndex;\n        uri = /^(http(s)?:\\/\\/|\\/)/.test(match[0]) ? match[0] : 'http://' + match[0];\n        $link = $(\"<a href=\\\"\" + uri + \"\\\" rel=\\\"nofollow\\\"></a>\").text(match[0]);\n        replaceEls.push($link[0]);\n      }\n      replaceEls.push(document.createTextNode(text.substring(lastIndex)));\n      $node.replaceWith($(replaceEls));\n    }\n    return $el;\n  };\n\n  Formatter.prototype.format = function($el) {\n    var $node, blockNode, k, l, len, len1, n, node, ref, ref1;\n    if ($el == null) {\n      $el = this.editor.body;\n    }\n\n    if ($el.is(':empty')) {\n      $el.append('<p>' + this.editor.util.phBr + '</p>');\n      return $el;\n    }\n    ref = $el.contents();\n    for (k = 0, len = ref.length; k < len; k++) {\n      n = ref[k];\n      this.cleanNode(n, true);\n    }\n    ref1 = $el.contents();\n    for (l = 0, len1 = ref1.length; l < len1; l++) {\n      node = ref1[l];\n      $node = $(node);\n      if ($node.is('br')) {\n        if (typeof blockNode !== \"undefined\" && blockNode !== null) {\n          blockNode = null;\n        }\n        $node.remove();\n      } else if (this.editor.util.isBlockNode(node)) {\n        if ($node.is('li')) {\n          if (blockNode && blockNode.is('ul, ol')) {\n            blockNode.append(node);\n          } else {\n            blockNode = $('<ul/>').insertBefore(node);\n            blockNode.append(node);\n          }\n        } else {\n          blockNode = null;\n        }\n      } else {\n        if (!blockNode || blockNode.is('ul, ol')) {\n          blockNode = $('<p/>').insertBefore(node);\n        }\n        blockNode.append(node);\n        if (this.editor.util.isEmptyNode(blockNode)) {\n          blockNode.append(this.editor.util.phBr);\n        }\n      }\n    }\n    return $el;\n  };\n\n  Formatter.prototype.cleanNode = function(node, recursive) {\n    var $blockEls, $childImg, $node, $p, $td, allowedAttributes, attr, contents, isDecoration, k, l, len, len1, n, ref, ref1, text, textNode;\n    $node = $(node);\n    if (!($node.length > 0)) {\n      return;\n    }\n    if ($node[0].nodeType === 3) {\n      text = $node.text().replace(/(\\r\\n|\\n|\\r)/gm, '');\n      if (text) {\n        textNode = document.createTextNode(text);\n        $node.replaceWith(textNode);\n      } else {\n        $node.remove();\n      }\n      return;\n    }\n    contents = $node.is('iframe') ? null : $node.contents();\n    isDecoration = this.editor.util.isDecoratedNode($node);\n    if ($node.is(this._allowedTags.join(',')) || isDecoration) {\n      if ($node.is('a') && ($childImg = $node.find('img')).length > 0) {\n        $node.replaceWith($childImg);\n        $node = $childImg;\n        contents = null;\n      }\n      if ($node.is('td') && ($blockEls = $node.find(this.editor.util.blockNodes.join(','))).length > 0) {\n        $blockEls.each((function(_this) {\n          return function(i, blockEl) {\n            return $(blockEl).contents().unwrap();\n          };\n        })(this));\n        contents = $node.contents();\n      }\n      if ($node.is('img') && $node.hasClass('uploading')) {\n        $node.remove();\n      }\n      if (!isDecoration) {\n        allowedAttributes = this._allowedAttributes[$node[0].tagName.toLowerCase()];\n        ref = $.makeArray($node[0].attributes);\n        for (k = 0, len = ref.length; k < len; k++) {\n          attr = ref[k];\n          if (attr.name === 'style') {\n            continue;\n          }\n          if (!((allowedAttributes != null) && (ref1 = attr.name, indexOf.call(allowedAttributes, ref1) >= 0))) {\n            $node.removeAttr(attr.name);\n          }\n        }\n        this._cleanNodeStyles($node);\n        if ($node.is('span') && $node[0].attributes.length === 0) {\n          $node.contents().first().unwrap();\n        }\n      }\n    } else if ($node[0].nodeType === 1 && !$node.is(':empty')) {\n      if ($node.is('div, article, dl, header, footer, tr')) {\n        $node.append('<br/>');\n        contents.first().unwrap();\n      } else if ($node.is('table')) {\n        $p = $('<p/>');\n        $node.find('tr').each(function(i, tr) {\n          return $p.append($(tr).text() + '<br/>');\n        });\n        $node.replaceWith($p);\n        contents = null;\n      } else if ($node.is('thead, tfoot')) {\n        $node.remove();\n        contents = null;\n      } else if ($node.is('th')) {\n        $td = $('<td/>').append($node.contents());\n        $node.replaceWith($td);\n      } else {\n        contents.first().unwrap();\n      }\n    } else {\n      $node.remove();\n      contents = null;\n    }\n    if (recursive && (contents != null) && !$node.is('pre')) {\n      for (l = 0, len1 = contents.length; l < len1; l++) {\n        n = contents[l];\n        this.cleanNode(n, true);\n      }\n    }\n    return null;\n  };\n\n  Formatter.prototype._cleanNodeStyles = function($node) {\n    var allowedStyles, k, len, pair, ref, ref1, style, styleStr, styles;\n    styleStr = $node.attr('style');\n    if (!styleStr) {\n      return;\n    }\n    $node.removeAttr('style');\n    allowedStyles = this._allowedStyles[$node[0].tagName.toLowerCase()];\n    if (!(allowedStyles && allowedStyles.length > 0)) {\n      return $node;\n    }\n    styles = {};\n    ref = styleStr.split(';');\n    for (k = 0, len = ref.length; k < len; k++) {\n      style = ref[k];\n      style = $.trim(style);\n      pair = style.split(':');\n      if (!(pair.length = 2)) {\n        continue;\n      }\n      if (ref1 = pair[0], indexOf.call(allowedStyles, ref1) >= 0) {\n        styles[$.trim(pair[0])] = $.trim(pair[1]);\n      }\n    }\n    if (Object.keys(styles).length > 0) {\n      $node.css(styles);\n    }\n    return $node;\n  };\n\n  Formatter.prototype.clearHtml = function(html, lineBreak) {\n    var container, contents, result;\n    if (lineBreak == null) {\n      lineBreak = true;\n    }\n    container = $('<div/>').append(html);\n    contents = container.contents();\n    result = '';\n    contents.each((function(_this) {\n      return function(i, node) {\n        var $node, children;\n        if (node.nodeType === 3) {\n          return result += node.nodeValue;\n        } else if (node.nodeType === 1) {\n          $node = $(node);\n          children = $node.is('iframe') ? null : $node.contents();\n          if (children && children.length > 0) {\n            result += _this.clearHtml(children);\n          }\n          if (lineBreak && i < contents.length - 1 && $node.is('br, p, div, li,tr, pre, address, artticle, aside, dl, figcaption, footer, h1, h2,h3, h4, header')) {\n            return result += '\\n';\n          }\n        }\n      };\n    })(this));\n    return result;\n  };\n\n  Formatter.prototype.beautify = function($contents) {\n    var uselessP;\n    uselessP = function($el) {\n      return !!($el.is('p') && !$el.text() && $el.children(':not(br)').length < 1);\n    };\n    return $contents.each(function(i, el) {\n      var $el, invalid;\n      $el = $(el);\n      invalid = $el.is(':not(img, br, col, td, hr, [class^=\"simditor-\"]):empty');\n      if (invalid || uselessP($el)) {\n        $el.remove();\n      }\n      return $el.find(':not(img, br, col, td, hr, [class^=\"simditor-\"]):empty').remove();\n    });\n  };\n\n  return Formatter;\n\n})(SimpleModule);\n\nInputManager = (function(superClass) {\n  extend(InputManager, superClass);\n\n  function InputManager() {\n    return InputManager.__super__.constructor.apply(this, arguments);\n  }\n\n  InputManager.pluginName = 'InputManager';\n\n  InputManager.prototype._modifierKeys = [16, 17, 18, 91, 93, 224];\n\n  InputManager.prototype._arrowKeys = [37, 38, 39, 40];\n\n  InputManager.prototype._init = function() {\n    var selectAllKey, submitKey;\n    this.editor = this._module;\n    this.throttledValueChanged = this.editor.util.throttle((function(_this) {\n      return function(params) {\n        return setTimeout(function() {\n          return _this.editor.trigger('valuechanged', params);\n        }, 10);\n      };\n    })(this), 300);\n    this.throttledSelectionChanged = this.editor.util.throttle((function(_this) {\n      return function() {\n        return _this.editor.trigger('selectionchanged');\n      };\n    })(this), 50);\n    $(document).on('selectionchange.simditor' + this.editor.id, (function(_this) {\n      return function(e) {\n        var triggerEvent;\n        if (!(_this.focused && !_this.editor.clipboard.pasting)) {\n          return;\n        }\n        triggerEvent = function() {\n          if (_this._selectionTimer) {\n            clearTimeout(_this._selectionTimer);\n            _this._selectionTimer = null;\n          }\n          if (_this.editor.selection._selection.rangeCount > 0) {\n            return _this.throttledSelectionChanged();\n          } else {\n            return _this._selectionTimer = setTimeout(function() {\n              _this._selectionTimer = null;\n              if (_this.focused) {\n                return triggerEvent();\n              }\n            }, 10);\n          }\n        };\n        return triggerEvent();\n      };\n    })(this));\n    this.editor.on('valuechanged', (function(_this) {\n      return function() {\n        var $rootBlocks;\n        _this.lastCaretPosition = null;\n        $rootBlocks = _this.editor.body.children().filter(function(i, node) {\n          return _this.editor.util.isBlockNode(node);\n        });\n        if (_this.focused && $rootBlocks.length === 0) {\n          _this.editor.selection.save();\n          _this.editor.formatter.format();\n          _this.editor.selection.restore();\n        }\n        _this.editor.body.find('hr, pre, .simditor-table').each(function(i, el) {\n          var $el, formatted;\n          $el = $(el);\n          if ($el.parent().is('blockquote') || $el.parent()[0] === _this.editor.body[0]) {\n            formatted = false;\n            if ($el.next().length === 0) {\n              $('<p/>').append(_this.editor.util.phBr).insertAfter($el);\n              formatted = true;\n            }\n            if ($el.prev().length === 0) {\n              $('<p/>').append(_this.editor.util.phBr).insertBefore($el);\n              formatted = true;\n            }\n            if (formatted) {\n              return _this.throttledValueChanged();\n            }\n          }\n        });\n        _this.editor.body.find('pre:empty').append(_this.editor.util.phBr);\n        if (!_this.editor.util.support.onselectionchange && _this.focused) {\n          return _this.throttledSelectionChanged();\n        }\n      };\n    })(this));\n    this.editor.body.on('keydown', $.proxy(this._onKeyDown, this)).on('keypress', $.proxy(this._onKeyPress, this)).on('keyup', $.proxy(this._onKeyUp, this)).on('mouseup', $.proxy(this._onMouseUp, this)).on('focus', $.proxy(this._onFocus, this)).on('blur', $.proxy(this._onBlur, this)).on('drop', $.proxy(this._onDrop, this)).on('input', $.proxy(this._onInput, this));\n    if (this.editor.util.browser.firefox) {\n      this.editor.hotkeys.add('cmd+left', (function(_this) {\n        return function(e) {\n          e.preventDefault();\n          _this.editor.selection._selection.modify('move', 'backward', 'lineboundary');\n          return false;\n        };\n      })(this));\n      this.editor.hotkeys.add('cmd+right', (function(_this) {\n        return function(e) {\n          e.preventDefault();\n          _this.editor.selection._selection.modify('move', 'forward', 'lineboundary');\n          return false;\n        };\n      })(this));\n      selectAllKey = this.editor.util.os.mac ? 'cmd+a' : 'ctrl+a';\n      this.editor.hotkeys.add(selectAllKey, (function(_this) {\n        return function(e) {\n          var $children, firstBlock, lastBlock, range;\n          $children = _this.editor.body.children();\n          if (!($children.length > 0)) {\n            return;\n          }\n          firstBlock = $children.first().get(0);\n          lastBlock = $children.last().get(0);\n          range = document.createRange();\n          range.setStart(firstBlock, 0);\n          range.setEnd(lastBlock, _this.editor.util.getNodeLength(lastBlock));\n          _this.editor.selection.range(range);\n          return false;\n        };\n      })(this));\n    }\n    submitKey = this.editor.util.os.mac ? 'cmd+enter' : 'ctrl+enter';\n    return this.editor.hotkeys.add(submitKey, (function(_this) {\n      return function(e) {\n        _this.editor.el.closest('form').find('button:submit').click();\n        return false;\n      };\n    })(this));\n  };\n\n  InputManager.prototype._onFocus = function(e) {\n    if (this.editor.clipboard.pasting) {\n      return;\n    }\n    this.editor.el.addClass('focus').removeClass('error');\n    this.focused = true;\n    return setTimeout((function(_this) {\n      return function() {\n        var $blockEl, range;\n        range = _this.editor.selection._selection.getRangeAt(0);\n        if (range.startContainer === _this.editor.body[0]) {\n          if (_this.lastCaretPosition) {\n            _this.editor.undoManager.caretPosition(_this.lastCaretPosition);\n          } else {\n            $blockEl = _this.editor.body.children().first();\n            range = document.createRange();\n            _this.editor.selection.setRangeAtStartOf($blockEl, range);\n          }\n        }\n        _this.lastCaretPosition = null;\n        _this.editor.triggerHandler('focus');\n        if (!_this.editor.util.support.onselectionchange) {\n          return _this.throttledSelectionChanged();\n        }\n      };\n    })(this), 0);\n  };\n\n  InputManager.prototype._onBlur = function(e) {\n    var ref;\n    if (this.editor.clipboard.pasting) {\n      return;\n    }\n    this.editor.el.removeClass('focus');\n    this.editor.sync();\n    this.focused = false;\n    this.lastCaretPosition = (ref = this.editor.undoManager.currentState()) != null ? ref.caret : void 0;\n    return this.editor.triggerHandler('blur');\n  };\n\n  InputManager.prototype._onMouseUp = function(e) {\n    if (!this.editor.util.support.onselectionchange) {\n      return this.throttledSelectionChanged();\n    }\n  };\n\n  InputManager.prototype._onKeyDown = function(e) {\n    var ref, ref1;\n    if (this.editor.triggerHandler(e) === false) {\n      return false;\n    }\n    if (this.editor.hotkeys.respondTo(e)) {\n      return;\n    }\n    if (this.editor.keystroke.respondTo(e)) {\n      this.throttledValueChanged();\n      return false;\n    }\n    if ((ref = e.which, indexOf.call(this._modifierKeys, ref) >= 0) || (ref1 = e.which, indexOf.call(this._arrowKeys, ref1) >= 0)) {\n      return;\n    }\n    if (this.editor.util.metaKey(e) && e.which === 86) {\n      return;\n    }\n    if (!this.editor.util.support.oninput) {\n      this.throttledValueChanged(['typing']);\n    }\n    return null;\n  };\n\n  InputManager.prototype._onKeyPress = function(e) {\n    if (this.editor.triggerHandler(e) === false) {\n      return false;\n    }\n  };\n\n  InputManager.prototype._onKeyUp = function(e) {\n    var p, ref;\n    if (this.editor.triggerHandler(e) === false) {\n      return false;\n    }\n    if (!this.editor.util.support.onselectionchange && (ref = e.which, indexOf.call(this._arrowKeys, ref) >= 0)) {\n      this.throttledValueChanged();\n      return;\n    }\n    if ((e.which === 8 || e.which === 46) && this.editor.util.isEmptyNode(this.editor.body)) {\n      this.editor.body.empty();\n      p = $('<p/>').append(this.editor.util.phBr).appendTo(this.editor.body);\n      this.editor.selection.setRangeAtStartOf(p);\n    }\n  };\n\n  InputManager.prototype._onDrop = function(e) {\n    if (this.editor.triggerHandler(e) === false) {\n      return false;\n    }\n    return this.throttledValueChanged();\n  };\n\n  InputManager.prototype._onInput = function(e) {\n    return this.throttledValueChanged(['oninput']);\n  };\n\n  return InputManager;\n\n})(SimpleModule);\n\nKeystroke = (function(superClass) {\n  extend(Keystroke, superClass);\n\n  function Keystroke() {\n    return Keystroke.__super__.constructor.apply(this, arguments);\n  }\n\n  Keystroke.pluginName = 'Keystroke';\n\n  Keystroke.prototype._init = function() {\n    this.editor = this._module;\n    this._keystrokeHandlers = {};\n    return this._initKeystrokeHandlers();\n  };\n\n  Keystroke.prototype.add = function(key, node, handler) {\n    key = key.toLowerCase();\n    key = this.editor.hotkeys.constructor.aliases[key] || key;\n    if (!this._keystrokeHandlers[key]) {\n      this._keystrokeHandlers[key] = {};\n    }\n    return this._keystrokeHandlers[key][node] = handler;\n  };\n\n  Keystroke.prototype.respondTo = function(e) {\n    var base, key, ref, result;\n    key = (ref = this.editor.hotkeys.constructor.keyNameMap[e.which]) != null ? ref.toLowerCase() : void 0;\n    if (!key) {\n      return;\n    }\n    if (key in this._keystrokeHandlers) {\n      result = typeof (base = this._keystrokeHandlers[key])['*'] === \"function\" ? base['*'](e) : void 0;\n      if (!result) {\n        this.editor.selection.startNodes().each((function(_this) {\n          return function(i, node) {\n            var handler, ref1;\n            if (node.nodeType !== Node.ELEMENT_NODE) {\n              return;\n            }\n            handler = (ref1 = _this._keystrokeHandlers[key]) != null ? ref1[node.tagName.toLowerCase()] : void 0;\n            result = typeof handler === \"function\" ? handler(e, $(node)) : void 0;\n            if (result === true || result === false) {\n              return false;\n            }\n          };\n        })(this));\n      }\n      if (result) {\n        return true;\n      }\n    }\n  };\n\n  Keystroke.prototype._initKeystrokeHandlers = function() {\n    var titleEnterHandler;\n    if (this.editor.util.browser.safari) {\n      this.add('enter', '*', (function(_this) {\n        return function(e) {\n          var $blockEl, $br;\n          if (!e.shiftKey) {\n            return;\n          }\n          $blockEl = _this.editor.selection.blockNodes().last();\n          if ($blockEl.is('pre')) {\n            return;\n          }\n          $br = $('<br/>');\n          if (_this.editor.selection.rangeAtEndOf($blockEl)) {\n            _this.editor.selection.insertNode($br);\n            _this.editor.selection.insertNode($('<br/>'));\n            _this.editor.selection.setRangeBefore($br);\n          } else {\n            _this.editor.selection.insertNode($br);\n          }\n          return true;\n        };\n      })(this));\n    }\n    if (this.editor.util.browser.webkit || this.editor.util.browser.msie) {\n      titleEnterHandler = (function(_this) {\n        return function(e, $node) {\n          var $p;\n          if (!_this.editor.selection.rangeAtEndOf($node)) {\n            return;\n          }\n          $p = $('<p/>').append(_this.editor.util.phBr).insertAfter($node);\n          _this.editor.selection.setRangeAtStartOf($p);\n          return true;\n        };\n      })(this);\n      this.add('enter', 'h1', titleEnterHandler);\n      this.add('enter', 'h2', titleEnterHandler);\n      this.add('enter', 'h3', titleEnterHandler);\n      this.add('enter', 'h4', titleEnterHandler);\n      this.add('enter', 'h5', titleEnterHandler);\n      this.add('enter', 'h6', titleEnterHandler);\n    }\n    this.add('backspace', '*', (function(_this) {\n      return function(e) {\n        var $blockEl, $prevBlockEl, $rootBlock, isWebkit;\n        $rootBlock = _this.editor.selection.rootNodes().first();\n        $prevBlockEl = $rootBlock.prev();\n        if ($prevBlockEl.is('hr') && _this.editor.selection.rangeAtStartOf($rootBlock)) {\n          _this.editor.selection.save();\n          $prevBlockEl.remove();\n          _this.editor.selection.restore();\n          return true;\n        }\n        $blockEl = _this.editor.selection.blockNodes().last();\n        isWebkit = _this.editor.util.browser.webkit;\n        if (isWebkit && _this.editor.selection.rangeAtStartOf($blockEl)) {\n          _this.editor.selection.save();\n          _this.editor.formatter.cleanNode($blockEl, true);\n          _this.editor.selection.restore();\n          return null;\n        }\n      };\n    })(this));\n    this.add('enter', 'li', (function(_this) {\n      return function(e, $node) {\n        var $cloneNode, listEl, newBlockEl, newListEl;\n        $cloneNode = $node.clone();\n        $cloneNode.find('ul, ol').remove();\n        if (!(_this.editor.util.isEmptyNode($cloneNode) && $node.is(_this.editor.selection.blockNodes().last()))) {\n          return;\n        }\n        listEl = $node.parent();\n        if ($node.next('li').length > 0) {\n          if (!_this.editor.util.isEmptyNode($node)) {\n            return;\n          }\n          if (listEl.parent('li').length > 0) {\n            newBlockEl = $('<li/>').append(_this.editor.util.phBr).insertAfter(listEl.parent('li'));\n            newListEl = $('<' + listEl[0].tagName + '/>').append($node.nextAll('li'));\n            newBlockEl.append(newListEl);\n          } else {\n            newBlockEl = $('<p/>').append(_this.editor.util.phBr).insertAfter(listEl);\n            newListEl = $('<' + listEl[0].tagName + '/>').append($node.nextAll('li'));\n            newBlockEl.after(newListEl);\n          }\n        } else {\n          if (listEl.parent('li').length > 0) {\n            newBlockEl = $('<li/>').insertAfter(listEl.parent('li'));\n            if ($node.contents().length > 0) {\n              newBlockEl.append($node.contents());\n            } else {\n              newBlockEl.append(_this.editor.util.phBr);\n            }\n          } else {\n            newBlockEl = $('<p/>').append(_this.editor.util.phBr).insertAfter(listEl);\n            if ($node.children('ul, ol').length > 0) {\n              newBlockEl.after($node.children('ul, ol'));\n            }\n          }\n        }\n        if ($node.prev('li').length) {\n          $node.remove();\n        } else {\n          listEl.remove();\n        }\n        _this.editor.selection.setRangeAtStartOf(newBlockEl);\n        return true;\n      };\n    })(this));\n    this.add('enter', 'pre', (function(_this) {\n      return function(e, $node) {\n        var $p, breakNode, range;\n        e.preventDefault();\n        if (e.shiftKey) {\n          $p = $('<p/>').append(_this.editor.util.phBr).insertAfter($node);\n          _this.editor.selection.setRangeAtStartOf($p);\n          return true;\n        }\n        range = _this.editor.selection.range();\n        breakNode = null;\n        range.deleteContents();\n        if (!_this.editor.util.browser.msie && _this.editor.selection.rangeAtEndOf($node)) {\n          breakNode = document.createTextNode('\\n\\n');\n          range.insertNode(breakNode);\n          range.setEnd(breakNode, 1);\n        } else {\n          breakNode = document.createTextNode('\\n');\n          range.insertNode(breakNode);\n          range.setStartAfter(breakNode);\n        }\n        range.collapse(false);\n        _this.editor.selection.range(range);\n        return true;\n      };\n    })(this));\n    this.add('enter', 'blockquote', (function(_this) {\n      return function(e, $node) {\n        var $closestBlock, range;\n        $closestBlock = _this.editor.selection.blockNodes().last();\n        if (!($closestBlock.is('p') && !$closestBlock.next().length && _this.editor.util.isEmptyNode($closestBlock))) {\n          return;\n        }\n        $node.after($closestBlock);\n        range = document.createRange();\n        _this.editor.selection.setRangeAtStartOf($closestBlock, range);\n        return true;\n      };\n    })(this));\n    this.add('backspace', 'li', (function(_this) {\n      return function(e, $node) {\n        var $br, $childList, $newLi, $prevChildList, $prevNode, $textNode, isFF, range, text;\n        $childList = $node.children('ul, ol');\n        $prevNode = $node.prev('li');\n        if (!($childList.length > 0 && $prevNode.length > 0)) {\n          return false;\n        }\n        text = '';\n        $textNode = null;\n        $node.contents().each(function(i, n) {\n          if (n.nodeType === 1 && /UL|OL/.test(n.nodeName)) {\n            return false;\n          }\n          if (n.nodeType === 1 && /BR/.test(n.nodeName)) {\n            return;\n          }\n          if (n.nodeType === 3 && n.nodeValue) {\n            text += n.nodeValue;\n          } else if (n.nodeType === 1) {\n            text += $(n).text();\n          }\n          return $textNode = $(n);\n        });\n        isFF = _this.editor.util.browser.firefox && !$textNode.next('br').length;\n        if ($textNode && text.length === 1 && isFF) {\n          $br = $(_this.editor.util.phBr).insertAfter($textNode);\n          $textNode.remove();\n          _this.editor.selection.setRangeBefore($br);\n          return true;\n        } else if (text.length > 0) {\n          return false;\n        }\n        range = document.createRange();\n        $prevChildList = $prevNode.children('ul, ol');\n        if ($prevChildList.length > 0) {\n          $newLi = $('<li/>').append(_this.editor.util.phBr).appendTo($prevChildList);\n          $prevChildList.append($childList.children('li'));\n          $node.remove();\n          _this.editor.selection.setRangeAtEndOf($newLi, range);\n        } else {\n          _this.editor.selection.setRangeAtEndOf($prevNode, range);\n          $prevNode.append($childList);\n          $node.remove();\n          _this.editor.selection.range(range);\n        }\n        return true;\n      };\n    })(this));\n    this.add('backspace', 'pre', (function(_this) {\n      return function(e, $node) {\n        var $newNode, codeStr, range;\n        if (!_this.editor.selection.rangeAtStartOf($node)) {\n          return;\n        }\n        codeStr = $node.html().replace('\\n', '<br/>') || _this.editor.util.phBr;\n        $newNode = $('<p/>').append(codeStr).insertAfter($node);\n        $node.remove();\n        range = document.createRange();\n        _this.editor.selection.setRangeAtStartOf($newNode, range);\n        return true;\n      };\n    })(this));\n    return this.add('backspace', 'blockquote', (function(_this) {\n      return function(e, $node) {\n        var $firstChild, range;\n        if (!_this.editor.selection.rangeAtStartOf($node)) {\n          return;\n        }\n        $firstChild = $node.children().first().unwrap();\n        range = document.createRange();\n        _this.editor.selection.setRangeAtStartOf($firstChild, range);\n        return true;\n      };\n    })(this));\n  };\n\n  return Keystroke;\n\n})(SimpleModule);\n\nUndoManager = (function(superClass) {\n  extend(UndoManager, superClass);\n\n  function UndoManager() {\n    return UndoManager.__super__.constructor.apply(this, arguments);\n  }\n\n  UndoManager.pluginName = 'UndoManager';\n\n  UndoManager.prototype._index = -1;\n\n  UndoManager.prototype._capacity = 20;\n\n  UndoManager.prototype._startPosition = null;\n\n  UndoManager.prototype._endPosition = null;\n\n  UndoManager.prototype._init = function() {\n    var redoShortcut, undoShortcut;\n    this.editor = this._module;\n    this._stack = [];\n    if (this.editor.util.os.mac) {\n      undoShortcut = 'cmd+z';\n      redoShortcut = 'shift+cmd+z';\n    } else if (this.editor.util.os.win) {\n      undoShortcut = 'ctrl+z';\n      redoShortcut = 'ctrl+y';\n    } else {\n      undoShortcut = 'ctrl+z';\n      redoShortcut = 'shift+ctrl+z';\n    }\n    this.editor.hotkeys.add(undoShortcut, (function(_this) {\n      return function(e) {\n        e.preventDefault();\n        _this.undo();\n        return false;\n      };\n    })(this));\n    this.editor.hotkeys.add(redoShortcut, (function(_this) {\n      return function(e) {\n        e.preventDefault();\n        _this.redo();\n        return false;\n      };\n    })(this));\n    this.throttledPushState = this.editor.util.throttle((function(_this) {\n      return function() {\n        return _this._pushUndoState();\n      };\n    })(this), 2000);\n    this.editor.on('valuechanged', (function(_this) {\n      return function(e, src) {\n        if (src === 'undo' || src === 'redo') {\n          return;\n        }\n        return _this.throttledPushState();\n      };\n    })(this));\n    this.editor.on('selectionchanged', (function(_this) {\n      return function(e) {\n        _this.resetCaretPosition();\n        return _this.update();\n      };\n    })(this));\n    this.editor.on('focus', (function(_this) {\n      return function(e) {\n        if (_this._stack.length === 0) {\n          return _this._pushUndoState();\n        }\n      };\n    })(this));\n    return this.editor.on('blur', (function(_this) {\n      return function(e) {\n        return _this.resetCaretPosition();\n      };\n    })(this));\n  };\n\n  UndoManager.prototype.resetCaretPosition = function() {\n    this._startPosition = null;\n    return this._endPosition = null;\n  };\n\n  UndoManager.prototype.startPosition = function() {\n    if (this.editor.selection._range) {\n      this._startPosition || (this._startPosition = this._getPosition('start'));\n    }\n    return this._startPosition;\n  };\n\n  UndoManager.prototype.endPosition = function() {\n    if (this.editor.selection._range) {\n      this._endPosition || (this._endPosition = (function(_this) {\n        return function() {\n          var range;\n          range = _this.editor.selection.range();\n          if (range.collapsed) {\n            return _this._startPosition;\n          }\n          return _this._getPosition('end');\n        };\n      })(this)());\n    }\n    return this._endPosition;\n  };\n\n  UndoManager.prototype._pushUndoState = function() {\n    var caret;\n    if (this.editor.triggerHandler('pushundostate') === false) {\n      return;\n    }\n    caret = this.caretPosition();\n    if (!caret.start) {\n      return;\n    }\n    this._index += 1;\n    this._stack.length = this._index;\n    this._stack.push({\n      html: this.editor.body.html(),\n      caret: this.caretPosition()\n    });\n    if (this._stack.length > this._capacity) {\n      this._stack.shift();\n      return this._index -= 1;\n    }\n  };\n\n  UndoManager.prototype.currentState = function() {\n    if (this._stack.length && this._index > -1) {\n      return this._stack[this._index];\n    } else {\n      return null;\n    }\n  };\n\n  UndoManager.prototype.undo = function() {\n    var state;\n    if (this._index < 1 || this._stack.length < 2) {\n      return;\n    }\n    this.editor.hidePopover();\n    this._index -= 1;\n    state = this._stack[this._index];\n    this.editor.body.get(0).innerHTML = state.html;\n    this.caretPosition(state.caret);\n    this.editor.body.find('.selected').removeClass('selected');\n    this.editor.sync();\n    return this.editor.trigger('valuechanged', ['undo']);\n  };\n\n  UndoManager.prototype.redo = function() {\n    var state;\n    if (this._index < 0 || this._stack.length < this._index + 2) {\n      return;\n    }\n    this.editor.hidePopover();\n    this._index += 1;\n    state = this._stack[this._index];\n    this.editor.body.get(0).innerHTML = state.html;\n    this.caretPosition(state.caret);\n    this.editor.body.find('.selected').removeClass('selected');\n    this.editor.sync();\n    return this.editor.trigger('valuechanged', ['redo']);\n  };\n\n  UndoManager.prototype.update = function() {\n    var currentState;\n    currentState = this.currentState();\n    if (!currentState) {\n      return;\n    }\n    currentState.html = this.editor.body.html();\n    return currentState.caret = this.caretPosition();\n  };\n\n  UndoManager.prototype._getNodeOffset = function(node, index) {\n    var $parent, merging, offset;\n    if ($.isNumeric(index)) {\n      $parent = $(node);\n    } else {\n      $parent = $(node).parent();\n    }\n    offset = 0;\n    merging = false;\n    $parent.contents().each(function(i, child) {\n      if (node === child || (index === i && i === 0)) {\n        return false;\n      }\n      if (child.nodeType === Node.TEXT_NODE) {\n        if (!merging && child.nodeValue.length > 0) {\n          offset += 1;\n          merging = true;\n        }\n      } else {\n        offset += 1;\n        merging = false;\n      }\n      if (index - 1 === i) {\n        return false;\n      }\n      return null;\n    });\n    return offset;\n  };\n\n  UndoManager.prototype._getPosition = function(type) {\n    var $nodes, node, nodes, offset, position, prevNode, range;\n    if (type == null) {\n      type = 'start';\n    }\n    range = this.editor.selection.range();\n    offset = range[type + \"Offset\"];\n    $nodes = this.editor.selection[type + \"Nodes\"]();\n    node = $nodes.first()[0];\n    if (node.nodeType === Node.TEXT_NODE) {\n      prevNode = node.previousSibling;\n      while (prevNode && prevNode.nodeType === Node.TEXT_NODE) {\n        node = prevNode;\n        offset += this.editor.util.getNodeLength(prevNode);\n        prevNode = prevNode.previousSibling;\n      }\n      nodes = $nodes.get();\n      nodes[0] = node;\n      $nodes = $(nodes);\n    } else {\n      offset = this._getNodeOffset(node, offset);\n    }\n    position = [offset];\n    $nodes.each((function(_this) {\n      return function(i, node) {\n        return position.unshift(_this._getNodeOffset(node));\n      };\n    })(this));\n    return position;\n  };\n\n  UndoManager.prototype._getNodeByPosition = function(position) {\n    var child, childNodes, i, k, len, node, offset, ref;\n    node = this.editor.body[0];\n    ref = position.slice(0, position.length - 1);\n    for (i = k = 0, len = ref.length; k < len; i = ++k) {\n      offset = ref[i];\n      childNodes = node.childNodes;\n      if (offset > childNodes.length - 1) {\n        if (i === position.length - 2 && $(node).is('pre:empty')) {\n          child = document.createTextNode('');\n          node.appendChild(child);\n          childNodes = node.childNodes;\n        } else {\n          node = null;\n          break;\n        }\n      }\n      node = childNodes[offset];\n    }\n    return node;\n  };\n\n  UndoManager.prototype.caretPosition = function(caret) {\n    var endContainer, endOffset, range, startContainer, startOffset;\n    if (!caret) {\n      range = this.editor.selection.range();\n      caret = this.editor.inputManager.focused && (range != null) ? {\n        start: this.startPosition(),\n        end: this.endPosition(),\n        collapsed: range.collapsed\n      } : {};\n      return caret;\n    } else {\n      if (!caret.start) {\n        return;\n      }\n      startContainer = this._getNodeByPosition(caret.start);\n      startOffset = caret.start[caret.start.length - 1];\n      if (caret.collapsed) {\n        endContainer = startContainer;\n        endOffset = startOffset;\n      } else {\n        endContainer = this._getNodeByPosition(caret.end);\n        endOffset = caret.start[caret.start.length - 1];\n      }\n      if (!startContainer || !endContainer) {\n        if (typeof console !== \"undefined\" && console !== null) {\n          if (typeof console.warn === \"function\") {\n            console.warn('simditor: invalid caret state');\n          }\n        }\n        return;\n      }\n      range = document.createRange();\n      range.setStart(startContainer, startOffset);\n      range.setEnd(endContainer, endOffset);\n      return this.editor.selection.range(range);\n    }\n  };\n\n  return UndoManager;\n\n})(SimpleModule);\n\nUtil = (function(superClass) {\n  extend(Util, superClass);\n\n  function Util() {\n    return Util.__super__.constructor.apply(this, arguments);\n  }\n\n  Util.pluginName = 'Util';\n\n  Util.prototype._init = function() {\n    this.editor = this._module;\n    if (this.browser.msie && this.browser.version < 11) {\n      return this.phBr = '';\n    }\n  };\n\n  Util.prototype.phBr = '<br/>';\n\n  Util.prototype.os = (function() {\n    var os;\n    os = {};\n    if (/Mac/.test(navigator.appVersion)) {\n      os.mac = true;\n    } else if (/Linux/.test(navigator.appVersion)) {\n      os.linux = true;\n    } else if (/Win/.test(navigator.appVersion)) {\n      os.win = true;\n    } else if (/X11/.test(navigator.appVersion)) {\n      os.unix = true;\n    }\n    if (/Mobi/.test(navigator.appVersion)) {\n      os.mobile = true;\n    }\n    return os;\n  })();\n\n  Util.prototype.browser = (function() {\n    var chrome, edge, firefox, ie, ref, ref1, ref2, ref3, ref4, safari, ua;\n    ua = navigator.userAgent;\n    ie = /(msie|trident)/i.test(ua);\n    chrome = /chrome|crios/i.test(ua);\n    safari = /safari/i.test(ua) && !chrome;\n    firefox = /firefox/i.test(ua);\n    edge = /edge/i.test(ua);\n    if (ie) {\n      return {\n        msie: true,\n        version: ((ref = ua.match(/(msie |rv:)(\\d+(\\.\\d+)?)/i)) != null ? ref[2] : void 0) * 1\n      };\n    } else if (edge) {\n      return {\n        edge: true,\n        webkit: true,\n        version: ((ref1 = ua.match(/edge\\/(\\d+(\\.\\d+)?)/i)) != null ? ref1[1] : void 0) * 1\n      };\n    } else if (chrome) {\n      return {\n        webkit: true,\n        chrome: true,\n        version: ((ref2 = ua.match(/(?:chrome|crios)\\/(\\d+(\\.\\d+)?)/i)) != null ? ref2[1] : void 0) * 1\n      };\n    } else if (safari) {\n      return {\n        webkit: true,\n        safari: true,\n        version: ((ref3 = ua.match(/version\\/(\\d+(\\.\\d+)?)/i)) != null ? ref3[1] : void 0) * 1\n      };\n    } else if (firefox) {\n      return {\n        mozilla: true,\n        firefox: true,\n        version: ((ref4 = ua.match(/firefox\\/(\\d+(\\.\\d+)?)/i)) != null ? ref4[1] : void 0) * 1\n      };\n    } else {\n      return {};\n    }\n  })();\n\n  Util.prototype.support = (function() {\n    return {\n      onselectionchange: (function() {\n        var e, onselectionchange;\n        onselectionchange = document.onselectionchange;\n        if (onselectionchange !== void 0) {\n          try {\n            document.onselectionchange = 0;\n            return document.onselectionchange === null;\n          } catch (_error) {\n            e = _error;\n          } finally {\n            document.onselectionchange = onselectionchange;\n          }\n        }\n        return false;\n      })(),\n      oninput: (function() {\n        return !/(msie|trident)/i.test(navigator.userAgent);\n      })()\n    };\n  })();\n\n  Util.prototype.reflow = function(el) {\n    if (el == null) {\n      el = document;\n    }\n    return $(el)[0].offsetHeight;\n  };\n\n  Util.prototype.metaKey = function(e) {\n    var isMac;\n    isMac = /Mac/.test(navigator.userAgent);\n    if (isMac) {\n      return e.metaKey;\n    } else {\n      return e.ctrlKey;\n    }\n  };\n\n  Util.prototype.isEmptyNode = function(node) {\n    var $node;\n    $node = $(node);\n    return $node.is(':empty') || (!$node.text() && !$node.find(':not(br, span, div)').length);\n  };\n\n  Util.prototype.isDecoratedNode = function(node) {\n    return $(node).is('[class^=\"simditor-\"]');\n  };\n\n  Util.prototype.blockNodes = [\"div\", \"p\", \"ul\", \"ol\", \"li\", \"blockquote\", \"hr\", \"pre\", \"h1\", \"h2\", \"h3\", \"h4\", \"h5\", \"table\"];\n\n  Util.prototype.isBlockNode = function(node) {\n    node = $(node)[0];\n    if (!node || node.nodeType === 3) {\n      return false;\n    }\n    return new RegExp(\"^(\" + (this.blockNodes.join('|')) + \")$\").test(node.nodeName.toLowerCase());\n  };\n\n  Util.prototype.getNodeLength = function(node) {\n    node = $(node)[0];\n    switch (node.nodeType) {\n      case 7:\n      case 10:\n        return 0;\n      case 3:\n      case 8:\n        return node.length;\n      default:\n        return node.childNodes.length;\n    }\n  };\n\n  Util.prototype.dataURLtoBlob = function(dataURL) {\n    var BlobBuilder, arrayBuffer, bb, blobArray, byteString, hasArrayBufferViewSupport, hasBlobConstructor, i, intArray, k, mimeString, ref, supportBlob;\n    hasBlobConstructor = window.Blob && (function() {\n      var e;\n      try {\n        return Boolean(new Blob());\n      } catch (_error) {\n        e = _error;\n        return false;\n      }\n    })();\n    hasArrayBufferViewSupport = hasBlobConstructor && window.Uint8Array && (function() {\n      var e;\n      try {\n        return new Blob([new Uint8Array(100)]).size === 100;\n      } catch (_error) {\n        e = _error;\n        return false;\n      }\n    })();\n    BlobBuilder = window.BlobBuilder || window.WebKitBlobBuilder || window.MozBlobBuilder || window.MSBlobBuilder;\n    supportBlob = hasBlobConstructor || BlobBuilder;\n    if (!(supportBlob && window.atob && window.ArrayBuffer && window.Uint8Array)) {\n      return false;\n    }\n    if (dataURL.split(',')[0].indexOf('base64') >= 0) {\n      byteString = atob(dataURL.split(',')[1]);\n    } else {\n      byteString = decodeURIComponent(dataURL.split(',')[1]);\n    }\n    arrayBuffer = new ArrayBuffer(byteString.length);\n    intArray = new Uint8Array(arrayBuffer);\n    for (i = k = 0, ref = byteString.length; 0 <= ref ? k <= ref : k >= ref; i = 0 <= ref ? ++k : --k) {\n      intArray[i] = byteString.charCodeAt(i);\n    }\n    mimeString = dataURL.split(',')[0].split(':')[1].split(';')[0];\n    if (hasBlobConstructor) {\n      blobArray = hasArrayBufferViewSupport ? intArray : arrayBuffer;\n      return new Blob([blobArray], {\n        type: mimeString\n      });\n    }\n    bb = new BlobBuilder();\n    bb.append(arrayBuffer);\n    return bb.getBlob(mimeString);\n  };\n\n  Util.prototype.throttle = function(func, wait) {\n    var args, call, ctx, last, rtn, throttled, timeoutID;\n    last = 0;\n    timeoutID = 0;\n    ctx = args = rtn = null;\n    call = function() {\n      timeoutID = 0;\n      last = +new Date();\n      rtn = func.apply(ctx, args);\n      ctx = null;\n      return args = null;\n    };\n    throttled = function() {\n      var delta;\n      ctx = this;\n      args = arguments;\n      delta = new Date() - last;\n      if (!timeoutID) {\n        if (delta >= wait) {\n          call();\n        } else {\n          timeoutID = setTimeout(call, wait - delta);\n        }\n      }\n      return rtn;\n    };\n    throttled.clear = function() {\n      if (!timeoutID) {\n        return;\n      }\n      clearTimeout(timeoutID);\n      return call();\n    };\n    return throttled;\n  };\n\n  Util.prototype.formatHTML = function(html) {\n    var cursor, indentString, lastMatch, level, match, re, repeatString, result, str;\n    re = /<(\\/?)(.+?)(\\/?)>/g;\n    result = '';\n    level = 0;\n    lastMatch = null;\n    indentString = '  ';\n    repeatString = function(str, n) {\n      return new Array(n + 1).join(str);\n    };\n    while ((match = re.exec(html)) !== null) {\n      match.isBlockNode = $.inArray(match[2], this.blockNodes) > -1;\n      match.isStartTag = match[1] !== '/' && match[3] !== '/';\n      match.isEndTag = match[1] === '/' || match[3] === '/';\n      cursor = lastMatch ? lastMatch.index + lastMatch[0].length : 0;\n      if ((str = html.substring(cursor, match.index)).length > 0 && $.trim(str)) {\n        result += str;\n      }\n      if (match.isBlockNode && match.isEndTag && !match.isStartTag) {\n        level -= 1;\n      }\n      if (match.isBlockNode && match.isStartTag) {\n        if (!(lastMatch && lastMatch.isBlockNode && lastMatch.isEndTag)) {\n          result += '\\n';\n        }\n        result += repeatString(indentString, level);\n      }\n      result += match[0];\n      if (match.isBlockNode && match.isEndTag) {\n        result += '\\n';\n      }\n      if (match.isBlockNode && match.isStartTag) {\n        level += 1;\n      }\n      lastMatch = match;\n    }\n    return $.trim(result);\n  };\n\n  return Util;\n\n})(SimpleModule);\n\nToolbar = (function(superClass) {\n  extend(Toolbar, superClass);\n\n  function Toolbar() {\n    return Toolbar.__super__.constructor.apply(this, arguments);\n  }\n\n  Toolbar.pluginName = 'Toolbar';\n\n  Toolbar.prototype.opts = {\n    toolbar: true,\n    toolbarFloat: true,\n    toolbarHidden: false,\n    toolbarFloatOffset: 0\n  };\n\n  Toolbar.prototype._tpl = {\n    wrapper: '<div class=\"simditor-toolbar\"><ul></ul></div>',\n    separator: '<li><span class=\"separator\"></span></li>'\n  };\n\n  Toolbar.prototype._init = function() {\n    var floatInitialized, initToolbarFloat, toolbarHeight;\n    this.editor = this._module;\n    if (!this.opts.toolbar) {\n      return;\n    }\n    if (!$.isArray(this.opts.toolbar)) {\n      this.opts.toolbar = ['bold', 'italic', 'underline', 'strikethrough', '|', 'ol', 'ul', 'blockquote', 'code', '|', 'link', 'image', '|', 'indent', 'outdent'];\n    }\n    this._render();\n    this.list.on('click', function(e) {\n      return false;\n    });\n    this.wrapper.on('mousedown', (function(_this) {\n      return function(e) {\n        return _this.list.find('.menu-on').removeClass('.menu-on');\n      };\n    })(this));\n    $(document).on('mousedown.simditor' + this.editor.id, (function(_this) {\n      return function(e) {\n        return _this.list.find('.menu-on').removeClass('.menu-on');\n      };\n    })(this));\n    if (!this.opts.toolbarHidden && this.opts.toolbarFloat) {\n      this.wrapper.css('top', this.opts.toolbarFloatOffset);\n      toolbarHeight = 0;\n      initToolbarFloat = (function(_this) {\n        return function() {\n          _this.wrapper.css('position', 'static');\n          _this.wrapper.width('auto');\n          _this.editor.util.reflow(_this.wrapper);\n          _this.wrapper.width(_this.wrapper.outerWidth());\n          _this.wrapper.css('left', _this.editor.util.os.mobile ? _this.wrapper.position().left : _this.wrapper.offset().left);\n          _this.wrapper.css('position', '');\n          toolbarHeight = _this.wrapper.outerHeight();\n          _this.editor.placeholderEl.css('top', toolbarHeight);\n          return true;\n        };\n      })(this);\n      floatInitialized = null;\n      $(window).on('resize.simditor-' + this.editor.id, function(e) {\n        return floatInitialized = initToolbarFloat();\n      });\n      $(window).on('scroll.simditor-' + this.editor.id, (function(_this) {\n        return function(e) {\n          var bottomEdge, scrollTop, topEdge;\n          if (!_this.wrapper.is(':visible')) {\n            return;\n          }\n          topEdge = _this.editor.wrapper.offset().top;\n          bottomEdge = topEdge + _this.editor.wrapper.outerHeight() - 80;\n          scrollTop = $(document).scrollTop() + _this.opts.toolbarFloatOffset;\n          if (scrollTop <= topEdge || scrollTop >= bottomEdge) {\n            _this.editor.wrapper.removeClass('toolbar-floating').css('padding-top', '');\n            if (_this.editor.util.os.mobile) {\n              return _this.wrapper.css('top', _this.opts.toolbarFloatOffset);\n            }\n          } else {\n            floatInitialized || (floatInitialized = initToolbarFloat());\n            _this.editor.wrapper.addClass('toolbar-floating').css('padding-top', toolbarHeight);\n            if (_this.editor.util.os.mobile) {\n              return _this.wrapper.css('top', scrollTop - topEdge + _this.opts.toolbarFloatOffset);\n            }\n          }\n        };\n      })(this));\n    }\n    this.editor.on('destroy', (function(_this) {\n      return function() {\n        return _this.buttons.length = 0;\n      };\n    })(this));\n    return $(document).on(\"mousedown.simditor-\" + this.editor.id, (function(_this) {\n      return function(e) {\n        return _this.list.find('li.menu-on').removeClass('menu-on');\n      };\n    })(this));\n  };\n\n  Toolbar.prototype._render = function() {\n    var k, len, name, ref;\n    this.buttons = [];\n    this.wrapper = $(this._tpl.wrapper).prependTo(this.editor.wrapper);\n    this.list = this.wrapper.find('ul');\n    ref = this.opts.toolbar;\n    for (k = 0, len = ref.length; k < len; k++) {\n      name = ref[k];\n      if (name === '|') {\n        $(this._tpl.separator).appendTo(this.list);\n        continue;\n      }\n      if (!this.constructor.buttons[name]) {\n        throw new Error(\"simditor: invalid toolbar button \" + name);\n        continue;\n      }\n      this.buttons.push(new this.constructor.buttons[name]({\n        editor: this.editor\n      }));\n    }\n    if (this.opts.toolbarHidden) {\n      return this.wrapper.hide();\n    }\n  };\n\n  Toolbar.prototype.findButton = function(name) {\n    var button;\n    button = this.list.find('.toolbar-item-' + name).data('button');\n    return button != null ? button : null;\n  };\n\n  Toolbar.addButton = function(btn) {\n    return this.buttons[btn.prototype.name] = btn;\n  };\n\n  Toolbar.buttons = {};\n\n  return Toolbar;\n\n})(SimpleModule);\n\nIndentation = (function(superClass) {\n  extend(Indentation, superClass);\n\n  function Indentation() {\n    return Indentation.__super__.constructor.apply(this, arguments);\n  }\n\n  Indentation.pluginName = 'Indentation';\n\n  Indentation.prototype.opts = {\n    tabIndent: true\n  };\n\n  Indentation.prototype._init = function() {\n    this.editor = this._module;\n    return this.editor.keystroke.add('tab', '*', (function(_this) {\n      return function(e) {\n        var codeButton;\n        codeButton = _this.editor.toolbar.findButton('code');\n        if (!(_this.opts.tabIndent || (codeButton && codeButton.active))) {\n          return;\n        }\n        return _this.indent(e.shiftKey);\n      };\n    })(this));\n  };\n\n  Indentation.prototype.indent = function(isBackward) {\n    var $blockNodes, $endNodes, $startNodes, nodes, result;\n    $startNodes = this.editor.selection.startNodes();\n    $endNodes = this.editor.selection.endNodes();\n    $blockNodes = this.editor.selection.blockNodes();\n    nodes = [];\n    $blockNodes = $blockNodes.each(function(i, node) {\n      var include, j, k, len, n;\n      include = true;\n      for (j = k = 0, len = nodes.length; k < len; j = ++k) {\n        n = nodes[j];\n        if ($.contains(node, n)) {\n          include = false;\n          break;\n        } else if ($.contains(n, node)) {\n          nodes.splice(j, 1, node);\n          include = false;\n          break;\n        }\n      }\n      if (include) {\n        return nodes.push(node);\n      }\n    });\n    $blockNodes = $(nodes);\n    result = false;\n    $blockNodes.each((function(_this) {\n      return function(i, blockEl) {\n        var r;\n        r = isBackward ? _this.outdentBlock(blockEl) : _this.indentBlock(blockEl);\n        if (r) {\n          return result = r;\n        }\n      };\n    })(this));\n    return result;\n  };\n\n  Indentation.prototype.indentBlock = function(blockEl) {\n    var $blockEl, $childList, $nextTd, $nextTr, $parentLi, $pre, $td, $tr, marginLeft, tagName;\n    $blockEl = $(blockEl);\n    if (!$blockEl.length) {\n      return;\n    }\n    if ($blockEl.is('pre')) {\n      $pre = this.editor.selection.containerNode();\n      if (!($pre.is($blockEl) || $pre.closest('pre').is($blockEl))) {\n        return;\n      }\n      this.indentText(this.editor.selection.range());\n    } else if ($blockEl.is('li')) {\n      $parentLi = $blockEl.prev('li');\n      if ($parentLi.length < 1) {\n        return;\n      }\n      this.editor.selection.save();\n      tagName = $blockEl.parent()[0].tagName;\n      $childList = $parentLi.children('ul, ol');\n      if ($childList.length > 0) {\n        $childList.append($blockEl);\n      } else {\n        $('<' + tagName + '/>').append($blockEl).appendTo($parentLi);\n      }\n      this.editor.selection.restore();\n    } else if ($blockEl.is('p, h1, h2, h3, h4')) {\n      marginLeft = parseInt($blockEl.css('margin-left')) || 0;\n      marginLeft = (Math.round(marginLeft / this.opts.indentWidth) + 1) * this.opts.indentWidth;\n      $blockEl.css('margin-left', marginLeft);\n    } else if ($blockEl.is('table') || $blockEl.is('.simditor-table')) {\n      $td = this.editor.selection.containerNode().closest('td, th');\n      $nextTd = $td.next('td, th');\n      if (!($nextTd.length > 0)) {\n        $tr = $td.parent('tr');\n        $nextTr = $tr.next('tr');\n        if ($nextTr.length < 1 && $tr.parent().is('thead')) {\n          $nextTr = $tr.parent('thead').next('tbody').find('tr:first');\n        }\n        $nextTd = $nextTr.find('td:first, th:first');\n      }\n      if (!($td.length > 0 && $nextTd.length > 0)) {\n        return;\n      }\n      this.editor.selection.setRangeAtEndOf($nextTd);\n    } else {\n      return false;\n    }\n    return true;\n  };\n\n  Indentation.prototype.indentText = function(range) {\n    var text, textNode;\n    text = range.toString().replace(/^(?=.+)/mg, '\\u00A0\\u00A0');\n    textNode = document.createTextNode(text || '\\u00A0\\u00A0');\n    range.deleteContents();\n    range.insertNode(textNode);\n    if (text) {\n      range.selectNode(textNode);\n      return this.editor.selection.range(range);\n    } else {\n      return this.editor.selection.setRangeAfter(textNode);\n    }\n  };\n\n  Indentation.prototype.outdentBlock = function(blockEl) {\n    var $blockEl, $parent, $parentLi, $pre, $prevTd, $prevTr, $td, $tr, marginLeft, range;\n    $blockEl = $(blockEl);\n    if (!($blockEl && $blockEl.length > 0)) {\n      return;\n    }\n    if ($blockEl.is('pre')) {\n      $pre = this.editor.selection.containerNode();\n      if (!($pre.is($blockEl) || $pre.closest('pre').is($blockEl))) {\n        return;\n      }\n      this.outdentText(range);\n    } else if ($blockEl.is('li')) {\n      $parent = $blockEl.parent();\n      $parentLi = $parent.parent('li');\n      this.editor.selection.save();\n      if ($parentLi.length < 1) {\n        range = document.createRange();\n        range.setStartBefore($parent[0]);\n        range.setEndBefore($blockEl[0]);\n        $parent.before(range.extractContents());\n        $('<p/>').insertBefore($parent).after($blockEl.children('ul, ol')).append($blockEl.contents());\n        $blockEl.remove();\n      } else {\n        if ($blockEl.next('li').length > 0) {\n          $('<' + $parent[0].tagName + '/>').append($blockEl.nextAll('li')).appendTo($blockEl);\n        }\n        $blockEl.insertAfter($parentLi);\n        if ($parent.children('li').length < 1) {\n          $parent.remove();\n        }\n      }\n      this.editor.selection.restore();\n    } else if ($blockEl.is('p, h1, h2, h3, h4')) {\n      marginLeft = parseInt($blockEl.css('margin-left')) || 0;\n      marginLeft = Math.max(Math.round(marginLeft / this.opts.indentWidth) - 1, 0) * this.opts.indentWidth;\n      $blockEl.css('margin-left', marginLeft === 0 ? '' : marginLeft);\n    } else if ($blockEl.is('table') || $blockEl.is('.simditor-table')) {\n      $td = this.editor.selection.containerNode().closest('td, th');\n      $prevTd = $td.prev('td, th');\n      if (!($prevTd.length > 0)) {\n        $tr = $td.parent('tr');\n        $prevTr = $tr.prev('tr');\n        if ($prevTr.length < 1 && $tr.parent().is('tbody')) {\n          $prevTr = $tr.parent('tbody').prev('thead').find('tr:first');\n        }\n        $prevTd = $prevTr.find('td:last, th:last');\n      }\n      if (!($td.length > 0 && $prevTd.length > 0)) {\n        return;\n      }\n      this.editor.selection.setRangeAtEndOf($prevTd);\n    } else {\n      return false;\n    }\n    return true;\n  };\n\n  Indentation.prototype.outdentText = function(range) {};\n\n  return Indentation;\n\n})(SimpleModule);\n\nClipboard = (function(superClass) {\n  extend(Clipboard, superClass);\n\n  function Clipboard() {\n    return Clipboard.__super__.constructor.apply(this, arguments);\n  }\n\n  Clipboard.pluginName = 'Clipboard';\n\n  Clipboard.prototype.opts = {\n    pasteImage: false,\n    cleanPaste: false\n  };\n\n  Clipboard.prototype._init = function() {\n    this.editor = this._module;\n    if (this.opts.pasteImage && typeof this.opts.pasteImage !== 'string') {\n      this.opts.pasteImage = 'inline';\n    }\n    return this.editor.body.on('paste', (function(_this) {\n      return function(e) {\n        var range;\n        if (_this.pasting || _this._pasteBin) {\n          return;\n        }\n        if (_this.editor.triggerHandler(e) === false) {\n          return false;\n        }\n        range = _this.editor.selection.deleteRangeContents();\n        if (_this.editor.body.html()) {\n          if (!range.collapsed) {\n            range.collapse(true);\n          }\n        } else {\n          _this.editor.formatter.format();\n          _this.editor.selection.setRangeAtStartOf(_this.editor.body.find('p:first'));\n        }\n        if (_this._processPasteByClipboardApi(e)) {\n          return false;\n        }\n        _this.editor.inputManager.throttledValueChanged.clear();\n        _this.editor.inputManager.throttledSelectionChanged.clear();\n        _this.editor.undoManager.throttledPushState.clear();\n        _this.editor.selection.reset();\n        _this.editor.undoManager.resetCaretPosition();\n        _this.pasting = true;\n        return _this._getPasteContent(function(pasteContent) {\n          _this._processPasteContent(pasteContent);\n          _this._pasteInBlockEl = null;\n          _this._pastePlainText = null;\n          return _this.pasting = false;\n        });\n      };\n    })(this));\n  };\n\n  Clipboard.prototype._processPasteByClipboardApi = function(e) {\n    var imageFile, pasteItem, ref, uploadOpt;\n    if (this.editor.util.browser.edge) {\n      return;\n    }\n    if (e.originalEvent.clipboardData && e.originalEvent.clipboardData.items && e.originalEvent.clipboardData.items.length > 0) {\n      pasteItem = e.originalEvent.clipboardData.items[0];\n      if (/^image\\//.test(pasteItem.type)) {\n        imageFile = pasteItem.getAsFile();\n        if (!((imageFile != null) && this.opts.pasteImage)) {\n          return;\n        }\n        if (!imageFile.name) {\n          imageFile.name = \"Clipboard Image.png\";\n        }\n        if (this.editor.triggerHandler('pasting', [imageFile]) === false) {\n          return;\n        }\n        uploadOpt = {};\n        uploadOpt[this.opts.pasteImage] = true;\n        if ((ref = this.editor.uploader) != null) {\n          ref.upload(imageFile, uploadOpt);\n        }\n        return true;\n      }\n    }\n  };\n\n  Clipboard.prototype._getPasteContent = function(callback) {\n    var state;\n    this._pasteBin = $('<div contenteditable=\"true\" />').addClass('simditor-paste-bin').attr('tabIndex', '-1').appendTo(this.editor.el);\n    state = {\n      html: this.editor.body.html(),\n      caret: this.editor.undoManager.caretPosition()\n    };\n    this._pasteBin.focus();\n    return setTimeout((function(_this) {\n      return function() {\n        var pasteContent, $el, $parent, $li;\n        _this.editor.hidePopover();\n        _this.editor.body.get(0).innerHTML = state.html;\n        _this.editor.undoManager.caretPosition(state.caret);\n        _this.editor.body.focus();\n        _this.editor.selection.reset();\n        _this.editor.selection.range();\n        _this._pasteInBlockEl = _this.editor.selection.blockNodes().last();\n\n        _this._pasteBin.children('style').remove(); //mod-for-jl\n        _this._pasteBin.find('ul').each(function(i, ul){ $(ul).before($('<ol/>').append($(ul).find('li'))); $(ul).remove();}); //mod-for-jl\n        _this._pasteBin.find('ol').find('li').children('p').each(function(i, p){ $(p).after($(p).html()); $(p).remove(); }); //mod-for-jl\n        // console.log(_this._pasteBin.html());\n        _this._pastePlainText = _this.opts.cleanPaste || _this._pasteInBlockEl.is('pre, table');\n        if (_this._pastePlainText) {\n          pasteContent = _this.editor.formatter.clearHtml(_this._pasteBin.html(), true);\n        } else {\n          pasteContent = $('<div/>').append(_this._pasteBin.contents());\n          pasteContent.find('table colgroup').remove();\n          _this.editor.formatter.format(pasteContent);\n          _this.editor.formatter.decorate(pasteContent);\n          _this.editor.formatter.beautify(pasteContent.children());\n          pasteContent.find('p').each(function(i, p){ if($(p).html()=='\t\t\t\t') $(p).html('<br>'); }) //mod-for-jl\n          pasteContent = pasteContent.contents();\n        }\n        _this._pasteBin.remove();\n        _this._pasteBin = null;\n        return callback(pasteContent);\n      };\n    })(this), 0);\n  };\n\n  Clipboard.prototype._processPasteContent = function(pasteContent) {\n    var $blockEl, $img, blob, children, insertPosition, k, l, lastLine, len, len1, len2, len3, len4, line, lines, m, node, o, q, ref, ref1, ref2, uploadOpt;\n    if (this.editor.triggerHandler('pasting', [pasteContent]) === false) {\n      return;\n    }\n    $blockEl = this._pasteInBlockEl;\n    if (!pasteContent) {\n      return;\n    } else if (this._pastePlainText) {\n      if ($blockEl.is('table')) {\n        lines = pasteContent.split('\\n');\n        lastLine = lines.pop();\n        for (k = 0, len = lines.length; k < len; k++) {\n          line = lines[k];\n          this.editor.selection.insertNode(document.createTextNode(line));\n          this.editor.selection.insertNode($('<br/>'));\n        }\n        this.editor.selection.insertNode(document.createTextNode(lastLine));\n      } else {\n        pasteContent = $('<div/>').text(pasteContent);\n        ref = pasteContent.contents();\n        for (l = 0, len1 = ref.length; l < len1; l++) {\n          node = ref[l];\n          this.editor.selection.insertNode($(node)[0]);\n        }\n      }\n    } else if ($blockEl.is(this.editor.body)) {\n      for (m = 0, len2 = pasteContent.length; m < len2; m++) {\n        node = pasteContent[m];\n        this.editor.selection.insertNode(node);\n      }\n    } else if (pasteContent.length < 1) {\n      return;\n    } else if (pasteContent.length === 1) {\n      if (pasteContent.is('p')) {\n        children = pasteContent.contents();\n        if (children.length === 1 && children.is('img')) {\n          $img = children;\n          if (/^data:image/.test($img.attr('src'))) {\n            if (!this.opts.pasteImage) {\n              return;\n            }\n            blob = this.editor.util.dataURLtoBlob($img.attr(\"src\"));\n            blob.name = \"Clipboard Image.png\";\n            uploadOpt = {};\n            uploadOpt[this.opts.pasteImage] = true;\n            if ((ref1 = this.editor.uploader) != null) {\n              ref1.upload(blob, uploadOpt);\n            }\n            return;\n          } else if ($img.is('img[src^=\"webkit-fake-url://\"]')) {\n            return;\n          }\n        }\n        for (o = 0, len3 = children.length; o < len3; o++) {\n          node = children[o];\n          this.editor.selection.insertNode(node);\n        }\n      } else if ($blockEl.is('p') && this.editor.util.isEmptyNode($blockEl)) {\n        $blockEl.replaceWith(pasteContent);\n        this.editor.selection.setRangeAtEndOf(pasteContent);\n      } else if (pasteContent.is('ul, ol')) {\n        if (pasteContent.find('li').length === 1) {\n          pasteContent = $('<div/>').text(pasteContent.text());\n          ref2 = pasteContent.contents();\n          for (q = 0, len4 = ref2.length; q < len4; q++) {\n            node = ref2[q];\n            this.editor.selection.insertNode($(node)[0]);\n          }\n        } else if ($blockEl.is('li')) {\n          $blockEl.parent().after(pasteContent);\n          this.editor.selection.setRangeAtEndOf(pasteContent);\n        } else {\n          $blockEl.after(pasteContent);\n          this.editor.selection.setRangeAtEndOf(pasteContent);\n        }\n      } else {\n        $blockEl.after(pasteContent);\n        this.editor.selection.setRangeAtEndOf(pasteContent);\n      }\n    } else {\n      if ($blockEl.is('li')) {\n        $blockEl = $blockEl.parent();\n      }\n      if (this.editor.selection.rangeAtStartOf($blockEl)) {\n        insertPosition = 'before';\n      } else if (this.editor.selection.rangeAtEndOf($blockEl)) {\n        insertPosition = 'after';\n      } else {\n        this.editor.selection.breakBlockEl($blockEl);\n        insertPosition = 'before';\n      }\n      $blockEl[insertPosition](pasteContent);\n      this.editor.selection.setRangeAtEndOf(pasteContent.last());\n    }\n    return this.editor.inputManager.throttledValueChanged();\n  };\n\n  return Clipboard;\n\n})(SimpleModule);\n\nSimditor = (function(superClass) {\n  extend(Simditor, superClass);\n\n  function Simditor() {\n    return Simditor.__super__.constructor.apply(this, arguments);\n  }\n\n  Simditor.connect(Util);\n\n  Simditor.connect(InputManager);\n\n  Simditor.connect(Selection);\n\n  Simditor.connect(UndoManager);\n\n  Simditor.connect(Keystroke);\n\n  Simditor.connect(Formatter);\n\n  Simditor.connect(Toolbar);\n\n  Simditor.connect(Indentation);\n\n  Simditor.connect(Clipboard);\n\n  Simditor.count = 0;\n\n  Simditor.prototype.opts = {\n    textarea: null,\n    placeholder: '',\n    defaultImage: 'images/image.png',\n    params: {},\n    upload: false,\n    indentWidth: 40\n  };\n\n  Simditor.prototype._init = function() {\n    var e, editor, form, uploadOpts;\n    this.textarea = $(this.opts.textarea);\n    this.opts.placeholder = this.opts.placeholder || this.textarea.attr('placeholder');\n    if (!this.textarea.length) {\n      throw new Error('simditor: param textarea is required.');\n      return;\n    }\n    editor = this.textarea.data('simditor');\n    if (editor != null) {\n      editor.destroy();\n    }\n    this.id = ++Simditor.count;\n    this._render();\n    if (simpleHotkeys) {\n      this.hotkeys = simpleHotkeys({\n        el: this.body\n      });\n    } else {\n      throw new Error('simditor: simple-hotkeys is required.');\n      return;\n    }\n    if (this.opts.upload && simpleUploader) {\n      uploadOpts = typeof this.opts.upload === 'object' ? this.opts.upload : {};\n      this.uploader = simpleUploader(uploadOpts);\n    }\n    form = this.textarea.closest('form');\n    if (form.length) {\n      form.on('submit.simditor-' + this.id, (function(_this) {\n        return function() {\n          return _this.sync();\n        };\n      })(this));\n      form.on('reset.simditor-' + this.id, (function(_this) {\n        return function() {\n          return _this.setValue('');\n        };\n      })(this));\n    }\n    this.on('initialized', (function(_this) {\n      return function() {\n        if (_this.opts.placeholder) {\n          _this.on('valuechanged', function() {\n            return _this._placeholder();\n          });\n        }\n        _this.setValue(_this.textarea.val().trim() || '');\n        if (_this.textarea.attr('autofocus')) {\n          return _this.focus();\n        }\n      };\n    })(this));\n    if (this.util.browser.mozilla) {\n      this.util.reflow();\n      try {\n        document.execCommand('enableObjectResizing', false, false);\n        return document.execCommand('enableInlineTableEditing', false, false);\n      } catch (_error) {\n        e = _error;\n      }\n    }\n  };\n\n  Simditor.prototype._tpl = \"<div class=\\\"simditor\\\">\\n  <div class=\\\"simditor-wrapper\\\">\\n    <div class=\\\"simditor-placeholder\\\"></div>\\n    <div class=\\\"simditor-body\\\" contenteditable=\\\"true\\\">\\n    </div>\\n  </div>\\n</div>\";\n\n  Simditor.prototype._render = function() {\n    var key, ref, results, val;\n    this.el = $(this._tpl).insertBefore(this.textarea);\n    this.wrapper = this.el.find('.simditor-wrapper');\n    this.body = this.wrapper.find('.simditor-body');\n    this.placeholderEl = this.wrapper.find('.simditor-placeholder').append(this.opts.placeholder);\n    this.el.data('simditor', this);\n    this.wrapper.append(this.textarea);\n    this.textarea.data('simditor', this).blur();\n    this.body.attr('tabindex', this.textarea.attr('tabindex'));\n    if (this.util.os.mac) {\n      this.el.addClass('simditor-mac');\n    } else if (this.util.os.linux) {\n      this.el.addClass('simditor-linux');\n    }\n    if (this.util.os.mobile) {\n      this.el.addClass('simditor-mobile');\n    }\n    if (this.opts.params) {\n      ref = this.opts.params;\n      results = [];\n      for (key in ref) {\n        val = ref[key];\n        results.push($('<input/>', {\n          type: 'hidden',\n          name: key,\n          value: val\n        }).insertAfter(this.textarea));\n      }\n      return results;\n    }\n  };\n\n  Simditor.prototype._placeholder = function() {\n    var children;\n    children = this.body.children();\n    if (children.length === 0 || (children.length === 1 && this.util.isEmptyNode(children) && parseInt(children.css('margin-left') || 0) < this.opts.indentWidth)) {\n      return this.placeholderEl.show();\n    } else {\n      return this.placeholderEl.hide();\n    }\n  };\n\n  Simditor.prototype.setValue = function(val) {\n    this.hidePopover();\n    this.textarea.val(val);\n    this.body.get(0).innerHTML = val;\n    this.formatter.format();\n    this.formatter.decorate();\n    this.util.reflow(this.body);\n    this.inputManager.lastCaretPosition = null;\n    return this.trigger('valuechanged');\n  };\n\n  Simditor.prototype.getValue = function() {\n    return this.sync();\n  };\n\n  Simditor.prototype.sync = function() {\n    var children, cloneBody, emptyP, firstP, lastP, val;\n    cloneBody = this.body.clone();\n    this.formatter.undecorate(cloneBody);\n    this.formatter.format(cloneBody);\n    this.formatter.autolink(cloneBody);\n    children = cloneBody.children();\n    lastP = children.last('p');\n    firstP = children.first('p');\n    while (lastP.is('p') && this.util.isEmptyNode(lastP)) {\n      emptyP = lastP;\n      lastP = lastP.prev('p');\n      emptyP.remove();\n    }\n    while (firstP.is('p') && this.util.isEmptyNode(firstP)) {\n      emptyP = firstP;\n      firstP = lastP.next('p');\n      emptyP.remove();\n    }\n    cloneBody.find('img.uploading').remove();\n    val = $.trim(cloneBody.html());\n    this.textarea.val(val);\n    return val;\n  };\n\n  Simditor.prototype.focus = function() {\n    var $blockEl, range;\n    if (!(this.body.is(':visible') && this.body.is('[contenteditable]'))) {\n      this.el.find('textarea:visible').focus();\n      return;\n    }\n    if (this.inputManager.lastCaretPosition) {\n      this.undoManager.caretPosition(this.inputManager.lastCaretPosition);\n      return this.inputManager.lastCaretPosition = null;\n    } else {\n      $blockEl = this.body.children().last();\n      if (!$blockEl.is('p')) {\n        $blockEl = $('<p/>').append(this.util.phBr).appendTo(this.body);\n      }\n      range = document.createRange();\n      return this.selection.setRangeAtEndOf($blockEl, range);\n    }\n  };\n\n  Simditor.prototype.blur = function() {\n    if (this.body.is(':visible') && this.body.is('[contenteditable]')) {\n      return this.body.blur();\n    } else {\n      return this.body.find('textarea:visible').blur();\n    }\n  };\n\n  Simditor.prototype.hidePopover = function() {\n    return this.el.find('.simditor-popover').each(function(i, popover) {\n      popover = $(popover).data('popover');\n      if (popover.active) {\n        return popover.hide();\n      }\n    });\n  };\n\n  Simditor.prototype.destroy = function() {\n    this.triggerHandler('destroy');\n    this.textarea.closest('form').off('.simditor .simditor-' + this.id);\n    this.selection.clear();\n    this.inputManager.focused = false;\n    this.textarea.insertBefore(this.el).hide().val('').removeData('simditor');\n    this.el.remove();\n    $(document).off('.simditor-' + this.id);\n    $(window).off('.simditor-' + this.id);\n    return this.off();\n  };\n\n  return Simditor;\n\n})(SimpleModule);\n\nSimditor.i18n = {\n  'zh-CN': {\n    'blockquote': '引用',\n    'bold': '加粗文字',\n    'code': '插入代码',\n    'color': '文字颜色',\n    'coloredText': '彩色文字',\n    'hr': '分隔线',\n    'image': '插入图片',\n    'externalImage': '外链图片',\n    'uploadImage': '上传图片',\n    'uploadFailed': '上传失败了',\n    'uploadError': '上传出错了',\n    'imageUrl': '图片地址',\n    'imageSize': '图片尺寸',\n    'imageAlt': '图片描述',\n    'restoreImageSize': '还原图片尺寸',\n    'uploading': '正在上传',\n    'indent': '向右缩进',\n    'outdent': '向左缩进',\n    'italic': '斜体文字',\n    'link': '插入链接',\n    'linkText': '链接文字',\n    'linkUrl': '链接地址',\n    'linkTarget': '打开方式',\n    'openLinkInCurrentWindow': '在当前窗口中打开',\n    'openLinkInNewWindow': '在新窗口中打开',\n    'removeLink': '移除链接',\n    'ol': '有序列表',\n    'ul': '无序列表',\n    'strikethrough': '删除线文字',\n    'table': '表格',\n    'deleteRow': '删除行',\n    'insertRowAbove': '在上面插入行',\n    'insertRowBelow': '在下面插入行',\n    'deleteColumn': '删除列',\n    'insertColumnLeft': '在左边插入列',\n    'insertColumnRight': '在右边插入列',\n    'deleteTable': '删除表格',\n    'title': '标题',\n    'normalText': '普通文本',\n    'underline': '下划线文字',\n    'alignment': '水平对齐',\n    'alignCenter': '居中',\n    'alignLeft': '居左',\n    'alignRight': '居右',\n    'selectLanguage': '选择程序语言',\n    'fontScale': '字体大小',\n    'fontScaleXLarge': '超大字体',\n    'fontScaleLarge': '大号字体',\n    'fontScaleNormal': '正常大小',\n    'fontScaleSmall': '小号字体',\n    'fontScaleXSmall': '超小字体',\n    'paintRow': 'Paint Row',\n    'paintCell': 'Paint Cell',\n    'dissolveRow': 'Dissolve Row',\n    'dissolveCell': 'Dissolve Cell',\n    'addBorder': 'Add borders',\n    'removeBorder': 'Delete borders',\n    'listDisc': 'List Disc',\n    'listCircle': 'List Circle',\n    'listSquare': 'List Square',\n    'listDecimal': 'List Decimal',\n    'listDecimal0': 'List Decimal 0',\n    'listUpperRoman': 'List Upper Roman',\n    'listLowerRoman': 'List Lower Roman',\n    'listUpperAlpha': 'List Upper Alpha',\n    'listLowerAlpha': 'List Lower Alpha',\n    'listGreek': 'List Greek',\n    'toggleList': 'List on/off'\n  },\n  'en-US': {\n    'blockquote': 'Block Quote',\n    'bold': 'Bold',\n    'code': 'Code',\n    'color': 'Text Color',\n    'coloredText': 'Colored Text',\n    'hr': 'Horizontal Line',\n    'image': 'Insert Image',\n    'externalImage': 'External Image',\n    'uploadImage': 'Upload Image',\n    'uploadFailed': 'Upload failed',\n    'uploadError': 'Error occurs during upload',\n    'imageUrl': 'Url',\n    'imageSize': 'Size',\n    'imageAlt': 'Alt',\n    'restoreImageSize': 'Restore Origin Size',\n    'uploading': 'Uploading',\n    'indent': 'Indent',\n    'outdent': 'Outdent',\n    'italic': 'Italic',\n    'link': 'Insert Link',\n    'linkText': 'Text',\n    'linkUrl': 'Url',\n    'linkTarget': 'Target',\n    'openLinkInCurrentWindow': 'Open link in current window',\n    'openLinkInNewWindow': 'Open link in new window',\n    'removeLink': 'Remove Link',\n    'ol': 'Ordered List',\n    'ul': 'Unordered List',\n    'strikethrough': 'Strikethrough',\n    'table': 'Table',\n    'deleteRow': 'Delete Row',\n    'insertRowAbove': 'Insert Row Above',\n    'insertRowBelow': 'Insert Row Below',\n    'deleteColumn': 'Delete Column',\n    'insertColumnLeft': 'Insert Column Left',\n    'insertColumnRight': 'Insert Column Right',\n    'deleteTable': 'Delete Table',\n    'title': 'Title',\n    'normalText': 'Text',\n    'underline': 'Underline',\n    'alignment': 'Alignment',\n    'alignCenter': 'Align Center',\n    'alignLeft': 'Align Left',\n    'alignRight': 'Align Right',\n    'alignJustify': 'Align Justify',\n    'selectLanguage': 'Select Language',\n    'fontScale': 'Font Size',\n    'fontScaleXLarge': 'X Large Size',\n    'fontScaleLarge': 'Large Size',\n    'fontScaleNormal': 'Normal Size',\n    'fontScaleSmall': 'Small Size',\n    'fontScaleXSmall': 'X Small Size',\n    'paintRow': 'Paint Row',\n    'paintCell': 'Paint Cell',\n    'dissolveRow': 'Dissolve Row',\n    'dissolveCell': 'Dissolve Cell',\n    'addBorder': 'Add borders',\n    'removeBorder': 'Delete borders',\n    'listDisc': 'List Disc',\n    'listCircle': 'List Circle',\n    'listSquare': 'List Square',\n    'listDecimal': 'List Decimal',\n    'listDecimal0': 'List Decimal 0',\n    'listUpperRoman': 'List Upper Roman',\n    'listLowerRoman': 'List Lower Roman',\n    'listUpperAlpha': 'List Upper Alpha',\n    'listLowerAlpha': 'List Lower Alpha',\n    'listGreek': 'List Greek',\n    'toggleList': 'List on/off'\n  }\n};\n\nButton = (function(superClass) {\n  extend(Button, superClass);\n\n  Button.prototype._tpl = {\n    item: '<li><a tabindex=\"-1\" unselectable=\"on\" class=\"toolbar-item\" href=\"javascript:;\"><span></span></a></li>',\n    menuWrapper: '<div class=\"toolbar-menu\"></div>',\n    menuItem: '<li><a tabindex=\"-1\" unselectable=\"on\" class=\"menu-item\" href=\"javascript:;\"><span></span></a></li>',\n    separator: '<li><span class=\"separator\"></span></li>'\n  };\n\n  Button.prototype.name = '';\n\n  Button.prototype.icon = '';\n\n  Button.prototype.title = '';\n\n  Button.prototype.text = '';\n\n  Button.prototype.htmlTag = '';\n\n  Button.prototype.disableTag = '';\n\n  Button.prototype.menu = false;\n\n  Button.prototype.active = false;\n\n  Button.prototype.disabled = false;\n\n  Button.prototype.needFocus = true;\n\n  Button.prototype.shortcut = null;\n\n  function Button(opts) {\n    this.editor = opts.editor;\n    this.title = this._t(this.name);\n    Button.__super__.constructor.call(this, opts);\n  }\n\n  Button.prototype._init = function() {\n    var k, len, ref, tag;\n    this.render();\n    this.el.on('mousedown', (function(_this) {\n      return function(e) {\n        var exceed, noFocus, param;\n        e.preventDefault();\n        noFocus = _this.needFocus && !_this.editor.inputManager.focused;\n        if (_this.el.hasClass('disabled') || noFocus) {\n          return false;\n        }\n        if (_this.menu) {\n          _this.wrapper.toggleClass('menu-on').siblings('li').removeClass('menu-on');\n          if (_this.wrapper.is('.menu-on')) {\n            exceed = _this.menuWrapper.offset().left + _this.menuWrapper.outerWidth() + 5 - _this.editor.wrapper.offset().left - _this.editor.wrapper.outerWidth();\n            if (exceed > 0) {\n              _this.menuWrapper.css({\n                'left': 'auto',\n                'right': 0\n              });\n            }\n            _this.trigger('menuexpand');\n          }\n          return false;\n        }\n        param = _this.el.data('param');\n        _this.command(param);\n        return false;\n      };\n    })(this));\n    this.wrapper.on('click', 'a.menu-item', (function(_this) {\n      return function(e) {\n        var btn, noFocus, param;\n        e.preventDefault();\n        btn = $(e.currentTarget);\n        _this.wrapper.removeClass('menu-on');\n        noFocus = _this.needFocus && !_this.editor.inputManager.focused;\n        if (btn.hasClass('disabled') || noFocus) {\n          return false;\n        }\n        _this.editor.toolbar.wrapper.removeClass('menu-on');\n        param = btn.data('param');\n        _this.command(param);\n        return false;\n      };\n    })(this));\n    this.wrapper.on('mousedown', 'a.menu-item', function(e) {\n      return false;\n    });\n    this.editor.on('blur', (function(_this) {\n      return function() {\n        var editorActive;\n        editorActive = _this.editor.body.is(':visible') && _this.editor.body.is('[contenteditable]');\n        if (!(editorActive && !_this.editor.clipboard.pasting)) {\n          return;\n        }\n        _this.setActive(false);\n        return _this.setDisabled(false);\n      };\n    })(this));\n    if (this.shortcut != null) {\n      this.editor.hotkeys.add(this.shortcut, (function(_this) {\n        return function(e) {\n          _this.el.mousedown();\n          return false;\n        };\n      })(this));\n    }\n    ref = this.htmlTag.split(',');\n    for (k = 0, len = ref.length; k < len; k++) {\n      tag = ref[k];\n      tag = $.trim(tag);\n      if (tag && $.inArray(tag, this.editor.formatter._allowedTags) < 0) {\n        this.editor.formatter._allowedTags.push(tag);\n      }\n    }\n    return this.editor.on('selectionchanged', (function(_this) {\n      return function(e) {\n        if (_this.editor.inputManager.focused) {\n          return _this._status();\n        }\n      };\n    })(this));\n  };\n\n  Button.prototype.iconClassOf = function(icon) {\n    if (icon) {\n      return \"simditor-icon simditor-icon-\" + icon;\n    } else {\n      return '';\n    }\n  };\n\n  Button.prototype.setIcon = function(icon) {\n    return this.el.find('span').removeClass().addClass(this.iconClassOf(icon)).text(this.text);\n  };\n\n  Button.prototype.render = function() {\n    this.wrapper = $(this._tpl.item).appendTo(this.editor.toolbar.list);\n    this.el = this.wrapper.find('a.toolbar-item');\n    this.el.attr('title', this.title).addClass(\"toolbar-item-\" + this.name).data('button', this);\n    this.setIcon(this.icon);\n    if (!this.menu) {\n      return;\n    }\n    this.menuWrapper = $(this._tpl.menuWrapper).appendTo(this.wrapper);\n    this.menuWrapper.addClass(\"toolbar-menu-\" + this.name);\n    return this.renderMenu();\n  };\n\n  Button.prototype.renderMenu = function() {\n    var $menuBtnEl, $menuItemEl, k, len, menuItem, ref, ref1, results;\n    if (!$.isArray(this.menu)) {\n      return;\n    }\n    this.menuEl = $('<ul/>').appendTo(this.menuWrapper);\n    ref = this.menu;\n    results = [];\n    for (k = 0, len = ref.length; k < len; k++) {\n      menuItem = ref[k];\n      if (menuItem === '|') {\n        $(this._tpl.separator).appendTo(this.menuEl);\n        continue;\n      }\n      $menuItemEl = $(this._tpl.menuItem).appendTo(this.menuEl);\n      $menuBtnEl = $menuItemEl.find('a.menu-item').attr({\n        'title': (ref1 = menuItem.title) != null ? ref1 : menuItem.text,\n        'data-param': menuItem.param\n      }).addClass('menu-item-' + menuItem.name);\n      if (menuItem.icon) {\n        results.push($menuBtnEl.find('span').addClass(this.iconClassOf(menuItem.icon)));\n      } else {\n        results.push($menuBtnEl.find('span').text(menuItem.text));\n      }\n    }\n    return results;\n  };\n\n  Button.prototype.setActive = function(active) {\n    if (active === this.active) {\n      return;\n    }\n    this.active = active;\n    return this.el.toggleClass('active', this.active);\n  };\n\n  Button.prototype.setDisabled = function(disabled) {\n    if (disabled === this.disabled) {\n      return;\n    }\n    this.disabled = disabled;\n    return this.el.toggleClass('disabled', this.disabled);\n  };\n\n  Button.prototype._disableStatus = function() {\n    var disabled, endNodes, startNodes;\n    startNodes = this.editor.selection.startNodes();\n    endNodes = this.editor.selection.endNodes();\n    disabled = startNodes.filter(this.disableTag).length > 0 || endNodes.filter(this.disableTag).length > 0;\n    this.setDisabled(disabled);\n    if (this.disabled) {\n      this.setActive(false);\n    }\n    return this.disabled;\n  };\n\n  Button.prototype._activeStatus = function() {\n    var active, endNode, endNodes, startNode, startNodes;\n    startNodes = this.editor.selection.startNodes();\n    endNodes = this.editor.selection.endNodes();\n    startNode = startNodes.filter(this.htmlTag);\n    endNode = endNodes.filter(this.htmlTag);\n    active = startNode.length > 0 && endNode.length > 0 && startNode.is(endNode);\n    this.node = active ? startNode : null;\n    this.setActive(active);\n    return this.active;\n  };\n\n  Button.prototype._status = function() {\n    this._disableStatus();\n    if (this.disabled) {\n      return;\n    }\n    return this._activeStatus();\n  };\n\n  Button.prototype.command = function(param) {};\n\n  Button.prototype._t = function() {\n    var args, ref, result;\n    args = 1 <= arguments.length ? slice.call(arguments, 0) : [];\n    result = Button.__super__._t.apply(this, args);\n    if (!result) {\n      result = (ref = this.editor)._t.apply(ref, args);\n    }\n    return result;\n  };\n\n  return Button;\n\n})(SimpleModule);\n\nSimditor.Button = Button;\n\nPopover = (function(superClass) {\n  extend(Popover, superClass);\n\n  Popover.prototype.offset = {\n    top: 4,\n    left: 0\n  };\n\n  Popover.prototype.target = null;\n\n  Popover.prototype.active = false;\n\n  function Popover(opts) {\n    this.button = opts.button;\n    this.editor = opts.button.editor;\n    Popover.__super__.constructor.call(this, opts);\n  }\n\n  Popover.prototype._init = function() {\n    this.el = $('<div class=\"simditor-popover\"></div>').appendTo(this.editor.el).data('popover', this);\n    this.render();\n    this.el.on('mouseenter', (function(_this) {\n      return function(e) {\n        return _this.el.addClass('hover');\n      };\n    })(this));\n    return this.el.on('mouseleave', (function(_this) {\n      return function(e) {\n        return _this.el.removeClass('hover');\n      };\n    })(this));\n  };\n\n  Popover.prototype.render = function() {};\n\n  Popover.prototype._initLabelWidth = function() {\n    var $fields;\n    $fields = this.el.find('.settings-field');\n    if (!($fields.length > 0)) {\n      return;\n    }\n    this._labelWidth = 0;\n    $fields.each((function(_this) {\n      return function(i, field) {\n        var $field, $label;\n        $field = $(field);\n        $label = $field.find('label');\n        if (!($label.length > 0)) {\n          return;\n        }\n        return _this._labelWidth = Math.max(_this._labelWidth, $label.width());\n      };\n    })(this));\n    return $fields.find('label').width(this._labelWidth);\n  };\n\n  Popover.prototype.show = function($target, position) {\n    if (position == null) {\n      position = 'bottom';\n    }\n    if ($target == null) {\n      return;\n    }\n    this.el.siblings('.simditor-popover').each(function(i, popover) {\n      popover = $(popover).data('popover');\n      if (popover.active) {\n        return popover.hide();\n      }\n    });\n    if (this.active && this.target) {\n      this.target.removeClass('selected');\n    }\n    this.target = $target.addClass('selected');\n    if (this.active) {\n      this.refresh(position);\n      return this.trigger('popovershow');\n    } else {\n      this.active = true;\n      this.el.css({\n        left: -9999\n      }).show();\n      if (!this._labelWidth) {\n        this._initLabelWidth();\n      }\n      this.editor.util.reflow();\n      this.refresh(position);\n      return this.trigger('popovershow');\n    }\n  };\n\n  Popover.prototype.hide = function() {\n    if (!this.active) {\n      return;\n    }\n    if (this.target) {\n      this.target.removeClass('selected');\n    }\n    this.target = null;\n    this.active = false;\n    this.el.hide();\n    return this.trigger('popoverhide');\n  };\n\n  Popover.prototype.refresh = function(position) {\n    var editorOffset, left, maxLeft, targetH, targetOffset, top;\n    if (position == null) {\n      position = 'bottom';\n    }\n    if (!this.active) {\n      return;\n    }\n    editorOffset = this.editor.el.offset();\n    targetOffset = this.target.offset();\n    targetH = this.target.outerHeight();\n    if (position === 'bottom') {\n      top = targetOffset.top - editorOffset.top + targetH;\n    } else if (position === 'top') {\n      top = targetOffset.top - editorOffset.top - this.el.height();\n    }\n    maxLeft = this.editor.wrapper.width() - this.el.outerWidth() - 10;\n    left = Math.min(targetOffset.left - editorOffset.left, maxLeft);\n    return this.el.css({\n      top: top + this.offset.top,\n      left: left + this.offset.left\n    });\n  };\n\n  Popover.prototype.destroy = function() {\n    this.target = null;\n    this.active = false;\n    this.editor.off('.linkpopover');\n    return this.el.remove();\n  };\n\n  Popover.prototype._t = function() {\n    var args, ref, result;\n    args = 1 <= arguments.length ? slice.call(arguments, 0) : [];\n    result = Popover.__super__._t.apply(this, args);\n    if (!result) {\n      result = (ref = this.button)._t.apply(ref, args);\n    }\n    return result;\n  };\n\n  return Popover;\n\n})(SimpleModule);\n\nSimditor.Popover = Popover;\n\nTitleButton = (function(superClass) {\n  extend(TitleButton, superClass);\n\n  function TitleButton() {\n    return TitleButton.__super__.constructor.apply(this, arguments);\n  }\n\n  TitleButton.prototype.name = 'title';\n\n  TitleButton.prototype.htmlTag = 'h1, h2, h3, h4, h5';\n\n  TitleButton.prototype.disableTag = 'pre, table';\n\n  TitleButton.prototype._init = function() {\n    this.menu = [\n      {\n        name: 'normal',\n        text: this._t('normalText'),\n        param: 'p'\n      }, '|', {\n        name: 'h1',\n        text: this._t('title') + ' 1',\n        param: 'h1'\n      }, {\n        name: 'h2',\n        text: this._t('title') + ' 2',\n        param: 'h2'\n      }, {\n        name: 'h3',\n        text: this._t('title') + ' 3',\n        param: 'h3'\n      }, {\n        name: 'h4',\n        text: this._t('title') + ' 4',\n        param: 'h4'\n      }, {\n        name: 'h5',\n        text: this._t('title') + ' 5',\n        param: 'h5'\n      }\n    ];\n    return TitleButton.__super__._init.call(this);\n  };\n\n  TitleButton.prototype.setActive = function(active, param) {\n    TitleButton.__super__.setActive.call(this, active);\n    if (active) {\n      param || (param = this.node[0].tagName.toLowerCase());\n    }\n    this.el.removeClass('active-p active-h1 active-h2 active-h3 active-h4 active-h5');\n    if (active) {\n      return this.el.addClass('active active-' + param);\n    }\n  };\n\n  TitleButton.prototype.command = function(param) {\n    var $rootNodes;\n    $rootNodes = this.editor.selection.rootNodes();\n    this.editor.selection.save();\n    $rootNodes.each((function(_this) {\n      return function(i, node) {\n        var $node;\n        $node = $(node);\n        if ($node.is('blockquote') || $node.is(param) || $node.is(_this.disableTag) || _this.editor.util.isDecoratedNode($node)) {\n          return;\n        }\n        return $('<' + param + '/>').append($node.contents()).replaceAll($node);\n      };\n    })(this));\n    this.editor.selection.restore();\n    return this.editor.trigger('valuechanged');\n  };\n\n  return TitleButton;\n\n})(Button);\n\nSimditor.Toolbar.addButton(TitleButton);\n\nFontScaleButton = (function(superClass) {\n  extend(FontScaleButton, superClass);\n\n  function FontScaleButton() {\n    return FontScaleButton.__super__.constructor.apply(this, arguments);\n  }\n\n  FontScaleButton.prototype.name = 'fontScale';\n\n  FontScaleButton.prototype.icon = 'font';\n\n  FontScaleButton.prototype.disableTag = 'pre';\n\n  FontScaleButton.prototype.htmlTag = 'span';\n\n  FontScaleButton.prototype.sizeMap = {\n    'x-large': '1.5em',\n    'large': '1.25em',\n    'small': '.75em',\n    'x-small': '.5em'\n  };\n\n  FontScaleButton.prototype._init = function() {\n    this.menu = [\n      {\n        name: '150%',\n        text: this._t('fontScaleXLarge'),\n        param: '5'\n      }, {\n        name: '125%',\n        text: this._t('fontScaleLarge'),\n        param: '4'\n      }, {\n        name: '100%',\n        text: this._t('fontScaleNormal'),\n        param: '3'\n      }, {\n        name: '75%',\n        text: this._t('fontScaleSmall'),\n        param: '2'\n      }, {\n        name: '50%',\n        text: this._t('fontScaleXSmall'),\n        param: '1'\n      }\n    ];\n    return FontScaleButton.__super__._init.call(this);\n  };\n\n  FontScaleButton.prototype._activeStatus = function() {\n    var active, endNode, endNodes, range, startNode, startNodes;\n    range = this.editor.selection.range();\n    startNodes = this.editor.selection.startNodes();\n    endNodes = this.editor.selection.endNodes();\n    startNode = startNodes.filter('span[style*=\"font-size\"]');\n    endNode = endNodes.filter('span[style*=\"font-size\"]');\n    active = startNodes.length > 0 && endNodes.length > 0 && startNode.is(endNode);\n    this.setActive(active);\n    return this.active;\n  };\n\n  FontScaleButton.prototype.command = function(param) {\n    var $scales, containerNode, range;\n    range = this.editor.selection.range();\n    if (range.collapsed) {\n      return;\n    }\n    document.execCommand('styleWithCSS', false, true);\n    document.execCommand('fontSize', false, param);\n    document.execCommand('styleWithCSS', false, false);\n    this.editor.selection.reset();\n    this.editor.selection.range();\n    containerNode = this.editor.selection.containerNode();\n    if (containerNode[0].nodeType === Node.TEXT_NODE) {\n      $scales = containerNode.closest('span[style*=\"font-size\"]');\n    } else {\n      $scales = containerNode.find('span[style*=\"font-size\"]');\n    }\n    $scales.each((function(_this) {\n      return function(i, n) {\n        var $span, size;\n        $span = $(n);\n        size = n.style.fontSize;\n        if (/large|x-large|small|x-small/.test(size)) {\n          return $span.css('fontSize', _this.sizeMap[size]);\n        } else if (size === 'medium') {\n          return $span.replaceWith($span.contents());\n        }\n      };\n    })(this));\n    return this.editor.trigger('valuechanged');\n  };\n\n  return FontScaleButton;\n\n})(Button);\n\nSimditor.Toolbar.addButton(FontScaleButton);\n\nBoldButton = (function(superClass) {\n  extend(BoldButton, superClass);\n\n  function BoldButton() {\n    return BoldButton.__super__.constructor.apply(this, arguments);\n  }\n\n  BoldButton.prototype.name = 'bold';\n\n  BoldButton.prototype.icon = 'bold';\n\n  BoldButton.prototype.htmlTag = 'b, strong';\n\n  BoldButton.prototype.disableTag = 'pre';\n\n  BoldButton.prototype.shortcut = 'cmd+b';\n\n  BoldButton.prototype._init = function() {\n    if (this.editor.util.os.mac) {\n      this.title = this.title + ' ( Cmd + b )';\n    } else {\n      this.title = this.title + ' ( Ctrl + b )';\n      this.shortcut = 'ctrl+b';\n    }\n    return BoldButton.__super__._init.call(this);\n  };\n\n  BoldButton.prototype._activeStatus = function() {\n    var active;\n    active = document.queryCommandState('bold') === true;\n    this.setActive(active);\n    return this.active;\n  };\n\n  BoldButton.prototype.command = function() {\n    document.execCommand('bold');\n    if (!this.editor.util.support.oninput) {\n      this.editor.trigger('valuechanged');\n    }\n    return $(document).trigger('selectionchange');\n  };\n\n  return BoldButton;\n\n})(Button);\n\nSimditor.Toolbar.addButton(BoldButton);\n\nItalicButton = (function(superClass) {\n  extend(ItalicButton, superClass);\n\n  function ItalicButton() {\n    return ItalicButton.__super__.constructor.apply(this, arguments);\n  }\n\n  ItalicButton.prototype.name = 'italic';\n\n  ItalicButton.prototype.icon = 'italic';\n\n  ItalicButton.prototype.htmlTag = 'i';\n\n  ItalicButton.prototype.disableTag = 'pre';\n\n  ItalicButton.prototype.shortcut = 'cmd+i';\n\n  ItalicButton.prototype._init = function() {\n    if (this.editor.util.os.mac) {\n      this.title = this.title + \" ( Cmd + i )\";\n    } else {\n      this.title = this.title + \" ( Ctrl + i )\";\n      this.shortcut = 'ctrl+i';\n    }\n    return ItalicButton.__super__._init.call(this);\n  };\n\n  ItalicButton.prototype._activeStatus = function() {\n    var active;\n    active = document.queryCommandState('italic') === true;\n    this.setActive(active);\n    return this.active;\n  };\n\n  ItalicButton.prototype.command = function() {\n    document.execCommand('italic');\n    if (!this.editor.util.support.oninput) {\n      this.editor.trigger('valuechanged');\n    }\n    return $(document).trigger('selectionchange');\n  };\n\n  return ItalicButton;\n\n})(Button);\n\nSimditor.Toolbar.addButton(ItalicButton);\n\nUnderlineButton = (function(superClass) {\n  extend(UnderlineButton, superClass);\n\n  function UnderlineButton() {\n    return UnderlineButton.__super__.constructor.apply(this, arguments);\n  }\n\n  UnderlineButton.prototype.name = 'underline';\n\n  UnderlineButton.prototype.icon = 'underline';\n\n  UnderlineButton.prototype.htmlTag = 'u';\n\n  UnderlineButton.prototype.disableTag = 'pre';\n\n  UnderlineButton.prototype.shortcut = 'cmd+u';\n\n  UnderlineButton.prototype.render = function() {\n    if (this.editor.util.os.mac) {\n      this.title = this.title + ' ( Cmd + u )';\n    } else {\n      this.title = this.title + ' ( Ctrl + u )';\n      this.shortcut = 'ctrl+u';\n    }\n    return UnderlineButton.__super__.render.call(this);\n  };\n\n  UnderlineButton.prototype._activeStatus = function() {\n    var active;\n    active = document.queryCommandState('underline') === true;\n    this.setActive(active);\n    return this.active;\n  };\n\n  UnderlineButton.prototype.command = function() {\n    document.execCommand('underline');\n    if (!this.editor.util.support.oninput) {\n      this.editor.trigger('valuechanged');\n    }\n    return $(document).trigger('selectionchange');\n  };\n\n  return UnderlineButton;\n\n})(Button);\n\nSimditor.Toolbar.addButton(UnderlineButton);\n\nColorButton = (function(superClass) {\n  extend(ColorButton, superClass);\n\n  function ColorButton() {\n    return ColorButton.__super__.constructor.apply(this, arguments);\n  }\n\n  ColorButton.prototype.name = 'color';\n\n  ColorButton.prototype.icon = 'tint';\n\n  ColorButton.prototype.disableTag = 'pre';\n\n  ColorButton.prototype.menu = true;\n\n  ColorButton.prototype.render = function() {\n    var args;\n    args = 1 <= arguments.length ? slice.call(arguments, 0) : [];\n    return ColorButton.__super__.render.apply(this, args);\n  };\n\n  ColorButton.prototype.renderMenu = function() {\n    $('<ul class=\"color-list\">\\n  <li><a href=\"javascript:;\" class=\"font-color font-color-1\"></a></li>\\n  <li><a href=\"javascript:;\" class=\"font-color font-color-2\"></a></li>\\n  <li><a href=\"javascript:;\" class=\"font-color font-color-3\"></a></li>\\n  <li><a href=\"javascript:;\" class=\"font-color font-color-4\"></a></li>\\n  <li><a href=\"javascript:;\" class=\"font-color font-color-5\"></a></li>\\n  <li><a href=\"javascript:;\" class=\"font-color font-color-6\"></a></li>\\n  <li><a href=\"javascript:;\" class=\"font-color font-color-7\"></a></li>\\n  <li><a href=\"javascript:;\" class=\"font-color font-color-default\"></a></li>\\n</ul>').appendTo(this.menuWrapper);\n    this.menuWrapper.on('mousedown', '.color-list', function(e) {\n      return false;\n    });\n    return this.menuWrapper.on('click', '.font-color', (function(_this) {\n      return function(e) {\n        var $link, $p, hex, range, rgb, textNode;\n        _this.wrapper.removeClass('menu-on');\n        $link = $(e.currentTarget);\n        if ($link.hasClass('font-color-default')) {\n          $p = _this.editor.body.find('p, li');\n          if (!($p.length > 0)) {\n            return;\n          }\n          rgb = window.getComputedStyle($p[0], null).getPropertyValue('color');\n          hex = _this._convertRgbToHex(rgb);\n        } else {\n          rgb = window.getComputedStyle($link[0], null).getPropertyValue('background-color');\n          hex = _this._convertRgbToHex(rgb);\n        }\n        if (!hex) {\n          return;\n        }\n        range = _this.editor.selection.range();\n        if (!$link.hasClass('font-color-default') && range.collapsed) {\n          textNode = document.createTextNode(_this._t('coloredText'));\n          range.insertNode(textNode);\n          range.selectNodeContents(textNode);\n          _this.editor.selection.range(range);\n        }\n        document.execCommand('styleWithCSS', false, true);\n        document.execCommand('foreColor', false, hex);\n        document.execCommand('styleWithCSS', false, false);\n        if (!_this.editor.util.support.oninput) {\n          return _this.editor.trigger('valuechanged');\n        }\n      };\n    })(this));\n  };\n\n  ColorButton.prototype._convertRgbToHex = function(rgb) {\n    var match, re, rgbToHex;\n    re = /rgb\\((\\d+),\\s?(\\d+),\\s?(\\d+)\\)/g;\n    match = re.exec(rgb);\n    if (!match) {\n      return '';\n    }\n    rgbToHex = function(r, g, b) {\n      var componentToHex;\n      componentToHex = function(c) {\n        var hex;\n        hex = c.toString(16);\n        if (hex.length === 1) {\n          return '0' + hex;\n        } else {\n          return hex;\n        }\n      };\n      return \"#\" + componentToHex(r) + componentToHex(g) + componentToHex(b);\n    };\n    return rgbToHex(match[1] * 1, match[2] * 1, match[3] * 1);\n  };\n\n  return ColorButton;\n\n})(Button);\n\nSimditor.Toolbar.addButton(ColorButton);\n\nListButton = (function(superClass) {\n  extend(ListButton, superClass);\n\n  function ListButton() {\n    return ListButton.__super__.constructor.apply(this, arguments);\n  }\n\n  ListButton.prototype.type = '';\n\n  ListButton.prototype.disableTag = 'pre, table';\n\n  ListButton.prototype.command = function(param) {\n    var $list, $rootNodes, anotherType;\n    $rootNodes = this.editor.selection.blockNodes();\n    anotherType = this.type === 'ul' ? 'ol' : 'ul';\n    this.editor.selection.save();\n    $list = null;\n    $rootNodes.each((function(_this) {\n      return function(i, node) {\n        var $node;\n        $node = $(node);\n        if ($node.is('blockquote, li') || $node.is(_this.disableTag) || _this.editor.util.isDecoratedNode($node) || !$.contains(document, node)) {\n          return;\n        }\n        if ($node.is(_this.type)) {\n          $node.children('li').each(function(i, li) {\n            var $childList, $li;\n            $li = $(li);\n            $childList = $li.children('ul, ol').insertAfter($node);\n            return $('<p/>').append($(li).html() || _this.editor.util.phBr).insertBefore($node);\n          });\n          return $node.remove();\n        } else if ($node.is(anotherType)) {\n          return $('<' + _this.type + '/>').append($node.contents()).replaceAll($node);\n        } else if ($list && $node.prev().is($list)) {\n          $('<li/>').append($node.html() || _this.editor.util.phBr).appendTo($list);\n          return $node.remove();\n        } else {\n          $list = $(\"<\" + _this.type + \"><li></li></\" + _this.type + \">\");\n          $list.find('li').append($node.html() || _this.editor.util.phBr);\n          return $list.replaceAll($node);\n        }\n      };\n    })(this));\n    this.editor.selection.restore();\n    return this.editor.trigger('valuechanged');\n  };\n\n  return ListButton;\n\n})(Button);\n\nOrderListButton = (function(superClass) {\n  extend(OrderListButton, superClass);\n\n  function OrderListButton() {\n    return OrderListButton.__super__.constructor.apply(this, arguments);\n  }\n\n  OrderListButton.prototype.type = 'ol';\n\n  OrderListButton.prototype.name = 'ol';\n\n  OrderListButton.prototype.icon = 'list-ol';\n\n  OrderListButton.prototype.htmlTag = 'ol';\n\n  OrderListButton.prototype.shortcut = 'cmd+/';\n\n  OrderListButton.prototype._init = function() {\n    if (this.editor.util.os.mac) {\n      this.title = this.title + ' ( Cmd + / )';\n    } else {\n      this.title = this.title + ' ( ctrl + / )';\n      this.shortcut = 'ctrl+/';\n    }\n    return OrderListButton.__super__._init.call(this);\n  };\n\n  return OrderListButton;\n\n})(ListButton);\n\nSimditor.Toolbar.addButton(OrderListButton);\n\nOrderListStyleButton = (function(superClass) { //mod-for-jl\n  extend(OrderListStyleButton, superClass);\n\n  function OrderListStyleButton() {\n    return OrderListStyleButton.__super__.constructor.apply(this, arguments);\n  }\n\n  OrderListStyleButton.prototype.name = 'ols';\n\n  OrderListStyleButton.prototype.icon = 'list-ul';\n\n  OrderListStyleButton.prototype.type = 'ol';\n\n  OrderListStyleButton.prototype.htmlTag = 'ol';\n\n  OrderListStyleButton.prototype.disableTag = 'pre, table';\n\n  OrderListStyleButton.prototype.menu = true;\n\n  OrderListStyleButton.prototype.shortcut = 'cmd+/';\n\n  OrderListStyleButton.prototype._init = function() {\n    $.extend(this.editor.formatter._allowedStyles, {\n      ol: ['list-style-type']\n    });\n    if (this.editor.util.os.mac) {\n      this.title = this.title + ' ( Cmd + / )';\n    } else {\n      this.title = this.title + ' ( ctrl + / )';\n      this.shortcut = 'ctrl+/';\n    }\n    return OrderListStyleButton.__super__._init.call(this);\n  };\n\n  OrderListStyleButton.prototype.renderMenu = function() {\n    $(\"<div class=\\\"menu-create-list\\\">\\n</div>\\n<div class=\\\"menu-edit-list\\\">\\n  <ul>\\n    <li>\\n      <a tabindex=\\\"-1\\\" unselectable=\\\"on\\\" class=\\\"menu-item\\\"\\n        href=\\\"javascript:;\\\" data-param=\\\"listDisc\\\">\\n        <span>\" + (this._t('listDisc')) + \"</span>\\n      </a>\\n    </li>\\n    <li>\\n      <a tabindex=\\\"-1\\\" unselectable=\\\"on\\\" class=\\\"menu-item\\\"\\n        href=\\\"javascript:;\\\" data-param=\\\"listCircle\\\">\\n        <span>\" + (this._t('listCircle')) + \" </span>\\n      </a>\\n    </li>\\n    <li>\\n      <a tabindex=\\\"-1\\\" unselectable=\\\"on\\\" class=\\\"menu-item\\\"\\n        href=\\\"javascript:;\\\" data-param=\\\"listSquare\\\">\\n        <span>\" + (this._t('listSquare')) + \"</span>\\n      </a>\\n    </li>\\n    <li><span class=\\\"separator\\\"></span></li>\\n    <li>\\n      <a tabindex=\\\"-1\\\" unselectable=\\\"on\\\" class=\\\"menu-item\\\"\\n        href=\\\"javascript:;\\\" data-param=\\\"listDecimal\\\">\\n        <span>\" + (this._t('listDecimal')) + \" </span>\\n      </a>\\n    </li>\\n    <li>\\n      <a tabindex=\\\"-1\\\" unselectable=\\\"on\\\" class=\\\"menu-item\\\"\\n        href=\\\"javascript:;\\\" data-param=\\\"listDecimal0\\\">\\n        <span>\" + (this._t('listDecimal0')) + \" </span>\\n      </a>\\n    </li>\\n    <li>\\n      <a tabindex=\\\"-1\\\" unselectable=\\\"on\\\" class=\\\"menu-item\\\"\\n        href=\\\"javascript:;\\\" data-param=\\\"listUpperRoman\\\">\\n        <span>\" + (this._t('listUpperRoman')) + \" </span>\\n      </a>\\n    </li>\\n    <li>\\n      <a tabindex=\\\"-1\\\" unselectable=\\\"on\\\" class=\\\"menu-item\\\"\\n        href=\\\"javascript:;\\\" data-param=\\\"listLowerRoman\\\">\\n        <span>\" + (this._t('listLowerRoman')) + \"</span>\\n      </a>\\n    </li>\\n    <li><span class=\\\"separator\\\"></span></li>\\n    <li>\\n      <a tabindex=\\\"-1\\\" unselectable=\\\"on\\\" class=\\\"menu-item\\\"\\n        href=\\\"javascript:;\\\" data-param=\\\"listUpperAlpha\\\">\\n        <span>\" + (this._t('listUpperAlpha')) + \" </span>\\n      </a>\\n    </li>\\n    <li>\\n      <a tabindex=\\\"-1\\\" unselectable=\\\"on\\\" class=\\\"menu-item\\\"\\n        href=\\\"javascript:;\\\" data-param=\\\"listLowerAlpha\\\">\\n        <span>\" + (this._t('listLowerAlpha')) + \" </span>\\n      </a>\\n    </li>\\n    <li>\\n      <a tabindex=\\\"-1\\\" unselectable=\\\"on\\\" class=\\\"menu-item\\\"\\n        href=\\\"javascript:;\\\" data-param=\\\"listGreek\\\">\\n        <span>\" + (this._t('listGreek')) + \" </span>\\n      </a>\\n    </li>\\n    <li>\\n      <a tabindex=\\\"-1\\\" unselectable=\\\"on\\\" class=\\\"menu-item\\\"\\n        href=\\\"javascript:;\\\" data-param=\\\"toggleList\\\">\\n        <span>\" + (this._t('toggleList')) + \" </span>\\n      </a>\\n    </li>\\n    </ul>\\n</div>\").appendTo(this.menuWrapper);\n    this.createMenu = this.menuWrapper.find('.menu-create-list');\n    this.editMenu = this.menuWrapper.find('.menu-edit-list');\n  };\n\n  OrderListStyleButton.prototype.command = function(param) {//mod-for-jl\n    var $ol, type, sw_mod;\n    type = {\n        'listDisc': 'disc',\n        'listCircle': 'circle',\n        'listSquare': 'square',\n        'listDecimal': 'decimal',\n        'listDecimal0': 'decimal-leading-zero',\n        'listUpperRoman': 'upper-roman',\n        'listLowerRoman': 'lower-roman',\n        'listUpperAlpha': 'upper-alpha',\n        'listLowerAlpha': 'lower-alpha',\n        'listGreek': 'lower-greek',\n    };\n\n    $ol = this.editor.selection.containerNode();\n    if (type[param]) {\n      while(!$ol.is('ol')){\n        if($ol.is('div.simditor-body')) break;\n        $ol = $ol.parent();\n      }\n      if(!$ol.is('div.simditor-body')) {\n        $ol.css('list-style-type', type[param])\n        return this.editor.trigger('valuechanged');\n      }\n    }\n\n    // codigo copeado de listButton\n    var $list, $rootNodes, anotherType;\n    $rootNodes = this.editor.selection.blockNodes();\n    anotherType = this.type === 'ul' ? 'ol' : 'ul';\n    this.editor.selection.save();\n    $list = null;\n    $rootNodes.each((function(_this) {\n      return function(i, node) {\n        var $node;\n        $node = $(node);\n        if ($node.is('blockquote, li') || $node.is(_this.disableTag) || _this.editor.util.isDecoratedNode($node) || !$.contains(document, node)) {\n          return;\n        }\n        if ($node.is(_this.type)) {\n          $node.children('li').each(function(i, li) {\n            var $childList, $li;\n            $li = $(li);\n            $childList = $li.children('ul, ol').insertAfter($node);\n            return $('<p/>').append($(li).html() || _this.editor.util.phBr).insertBefore($node);\n          });\n          return $node.remove();\n        } else if ($node.is(anotherType)) {\n          return $('<' + _this.type + '/>').append($node.contents()).replaceAll($node);\n        } else if ($list && $node.prev().is($list)) {\n          $('<li/>').append($node.html() || _this.editor.util.phBr).appendTo($list);\n          return $node.remove();\n        } else {\n          $list = $(\"<\" + _this.type + \"><li></li></\" + _this.type + \">\");\n          $list.find('li').append($node.html() || _this.editor.util.phBr);\n          return $list.replaceAll($node);\n        }\n      };\n    })(this));\n    this.editor.selection.restore();\n\n    if (type[param] && $list) { $list.css('list-style-type', type[param]) }\n\n    return this.editor.trigger('valuechanged');\n  };\n\n  return OrderListStyleButton;\n\n})(Button);\n\nSimditor.Toolbar.addButton(OrderListStyleButton);//mod-for-jl\n\n/*\nOrderListButton = (function(superClass) {\n  extend(OrderListButton, superClass);\n\n  function OrderListButton() {\n    return OrderListButton.__super__.constructor.apply(this, arguments);\n  }\n\n  OrderListButton.prototype.type = 'ol';\n\n  OrderListButton.prototype.name = 'ol';\n\n  OrderListButton.prototype.icon = 'list-ol';\n\n  OrderListButton.prototype.htmlTag = 'ol';\n\n  OrderListButton.prototype.shortcut = 'cmd+/';\n\n  OrderListButton.prototype._init = function() {\n    if (this.editor.util.os.mac) {\n      this.title = this.title + ' ( Cmd + / )';\n    } else {\n      this.title = this.title + ' ( ctrl + / )';\n      this.shortcut = 'ctrl+/';\n    }\n    return OrderListButton.__super__._init.call(this);\n  };\n\n  return OrderListButton;\n\n})(ListButton);\nUnorderListButton = (function(superClass) {\n  extend(UnorderListButton, superClass);\n\n  function UnorderListButton() {\n    return UnorderListButton.__super__.constructor.apply(this, arguments);\n  }\n\n  UnorderListButton.prototype.type = 'ul';\n\n  UnorderListButton.prototype.name = 'ul';\n\n  UnorderListButton.prototype.icon = 'list-ul';\n\n  UnorderListButton.prototype.htmlTag = 'ul';\n\n  UnorderListButton.prototype.shortcut = 'cmd+.';\n\n  UnorderListButton.prototype._init = function() {\n    if (this.editor.util.os.mac) {\n      this.title = this.title + ' ( Cmd + . )';\n    } else {\n      this.title = this.title + ' ( Ctrl + . )';\n      this.shortcut = 'ctrl+.';\n    }\n    return UnorderListButton.__super__._init.call(this);\n  };\n\n  return UnorderListButton;\n\n})(ListButton);\nSimditor.Toolbar.addButton(OrderListButton);\nSimditor.Toolbar.addButton(UnorderListButton);\n*/\nBlockquoteButton = (function(superClass) {\n  extend(BlockquoteButton, superClass);\n\n  function BlockquoteButton() {\n    return BlockquoteButton.__super__.constructor.apply(this, arguments);\n  }\n\n  BlockquoteButton.prototype.name = 'blockquote';\n\n  BlockquoteButton.prototype.icon = 'quote-left';\n\n  BlockquoteButton.prototype.htmlTag = 'blockquote';\n\n  BlockquoteButton.prototype.disableTag = 'pre, table';\n\n  BlockquoteButton.prototype.command = function() {\n    var $rootNodes, clearCache, nodeCache;\n    $rootNodes = this.editor.selection.rootNodes();\n    $rootNodes = $rootNodes.filter(function(i, node) {\n      return !$(node).parent().is('blockquote');\n    });\n    this.editor.selection.save();\n    nodeCache = [];\n    clearCache = (function(_this) {\n      return function() {\n        if (nodeCache.length > 0) {\n          $(\"<\" + _this.htmlTag + \"/>\").insertBefore(nodeCache[0]).append(nodeCache);\n          return nodeCache.length = 0;\n        }\n      };\n    })(this);\n    $rootNodes.each((function(_this) {\n      return function(i, node) {\n        var $node;\n        $node = $(node);\n        if (!$node.parent().is(_this.editor.body)) {\n          return;\n        }\n        if ($node.is(_this.htmlTag)) {\n          clearCache();\n          return $node.children().unwrap();\n        } else if ($node.is(_this.disableTag) || _this.editor.util.isDecoratedNode($node)) {\n          return clearCache();\n        } else {\n          return nodeCache.push(node);\n        }\n      };\n    })(this));\n    clearCache();\n    this.editor.selection.restore();\n    return this.editor.trigger('valuechanged');\n  };\n\n  return BlockquoteButton;\n\n})(Button);\n\nSimditor.Toolbar.addButton(BlockquoteButton);\n\nCodeButton = (function(superClass) {\n  extend(CodeButton, superClass);\n\n  function CodeButton() {\n    return CodeButton.__super__.constructor.apply(this, arguments);\n  }\n\n  CodeButton.prototype.name = 'code';\n\n  CodeButton.prototype.icon = 'code';\n\n  CodeButton.prototype.htmlTag = 'pre';\n\n  CodeButton.prototype.disableTag = 'ul, ol, table';\n\n  CodeButton.prototype._init = function() {\n    CodeButton.__super__._init.call(this);\n    this.editor.on('decorate', (function(_this) {\n      return function(e, $el) {\n        return $el.find('pre').each(function(i, pre) {\n          return _this.decorate($(pre));\n        });\n      };\n    })(this));\n    return this.editor.on('undecorate', (function(_this) {\n      return function(e, $el) {\n        return $el.find('pre').each(function(i, pre) {\n          return _this.undecorate($(pre));\n        });\n      };\n    })(this));\n  };\n\n  CodeButton.prototype.render = function() {\n    var args;\n    args = 1 <= arguments.length ? slice.call(arguments, 0) : [];\n    CodeButton.__super__.render.apply(this, args);\n    return this.popover = new CodePopover({\n      button: this\n    });\n  };\n\n  CodeButton.prototype._checkMode = function() {\n    var $blockNodes, range;\n    range = this.editor.selection.range();\n    if (($blockNodes = $(range.cloneContents()).find(this.editor.util.blockNodes.join(','))) > 0 || (range.collapsed && this.editor.selection.startNodes().filter('code').length === 0)) {\n      this.inlineMode = false;\n      return this.htmlTag = 'pre';\n    } else {\n      this.inlineMode = true;\n      return this.htmlTag = 'code';\n    }\n  };\n\n  CodeButton.prototype._status = function() {\n    this._checkMode();\n    CodeButton.__super__._status.call(this);\n    if (this.inlineMode) {\n      return;\n    }\n    if (this.active) {\n      return this.popover.show(this.node);\n    } else {\n      return this.popover.hide();\n    }\n  };\n\n  CodeButton.prototype.decorate = function($pre) {\n    var $code, lang, ref, ref1;\n    $code = $pre.find('> code');\n    if ($code.length > 0) {\n      lang = (ref = $code.attr('class')) != null ? (ref1 = ref.match(/lang-(\\S+)/)) != null ? ref1[1] : void 0 : void 0;\n      $code.contents().unwrap();\n      if (lang) {\n        return $pre.attr('data-lang', lang);\n      }\n    }\n  };\n\n  CodeButton.prototype.undecorate = function($pre) {\n    var $code, lang;\n    lang = $pre.attr('data-lang');\n    $code = $('<code/>');\n    if (lang && lang !== -1) {\n      $code.addClass('lang-' + lang);\n    }\n    return $pre.wrapInner($code).removeAttr('data-lang');\n  };\n\n  CodeButton.prototype.command = function() {\n    if (this.inlineMode) {\n      return this._inlineCommand();\n    } else {\n      return this._blockCommand();\n    }\n  };\n\n  CodeButton.prototype._blockCommand = function() {\n    var $rootNodes, clearCache, nodeCache, resultNodes;\n    $rootNodes = this.editor.selection.rootNodes();\n    nodeCache = [];\n    resultNodes = [];\n    clearCache = (function(_this) {\n      return function() {\n        var $pre;\n        if (!(nodeCache.length > 0)) {\n          return;\n        }\n        $pre = $(\"<\" + _this.htmlTag + \"/>\").insertBefore(nodeCache[0]).text(_this.editor.formatter.clearHtml(nodeCache));\n        resultNodes.push($pre[0]);\n        return nodeCache.length = 0;\n      };\n    })(this);\n    $rootNodes.each((function(_this) {\n      return function(i, node) {\n        var $node, $p;\n        $node = $(node);\n        if ($node.is(_this.htmlTag)) {\n          clearCache();\n          $p = $('<p/>').append($node.html().replace('\\n', '<br/>')).replaceAll($node);\n          return resultNodes.push($p[0]);\n        } else if ($node.is(_this.disableTag) || _this.editor.util.isDecoratedNode($node) || $node.is('blockquote')) {\n          return clearCache();\n        } else {\n          return nodeCache.push(node);\n        }\n      };\n    })(this));\n    clearCache();\n    this.editor.selection.setRangeAtEndOf($(resultNodes).last());\n    return this.editor.trigger('valuechanged');\n  };\n\n  CodeButton.prototype._inlineCommand = function() {\n    var $code, $contents, range;\n    range = this.editor.selection.range();\n    if (this.active) {\n      range.selectNodeContents(this.node[0]);\n      this.editor.selection.save(range);\n      this.node.contents().unwrap();\n      this.editor.selection.restore();\n    } else {\n      $contents = $(range.extractContents());\n      $code = $(\"<\" + this.htmlTag + \"/>\").append($contents.contents());\n      range.insertNode($code[0]);\n      range.selectNodeContents($code[0]);\n      this.editor.selection.range(range);\n    }\n    return this.editor.trigger('valuechanged');\n  };\n\n  return CodeButton;\n\n})(Button);\n\nCodePopover = (function(superClass) {\n  extend(CodePopover, superClass);\n\n  function CodePopover() {\n    return CodePopover.__super__.constructor.apply(this, arguments);\n  }\n\n  CodePopover.prototype.render = function() {\n    var $option, k, lang, len, ref;\n    this._tpl = \"<div class=\\\"code-settings\\\">\\n  <div class=\\\"settings-field\\\">\\n    <select class=\\\"select-lang\\\">\\n      <option value=\\\"-1\\\">\" + (this._t('selectLanguage')) + \"</option>\\n    </select>\\n  </div>\\n</div>\";\n    this.langs = this.editor.opts.codeLanguages || [\n      {\n        name: 'Bash',\n        value: 'bash'\n      }, {\n        name: 'C++',\n        value: 'c++'\n      }, {\n        name: 'C#',\n        value: 'cs'\n      }, {\n        name: 'CSS',\n        value: 'css'\n      }, {\n        name: 'Erlang',\n        value: 'erlang'\n      }, {\n        name: 'Less',\n        value: 'less'\n      }, {\n        name: 'Sass',\n        value: 'sass'\n      }, {\n        name: 'Diff',\n        value: 'diff'\n      }, {\n        name: 'CoffeeScript',\n        value: 'coffeescript'\n      }, {\n        name: 'HTML,XML',\n        value: 'html'\n      }, {\n        name: 'JSON',\n        value: 'json'\n      }, {\n        name: 'Java',\n        value: 'java'\n      }, {\n        name: 'JavaScript',\n        value: 'js'\n      }, {\n        name: 'Markdown',\n        value: 'markdown'\n      }, {\n        name: 'Objective C',\n        value: 'oc'\n      }, {\n        name: 'PHP',\n        value: 'php'\n      }, {\n        name: 'Perl',\n        value: 'parl'\n      }, {\n        name: 'Python',\n        value: 'python'\n      }, {\n        name: 'Ruby',\n        value: 'ruby'\n      }, {\n        name: 'SQL',\n        value: 'sql'\n      }\n    ];\n    this.el.addClass('code-popover').append(this._tpl);\n    this.selectEl = this.el.find('.select-lang');\n    ref = this.langs;\n    for (k = 0, len = ref.length; k < len; k++) {\n      lang = ref[k];\n      $option = $('<option/>', {\n        text: lang.name,\n        value: lang.value\n      }).appendTo(this.selectEl);\n    }\n    this.selectEl.on('change', (function(_this) {\n      return function(e) {\n        var selected;\n        _this.lang = _this.selectEl.val();\n        selected = _this.target.hasClass('selected');\n        _this.target.removeClass().removeAttr('data-lang');\n        if (_this.lang !== -1) {\n          _this.target.attr('data-lang', _this.lang);\n        }\n        if (selected) {\n          _this.target.addClass('selected');\n        }\n        return _this.editor.trigger('valuechanged');\n      };\n    })(this));\n    return this.editor.on('valuechanged', (function(_this) {\n      return function(e) {\n        if (_this.active) {\n          return _this.refresh();\n        }\n      };\n    })(this));\n  };\n\n  CodePopover.prototype.show = function() {\n    var args;\n    args = 1 <= arguments.length ? slice.call(arguments, 0) : [];\n    CodePopover.__super__.show.apply(this, args);\n    this.lang = this.target.attr('data-lang');\n    if (this.lang != null) {\n      return this.selectEl.val(this.lang);\n    } else {\n      return this.selectEl.val(-1);\n    }\n  };\n\n  return CodePopover;\n\n})(Popover);\n\nSimditor.Toolbar.addButton(CodeButton);\n\nLinkButton = (function(superClass) {\n  extend(LinkButton, superClass);\n\n  function LinkButton() {\n    return LinkButton.__super__.constructor.apply(this, arguments);\n  }\n\n  LinkButton.prototype.name = 'link';\n\n  LinkButton.prototype.icon = 'link';\n\n  LinkButton.prototype.htmlTag = 'a';\n\n  LinkButton.prototype.disableTag = 'pre';\n\n  LinkButton.prototype.render = function() {\n    var args;\n    args = 1 <= arguments.length ? slice.call(arguments, 0) : [];\n    LinkButton.__super__.render.apply(this, args);\n    return this.popover = new LinkPopover({\n      button: this\n    });\n  };\n\n  LinkButton.prototype._status = function() {\n    LinkButton.__super__._status.call(this);\n    if (this.active && !this.editor.selection.rangeAtEndOf(this.node)) {\n      return this.popover.show(this.node);\n    } else {\n      return this.popover.hide();\n    }\n  };\n\n  LinkButton.prototype.command = function() {\n    var $contents, $link, $newBlock, linkText, range, txtNode;\n    range = this.editor.selection.range();\n    if (this.active) {\n      txtNode = document.createTextNode(this.node.text());\n      this.node.replaceWith(txtNode);\n      range.selectNode(txtNode);\n    } else {\n      $contents = $(range.extractContents());\n      linkText = this.editor.formatter.clearHtml($contents.contents(), false);\n      $link = $('<a/>', {\n        href: 'http://www.example.com',\n        target: '_blank',\n        text: linkText || this._t('linkText')\n      });\n      if (this.editor.selection.blockNodes().length > 0) {\n        range.insertNode($link[0]);\n      } else {\n        $newBlock = $('<p/>').append($link);\n        range.insertNode($newBlock[0]);\n      }\n      range.selectNodeContents($link[0]);\n      this.popover.one('popovershow', (function(_this) {\n        return function() {\n          if (linkText) {\n            _this.popover.urlEl.focus();\n            return _this.popover.urlEl[0].select();\n          } else {\n            _this.popover.textEl.focus();\n            return _this.popover.textEl[0].select();\n          }\n        };\n      })(this));\n    }\n    this.editor.selection.range(range);\n    return this.editor.trigger('valuechanged');\n  };\n\n  return LinkButton;\n\n})(Button);\n\nLinkPopover = (function(superClass) {\n  extend(LinkPopover, superClass);\n\n  function LinkPopover() {\n    return LinkPopover.__super__.constructor.apply(this, arguments);\n  }\n\n  LinkPopover.prototype.render = function() {\n    var tpl;\n    tpl = \"<div class=\\\"link-settings\\\">\\n  <div class=\\\"settings-field\\\">\\n    <label>\" + (this._t('linkText')) + \"</label>\\n    <input class=\\\"link-text\\\" type=\\\"text\\\"/>\\n    <a class=\\\"btn-unlink\\\" href=\\\"javascript:;\\\" title=\\\"\" + (this._t('removeLink')) + \"\\\"\\n      tabindex=\\\"-1\\\">\\n      <span class=\\\"simditor-icon simditor-icon-unlink\\\"></span>\\n    </a>\\n  </div>\\n  <div class=\\\"settings-field\\\">\\n    <label>\" + (this._t('linkUrl')) + \"</label>\\n    <input class=\\\"link-url\\\" type=\\\"text\\\"/>\\n  </div>\\n  <div class=\\\"settings-field\\\">\\n    <label>\" + (this._t('linkTarget')) + \"</label>\\n    <select class=\\\"link-target\\\">\\n      <option value=\\\"_blank\\\">\" + (this._t('openLinkInNewWindow')) + \" (_blank)</option>\\n      <option value=\\\"_self\\\">\" + (this._t('openLinkInCurrentWindow')) + \" (_self)</option>\\n    </select>\\n  </div>\\n</div>\";\n    this.el.addClass('link-popover').append(tpl);\n    this.textEl = this.el.find('.link-text');\n    this.urlEl = this.el.find('.link-url');\n    this.unlinkEl = this.el.find('.btn-unlink');\n    this.selectTarget = this.el.find('.link-target');\n    this.textEl.on('keyup', (function(_this) {\n      return function(e) {\n        if (e.which === 13) {\n          return;\n        }\n        _this.target.text(_this.textEl.val());\n        return _this.editor.inputManager.throttledValueChanged();\n      };\n    })(this));\n    this.urlEl.on('keyup', (function(_this) {\n      return function(e) {\n        var val;\n        if (e.which === 13) {\n          return;\n        }\n        val = _this.urlEl.val();\n        if (!(/https?:\\/\\/|^\\//ig.test(val) || !val)) {\n          val = 'http://' + val;\n        }\n        _this.target.attr('href', val);\n        return _this.editor.inputManager.throttledValueChanged();\n      };\n    })(this));\n    $([this.urlEl[0], this.textEl[0]]).on('keydown', (function(_this) {\n      return function(e) {\n        var range;\n        if (e.which === 13 || e.which === 27 || (!e.shiftKey && e.which === 9 && $(e.target).hasClass('link-url'))) {\n          e.preventDefault();\n          range = document.createRange();\n          _this.editor.selection.setRangeAfter(_this.target, range);\n          _this.hide();\n          return _this.editor.inputManager.throttledValueChanged();\n        }\n      };\n    })(this));\n    this.unlinkEl.on('click', (function(_this) {\n      return function(e) {\n        var range, txtNode;\n        txtNode = document.createTextNode(_this.target.text());\n        _this.target.replaceWith(txtNode);\n        _this.hide();\n        range = document.createRange();\n        _this.editor.selection.setRangeAfter(txtNode, range);\n        return _this.editor.inputManager.throttledValueChanged();\n      };\n    })(this));\n    return this.selectTarget.on('change', (function(_this) {\n      return function(e) {\n        _this.target.attr('target', _this.selectTarget.val());\n        return _this.editor.inputManager.throttledValueChanged();\n      };\n    })(this));\n  };\n\n  LinkPopover.prototype.show = function() {\n    var args;\n    args = 1 <= arguments.length ? slice.call(arguments, 0) : [];\n    LinkPopover.__super__.show.apply(this, args);\n    this.textEl.val(this.target.text());\n    return this.urlEl.val(this.target.attr('href'));\n  };\n\n  return LinkPopover;\n\n})(Popover);\n\nSimditor.Toolbar.addButton(LinkButton);\n\nImageButton = (function(superClass) {\n  extend(ImageButton, superClass);\n\n  function ImageButton() {\n    return ImageButton.__super__.constructor.apply(this, arguments);\n  }\n\n  ImageButton.prototype.name = 'image';\n\n  ImageButton.prototype.icon = 'picture-o';\n\n  ImageButton.prototype.htmlTag = 'img';\n\n  ImageButton.prototype.disableTag = 'pre, table';\n\n  ImageButton.prototype.defaultImage = '';\n\n  ImageButton.prototype.needFocus = false;\n\n  ImageButton.prototype._init = function() {\n    var item, k, len, ref;\n    if (this.editor.opts.imageButton) {\n      if (Array.isArray(this.editor.opts.imageButton)) {\n        this.menu = [];\n        ref = this.editor.opts.imageButton;\n        for (k = 0, len = ref.length; k < len; k++) {\n          item = ref[k];\n          this.menu.push({\n            name: item + '-image',\n            text: this._t(item + 'Image')\n          });\n        }\n      } else {\n        this.menu = false;\n      }\n    } else {\n      if (this.editor.uploader != null) {\n        this.menu = [\n          {\n            name: 'upload-image',\n            text: this._t('uploadImage')\n          }, {\n            name: 'external-image',\n            text: this._t('externalImage')\n          }\n        ];\n      } else {\n        this.menu = false;\n      }\n    }\n    this.defaultImage = this.editor.opts.defaultImage;\n    this.editor.body.on('click', 'img:not([data-non-image])', (function(_this) {\n      return function(e) {\n        var $img, range;\n        $img = $(e.currentTarget);\n        range = document.createRange();\n        range.selectNode($img[0]);\n        _this.editor.selection.range(range);\n        if (!_this.editor.util.support.onselectionchange) {\n          _this.editor.trigger('selectionchanged');\n        }\n        return false;\n      };\n    })(this));\n    this.editor.body.on('mouseup', 'img:not([data-non-image])', function(e) {\n      return false;\n    });\n    this.editor.on('selectionchanged.image', (function(_this) {\n      return function() {\n        var $contents, $img, range;\n        range = _this.editor.selection.range();\n        if (range == null) {\n          return;\n        }\n        $contents = $(range.cloneContents()).contents();\n        if ($contents.length === 1 && $contents.is('img:not([data-non-image])')) {\n          $img = $(range.startContainer).contents().eq(range.startOffset);\n          return _this.popover.show($img);\n        } else {\n          return _this.popover.hide();\n        }\n      };\n    })(this));\n    this.editor.on('valuechanged.image', (function(_this) {\n      return function() {\n        var $masks;\n        $masks = _this.editor.wrapper.find('.simditor-image-loading');\n        if (!($masks.length > 0)) {\n          return;\n        }\n        return $masks.each(function(i, mask) {\n          var $img, $mask, file;\n          $mask = $(mask);\n          $img = $mask.data('img');\n          if (!($img && $img.parent().length > 0)) {\n            $mask.remove();\n            if ($img) {\n              file = $img.data('file');\n              if (file) {\n                _this.editor.uploader.cancel(file);\n                if (_this.editor.body.find('img.uploading').length < 1) {\n                  return _this.editor.uploader.trigger('uploadready', [file]);\n                }\n              }\n            }\n          }\n        });\n      };\n    })(this));\n    return ImageButton.__super__._init.call(this);\n  };\n\n  ImageButton.prototype.render = function() {\n    var args;\n    args = 1 <= arguments.length ? slice.call(arguments, 0) : [];\n    ImageButton.__super__.render.apply(this, args);\n    this.popover = new ImagePopover({\n      button: this\n    });\n    if (this.editor.opts.imageButton === 'upload') {\n      return this._initUploader(this.el);\n    }\n  };\n\n  ImageButton.prototype.renderMenu = function() {\n    ImageButton.__super__.renderMenu.call(this);\n    return this._initUploader();\n  };\n\n  ImageButton.prototype._initUploader = function($uploadItem) {\n    var $input, createInput, uploadProgress;\n    if ($uploadItem == null) {\n      $uploadItem = this.menuEl.find('.menu-item-upload-image');\n    }\n    if (this.editor.uploader == null) {\n      this.el.find('.btn-upload').remove();\n      return;\n    }\n    $input = null;\n    createInput = (function(_this) {\n      return function() {\n        if ($input) {\n          $input.remove();\n        }\n        return $input = $('<input/>', {\n          type: 'file',\n          title: _this._t('uploadImage'),\n          multiple: true,\n          accept: 'image/*'\n        }).appendTo($uploadItem);\n      };\n    })(this);\n    createInput();\n    $uploadItem.on('click mousedown', 'input[type=file]', function(e) {\n      return e.stopPropagation();\n    });\n    $uploadItem.on('change', 'input[type=file]', (function(_this) {\n      return function(e) {\n        if (_this.editor.inputManager.focused) {\n          _this.editor.uploader.upload($input, {\n            inline: true\n          });\n          createInput();\n        } else {\n          _this.editor.one('focus', function(e) {\n            _this.editor.uploader.upload($input, {\n              inline: true\n            });\n            return createInput();\n          });\n          _this.editor.focus();\n        }\n        return _this.wrapper.removeClass('menu-on');\n      };\n    })(this));\n    this.editor.uploader.on('beforeupload', (function(_this) {\n      return function(e, file) {\n        var $img;\n        if (!file.inline) {\n          return;\n        }\n        if (file.img) {\n          $img = $(file.img);\n        } else {\n          $img = _this.createImage(file.name);\n          file.img = $img;\n        }\n        $img.addClass('uploading');\n        $img.data('file', file);\n        return _this.editor.uploader.readImageFile(file.obj, function(img) {\n          var src;\n          if (!$img.hasClass('uploading')) {\n            return;\n          }\n          src = img ? img.src : _this.defaultImage;\n          return _this.loadImage($img, src, function() {\n            if (_this.popover.active) {\n              _this.popover.refresh();\n              return _this.popover.srcEl.val(_this._t('uploading')).prop('disabled', true);\n            }\n          });\n        });\n      };\n    })(this));\n    uploadProgress = $.proxy(this.editor.util.throttle(function(e, file, loaded, total) {\n      var $img, $mask, percent;\n      if (!file.inline) {\n        return;\n      }\n      $mask = file.img.data('mask');\n      if (!$mask) {\n        return;\n      }\n      $img = $mask.data('img');\n      if (!($img.hasClass('uploading') && $img.parent().length > 0)) {\n        $mask.remove();\n        return;\n      }\n      percent = loaded / total;\n      percent = (percent * 100).toFixed(0);\n      if (percent > 99) {\n        percent = 99;\n      }\n      return $mask.find('.progress').height((100 - percent) + \"%\");\n    }, 500), this);\n    this.editor.uploader.on('uploadprogress', uploadProgress);\n    this.editor.uploader.on('uploadsuccess', (function(_this) {\n      return function(e, file, result) {\n        var $img, img_path, msg;\n        if (!file.inline) {\n          return;\n        }\n        $img = file.img;\n        if (!($img.hasClass('uploading') && $img.parent().length > 0)) {\n          return;\n        }\n        if (typeof result !== 'object') {\n          try {\n            result = $.parseJSON(result);\n          } catch (_error) {\n            e = _error;\n            result = {\n              success: false\n            };\n          }\n        }\n        if (result.success === false) {\n          msg = result.msg || _this._t('uploadFailed');\n          alert(msg);\n          img_path = _this.defaultImage;\n        } else {\n          img_path = result.file_path;\n        }\n        _this.loadImage($img, img_path, function() {\n          var $mask;\n          $img.removeData('file');\n          $img.removeClass('uploading').removeClass('loading');\n          $mask = $img.data('mask');\n          if ($mask) {\n            $mask.remove();\n          }\n          $img.removeData('mask');\n          _this.editor.trigger('valuechanged');\n          if (_this.editor.body.find('img.uploading').length < 1) {\n            return _this.editor.uploader.trigger('uploadready', [file, result]);\n          }\n        });\n        if (_this.popover.active) {\n          _this.popover.srcEl.prop('disabled', false);\n          return _this.popover.srcEl.val(result.file_path);\n        }\n      };\n    })(this));\n    return this.editor.uploader.on('uploaderror', (function(_this) {\n      return function(e, file, xhr) {\n        var $img, msg, result;\n        if (!file.inline) {\n          return;\n        }\n        if (xhr.statusText === 'abort') {\n          return;\n        }\n        if (xhr.responseText) {\n          try {\n            result = $.parseJSON(xhr.responseText);\n            msg = result.msg;\n          } catch (_error) {\n            e = _error;\n            msg = _this._t('uploadError');\n          }\n          alert(msg);\n        }\n        $img = file.img;\n        if (!($img.hasClass('uploading') && $img.parent().length > 0)) {\n          return;\n        }\n        _this.loadImage($img, _this.defaultImage, function() {\n          var $mask;\n          $img.removeData('file');\n          $img.removeClass('uploading').removeClass('loading');\n          $mask = $img.data('mask');\n          if ($mask) {\n            $mask.remove();\n          }\n          return $img.removeData('mask');\n        });\n        if (_this.popover.active) {\n          _this.popover.srcEl.prop('disabled', false);\n          _this.popover.srcEl.val(_this.defaultImage);\n        }\n        _this.editor.trigger('valuechanged');\n        if (_this.editor.body.find('img.uploading').length < 1) {\n          return _this.editor.uploader.trigger('uploadready', [file, result]);\n        }\n      };\n    })(this));\n  };\n\n  ImageButton.prototype._status = function() {\n    return this._disableStatus();\n  };\n\n  ImageButton.prototype.loadImage = function($img, src, callback) {\n    var $mask, img, positionMask;\n    positionMask = (function(_this) {\n      return function() {\n        var imgOffset, wrapperOffset;\n        imgOffset = $img.offset();\n        wrapperOffset = _this.editor.wrapper.offset();\n        return $mask.css({\n          top: imgOffset.top - wrapperOffset.top,\n          left: imgOffset.left - wrapperOffset.left,\n          width: $img.width(),\n          height: $img.height()\n        }).show();\n      };\n    })(this);\n    $img.addClass('loading');\n    $mask = $img.data('mask');\n    if (!$mask) {\n      $mask = $('<div class=\"simditor-image-loading\">\\n  <div class=\"progress\"></div>\\n</div>').hide().appendTo(this.editor.wrapper);\n      positionMask();\n      $img.data('mask', $mask);\n      $mask.data('img', $img);\n    }\n    img = new Image();\n    img.onload = (function(_this) {\n      return function() {\n        var height, width;\n        if (!$img.hasClass('loading') && !$img.hasClass('uploading')) {\n          return;\n        }\n        width = img.width;\n        height = img.height;\n        $img.attr({\n          src: src,\n          width: width,\n          height: height,\n          'data-image-size': width + ',' + height\n        }).removeClass('loading');\n        if ($img.hasClass('uploading')) {\n          _this.editor.util.reflow(_this.editor.body);\n          positionMask();\n        } else {\n          $mask.remove();\n          $img.removeData('mask');\n        }\n        if ($.isFunction(callback)) {\n          return callback(img);\n        }\n      };\n    })(this);\n    img.onerror = function() {\n      if ($.isFunction(callback)) {\n        callback(false);\n      }\n      $mask.remove();\n      return $img.removeData('mask').removeClass('loading');\n    };\n    return img.src = src;\n  };\n\n  ImageButton.prototype.createImage = function(name) {\n    var $img, range;\n    if (name == null) {\n      name = 'Image';\n    }\n    if (!this.editor.inputManager.focused) {\n      this.editor.focus();\n    }\n    range = this.editor.selection.range();\n    range.deleteContents();\n    this.editor.selection.range(range);\n    $img = $('<img/>').attr('alt', name);\n    range.insertNode($img[0]);\n    this.editor.selection.setRangeAfter($img, range);\n    this.editor.trigger('valuechanged');\n    return $img;\n  };\n\n  ImageButton.prototype.command = function(src) {\n    var $img;\n    $img = this.createImage();\n    return this.loadImage($img, src || this.defaultImage, (function(_this) {\n      return function() {\n        _this.editor.trigger('valuechanged');\n        _this.editor.util.reflow($img);\n        $img.click();\n        return _this.popover.one('popovershow', function() {\n          _this.popover.srcEl.focus();\n          return _this.popover.srcEl[0].select();\n        });\n      };\n    })(this));\n  };\n\n  return ImageButton;\n\n})(Button);\n\nImagePopover = (function(superClass) {\n  extend(ImagePopover, superClass);\n\n  function ImagePopover() {\n    return ImagePopover.__super__.constructor.apply(this, arguments);\n  }\n\n  ImagePopover.prototype.offset = {\n    top: 6,\n    left: -4\n  };\n\n  ImagePopover.prototype.render = function() {\n    var tpl;\n    tpl = \"<div class=\\\"link-settings\\\">\\n  <div class=\\\"settings-field\\\">\\n    <label>\" + (this._t('imageUrl')) + \"</label>\\n    <input class=\\\"image-src\\\" type=\\\"text\\\" tabindex=\\\"1\\\" />\\n    <a class=\\\"btn-upload\\\" href=\\\"javascript:;\\\"\\n      title=\\\"\" + (this._t('uploadImage')) + \"\\\" tabindex=\\\"-1\\\">\\n      <span class=\\\"simditor-icon simditor-icon-upload\\\"></span>\\n    </a>\\n  </div>\\n  <div class='settings-field'>\\n    <label>\" + (this._t('imageAlt')) + \"</label>\\n    <input class=\\\"image-alt\\\" id=\\\"image-alt\\\" type=\\\"text\\\" tabindex=\\\"1\\\" />\\n  </div>\\n  <div class=\\\"settings-field\\\">\\n    <label>\" + (this._t('imageSize')) + \"</label>\\n    <input class=\\\"image-size\\\" id=\\\"image-width\\\" type=\\\"text\\\" tabindex=\\\"2\\\" />\\n    <span class=\\\"times\\\">×</span>\\n    <input class=\\\"image-size\\\" id=\\\"image-height\\\" type=\\\"text\\\" tabindex=\\\"3\\\" />\\n    <a class=\\\"btn-restore\\\" href=\\\"javascript:;\\\"\\n      title=\\\"\" + (this._t('restoreImageSize')) + \"\\\" tabindex=\\\"-1\\\">\\n      <span class=\\\"simditor-icon simditor-icon-undo\\\"></span>\\n    </a>\\n  </div>\\n</div>\";\n    this.el.addClass('image-popover').append(tpl);\n    this.srcEl = this.el.find('.image-src');\n    this.widthEl = this.el.find('#image-width');\n    this.heightEl = this.el.find('#image-height');\n    this.altEl = this.el.find('#image-alt');\n    this.srcEl.on('keydown', (function(_this) {\n      return function(e) {\n        var range;\n        if (!(e.which === 13 && !_this.target.hasClass('uploading'))) {\n          return;\n        }\n        e.preventDefault();\n        range = document.createRange();\n        _this.button.editor.selection.setRangeAfter(_this.target, range);\n        return _this.hide();\n      };\n    })(this));\n    this.srcEl.on('blur', (function(_this) {\n      return function(e) {\n        return _this._loadImage(_this.srcEl.val());\n      };\n    })(this));\n    this.el.find('.image-size').on('blur', (function(_this) {\n      return function(e) {\n        _this._resizeImg($(e.currentTarget));\n        return _this.el.data('popover').refresh();\n      };\n    })(this));\n    this.el.find('.image-size').on('keyup', (function(_this) {\n      return function(e) {\n        var inputEl;\n        inputEl = $(e.currentTarget);\n        if (!(e.which === 13 || e.which === 27 || e.which === 9)) {\n          return _this._resizeImg(inputEl, true);\n        }\n      };\n    })(this));\n    this.el.find('.image-size').on('keydown', (function(_this) {\n      return function(e) {\n        var $img, inputEl, range;\n        inputEl = $(e.currentTarget);\n        if (e.which === 13 || e.which === 27) {\n          e.preventDefault();\n          if (e.which === 13) {\n            _this._resizeImg(inputEl);\n          } else {\n            _this._restoreImg();\n          }\n          $img = _this.target;\n          _this.hide();\n          range = document.createRange();\n          return _this.button.editor.selection.setRangeAfter($img, range);\n        } else if (e.which === 9) {\n          return _this.el.data('popover').refresh();\n        }\n      };\n    })(this));\n    this.altEl.on('keydown', (function(_this) {\n      return function(e) {\n        var range;\n        if (e.which === 13) {\n          e.preventDefault();\n          range = document.createRange();\n          _this.button.editor.selection.setRangeAfter(_this.target, range);\n          return _this.hide();\n        }\n      };\n    })(this));\n    this.altEl.on('keyup', (function(_this) {\n      return function(e) {\n        if (e.which === 13 || e.which === 27 || e.which === 9) {\n          return;\n        }\n        _this.alt = _this.altEl.val();\n        return _this.target.attr('alt', _this.alt);\n      };\n    })(this));\n    this.el.find('.btn-restore').on('click', (function(_this) {\n      return function(e) {\n        _this._restoreImg();\n        return _this.el.data('popover').refresh();\n      };\n    })(this));\n    this.editor.on('valuechanged', (function(_this) {\n      return function(e) {\n        if (_this.active) {\n          return _this.refresh();\n        }\n      };\n    })(this));\n    return this._initUploader();\n  };\n\n  ImagePopover.prototype._initUploader = function() {\n    var $uploadBtn, createInput;\n    $uploadBtn = this.el.find('.btn-upload');\n    if (this.editor.uploader == null) {\n      $uploadBtn.remove();\n      return;\n    }\n    createInput = (function(_this) {\n      return function() {\n        if (_this.input) {\n          _this.input.remove();\n        }\n        return _this.input = $('<input/>', {\n          type: 'file',\n          title: _this._t('uploadImage'),\n          multiple: true,\n          accept: 'image/*'\n        }).appendTo($uploadBtn);\n      };\n    })(this);\n    createInput();\n    this.el.on('click mousedown', 'input[type=file]', function(e) {\n      return e.stopPropagation();\n    });\n    return this.el.on('change', 'input[type=file]', (function(_this) {\n      return function(e) {\n        _this.editor.uploader.upload(_this.input, {\n          inline: true,\n          img: _this.target\n        });\n        return createInput();\n      };\n    })(this));\n  };\n\n  ImagePopover.prototype._resizeImg = function(inputEl, onlySetVal) {\n    var height, value, width;\n    if (onlySetVal == null) {\n      onlySetVal = false;\n    }\n    value = inputEl.val() * 1;\n    if (!(this.target && ($.isNumeric(value) || value < 0))) {\n      return;\n    }\n    if (inputEl.is(this.widthEl)) {\n      width = value;\n      height = this.height * value / this.width;\n      this.heightEl.val(height);\n    } else {\n      height = value;\n      width = this.width * value / this.height;\n      this.widthEl.val(width);\n    }\n    if (!onlySetVal) {\n      this.target.attr({\n        width: width,\n        height: height\n      });\n      return this.editor.trigger('valuechanged');\n    }\n  };\n\n  ImagePopover.prototype._restoreImg = function() {\n    var ref, size;\n    size = ((ref = this.target.data('image-size')) != null ? ref.split(\",\") : void 0) || [this.width, this.height];\n    this.target.attr({\n      width: size[0] * 1,\n      height: size[1] * 1\n    });\n    this.widthEl.val(size[0]);\n    this.heightEl.val(size[1]);\n    return this.editor.trigger('valuechanged');\n  };\n\n  ImagePopover.prototype._loadImage = function(src, callback) {\n    if (/^data:image/.test(src) && !this.editor.uploader) {\n      if (callback) {\n        callback(false);\n      }\n      return;\n    }\n    if (this.target.attr('src') === src) {\n      return;\n    }\n    return this.button.loadImage(this.target, src, (function(_this) {\n      return function(img) {\n        var blob;\n        if (!img) {\n          return;\n        }\n        if (_this.active) {\n          _this.width = img.width;\n          _this.height = img.height;\n          _this.widthEl.val(_this.width);\n          _this.heightEl.val(_this.height);\n        }\n        if (/^data:image/.test(src)) {\n          blob = _this.editor.util.dataURLtoBlob(src);\n          blob.name = \"Base64 Image.png\";\n          _this.editor.uploader.upload(blob, {\n            inline: true,\n            img: _this.target\n          });\n        } else {\n          _this.editor.trigger('valuechanged');\n        }\n        if (callback) {\n          return callback(img);\n        }\n      };\n    })(this));\n  };\n\n  ImagePopover.prototype.show = function() {\n    var $img, args;\n    args = 1 <= arguments.length ? slice.call(arguments, 0) : [];\n    ImagePopover.__super__.show.apply(this, args);\n    $img = this.target;\n    this.width = $img.width();\n    this.height = $img.height();\n    this.alt = $img.attr('alt');\n    if ($img.hasClass('uploading')) {\n      return this.srcEl.val(this._t('uploading')).prop('disabled', true);\n    } else {\n      this.srcEl.val($img.attr('src')).prop('disabled', false);\n      this.widthEl.val(this.width);\n      this.heightEl.val(this.height);\n      return this.altEl.val(this.alt);\n    }\n  };\n\n  return ImagePopover;\n\n})(Popover);\n\nSimditor.Toolbar.addButton(ImageButton);\n\nIndentButton = (function(superClass) {\n  extend(IndentButton, superClass);\n\n  function IndentButton() {\n    return IndentButton.__super__.constructor.apply(this, arguments);\n  }\n\n  IndentButton.prototype.name = 'indent';\n\n  IndentButton.prototype.icon = 'indent';\n\n  IndentButton.prototype._init = function() {\n    this.title = this._t(this.name) + ' (Tab)';\n    return IndentButton.__super__._init.call(this);\n  };\n\n  IndentButton.prototype._status = function() {};\n\n  IndentButton.prototype.command = function() {\n    return this.editor.indentation.indent();\n  };\n\n  return IndentButton;\n\n})(Button);\n\nSimditor.Toolbar.addButton(IndentButton);\n\nOutdentButton = (function(superClass) {\n  extend(OutdentButton, superClass);\n\n  function OutdentButton() {\n    return OutdentButton.__super__.constructor.apply(this, arguments);\n  }\n\n  OutdentButton.prototype.name = 'outdent';\n\n  OutdentButton.prototype.icon = 'outdent';\n\n  OutdentButton.prototype._init = function() {\n    this.title = this._t(this.name) + ' (Shift + Tab)';\n    return OutdentButton.__super__._init.call(this);\n  };\n\n  OutdentButton.prototype._status = function() {};\n\n  OutdentButton.prototype.command = function() {\n    return this.editor.indentation.indent(true);\n  };\n\n  return OutdentButton;\n\n})(Button);\n\nSimditor.Toolbar.addButton(OutdentButton);\n\nHrButton = (function(superClass) {\n  extend(HrButton, superClass);\n\n  function HrButton() {\n    return HrButton.__super__.constructor.apply(this, arguments);\n  }\n\n  HrButton.prototype.name = 'hr';\n\n  HrButton.prototype.icon = 'minus';\n\n  HrButton.prototype.htmlTag = 'hr';\n\n  HrButton.prototype._status = function() {};\n\n  HrButton.prototype.command = function() {\n    var $hr, $newBlock, $nextBlock, $rootBlock;\n    $rootBlock = this.editor.selection.rootNodes().first();\n    $nextBlock = $rootBlock.next();\n    if ($nextBlock.length > 0) {\n      this.editor.selection.save();\n    } else {\n      $newBlock = $('<p/>').append(this.editor.util.phBr);\n    }\n    $hr = $('<hr/>').insertAfter($rootBlock);\n    if ($newBlock) {\n      $newBlock.insertAfter($hr);\n      this.editor.selection.setRangeAtStartOf($newBlock);\n    } else {\n      this.editor.selection.restore();\n    }\n    return this.editor.trigger('valuechanged');\n  };\n\n  return HrButton;\n\n})(Button);\n\nSimditor.Toolbar.addButton(HrButton);\n\nTableButton = (function(superClass) {\n  extend(TableButton, superClass);\n\n  function TableButton() {\n    return TableButton.__super__.constructor.apply(this, arguments);\n  }\n\n  TableButton.prototype.name = 'table';\n\n  TableButton.prototype.icon = 'table';\n\n  TableButton.prototype.htmlTag = 'table';\n\n  TableButton.prototype.disableTag = 'pre, li, blockquote';\n\n  TableButton.prototype.menu = true;\n\n  TableButton.prototype._init = function() {\n    TableButton.__super__._init.call(this);\n    $.merge(this.editor.formatter._allowedTags, ['thead', 'th', 'tbody', 'tr', 'td', 'colgroup', 'col']);\n    $.extend(this.editor.formatter._allowedAttributes, {\n      table: ['class'],\n      td: ['rowspan', 'colspan', 'class'],//mod-for-jl\n      col: ['width']\n    });\n    $.extend(this.editor.formatter._allowedStyles, {\n      td: ['text-align'],\n      th: ['text-align']\n    });\n    this._initShortcuts();\n    this.editor.on('decorate', (function(_this) {\n      return function(e, $el) {\n        return $el.find('table').each(function(i, table) {\n          return _this.decorate($(table));\n        });\n      };\n    })(this));\n    this.editor.on('undecorate', (function(_this) {\n      return function(e, $el) {\n        return $el.find('table').each(function(i, table) {\n          return _this.undecorate($(table));\n        });\n      };\n    })(this));\n    this.editor.on('selectionchanged.table', (function(_this) {\n      return function(e) {\n        var $container, range;\n        _this.editor.body.find('.simditor-table td, .simditor-table th').removeClass('active');\n        range = _this.editor.selection.range();\n        if (!range) {\n          return;\n        }\n        $container = _this.editor.selection.containerNode();\n        if (range.collapsed && $container.is('.simditor-table')) {\n          if (_this.editor.selection.rangeAtStartOf($container)) {\n            $container = $container.find('td:first');//mod-for-jl\n          } else {\n            $container = $container.find('td:last');\n          }\n          _this.editor.selection.setRangeAtEndOf($container);\n        }\n        return $container.closest('td, th', _this.editor.body).addClass('active');\n      };\n    })(this));\n    this.editor.on('blur.table', (function(_this) {\n      return function(e) {\n        return _this.editor.body.find('.simditor-table td, .simditor-table th').removeClass('active');\n      };\n    })(this));\n    this.editor.keystroke.add('up', 'td', (function(_this) {\n      return function(e, $node) {\n        _this._tdNav($node, 'up');\n        return true;\n      };\n    })(this));\n    this.editor.keystroke.add('up', 'th', (function(_this) {\n      return function(e, $node) {\n        _this._tdNav($node, 'up');\n        return true;\n      };\n    })(this));\n    this.editor.keystroke.add('down', 'td', (function(_this) {\n      return function(e, $node) {\n        _this._tdNav($node, 'down');\n        return true;\n      };\n    })(this));\n    return this.editor.keystroke.add('down', 'th', (function(_this) {\n      return function(e, $node) {\n        _this._tdNav($node, 'down');\n        return true;\n      };\n    })(this));\n  };\n\n  TableButton.prototype._tdNav = function($td, direction) {\n    var $anotherTr, $tr, action, anotherTag, index, parentTag, ref;\n    if (direction == null) {\n      direction = 'up';\n    }\n    action = direction === 'up' ? 'prev' : 'next';\n    ref = direction === 'up' ? ['tbody', 'thead'] : ['thead', 'tbody'], parentTag = ref[0], anotherTag = ref[1];\n    $tr = $td.parent('tr');\n    $anotherTr = this[\"_\" + action + \"Row\"]($tr);\n    if (!($anotherTr.length > 0)) {//mod-for-jl\n        if(direction=='up')\n            return this.editor.selection.setRangeAtEndOf($tr.parent().parent().parent().prev());\n        if(direction=='down')\n            return this.editor.selection.setRangeAtEndOf($tr.parent().parent().parent().next());\n      return true;\n    }\n    index = $tr.find('td, th').index($td);\n    if($anotherTr.find('td, th').length-1<index) index = $anotherTr.find('td th').length-1; //mod-for-jl\n    return this.editor.selection.setRangeAtEndOf($anotherTr.find('td, th').eq(index));\n  };\n\n  TableButton.prototype._nextRow = function($tr) {\n    var $nextTr;\n    $nextTr = $tr.next('tr');\n    if ($nextTr.length < 1 && $tr.parent('thead').length > 0) {\n      $nextTr = $tr.parent('thead').next('tbody').find('tr:first');\n    }\n    return $nextTr;\n  };\n\n  TableButton.prototype._prevRow = function($tr) {\n    var $prevTr;\n    $prevTr = $tr.prev('tr');\n    if ($prevTr.length < 1 && $tr.parent('tbody').length > 0) {\n      $prevTr = $tr.parent('tbody').prev('thead').find('tr');\n    }\n    return $prevTr;\n  };\n\n  TableButton.prototype.initResize = function($table) {//mod-for-jl\n    var $colgroup, $resizeHandle, $wrapper;\n    $wrapper = $table.parent('.simditor-table');\n    $colgroup = $table.find('colgroup');\n    if ($colgroup.length < 1) {\n      $colgroup = $('<colgroup/>').prependTo($table);\n      // seleccionamos la fila mas grande\n      var cant_td, max_td, $trr;;\n      max_td = 0;\n      $table.find('tbody tr').each(function(i, tr) {\n          cant_td = $(tr).find('td').length;\n          if(cant_td>max_td){\n              $trr = $(tr);\n              max_td = cant_td;\n          }\n      });\n      $trr.find('td').each(function(i, td) {\n        var $col;\n        return $col = $('<col/>').appendTo($colgroup);\n      })\n      this.refreshTableWidth($table);\n    }\n    $resizeHandle = $('<div />', {\n      \"class\": 'simditor-resize-handle',\n      contenteditable: 'false'\n    }).appendTo($wrapper);\n    $wrapper.on('mousemove', 'td, th', function(e) {\n      var $col, $td, index, ref, ref1, x;\n      if ($wrapper.hasClass('resizing')) {\n        return;\n      }\n      $td = $(e.currentTarget);\n      x = e.pageX - $(e.currentTarget).offset().left;\n      if (x < 5 && $td.prev().length > 0) {\n        $td = $td.prev();\n      }\n      if ($td.next('td, th').length < 1) {\n        $resizeHandle.hide();\n        return;\n      }\n      if ((ref = $resizeHandle.data('td')) != null ? ref.is($td) : void 0) {\n        $resizeHandle.show();\n        return;\n      }\n      index = $td.parent().find('td, th').index($td);\n      $col = $colgroup.find('col').eq(index);\n      if ((ref1 = $resizeHandle.data('col')) != null ? ref1.is($col) : void 0) {\n        $resizeHandle.show();\n        return;\n      }\n      return $resizeHandle.css('left', $td.position().left + $td.outerWidth() - 5).data('td', $td).data('col', $col).show();\n    });\n    $wrapper.on('mouseleave', function(e) {\n      return $resizeHandle.hide();\n    });\n    return $wrapper.on('mousedown', '.simditor-resize-handle', function(e) {\n      var $handle, $leftCol, $leftTd, $rightCol, $rightTd, minWidth, startHandleLeft, startLeftWidth, startRightWidth, startX, tableWidth;\n      $handle = $(e.currentTarget);\n      $leftTd = $handle.data('td');\n      $leftCol = $handle.data('col');\n      $rightTd = $leftTd.next('td, th');\n      $rightCol = $leftCol.next('col');\n      startX = e.pageX;\n      startLeftWidth = $leftTd.outerWidth() * 1;\n      startRightWidth = $rightTd.outerWidth() * 1;\n      startHandleLeft = parseFloat($handle.css('left'));\n      tableWidth = $leftTd.closest('table').width();\n      minWidth = 50;\n      $(document).on('mousemove.simditor-resize-table', function(e) {\n        var deltaX, leftWidth, rightWidth;\n        deltaX = e.pageX - startX;\n        leftWidth = startLeftWidth + deltaX;\n        rightWidth = startRightWidth - deltaX;\n        if (leftWidth < minWidth) {\n          leftWidth = minWidth;\n          deltaX = minWidth - startLeftWidth;\n          rightWidth = startRightWidth - deltaX;\n        } else if (rightWidth < minWidth) {\n          rightWidth = minWidth;\n          deltaX = startRightWidth - minWidth;\n          leftWidth = startLeftWidth + deltaX;\n        }\n        $leftCol.attr('width', (leftWidth / tableWidth * 100) + '%');\n        $rightCol.attr('width', (rightWidth / tableWidth * 100) + '%');\n        return $handle.css('left', startHandleLeft + deltaX);\n      });\n      $(document).one('mouseup.simditor-resize-table', function(e) {\n        $(document).off('.simditor-resize-table');\n        return $wrapper.removeClass('resizing');\n      });\n      $wrapper.addClass('resizing');\n      return false;\n    });\n  };\n\n  TableButton.prototype._initShortcuts = function() {\n    this.editor.hotkeys.add('ctrl+alt+up', (function(_this) {\n      return function(e) {\n        _this.editMenu.find('.menu-item[data-param=insertRowAbove]').click();\n        return false;\n      };\n    })(this));\n    this.editor.hotkeys.add('ctrl+alt+down', (function(_this) {\n      return function(e) {\n        _this.editMenu.find('.menu-item[data-param=insertRowBelow]').click();\n        return false;\n      };\n    })(this));\n    this.editor.hotkeys.add('ctrl+alt+left', (function(_this) {\n      return function(e) {\n        _this.editMenu.find('.menu-item[data-param=insertColLeft]').click();\n        return false;\n      };\n    })(this));\n    return this.editor.hotkeys.add('ctrl+alt+right', (function(_this) {\n      return function(e) {\n        _this.editMenu.find('.menu-item[data-param=insertColRight]').click();\n        return false;\n      };\n    })(this));\n  };\n\n  TableButton.prototype.decorate = function($table) {//mod-for-jl\n    var $headRow, $tbody, $thead;\n    if ($table.parent('.simditor-table').length > 0) {\n      this.undecorate($table);\n    }\n    $table.wrap('<div class=\"simditor-table\"></div>');\n    this.initResize($table);\n    return $table.parent();\n  };\n\n  TableButton.prototype.undecorate = function($table) {\n    if (!($table.parent('.simditor-table').length > 0)) {\n      return;\n    }\n    return $table.parent().replaceWith($table);\n  };\n\n  TableButton.prototype.renderMenu = function() {\n    var $table;\n    $(\"<div class=\\\"menu-create-table\\\">\\n</div>\\n<div class=\\\"menu-edit-table\\\">\\n  <ul>\\n    <li>\\n      <a tabindex=\\\"-1\\\" unselectable=\\\"on\\\" class=\\\"menu-item\\\"\\n        href=\\\"javascript:;\\\" data-param=\\\"deleteRow\\\">\\n        <span>\" + (this._t('deleteRow')) + \"</span>\\n      </a>\\n    </li>\\n    <li>\\n      <a tabindex=\\\"-1\\\" unselectable=\\\"on\\\" class=\\\"menu-item\\\"\\n        href=\\\"javascript:;\\\" data-param=\\\"insertRowAbove\\\">\\n        <span>\" + (this._t('insertRowAbove')) + \" ( Ctrl + Alt + ↑ )</span>\\n      </a>\\n    </li>\\n    <li>\\n      <a tabindex=\\\"-1\\\" unselectable=\\\"on\\\" class=\\\"menu-item\\\"\\n        href=\\\"javascript:;\\\" data-param=\\\"insertRowBelow\\\">\\n        <span>\" + (this._t('insertRowBelow')) + \" ( Ctrl + Alt + ↓ )</span>\\n      </a>\\n    </li>\\n    <li><span class=\\\"separator\\\"></span></li>\\n    <li>\\n      <a tabindex=\\\"-1\\\" unselectable=\\\"on\\\" class=\\\"menu-item\\\"\\n        href=\\\"javascript:;\\\" data-param=\\\"deleteCol\\\">\\n        <span>\" + (this._t('deleteColumn')) + \"</span>\\n      </a>\\n    </li>\\n    <li>\\n      <a tabindex=\\\"-1\\\" unselectable=\\\"on\\\" class=\\\"menu-item\\\"\\n        href=\\\"javascript:;\\\" data-param=\\\"insertColLeft\\\">\\n        <span>\" + (this._t('insertColumnLeft')) + \" ( Ctrl + Alt + ← )</span>\\n      </a>\\n    </li>\\n    <li>\\n      <a tabindex=\\\"-1\\\" unselectable=\\\"on\\\" class=\\\"menu-item\\\"\\n        href=\\\"javascript:;\\\" data-param=\\\"insertColRight\\\">\\n        <span>\" + (this._t('insertColumnRight')) + \" ( Ctrl + Alt + → )</span>\\n      </a>\\n    </li>\\n    <li><span class=\\\"separator\\\"></span></li>\\n    <li>\\n      <a tabindex=\\\"-1\\\" unselectable=\\\"on\\\" class=\\\"menu-item\\\"\\n        href=\\\"javascript:;\\\" data-param=\\\"paintRow\\\">\\n        <span>\" + (this._t('paintRow')) + \"</span>\\n      </a>\\n    </li>\\n  <li>\\n      <a tabindex=\\\"-1\\\" unselectable=\\\"on\\\" class=\\\"menu-item\\\"\\n        href=\\\"javascript:;\\\" data-param=\\\"paintCell\\\">\\n        <span>\" + (this._t('paintCell')) + \"</span>\\n      </a>\\n    </li>\\n    <li>\\n      <a tabindex=\\\"-1\\\" unselectable=\\\"on\\\" class=\\\"menu-item\\\"\\n        href=\\\"javascript:;\\\" data-param=\\\"dissolveRow\\\">\\n        <span>\" + (this._t('dissolveRow')) + \"</span>\\n      </a>\\n    </li>\\n  <li>\\n      <a tabindex=\\\"-1\\\" unselectable=\\\"on\\\" class=\\\"menu-item\\\"\\n        href=\\\"javascript:;\\\" data-param=\\\"dissolveCell\\\">\\n        <span>\" + (this._t('dissolveCell')) + \"</span>\\n      </a>\\n    </li>\\n   <li>\\n      <a tabindex=\\\"-1\\\" unselectable=\\\"on\\\" class=\\\"menu-item\\\"\\n        href=\\\"javascript:;\\\" data-param=\\\"addBorder\\\">\\n        <span>\" + (this._t('addBorder')) + \"</span>\\n      </a>\\n    </li>\\n   <li>\\n      <a tabindex=\\\"-1\\\" unselectable=\\\"on\\\" class=\\\"menu-item\\\"\\n        href=\\\"javascript:;\\\" data-param=\\\"removeBorder\\\">\\n        <span>\" + (this._t('removeBorder')) + \"</span>\\n      </a>\\n    </li>\\n   <li><span class=\\\"separator\\\"></span></li>\\n    <li>\\n      <a tabindex=\\\"-1\\\" unselectable=\\\"on\\\" class=\\\"menu-item\\\"\\n        href=\\\"javascript:;\\\" data-param=\\\"deleteTable\\\">\\n        <span>\" + (this._t('deleteTable')) + \"</span>\\n      </a>\\n    </li>\\n  </ul>\\n</div>\").appendTo(this.menuWrapper);\n    this.createMenu = this.menuWrapper.find('.menu-create-table');\n    this.editMenu = this.menuWrapper.find('.menu-edit-table');\n    $table = this.createTable(6, 6).appendTo(this.createMenu);\n    this.createMenu.on('mouseenter', 'td, th', (function(_this) {\n      return function(e) {\n        var $td, $tr, $trs, num;\n        _this.createMenu.find('td, th').removeClass('selected');\n        $td = $(e.currentTarget);\n        $tr = $td.parent();\n        num = $tr.find('td, th').index($td) + 1;\n        $trs = $tr.prevAll('tr').addBack();\n        if ($tr.parent().is('tbody')) {\n          $trs = $trs.add($table.find('thead tr'));\n        }\n        return $trs.find(\"td:lt(\" + num + \"), th:lt(\" + num + \")\").addClass('selected');\n      };\n    })(this));\n    this.createMenu.on('mouseleave', function(e) {\n      return $(e.currentTarget).find('td, th').removeClass('selected');\n    });\n    return this.createMenu.on('mousedown', 'td', (function(_this) {\n      return function(e) {\n        var $closestBlock, $td, $tr, colNum, rowNum;\n        _this.wrapper.removeClass('menu-on');\n        if (!_this.editor.inputManager.focused) {\n          return;\n        }\n        $td = $(e.currentTarget);\n        $tr = $td.parent();\n        colNum = $tr.find('td').index($td) + 1;\n        rowNum = $tr.prevAll('tr').length + 1;\n        if ($tr.parent().is('tbody')) {\n          rowNum += 1;\n        }\n        $table = _this.createTable(rowNum, colNum, true);\n        $closestBlock = _this.editor.selection.blockNodes().last();\n        if (_this.editor.util.isEmptyNode($closestBlock)) {\n          $closestBlock.replaceWith($table);\n        } else {\n          $closestBlock.after($table);\n        }\n        _this.decorate($table);\n        _this.editor.selection.setRangeAtStartOf($table.find('td:first'));\n        _this.editor.trigger('valuechanged');\n        return false;\n      };\n    })(this));\n  };\n\n  TableButton.prototype.createTable = function(row, col, phBr) {//mod-for-jl\n    var $table, $tbody, $td, $thead, $tr, c, k, l, r, ref, ref1;\n    $table = $('<table/>');\n    $tbody = $('<tbody/>').appendTo($table);\n    for (r = k = 0, ref = row; 0 <= ref ? k < ref : k > ref; r = 0 <= ref ? ++k : --k) {\n      $tr = $('<tr/>');\n      $tr.appendTo($tbody);\n      for (c = l = 0, ref1 = col; 0 <= ref1 ? l < ref1 : l > ref1; c = 0 <= ref1 ? ++l : --l) {\n        $td = $('<td/>').appendTo($tr);\n        if (phBr) {\n          $td.append(this.editor.util.phBr);\n        }\n      }\n    }\n    return $table;\n  };\n\n  TableButton.prototype.refreshTableWidth = function($table) { //mod-for-jl\n    var cols, tableWidth;\n    tableWidth = $table.width();\n    cols = $table.find('col');\n\n    // seleccionamos la fila mas grande\n    var cant_td, max_td, $trr;;\n    max_td = 0;\n    $table.find('tbody tr').each(function(i, tr) {\n        cant_td = $(tr).find('td').length;\n        if(cant_td>max_td){\n            $trr = $(tr);\n            max_td = cant_td;\n        }\n    });\n\n    return $trr.find('td').each(function(i, td) {\n      var $col, tam;\n      $col = cols.eq(i);\n      tam = (typeof $(td).outerWidth==\"function\")? 100/cols.length:  ($(td).outerWidth()==0)? 100/cols.length: (td).outerWidth() / tableWidth * 100 ;\n      return $col.attr('width', tam + '%');\n    });\n  };\n\n  TableButton.prototype.setActive = function(active) {\n    TableButton.__super__.setActive.call(this, active);\n    if (active) {\n      this.createMenu.hide();\n      return this.editMenu.show();\n    } else {\n      this.createMenu.show();\n      return this.editMenu.hide();\n    }\n  };\n\n  TableButton.prototype._changeCellTag = function($tr, tagName) {\n    return $tr.find('td, th').each(function(i, cell) {\n      var $cell;\n      $cell = $(cell);\n      return $cell.replaceWith(\"<\" + tagName + \">\" + ($cell.html()) + \"</\" + tagName + \">\");\n    });\n  };\n\n  TableButton.prototype.deleteRow = function($td) {\n    var $newTr, $tr, index;\n    $tr = $td.parent('tr');\n    if ($tr.closest('table').find('tr').length < 1) {\n      return this.deleteTable($td);\n    } else {\n      $newTr = this._nextRow($tr);\n      if (!($newTr.length > 0)) {\n        $newTr = this._prevRow($tr);\n      }\n      index = $tr.find('td, th').index($td);\n      if ($tr.parent().is('thead')) {\n        $newTr.appendTo($tr.parent());\n        this._changeCellTag($newTr, 'th');\n      }\n      if($newTr.find('td, th').eq(index).length==0) return this.deleteTable($td);//mod-for-jl\n      $tr.remove();\n      return this.editor.selection.setRangeAtEndOf($newTr.find('td, th').eq(index));\n    }\n  };\n\n  TableButton.prototype.insertRow = function($td, direction) {\n    var $newTr, $table, $tr, cellTag, colNum, i, index, k, ref;\n    if (direction == null) {\n      direction = 'after';\n    }\n    $tr = $td.parent('tr');\n    $table = $tr.closest('table');\n    colNum = 0;\n    $table.find('tr').each(function(i, tr) {\n      return colNum = Math.max(colNum, $(tr).find('td').length);\n    });\n    index = $tr.find('td, th').index($td);\n    $newTr = $('<tr/>');\n    cellTag = 'td';\n    if (direction === 'after' && $tr.parent().is('thead')) {\n      $tr.parent().next('tbody').prepend($newTr);\n    } else if (direction === 'before' && $tr.parent().is('thead')) {\n      $tr.before($newTr);\n      $tr.parent().next('tbody').prepend($tr);\n      this._changeCellTag($tr, 'td');\n      cellTag = 'th';\n    } else {\n      $tr[direction]($newTr);\n    }\n    for (i = k = 1, ref = colNum; 1 <= ref ? k <= ref : k >= ref; i = 1 <= ref ? ++k : --k) {\n      $(\"<\" + cellTag + \"/>\").append(this.editor.util.phBr).appendTo($newTr);\n    }\n    return this.editor.selection.setRangeAtStartOf($newTr.find('td, th').eq(index));\n  };\n\n  TableButton.prototype.deleteCol = function($td) {\n    var $newTd, $table, $tr, index, noOtherCol, noOtherRow;\n    $tr = $td.parent('tr');\n    noOtherRow = $tr.closest('table').find('tr').length < 2;\n    noOtherCol = $td.siblings('td, th').length < 1;\n    if (noOtherRow && noOtherCol) {\n      return this.deleteTable($td);\n    } else if($tr.find('td, th').length==1){//mod-for-jl\n      return this.deleteTable($td);\n    }else{\n      index = $tr.find('td, th').index($td);\n      $newTd = ($td.next('td, th').length!=0)? $td.next('td, th'): $td;//mod-for-jl\n      if (!($newTd.length > 0)) {\n        $newTd = $tr.prev('td, th');\n      }\n      $table = $tr.closest('table');\n      $table.find('col').eq(index).remove();\n      $table.find('tr').each(function(i, tr) {\n        return $(tr).find('td, th').eq(index).remove();\n      });\n      this.refreshTableWidth($table);\n      return this.editor.selection.setRangeAtEndOf($newTd);\n    }\n  };\n\n  TableButton.prototype.insertCol = function($td, direction) {\n    var $col, $newCol, $newTd, $table, $tr, index, tableWidth, width;\n    if (direction == null) {\n      direction = 'after';\n    }\n    $tr = $td.parent('tr');\n    index = $tr.find('td, th').index($td);\n    $table = $td.closest('table');\n    $col = $table.find('col').eq(index);\n    $table.find('tr').each((function(_this) {\n      return function(i, tr) {\n        var $newTd, cellTag;\n        cellTag = $(tr).parent().is('thead') ? 'th' : 'td';\n        $newTd = $(\"<\" + cellTag + \"/>\").append(_this.editor.util.phBr);\n        return $(tr).find('td, th').eq(index)[direction]($newTd);\n      };\n    })(this));\n    $newCol = $('<col/>');\n    $col[direction]($newCol);\n    tableWidth = $table.width();\n    width = Math.max(parseFloat($col.attr('width')) / 2, 50 / tableWidth * 100);\n    $col.attr('width', width + '%');\n    $newCol.attr('width', width + '%');\n    this.refreshTableWidth($table);\n    $newTd = direction === 'after' ? $td.next('td, th') : $td.prev('td, th');\n    return this.editor.selection.setRangeAtStartOf($newTd);\n  };\n\n  TableButton.prototype.deleteTable = function($td) {\n    var $block, $table;\n    $table = $td.closest('.simditor-table');\n    $block = $table.next('p');\n    $block.html('<br>');\n    $table.remove();\n    if ($block.length > 0) {\n      return this.editor.selection.setRangeAtStartOf($block);\n    }\n  };\n\n  //mod-for-jl\n  TableButton.prototype.paintCell = function($td) { $td.addClass('header');};\n  TableButton.prototype.paintRow = function($td) { $td.parent('tr').find('td').each(function (i, td) {  $(td).addClass('header'); $(td).css({ 'text-align': 'center'});  })   };\n  TableButton.prototype.dissolveCell = function($td) { $td.removeClass('header');};\n  TableButton.prototype.dissolveRow = function($td) { $td.parent('tr').find('td').each(function (i, td) {  $(td).removeClass('header'); $(td).css({ 'text-align': 'left'});  })   };\n  TableButton.prototype.addBorder = function($td) { $td.closest('table').removeClass('sin-bordes'); };\n  TableButton.prototype.removeBorder = function($td) { $td.closest('table').addClass('sin-bordes'); };\n\n  TableButton.prototype.command = function(param) {\n    var $td;\n    $td = this.editor.selection.containerNode().closest('td, th');\n    if (!($td.length > 0)) {\n      return;\n    }\n    if (param === 'deleteRow') {\n      this.deleteRow($td);\n    } else if (param === 'insertRowAbove') {\n      this.insertRow($td, 'before');\n    } else if (param === 'insertRowBelow') {\n      this.insertRow($td);\n    } else if (param === 'deleteCol') {\n      this.deleteCol($td);\n    } else if (param === 'insertColLeft') {\n      this.insertCol($td, 'before');\n    } else if (param === 'insertColRight') {\n      this.insertCol($td);\n    } else if (param === 'paintRow') {//mod-for-jl\n      this.paintRow($td);\n    } else if (param === 'paintCell') {\n      this.paintCell($td);\n    } else if (param === 'dissolveRow') {\n      this.dissolveRow($td);\n    } else if (param === 'dissolveCell') {\n      this.dissolveCell($td);\n    } else if (param === 'addBorder') {\n      this.addBorder($td);\n    } else if (param === 'removeBorder') {\n      this.removeBorder($td);\n    } else if (param === 'deleteTable') {\n      this.deleteTable($td);\n    } else {\n      return;\n    }\n    return this.editor.trigger('valuechanged');\n  };\n\n  return TableButton;\n\n})(Button);\n\nSimditor.Toolbar.addButton(TableButton);\n\nStrikethroughButton = (function(superClass) {\n  extend(StrikethroughButton, superClass);\n\n  function StrikethroughButton() {\n    return StrikethroughButton.__super__.constructor.apply(this, arguments);\n  }\n\n  StrikethroughButton.prototype.name = 'strikethrough';\n\n  StrikethroughButton.prototype.icon = 'strikethrough';\n\n  StrikethroughButton.prototype.htmlTag = 'strike';\n\n  StrikethroughButton.prototype.disableTag = 'pre';\n\n  StrikethroughButton.prototype._activeStatus = function() {\n    var active;\n    active = document.queryCommandState('strikethrough') === true;\n    this.setActive(active);\n    return this.active;\n  };\n\n  StrikethroughButton.prototype.command = function() {\n    document.execCommand('strikethrough');\n    if (!this.editor.util.support.oninput) {\n      this.editor.trigger('valuechanged');\n    }\n    return $(document).trigger('selectionchange');\n  };\n\n  return StrikethroughButton;\n\n})(Button);\n\nSimditor.Toolbar.addButton(StrikethroughButton);\n\nAlignmentButton = (function(superClass) {\n  extend(AlignmentButton, superClass);\n\n  function AlignmentButton() {\n    return AlignmentButton.__super__.constructor.apply(this, arguments);\n  }\n\n  AlignmentButton.prototype.name = \"alignment\";\n\n  AlignmentButton.prototype.icon = 'align-left';\n\n  AlignmentButton.prototype.htmlTag = 'p, h1, h2, h3, h4, td, th';\n\n  AlignmentButton.prototype._init = function() {\n    this.menu = [\n      {\n        name: 'left',\n        text: this._t('alignLeft'),\n        icon: 'align-left',\n        param: 'left'\n      }, {\n        name: 'center',\n        text: this._t('alignCenter'),\n        icon: 'align-center',\n        param: 'center'\n      }, {\n        name: 'right',\n        text: this._t('alignRight'),\n        icon: 'align-right',\n        param: 'right'\n      }, {//mod-for-jl\n        name: 'justify',\n        text: 'Justify',\n        icon: 'align-justify',\n        param: 'justify'\n      }\n    ];\n    return AlignmentButton.__super__._init.call(this);\n  };\n\n  AlignmentButton.prototype.setActive = function(active, align) {\n    if (align == null) {\n      align = 'left';\n    }\n    if (align !== 'left' && align !== 'center' && align !== 'right' && align !== 'justify') {\n      align = 'left';\n    }\n    if (align === 'left') {\n      AlignmentButton.__super__.setActive.call(this, false);\n    } else {\n      AlignmentButton.__super__.setActive.call(this, active);\n    }\n    this.el.removeClass('align-left align-center align-right align-justify');\n    if (active) {\n      this.el.addClass('align-' + align);\n    }\n    this.setIcon('align-' + align);\n    return this.menuEl.find('.menu-item').show().end().find('.menu-item-' + align).hide();\n  };\n\n  AlignmentButton.prototype._status = function() {\n    this.nodes = this.editor.selection.nodes().filter(this.htmlTag);\n    if (this.nodes.length < 1) {\n      this.setDisabled(true);\n      return this.setActive(false);\n    } else {\n      this.setDisabled(false);\n      return this.setActive(true, this.nodes.first().css('text-align'));\n    }\n  };\n\n  AlignmentButton.prototype.command = function(align) {\n    if (align !== 'left' && align !== 'center' && align !== 'right' && align !== 'justify') {\n      throw new Error(\"simditor alignment button: invalid align \" + align);\n    }\n    this.nodes.css({\n      'text-align': align === 'left' ? '' : align\n    });\n    this.editor.trigger('valuechanged');\n    return this.editor.inputManager.throttledSelectionChanged();\n  };\n\n  return AlignmentButton;\n\n})(Button);\n\nSimditor.Toolbar.addButton(AlignmentButton);\n\nreturn Simditor;\n\n}));\n\n(function() {\n    'use strict'\n\n    angular\n    .module('app')\n    .factory('SideNavFactory', SideNavFactory);\n\n    function SideNavFactory() {\n\n        var factory = {\n            user: {\n                id: '',\n                first_name: '',\n                last_name: '',\n                cargo: '',\n                email: '',\n                photo: ''\n            },\n            userColor: '',\n            visible: false,\n            menu: [],\n            getMenu: function () {\n                return this.menu;\n            },\n            getUser: function () {\n                return this.user;\n            },\n            getVisible: function () {\n                return this.visible;\n            },\n            setMenu: function (menu) {\n                this.menu = menu;\n            },\n            setUser: function (user) {\n                this.user = user;\n            },\n            setVisible: function (visible) {\n                this.visible = visible;\n            }\n        };\n\n        return factory;\n\n    }\n\n})();\n(function() {\n    'use strict'\n\n    angular\n    .module('app')\n    .directive('acmeSidenav', SidenavDirective);\n\n    /** @ngInject */\n    function SidenavDirective() {\n        var directive = {\n            restrict: 'E',\n            templateUrl: 'app/components/sidenav/sidenav.html',\n            scope: {},\n            controller: ['$timeout', '$mdSidenav', 'SideNavFactory', '$location', 'Storage', 'Util', 'BreadcrumbFactory', '$log', SidenavController],\n            controllerAs: 'vm',\n            bindToController: true,\n            link: function(scope, elem) {\n                var $sidenav = elem\n\n                $sidenav.on('click', '.md-button-href', function () {\n                    $sidenav.find('.md-button-href').removeClass('active');\n                    angular.element(this).addClass('active');\n                })\n\n                $sidenav.on('click', '.md-button-toggle', function () {\n                    if ($sidenav.hasClass('collapsed')) {\n                        return false;\n                    }\n                    $sidenav.find('.sidenav-sublist').slideUp(300);\n                    $sidenav.find('.sidenav-list > li').removeClass('active');\n\n                    var $this = angular.element(this);\n                    $this.addClass('active');\n                    if(!$this.next().is(\":visible\")) {\n                        $this.next().slideToggle(300);\n                        $this.closest('li').addClass('active');\n                    }\n                })\n            }\n        }\n\n        return directive\n\n        /** @ngInject */\n        function SidenavController($timeout, $mdSidenav, SideNavFactory, $location, Storage, Util, BreadcrumbFactory, $log) {\n            var vm = this;\n            var color = ['info', 'success', 'danger', 'warning', 'primary'];\n\n            vm.user = {};\n            vm.menu = [];\n\n            vm.toggleLeft = buildDelayedToggler('left');\n\n            vm.send = function (url, submenu) {\n                if (typeof submenu == 'undefined') {\n                    if (Storage.exist('menu')) {\n                        var page = Util.getMenuOption(Storage.getSession('menu'), url);\n                        BreadcrumbFactory.setParent(page[0]);\n                        BreadcrumbFactory.setCurrent(page[1]);\n                    }\n                    Storage.setSession('last_route', url);\n                    // vm.toggleLeft();\n                    $location.path(url);\n                }\n                vm.reset();\n            }\n\n            vm.reset = function () {\n                angular.element('#toast-container-main').find('md-toast').fadeOut();\n            }\n\n            activate();\n\n            function activate() {\n                if(Storage.existUser()) {\n                    SideNavFactory.setUser(Storage.getUser());\n                    SideNavFactory.setMenu(Storage.getSession('menu'));\n                }\n                vm.menu = SideNavFactory.getMenu();\n                Storage.setSession('menu', vm.menu);\n\n                vm.active = $location.path().replace('/', '');\n                SideNavFactory.userColor = color[parseInt(Math.random()*color.length)];\n\n                $timeout(function () {\n                    angular.element('#sidenav').find('.md-button-href.active').parent().parent().prev().click();\n                }, 1000);\n            }\n\n            vm.getColor = function () {\n                return SideNavFactory.userColor;\n            }\n\n            vm.getName = function () {\n                var user = SideNavFactory.getUser();\n                return user.first_name + ' ' + user.last_name;\n            }\n\n            vm.getEmail = function () {\n                return SideNavFactory.getUser().email;\n            }\n\n            vm.getInitial = function () {\n                var firstName = SideNavFactory.getUser().first_name;\n                return firstName.length ? firstName[0].toUpperCase() : '?';\n            }\n\n            vm.getMenu = function () {\n                return SideNavFactory.getMenu();\n            }\n\n            /**\n            * Supplies a function that will continue to operate until the\n            * time is up.\n            */\n            function debounce(func, wait) {\n                var timer\n                return function debounced() {\n                    var context = vm,\n                    args = Array.prototype.slice.call(arguments);\n                    $timeout.cancel(timer);\n                    timer = $timeout(function() {\n                        timer = undefined;\n                        func.apply(context, args);\n                    }, wait || 10);\n                }\n            }\n            /**\n            * Build handler to open/close a SideNav when animation finishes\n            * report completion in console\n            */\n            function buildDelayedToggler(navID) {\n                return debounce(function() {\n                    $mdSidenav(navID)\n                    .toggle()\n                    .then(function () {\n                        $log.debug(\"toggle \" + navID + \" is done\");\n                    })\n                }, 200);\n            }\n        }\n    }\n})();\n\n(function() {\n    'use strict';\n\n    angular\n    .module('app')\n    .component('mdSelectDate', {\n        templateUrl: 'app/components/selectDate/selectDate.html',\n        controller: ['$scope', 'Datetime', SelectDateController],\n        controllerAs: 'vm',\n        bindings: {\n            ngModel: '=',\n            ngDisabled: '=',\n            ngRequired: '=',\n            ngLabel: '@',\n            yearIni: '@',\n            yearEnd: '@',\n            year: '@',\n            month: '@',\n            day: '@'\n        }\n    });\n\n    /** @ngInject */\n    function SelectDateController($scope, Datetime) {\n        var vm = this;\n\n        activate();\n\n        function activate() {\n            initDays();\n            initMonths();\n            initYears();\n\n            if (vm.ngModel && Datetime.isDate(new Date(vm.ngModel))) {\n                var date = new Date(vm.ngModel);\n                vm.day = date.getDate();\n                vm.month = date.getMonth() + 1;\n                vm.year = date.getFullYear();\n            }\n        }\n\n        function initDays() {\n            var days = [];\n            for (var i = 1; i <= 31; i++) {\n                days.push({\n                    name: i,\n                    value: i\n                });\n            }\n            vm.days = days;\n        }\n\n        function initMonths() {\n            var months = [];\n            for (var i = 0; i < 12; i++) {\n                months.push({\n                    name: Datetime.months[i],\n                    value: i + 1\n                });\n            }\n            vm.months = months;\n        }\n\n        function initYears() {\n            var year = parseInt(Datetime.now('YYYY'));\n            var years = [];\n            var yearIni = year - (vm.yearIni || 100);\n            var yearEnd = year - (vm.yearEnd || 0);\n            for (var i = yearEnd, l = yearIni; i >= l; i--) {\n                years.push({\n                    name: i,\n                    value: i\n                });\n            }\n            vm.years = years;\n            // if (typeof vm.year == 'undefined' && typeof vm.ngModel == 'undefined') {\n            //     vm.year = year - 30;\n            // }\n        }\n\n        $scope.$watch('vm.day', function (newValue, oldValue) {\n            oldValue = oldValue; //TODO: Esta linea no es necesaria\n            vm.ngModel = new Date(vm.year, vm.month-1, newValue);\n        });\n        $scope.$watch('vm.month', function (newValue, oldValue) {\n            oldValue = oldValue; //TODO: Esta linea no es necesaria\n            vm.ngModel = new Date(vm.year, newValue-1, vm.day);\n        });\n        $scope.$watch('vm.year', function (newValue, oldValue) {\n            oldValue = oldValue; //TODO: Esta linea no es necesaria\n            vm.ngModel = new Date(newValue, vm.month-1, vm.day);\n        });\n        $scope.$watch('vm.ngModel', function (newValue, oldValue) {\n            if (newValue && newValue != oldValue && Datetime.isDate(new Date(newValue))) {\n                var date = new Date(newValue);\n                vm.day = date.getDate();\n                vm.month = date.getMonth() + 1;\n                vm.year = date.getFullYear();\n            }\n        });\n    }\n\n})();\n\n(function() {\n    'use strict'\n\n    angular\n    .module('app')\n    .component('paletteFormly', {\n        templateUrl : 'app/components/paletteFormly/paletteFormly.html',\n        controller : PaletteFormlyController,\n        controllerAs: 'vm',\n        bindings: {\n            menu: '=',\n            funcionAgregar: '=',\n            options: '=',\n            node: '@'\n        }\n    });\n\n    function PaletteFormlyController(){\n        var vm = this;\n        //contador de templates\n        // var cont_templates = 0;\n\n        //cargamos funcion\n        vm.addItem = addItem;\n\n        //variable que contiene la lista de menus con templates cada uno\n        vm.elementos = [\n            {\n                \"expanded\": true,\n                \"titulo\" : \"DOCUMENTOS\",\n                \"submenu\": [\n                    { name: \"Datos generales\", tipo: \"datosGenerales\" },\n                    { name: \"Encabezado\", tipo: \"encabezado\" },\n                    { name: \"Asunto\" , tipo: \"inputt\" },\n                    // { name: \"Cite\", tipo: \"cite\" },\n                    { name: \"Documentos relacionados\", tipo: \"documentosRelacionados\" },\n                    { name: \"Documentos a anular\", tipo: \"documentosAnular\" },\n                    { name: \"Cc.:archivo\", tipo: \"ccArchivo\" },\n                    { name: \"Caja chica\", tipo: \"cajachica\" },\n                    { name: \"Certificacion comprometido\", tipo: \"certificacionComprometido\" },\n                    { name: \"Lista de contactos\", tipo: \"listaContactos\" },\n                    { name: \"Editor de texto\", tipo: \"editorTexto\" }\n                ]\n            },\n            {\n                \"expanded\": true,\n                \"titulo\" : \"TEXTOS\",\n                \"submenu\": [\n                    { name: \"Título\", tipo: \"titulo\" },\n                    { name: \"Subtítulo\", tipo: \"subtitulo\" },\n                    { name: \"Párrafo\", tipo: \"parrafo\" },\n                    { name: \"Lista\", tipo: \"lista\" }\n                ]\n            },\n            {\n                \"expanded\": true,\n                \"titulo\" : \"LAYOUTS\",\n                \"submenu\": [\n                    { name: \"Contenedor\", tipo: \"layout\" },\n                    { name: \"Espacio\", tipo: \"vacio\" }\n                ]\n            },\n            {\n                \"expanded\": true,\n                \"titulo\" : \"ELEMENTOS FORMULARIO\",\n                \"submenu\": [\n                    { name: \"Archivo\", tipo: \"archivo\" },\n                    { name: \"Campo de texto\" , tipo: \"input\" },\n                    { name: \"Selección radio\", tipo: \"radio\" },\n                    { name: \"Selección simple\", tipo: \"select\" },\n                    { name: \"Selección multiple\", tipo: \"select_multiple\" },\n                    { name: \"Area de texto\", tipo: \"textarea\" },\n                    { name: \"Checkbox\", tipo: \"checkbox\" },\n                    { name: \"Calendario\", tipo: \"datepicker\" },\n                    // { name: \"Calendario\", tipo: \"calendario\" },\n                    { name: \"Deslizador\", tipo: \"slider\" },\n                    { name: \"Interruptor\", tipo: \"switch\" },\n                    { name: \"Palabras clave\", tipo: \"chips\" }\n                ]\n            }\n        ];\n\n        function addItem(tipo){\n            if(angular.isDefined(vm.funcionAgregar)){\n                vm.funcionAgregar(tipo);\n            }\n        }\n\n    }\n  })();\n\n(function() {\n    'use strict'\n\n    angular\n    .module('app')\n    .directive('acmeNavbar', acmeNavbar);\n\n    /** @ngInject */\n    function acmeNavbar() {\n        var directive = {\n            restrict: 'E',\n            templateUrl: 'app/components/navbar/navbar.html',\n            scope: {},\n            controller: ['ExpirationTime', '$location', 'Storage', 'SideNavFactory', 'Util', 'DataService', '$window', 'restUrl', NavbarController],\n            controllerAs: 'vm',\n            bindToController: true\n        }\n\n        return directive\n\n        /** @ngInject */\n        function NavbarController(ExpirationTime, $location, Storage, SideNavFactory, Util, DataService, $window, restUrl) {\n            var vm = this;\n\n            vm.toggle = function () {\n                angular.element('#sidenav-main').toggleClass('collapsed');\n            }\n\n            vm.openMenu = function ($mdOpenMenu, ev) {\n                $mdOpenMenu(ev);\n            }\n\n            vm.profile = function () {\n                $location.path(\"profile\");\n            }\n\n            vm.settings = function () {\n                $location.path(\"configuracion\");\n            }\n\n            vm.getFirstName = function () {\n                if (Storage.existUser()) {\n                    return Storage.getUser().first_name;\n                }\n                return SideNavFactory.getUser().first_name;\n            }\n\n            vm.getColor = function () {\n                return SideNavFactory.userColor;\n            }\n\n            vm.getInitial = function () {\n                var firstName = SideNavFactory.getUser().first_name;\n                return firstName.length ? firstName[0].toUpperCase() : '?';\n            }\n\n            vm.logout = function () {\n              var codigo = $window.localStorage.getItem('oauth2_state');\n              if (codigo) {\n                  // this.$log.log('------------------------------codigo', codigo);\n                  DataService.get(restUrl + 'salir?codigo=' + codigo)\n                  .then(function (response) {\n                      $window.location.href = response.datos;\n                  });\n              } else {\n                  ExpirationTime.logout();\n              }\n            }\n\n            vm.fullscreen = function () {\n                angular.element('body').toggleClass('fullscreen');\n                Util.fullscreen();\n            }\n\n            vm.cambiarUsuario = function () {\n                $location.path(\"elegir\");\n            }\n        }\n    }\n\n})();\n\n(function() {\n    'use strict'\n\n    angular\n    .module('app')\n    .component('menuCard', {\n        templateUrl : 'app/components/menuCard/menuCard.html',\n        controller : [MenuCardController],\n        controllerAs: 'vm',\n        bindings: {\n            items: '=',\n            titleTable: '=',\n            node: '@'\n        }\n    });\n\n    function MenuCardController(){\n    }\n  })();\n\n(function () {\n    'use strict';\n\n    angular\n        .module('app')\n        .constant('simditorConfig', {\n            placeholder: 'Ingrese contenido aquí...',\n            toolbar: [ 'underline', 'ols', '|', 'indent', 'outdent', 'alignment', '|', 'table', 'link', 'hr' ],\n            allowedTags: ['br', 'u', 'p', 'li', 'div'],\n            toolbarHidden: true\n        })\n        .directive('ngSimditor', ['$timeout', 'simditorConfig', function ($timeout, simditorConfig) {\n            Simditor.locale = 'en-US';  // eslint-disable-line no-undef\n            Simditor.i18n['en-US'] = {  // eslint-disable-line no-undef\n                'bold': 'Negrita',\n                'italic': 'Itálica',\n                'underline': 'Subrayar',\n                'color': 'Color',\n                'indent': 'Aumentar sangría',\n                'outdent': 'Quitar sangría',\n                'alignment': 'Alinear',\n                'table': 'Tabla',\n                'link': 'Enlace',\n                'hr': 'Línea',\n                'deleteRow': 'Eliminar fila',\n                'insertRowAbove': 'Insertar fila arriba',\n                'insertRowBelow': 'Insertar fila abajo',\n                'deleteColumn': 'Eliminar columna',\n                'insertColumnLeft': 'Insertar columna a la izquierda',\n                'insertColumnRight': 'Insertar columna a la derecha',\n                'paintRow': 'Pintar fila',\n                'paintCell': 'Pintar celda',\n                'dissolveRow': 'Despintar fila',\n                'dissolveCell': 'Despintar celda',\n                'deleteTable': 'Eliminar tabla',\n                'addBorder': 'Agregar bordes',\n                'removeBorder': 'Eliminar bordes',\n                'listDisc': 'Circulos llenos',\n                'listCircle': 'Circulos vacios',\n                'listSquare': 'Cuadrados llenos',\n                'listDecimal': '1, 2, 3, 4...',\n                'listDecimal0': '01, 02, 03, 04...',\n                'listUpperRoman': 'I, II, III, IV...',\n                'listLowerRoman': 'i, ii, iii, iv...',\n                'listUpperAlpha': 'A, B, C, D...',\n                'listLowerAlpha': 'a, b, c, d...',\n                'listGreek': 'Letras griegas',\n                'toggleList': 'Añadir/quitar Lista'\n            };\n\n            // Runs during compile\n            return {\n                // name: '',\n                // priority: 1,\n                // terminal: true,\n                scope: {\n                    content: '=',\n                    disabled: '=',\n                    save: '@'\n                }, // {} = isolate, true = child, false/undefined = no change\n                // controller: function($scope, $element, $attrs, $transclude) {},\n                // require: 'ngModel', // Array = multiple requires, ? = optional, ^ = check parent elements\n                restrict: 'E', // E = Element, A = Attribute, C = Class, M = Comment\n                template: '<textarea data-autosave=\"editor-content\"></textarea>',\n                // templateUrl: '',\n                replace: true,\n                // transclude: true,\n                // compile: function(tElement, tAttrs, function transclude(function(scope, cloneLinkingFn){ return function linking(scope, elm, attrs){}})),\n                link: function ($scope, iElm, iAttrs, controller) { // eslint-disable-line no-unused-vars\n                    var sc = $scope;\n                    var editor = new Simditor( // eslint-disable-line no-undef\n                        angular.extend({ textarea: iElm }, simditorConfig)\n                    );\n                    // console.log(editor);\n\n                    //cargar valor inicial si tiene\n                    $timeout(function() {\n                        editor.body[0].contentEditable = (angular.isDefined(sc.disabled))? !sc.disabled : true;\n                        if(angular.isDefined(sc.content))  editor.setValue(sc.content);\n                    })\n\n                    //actualizar el content\n                    var changed = function (ev) {  // eslint-disable-line no-unused-vars\n                        sc.content = editor.getValue();\n                    };\n\n                    editor.on('valuechanged', changed);\n\n                    editor.on('focus', function (ev) {  // eslint-disable-line no-unused-vars\n                        angular.element(iElm).prev().prev().prev().addClass('active-editor');\n                    });\n\n                    editor.on('blur', function (ev) {  // eslint-disable-line no-unused-vars\n                        $timeout(function () {\n                            angular.element(iElm).prev().prev().prev().removeClass('active-editor');\n                        }, 200);\n                    });\n                }\n            };\n        }]);\n\n})();\n\n(function() {\n    'use strict';\n\n    angular\n    .module('app')\n    .component('documentoIdentidad', {\n        templateUrl: 'app/components/documentoIdentidad/documentoIdentidad.html',\n        controller: ['$scope', 'DataService', 'Datetime', 'Message', DocumentoIdentidadController],\n        controllerAs: 'vm',\n        bindings: {\n            ngModel: '=',\n            ngDisabled: '=',\n            onlyCi: '@',\n            url: '='\n        }\n    });\n\n    /** @ngInject */\n    function DocumentoIdentidadController($scope, DataService, Datetime, Message) {\n        var vm = this;\n\n        vm.tipos = [\n            {\n                value: 'CI',\n                name: 'Cedula de identidad'\n            },\n            {\n                value: 'PASAPORTE',\n                name: 'Pasaporte'\n            }\n        ];\n\n        vm.tipo_documento = 'CI';\n        vm.search = search;\n        vm.isDisabled = isDisabled;\n\n        activate();\n\n        function activate() {\n            if (vm.ngModel) {\n                vm.model = vm.ngModel;\n                vm.fecha_nacimiento = new Date(vm.model.persona.fecha_nacimiento);\n                vm.complemento = vm.model.persona.complemento;\n                vm.nro_documento = vm.model.persona.nro_documento;\n                vm.tipo_documento = vm.model.persona.tipo_documento;\n            } else {\n                vm.model = {};\n            }\n        }\n\n        function isDisabled() {\n            return typeof vm.nro_documento == 'undefined' || !Datetime.isDate(vm.fecha_nacimiento);\n        }\n\n        function search() {\n            Message.loading(\"Buscando datos en el SEGIP\");\n            DataService.get(vm.url + vm.nro_documento + '?fecha_nacimiento=' + Datetime.format(vm.fecha_nacimiento, 'dd/MM/YYYY'))\n            .then(function(response) {\n                if (response) {\n                    vm.model.persona = response;\n                    vm.ngModel = vm.model;\n                } else {\n                    vm.model.persona = {};\n                    vm.ngModel = vm.model;\n                }\n            });\n        }\n\n        $scope.$watch('vm.tipo_documento', function (newValue) {\n            vm.model.tipo_documento = newValue;\n            vm.ngModel = vm.model;\n        });\n        $scope.$watch('vm.nro_documento', function (newValue) {\n            vm.model.nro_documento = newValue;\n            vm.ngModel = vm.model;\n        });\n        $scope.$watch('vm.complemento', function (newValue) {\n            vm.model.complemento = newValue;\n            vm.ngModel = vm.model;\n        });\n        $scope.$watch('vm.fecha_nacimiento', function (newValue) {\n            vm.model.fecha_nacimiento = newValue;\n            vm.ngModel = vm.model;\n        });\n\n    }\n\n})();\n\n(function() {\n    'use strict'\n\n    angular\n    .module('app')\n    .component('crudTable', {\n        templateUrl : 'app/components/crudTable/crudTable.html',\n        controller : ['$scope', 'DataService', 'Message', 'Modal', 'Util', '$timeout', 'ArrayUtil', 'Datetime', '$state', CrudTableController],\n        controllerAs: 'vm',\n        bindings: {\n            url: '=',\n            fields: '=',\n            fks: '=',\n            titleTable: '=',\n            template: '=',\n            permission: '=',\n            column: '=',\n            formly: '=',\n            editable: '=',\n            eventSave: '=',\n            dialogController: '=',\n            order: '=',\n            optionSelected: '=',\n            condiciones: '=',\n            buttons: '=',\n            buttonAgregar: '=',\n            idShow: '=',\n            include: '=',\n            queryExtra: '=',\n            usuario: '=',\n            informacionBienes: '=',\n            estadoSw: '=', // TODO solo funciona con estado= 'ACTIVO'|'INACTIVO'\n            onlyFields: '=',\n            searchPro: '=',\n            estadoChecks: '=',\n            estadoOpciones: '=',\n            items: '=?',\n            habilitarSeleccion: '=',\n            node: '@',\n            seleccionados:'='\n        }\n    });\n\n    function CrudTableController($scope, DataService, Message, Modal, Util, $timeout, ArrayUtil, Datetime, $state) {\n        var vm = this;\n        var bookmark;\n        var limit = 10;\n\n        vm.headers = [];\n        vm.items = null;\n        vm.item = null;\n        // vm.node = true; // Habilitar para nodejs\n        vm.tipo_busqueda='todos';\n        vm.campo_seleccionado={};\n        vm.busqueda_estado = [];\n\n        vm.prevent = prevent;\n        vm.estadoModificado = estadoModificado;\n        vm.add = add;\n        vm.edit = edit;\n        vm.delete = deleteItem;\n        vm.print = print;\n        vm.save = save;\n        vm.saveAll = saveAll;\n        vm.removeFilter = removeFilter;\n        vm.showFilter = showFilter;\n        vm.getItems = getItems;\n        vm.buttonEvent = buttonEvent;\n        vm.dataGrid = {};\n        vm.seleccionar = false;\n        vm.seleccionarTodos = seleccionarTodos;\n        vm.seleccionando = seleccionando;\n        // para permitir ver informacion pequeña de documentos\n        vm.sw_cite = ['/documentos', '/impresion', '/aprobacion', '/en_curso', '/firmar'].indexOf($state.current.url) !== -1;\n\n        vm.permissions = {\n            create: true,\n            read: true,\n            update: true,\n            delete: true,\n            print: false,\n            filter: true\n        }\n\n        vm.limitOptions = [limit, 25, 50];\n        // vm.limitOptions = [limit];\n\n        vm.options = {\n            rowSelection: false,\n            multiSelect: false,\n            autoSelect: true,\n            decapitate: false,\n            largeEditDialog: true,\n            boundaryLinks: true,\n            limitSelect: true,\n            pageSelect: false\n        }\n\n        vm.query = {\n            order: (vm.fields.indexOf('_fecha_modificacion'))? '-_fecha_modificacion': '',\n            limit: limit,\n            page: 1,\n            filter: ''\n        }\n\n        vm.filter = {\n            options: {\n                debounce: 500\n            }\n        };\n\n        activate();\n\n        function activate() {\n            getFields();\n        }\n\n        function seleccionando (){\n          if(angular.isFunction(vm.seleccionados)) $timeout(function(){ vm.seleccionados(existeSeleccionado()); });\n        }\n\n        function estadoModificado(item) {\n            item._usuario_modificacion = vm.usuario;\n            DataService.put(vm.url+Util.getId(item, vm.fieldsData), angular.copy(item));\n            if(vm.fields.indexOf('_usuario_modificacion')===-1) delete item._usuario_modificacion;\n        }\n\n        function seleccionarTodos() {\n            if(!vm.seleccionar) {\n                vm.items.data.map (function (item) {\n                    item.selected = true;\n                });\n            } else {\n                vm.items.data.map (function (item) {\n                    item.selected = false;\n                });\n            }\n            if(angular.isFunction(vm.seleccionados)) vm.seleccionados(existeSeleccionado());\n        }\n\n        function prevent(ev) {\n            ev.stopPropagation();\n        }\n\n        function getItems () {\n            if (vm.fieldsData) {\n                vm.promise = getData();\n            }\n        }\n\n        function add(event, item) {\n            var id = Util.getId(item, vm.fieldsData);\n            if (id) {\n                getItem(event, false, id);\n            } else {\n                item = {};\n                item._usuario_creacion = vm.usuario;\n                item._fecha_creacion = new Date();\n                item._fecha_modificacion = new Date();\n                openDialog(event, true, item);\n            }\n        }\n\n        function save (data) {\n\n            var obj = {};\n\n            for (var i in data) {\n                obj[i] = vm.dataGrid[data[i]];\n            }\n\n            DataService.save(vm.url, Util.parseSave(obj, vm.fieldsData))\n            .then(function(data) {\n                if (data) {\n                    Message.show(data.tipoMensaje,data.mensaje);\n                }\n            });\n        }\n\n\n        function saveAll () {\n            var data = vm.dataGrid,\n                c = 0,\n                length = vm.headers.length,\n                dataSave = [],\n                obj = {},\n                promises = [];\n\n            for (var i in data) {\n                var key = i.split('_');\n                key.shift();\n                key = key.join('_');\n                obj[key] = data[i];\n                c++;\n                if (c % length == 0) {\n                    dataSave.push(obj);\n                    promises.push(savePromise(obj));\n                    obj = {};\n                }\n            }\n            Promise.all(promises)\n            .then(function (response) {\n                for (var i in response) {\n                    if (response[i] === false) {\n                        Message.error('Se produjo un error al grabar todos los datos.');\n                        throw new Error('Error al grabar todos los datos');\n                    }\n                }\n                Message.success('Se guardaron todos los datos');\n            });\n        }\n\n        function savePromise(data) {\n            return new Promise(function (resolve, reject) {\n                DataService.save(vm.url, Util.parseSave(data, vm.fieldsData))\n                .then(function(data) {\n                    if (data) {\n                        resolve(true);\n                    } else {\n                        reject(false);\n                    }\n                }).catch(function () {\n                    reject(false);\n                });\n            });\n        }\n\n        function edit (event, item) {\n            vm.add(event, item);\n        }\n\n        function deleteItem (event, item) {\n            Modal.confirm('Se eliminará el registro de forma permanente, ¿Está seguro?.', function () {\n                DataService.delete( vm.url , Util.getId(item, vm.fieldsData))\n                .then(function() {\n                    Message.success('El registro se eliminó correctamente.');\n                    vm.getItems();\n                })\n                .catch(function () {\n                    Message.error();\n                });\n            }, null, event);\n        }\n\n        function getItem(event, add, id) {\n            DataService.get( vm.url, id + (vm.include ? '?include=' + vm.include: ''))\n            .then(function(data) {\n              if (data && data.datos[Util.getId(data, vm.fieldsData, true)]) {\n                    data.datos._usuario_modificacion = vm.usuario;\n                    data.datos._fecha_modificacion = new Date();\n                    openDialog(event, add, Util.filterItem(data.datos));\n                }\n            });\n        }\n\n        function openDialog(event, add, item) {\n            var config = {\n                event: event,\n                data: item,\n                title: add ? 'Agregar' : 'Editar',\n                add: add,\n                fields: vm.fieldsData,\n                column: vm.column || 1,\n                templateUrl : vm.template || 'app/components/crudTable/dialog.crudTable.html',\n                done : function (answer, $mdDialog) {\n                    if (answer == 'save') {\n                        delete item._fecha_creacion;\n                        delete item._fecha_modificacion;\n                        DataService.save( vm.url, Util.parseSave(item, vm.fieldsData))\n                        .then(function(data) {\n                            if (data) {\n                                Message.show(data.tipoMensaje,'', null, 0);\n                                $mdDialog.hide();\n                                vm.getItems();\n                                if (vm.eventSave) {\n                                    vm.eventSave(data);\n                                }\n                            }\n                        });\n                    }\n                }\n            };\n            if (vm.dialogController) {\n                config.controller = vm.dialogController;\n            }\n            Modal.show(config);\n        }\n\n        function getData() {\n            if (vm.include) {\n                vm.query.include = vm.include;\n            }\n            if (vm.queryExtra) {\n                for (var k in vm.queryExtra) {\n                    vm.query[k] = vm.queryExtra[k];\n                }\n            }\n            if(vm.onlyFields){\n                vm.query['fields'] = '';\n                for (var i = 0; i < vm.fields.length; i++) {\n                    vm.query['fields'] += vm.fields[i]+\",\";\n                }\n                vm.query['fields'] = vm.query['fields'].substring(0, vm.query['fields'].length-1);\n            }\n            if(vm.estadoChecks){\n                if(vm.busqueda_estado.length>0) vm.query['estado'] = vm.busqueda_estado.toString();\n                else delete vm.query['estado'];\n            }\n\n            if(vm.searchPro){\n                vm.query['searchPro'] = 1;\n                vm.query['tipoBus'] = vm.tipo_busqueda;\n                if(vm.tipo_busqueda!='todos' || vm.tipo_busqueda!='documento'){\n                    if(vm.tipo_busqueda=='campo'){\n                        vm.query['campoSel'] = vm.campo_seleccionado.name || vm.headers[1].name;\n                    }\n                }else {\n                    delete vm.query['tipoBus'];\n                    delete vm.query['campoSel'];\n                    delete vm.query['fFin'];\n                }\n                if(vm.check_fechas){\n                    if (!Datetime.isDate(vm.fecha_inicio))\n                        vm.fecha_inicio = new Date(Datetime.subtractDays(new Date(), 365));\n                    if(!Datetime.isDate(vm.fecha_final))\n                        vm.fecha_final = new Date();\n                    vm.query['fIni'] = vm.fecha_inicio;\n                    vm.query['fFin'] = new Date(Datetime.addDays(vm.fecha_final, 1));\n                    vm.query['fIni'].setHours(0);\n                    vm.query['fFin'].setHours(0);\n                }else {\n                    delete vm.query['fIni'];\n                    delete vm.query['fFin'];\n                }\n            }\n            return DataService.list( vm.url, vm.query)\n            .then(function(data) {\n                if (data) {\n                    var items = {};\n                    var datos = data.datos;\n\n                    items.count = datos.total;\n                    items.results = datos.resultado;\n                    items.data = filterItems(datos.resultado);\n                    vm.items = items;\n                    if(angular.isFunction(vm.seleccionados)) vm.seleccionados(existeSeleccionado());\n                }\n            });\n        }\n\n        function existeSeleccionado() {\n          var cont = 0;\n          var respuesta = false;\n          vm.items.data.map (function (item) {\n            if(item.selected === true) cont++;\n          });\n          if(cont > 0) respuesta = true;\n          return respuesta;\n        }\n\n        function getFields() {\n            DataService.fields(vm.url)\n            .then(function(data) {\n                if (data) {\n                    vm.fieldsData = Util.filterFields(data, vm.fields);\n                    vm.fieldsData = Util.addPropertiesFormly(vm.fieldsData, vm.formly);\n\n                    var arr = [\"_usuario_creacion\",\"_usuario_modificacion\",\"_fecha_creacion\",\"_fecha_modificacion\"];\n                    for (var i in vm.fieldsData) {\n                      var xfield = vm.fieldsData[i];\n                      var arrindex = arr.indexOf(xfield.key);\n                      if( arrindex != -1){\n                        xfield.templateOptions.required = false;\n                        xfield.templateOptions.disabled = true;\n                        if(arrindex == 2) xfield.templateOptions.label = \"Fecha de creación\";\n                        if(arrindex == 3) xfield.templateOptions.label = \"Fecha de modificación\";\n                      }else if(xfield.templateOptions.label == \"ID\"){\n                        xfield.templateOptions.required = false;\n                      }else if (xfield.key.indexOf(\"fid_\") == 0) {\n                        var object = {};\n                        var options = xfield.templateOptions.options;\n                        for (var k in options) {\n                          object[options[k].value] = options[k].name  ;\n                        }\n                        xfield.templateOptions.fkeys = object;\n                      }\n                    }\n\n                    addOptionSelected(vm.fieldsData, vm.optionSelected);\n                    DataService.setFormly(vm.fieldsData);\n\n                    setHeaders(vm.fieldsData);\n                    if (vm.editable) {\n                        vm.types = Util.getKeys(vm.fieldsData);\n                    }\n                    if (vm.permission) {\n                        vm.permissions = angular.merge(vm.permissions, vm.permission);\n                    }\n                    if (vm.condiciones) {\n                        vm.query = angular.merge(vm.query, vm.condiciones);\n                    }\n                    vm.getItems();\n                }\n            });\n        }\n\n        function addOptionSelected(data, options) {\n            for (var i in data) {\n                if (data[i].type == 'select') {\n                    var item = Util.searchField(options, data[i].key);\n                    if (item) {\n                        ArrayUtil.insert(data[i].templateOptions.options, 0, {\n                            name: item.text || 'Seleccione',\n                            value: item.value || ''\n                        });\n                    }\n                }\n            }\n        }\n\n        function filterItems(data) {\n            var fields = typeof vm.fields != 'undefined';\n            var fks = typeof vm.fks != 'undefined';\n            var array = [];\n            for (var i in data) {\n                for (var j in data[i]) {\n                    if (fields && vm.fields.indexOf(j) == -1) {\n                        delete data[i][j];\n                    } else {\n                        if (typeof vm.editable == 'undefined') {\n                            if (typeof data[i][j] == 'boolean') {\n                                data[i][j] = data[i][j] ? 'check_circle_success' : 'check_circle_gray';\n                            } else if (fks && vm.fks.indexOf(j) != -1) {\n                                if (Util.toType(data[i][j]) == 'array') {\n                                    var l = Util.lengthOptions(vm.fieldsData, j);\n                                    if (l > 1 && l == data[i][j].length) {\n                                        data[i][j] = 'Todos';\n                                    } else {\n                                        var text = [];\n                                        /*eslint-disable no-unused-vars*/\n                                        data[i][j].map(function (e, i) {\n                                          /*eslint-enable no-unused-vars*/\n                                           text.push(Util.getFkData(vm.fieldsData ,j, e));\n                                        });\n                                        data[i][j] = text.join(', ');\n                                    }\n                                } else {\n                                    data[i][j] = Util.getFkData(vm.fieldsData ,j, data[i][j]);\n                                }\n                            } else if (typeof data[i][j] == 'string' && !/[a-zA-Z]+/g.test(data[i][j]) && /^-?[0-9.]+\\-?[0-9]+\\-?[0-9]*$/g.test(data[i][j]) && data[i][j].length == 10) {\n                                data[i][j] = Util.formatDate(data[i][j]);\n                            } else if (Util.toType(data[i][j]) == 'array') {\n                                data[i][j] = data[i][j][0];\n                            } else if (typeof data[i][j] == 'string' && !/[a-zA-Z]+/g.test(data[i][j]) && /^(?:(?:([01]?\\d|2[0-3]):)?([0-5]?\\d):)?([0-5]?\\d)$/g.test(data[i][j]) && data[i][j].length == 8) {\n                              data[i][j] = formatTime(data[i][j])\n                            }\n                        }\n                    }\n                }\n                array.push(orderItem(data[i], vm.fieldsData, i));\n            }\n            return array;\n        }\n\n        function orderItem(data, fields, pos) {\n\n            if (typeof fields == 'undefined' || fields.length == 0) {\n                return data;\n            }\n\n            var item = {};\n\n            for (var i in fields) {\n                var field = fields[i].key\n                if (typeof data[field] != 'undefined') {\n                    if (vm.editable) {\n                        if (typeof data[field] == 'string' && !/[a-zA-Z]+/g.test(data[field]) && /^-?[0-9.]+\\-?[0-9]+\\-?[0-9]*$/g.test(data[field]) && data[field].length == 10) {\n                            var date = data[field].split('-');\n                            vm.dataGrid[pos + '_' + field] = new Date(date[0], date[1]-1, date[2]);\n                        } else {\n                            vm.dataGrid[pos + '_' + field] = data[field];\n                        }\n                        item[field] = pos + '_' + field;\n                    } else {\n                        item[field] = data[field];\n                    }\n                }\n            }\n\n            return item;\n        }\n\n        function formatTime(time) {\n            time = time.split(':')\n            return [time[0], time[1]].join(':')\n        }\n\n        function setHeaders(data) {\n            var headers = [];\n            var order = typeof vm.order == 'undefined';\n            for (var i in data) {\n                headers.push({\n                    name: data[i].key,\n                    title: data[i].templateOptions.label,\n                    order: order || (vm.order && vm.order.indexOf(data[i].key) != -1)\n                });\n            }\n            vm.headers = headers;\n        }\n\n        function print(event, item) {\n            DataService.pdf(vm.url + 'print/' + Util.getId(item, vm.fieldsData) + '/')\n            .then(function (data) {\n                Modal.show({\n                    event: event,\n                    data: data.url,\n                    title: 'Impresión',\n                    templateUrl : 'app/components/crudTable/dialog.pdf.html',\n                    controller: ['$scope', '$mdDialog', 'data', 'title', PdfController]\n                });\n            });\n        }\n\n        function PdfController($scope, $mdDialog, data, title) {\n            var vm = $scope;\n\n            vm.title = title;\n            vm.data = data;\n            vm.hide = $mdDialog.hide;\n            vm.cancel = $mdDialog.cancel;\n        }\n\n        function showFilter() {\n            vm.filter.show = true;\n            $timeout(function () {\n                angular.element('#crud-table-input').focus();\n            }, 300);\n        }\n\n        function removeFilter () {\n            vm.filter.show = false;\n            vm.query.filter = '';\n            vm.tipo_busqueda='todos';\n\n            if(vm.filter.form.$dirty) {\n                vm.filter.form.$setPristine();\n            }\n        }\n\n        $scope.$watch('vm.query.filter', function (newValue, oldValue) {\n            if(!oldValue) {\n                bookmark = vm.query.page;\n            }\n\n            if(newValue !== oldValue) {\n                vm.query.page = 1;\n            }\n\n            if(!newValue) {\n                vm.query.page = bookmark;\n            }\n\n            vm.getItems();\n        });\n\n        //New Bottons\n        function buttonEvent(event, item, callback) {\n            callback(event, Util.getId(item, vm.fieldsData));\n        }\n\n    }\n\n})();\n\n(function () {\n    'use strict';\n\n    angular\n        .module('app')\n        .constant('charColors', {\n            bo: {\n                rojo: 'rgba(211, 47, 47, 0.7)',\n                azul: 'rgba(48, 79, 254, 0.7)',\n                amarillo: 'rgba(255, 171, 0, 0.7)',\n                celeste: 'rgba(0, 184, 212, 0.7)',\n                lila: 'rgba(123, 31, 162, 0.7)',\n                naranja: 'rgba(230, 74, 25, 0.7)',\n                verde: 'rgba(104, 159, 56, 0.7)'\n            },\n            bg: {\n                rojo: 'rgba(211,47,47, 0.1)',\n                azul: 'rgba(48, 79, 254, 0.1)',\n                amarillo: 'rgba(255, 171, 0, 0.1)',\n                celeste: 'rgba(0, 184, 212, 0.1)',\n                lila: 'rgba(123, 31, 162, 0.1)',\n                naranja: 'rgba(230, 74, 25, 0.1)',\n                verde: 'rgba(104, 159, 56, 0.1)'\n            }\n        })\n        .directive('chartGraph', ['$timeout', '$window', function ($timeout, $window) {\n            var options_default = {\n                line: {\n                    scales: {\n                        yAxes: [{\n                            ticks: {\n                                beginAtZero:true\n                            }\n                        }],\n                        xAxes: [{\n                            ticks: {\n                                autoSkip: false\n                            }\n                        }]\n                    },\n                    legend: {\n                        labels: {\n                            boxWidth: 15\n                        }\n                    },\n                    tooltips: {\n                        mode: 'x-axis'\n                    }\n                },\n                bar: {\n                    legend: {\n                        labels: {\n                            boxWidth: 15\n                        }\n                    },\n                    scales: {\n                        yAxes: [{\n                            ticks: {\n                                beginAtZero:true\n                            }\n                        }],\n                        xAxes: [{\n                            ticks: {\n                                autoSkip: false\n                            }\n                        }]\n                    }\n\n                }\n            };\n            // Runs during compile\n            return {\n                scope: {\n                    ancho: '=',\n                    alto: '=',\n                    tipo: '=',\n                    datos: '=',\n                    actualizar: '=', // flag disparador del watch actualizar\n                    reiniciar: '=', // flag disparador del watch reiniciar\n                    opciones: '='\n                },\n                restrict: 'E', // E = Element, A = Attribute, C = Class, M = Comment\n                link: function (sc, elm, attrs, controller) { // eslint-disable-line no-unused-vars\n                    $timeout(function () {\n                        var canvas, xchart;\n                        elm.wrap('<div></div>');\n                        elm.parent().css('overflow','auto');\n                        // elm.parent().css('border','1px solid #c3c3c3');\n                        // elm.parent().css('box-shadow','3px 3px 3px 0 solid #e3e3e3');\n\n                        iniciar();\n                        /**\n                          Funcion que inicia o reinicia el componente chart\n                        */\n                        function isMobile() { return angular.isDefined($window.orientation); }\n\n                        function iniciar() {\n                            if(isMobile()){\n                                if(sc.ancho>750) sc.ancho=750;\n                                if(sc.alto>320) sc.alto=320;\n                            }\n                            elm.parent().css('width',((sc.ancho)||400));\n                            elm.parent().css('height',((sc.alto)||250));\n                            elm.html('<div class=\"chart-graph\" style=\"width:'+(sc.ancho-25 || 400)+'px;height:'+(sc.alto-25||250)+'px;\"><canvas></canvas></div>');\n                            canvas = elm.children('div').children('canvas');\n                            canvas.attr('width',(sc.ancho-20||400));\n                            canvas.attr('height',(sc.alto-20||250));\n                            xchart = new Chart(canvas, { // eslint-disable-line no-undef\n                                type: sc.tipo || 'line',\n                                data: sc.datos,\n                                options: sc.opciones || options_default[sc.tipo || 'line']\n                            });\n                        }\n                        /**\n                          Funcion que se debe activar cambiando solo datos o labels del objeto sc.datos\n                          vm.ch.datos.labels.shift();\n                          vm.ch.datos.labels.push(newRandom()+'-02-2017');\n                          vm.ch.datos.datasets[0].data.shift();\n                          vm.ch.datos.datasets[0].data.push(newRandom());\n                          o bien actuializar los arrays completos\n                          vm.chart.datos.labels = createLabels(anio,mes);\n                          vm.chart.datos.datasets[0].data = getDataRandom(vm.chart.datos.labels.length);\n                        */\n                        sc.$watch('actualizar', function () { if(angular.isDefined(sc.actualizar)) xchart.update(); })\n                        /**\n                          Funcion que reinicia el objeto xchart con los parametros ocnfigurados (mas que todo cuando se quiere cambiar de tipo)\n                        */\n                        sc.$watch('reiniciar', function () { if(angular.isDefined(sc.reiniciar)) iniciar(); });\n\n                    })\n                }\n            };\n        }]);\n\n})();\n\n'use strict';\n\nangular\n.module('app')\n.directive('ngMostrarThumb',['$window',function($window){\n  var helper={\n    support: !!($window.FileReader && $window.CanvasRenderingContext2D),\n    extension:function(pUrl){\n      return pUrl.slice(pUrl.lastIndexOf(\".\")+1);\n    }\n  }\n\n  return{\n    restrict:'A',\n    template:'<canvas/>',\n    link:function(scope,element,attributes){\n      var params=scope.$eval(attributes.ngMostrarThumb);\n      var canvas = element.find('canvas');\n      var imagenes=['jpg','png','jpeg','bmp','gif'];\n      // var documentos=['pdf'];\n      var extension=helper.extension(params.ruta);\n\n      if(imagenes.indexOf(extension)> -1){\n        // var reader = new FileReader();\n        var img = new Image();\n        img.src=params.ruta;\n        helper.extension(params.ruta);\n        img.onload=function(){\n          var width = params.width || this.width / this.height * params.height;\n          var height = params.height || this.height / this.width * params.width;\n          canvas.attr({width:width, height:height});\n          canvas[0].getContext('2d').drawImage(img,0,0,width,height);\n        }\n      }\n      // TODO: como se adjunta un pdf a canvas??, es necesario usar pdf.js??\n      // else if(documentos.indexOf(extension)> -1){\n      // }\n\n\n\n    }\n  };\n}]);\n\n'use strict';\n\nangular\n    .module('app')\n    .directive('ngThumb', ['$window', function($window) {\n        var helper = {\n            support: !!($window.FileReader && $window.CanvasRenderingContext2D),\n            isFile: function(item) {\n                return angular.isObject(item) && item instanceof $window.File;\n            },\n            isImage: function(file) {\n                var type =  '|' + file.type.slice(file.type.lastIndexOf('/') + 1) + '|';\n                return '|jpg|png|jpeg|bmp|gif|'.indexOf(type) !== -1;\n            }\n        };\n\n        return {\n            restrict: 'A',\n            template: '<canvas/>',\n            link: function(scope, element, attributes) {\n                if (!helper.support) return;\n\n                var params = scope.$eval(attributes.ngThumb);\n\n                if (!helper.isFile(params.file)) return;\n                if (!helper.isImage(params.file)) return;\n\n                var canvas = element.find('canvas');\n                var reader = new FileReader();\n\n                reader.onload = onLoadFile;\n                reader.readAsDataURL(params.file);\n\n                function onLoadFile(event) {\n                    var img = new Image();\n                    img.onload = onLoadImage;\n                    img.src = event.target.result;\n                }\n\n                function onLoadImage() {\n                    var width = params.width || this.width / this.height * params.height;\n                    var height = params.height || this.height / this.width * params.width;\n                    canvas.attr({ width: width, height: height });\n                    canvas[0].getContext('2d').drawImage(this, 0, 0, width, height);\n                }\n            }\n        };\n    }]);\n(function() {\n    'use strict'\n\n    angular\n    .module('app')\n    .component('cargadorArchivos', {\n        templateUrl : 'app/components/cargadorArchivos/cargadorArchivos.html',\n        controller : ['$scope', 'restUrl', 'DataService', 'Storage', 'FileUploader','Modal', CargadorArchivosController],\n        controllerAs: 'vm',\n        bindings: {\n            archivos: '=', // Lista de archivos subidos\n            permitidos: '=',\n            anchoMiniatura: '=',\n            altoMiniatura: '=',\n            soloImagenes: '=',\n            maxArchivosPermitidos: '=',\n            mostrar:'='\n        }\n    });\n\n    function CargadorArchivosController($scope, restUrl, DataService, Storage, FileUploader,Modal) {\n\n        var vm = this;\n        vm.uploader = new FileUploader({url: \"\"});\n        vm.restUrl=restUrl;\n        vm.fotosEliminar=[];\n\n        if(vm.archivos==null){\n            vm.archivos = vm.uploader.queue;\n        }else {\n            vm.uploader.queue = vm.archivos;\n        }\n        vm.formatos = vm.permitidos.replace(/(\\||,)/g, \" \").toUpperCase();\n        var uploader = vm.uploader;\n        uploader.filters.push({\n                name: 'fileFilter',\n                fn: function (item) {\n                    var type = '|' + item.type.slice(item.type.lastIndexOf('/') + 1) + '|';\n                    return vm.permitidos.indexOf(type) !== -1;\n                }\n            });\n\n        //funcion para unir el drop y select\n        vm.clickUp = function () {\n            angular.element('#input_seleccionar').trigger('click'); //angular way\n\n        };\n\n        vm.esImagen =  function(file) {\n                var type =  '|' + file.type.slice(file.type.lastIndexOf('/') + 1) + '|';\n                return '|jpg|png|jpeg|bmp|gif|'.indexOf(type) !== -1;\n        }\n\n        // Funcion que elimina un \"archivo\".\n        vm.eliminar = function(pArchivo){\n          // Despliega el modal de confirmacion para eliminar un elemento.\n          Modal.confirm('Se eliminará la foto, ¿Está seguro?.', function () {\n            var indice=vm.mostrar.indexOf(pArchivo);\n\n            // Si el elemento existe dentro del vector.\n            if (indice > -1) {\n              // Elimina el elemento, basado en su indice.\n              vm.mostrar.splice(indice, 1);\n              // Agrega el item eliminado a un vector.\n              vm.fotosEliminar.push(pArchivo);\n            }\n\n          });\n\n        }\n\n\n\n    } //Fin del controller\n\n\n  })();\n\n(function() {\n    'use strict'\n\n    angular\n    .module('app')\n    .factory('BreadcrumbFactory', BreadcrumbFactory)\n\n    function BreadcrumbFactory() {\n\n        var factory = {\n            parent: '',\n            current: '',\n            setParent: function (parent) {\n                this.parent = parent;\n            },\n            setCurrent: function (current) {\n                this.current = current;\n            },\n            getParent: function () {\n                return this.parent;\n            },\n            getCurrent: function () {\n                return this.current;\n            }\n        };\n\n        return factory;\n\n    }\n\n})();\n(function() {\n    'use strict';\n\n    angular\n    .module('app')\n    .component('breadcrumb', {\n        templateUrl : 'app/components/breadcrumb/breadcrumb.html',\n        controller : ['Storage', '$location', 'BreadcrumbFactory', 'Util', BreadcrumbController],\n        bindings: {\n            // parent: '=',\n            // current: '='\n        }\n    });\n\n    /** @ngInject */\n    function BreadcrumbController(Storage, $location, BreadcrumbFactory, Util) {\n        var vm = this;\n\n        vm.getParent = getParent;\n        vm.getCurrent = getCurrent;\n\n        activate();\n\n        function activate() {\n            if (Storage.exist('menu')) {\n                var page = Util.getMenuOption(Storage.getSession('menu'), $location.path().replace('/', ''));\n                BreadcrumbFactory.setParent(page[0]);\n                BreadcrumbFactory.setCurrent(page[1]);\n            }\n        }\n\n        function getParent() {\n            return BreadcrumbFactory.getParent();\n        }\n\n        function getCurrent() {\n            return BreadcrumbFactory.getCurrent();\n        }\n\n    }\n\n})();\n\n(function() {\n    'use strict'\n\n    angular\n    .module('app')\n    .factory('UtilFormly', UtilFormlyFactory);\n\n    /** @ngInject */\n    function UtilFormlyFactory() {\n\n        var factory = {\n            getConfigItem: getConfigItem,\n            parse: parse,\n            listToForm: listToForm,\n            filterDates: filterDates,\n            newTemplate: newTemplate,\n            dataToView: dataToView,\n            sizeObj: sizeObj,\n            recursiveShowError: recursiveShowError,\n            disableForm: disableForm,\n            clearModel: clearModel\n        };\n\n        load_templates();\n\n        return factory;\n\n        /**\n          Funcion que crea un nuevo template\n          @param {String} tipo Tipo de template que se quiere crear\n        */\n        function newTemplate(tipo) {\n            return parse(this.templates[tipo].template);\n        }\n\n        function sizeObj(o) {\n            return Object.keys(o).length;\n        }\n        function recursiveShowError(error) {\n            for (var k in error) {\n                for (var i = 0; i < error[k].length; i++) {\n                    if(angular.isDefined(error[k][i].$submitted)){\n                        error[k][i].$submitted = true;\n                        recursiveShowError(error[k][i].$error);\n                    }else {\n                        if(error[k][i].$setTouched)\n                            error[k][i].$setTouched(true);\n                    }\n                }\n            }\n        }\n\n        /**\n          Funcion que limpia los valores del modelo, para que no quede basura\n          @param {Array} data Array de objetos formly\n          @param {Objeto} model contiene los valores para todos los keys de cada template\n        */\n        function clearModel(data, model) {\n            var elem,\n                new_model = {},\n                keys = {};\n                for (var i = 0; i < data.length; i++) {\n                  if (data[i].type==\"layout\") {\n                      for (var j = 0; j < data[i].fieldGroup.length; j++) {\n                          elem = getConfigItem(data[i].fieldGroup[j]);\n                          clearElem(elem, keys, model, new_model);\n                      }\n                  }else {\n                      elem = getConfigItem(data[i]);\n                      clearElem(elem, keys, model, new_model)                    ;\n                  }\n                }\n            return new_model;\n        }\n\n        /**\n          Funcion que modifica la estructura de un elemento, ademas tranforma de cadena a Date del modelo de la plantilla\n          @param {Objecto} elem Template formly\n          @param {Objeto} keys Objeto que representa un arbol de tipos de formly, para ir incrementando sus keys\n          @param {Objeto} model contiene los valores para todos los keys de cada template\n          @param {Objeto} new_model contiene los valores para todos los keys de cada template limpiado\n        */\n        function clearElem(elem, keys, model, new_model) {\n          if (angular.isUndefined(keys[elem.type])) {\n              keys[elem.type] = 1;\n              elem.key = elem.type + \"-0\";\n          } else {\n              elem.key = elem.type +\"-\"+ keys[elem.type];\n              keys[elem.type]++;\n          }\n          if (angular.isDefined(model[elem.key])) new_model[elem.key] = angular.copy(model[elem.key]);\n        }\n\n        /**\n          Funcion que transforma los string de la lista_valores a datepicker\n          @param {Array} lista_templates Lista de objetos formato formly\n          @param {Array} lista_valores Lista de objetos que son valores de los templates\n        */\n        function filterDates(lista_templates, lista_valores) {\n            for (var j = 0; j < lista_templates.length; j++) {\n                //cuando en la lista de templates exista uno de tipo datepicker\n                //hay que cambiar de tipo String a Objeto Date\n                if (lista_templates[j].type == \"datepicker\") {\n                    var nombre = lista_templates[j].templateOptions.label;\n                    if(lista_valores.hasOwnProperty(nombre)){\n                        lista_valores[nombre] = new Date(lista_valores[nombre]);\n                    }\n                }\n            }\n        }\n        /**\n          Funcion que crea un array de templates formly tranformado\n          @param {Array} data Array de objetos formly\n          @param {Objeto} model contiene los valores para todos los keys de cada template\n        */\n        function dataToView(data, model) {\n            var elem;\n            var form = [];\n            var keys = {}; // variable para controlar que no existan keys iguales\n            for (var i = 0; i < data.length; i++) {\n                if (data[i].type==\"layout\") {\n                    var fg = parse(data[i]);\n                    var clase = \" flex-\"+parseInt(100/fg.elementAttributes['num-cols']);\n                    delete fg.type;\n                    delete fg.elementAttributes['num-cols'];\n                    fg.fieldGroup = [];\n                    for (var j = 0; j < data[i].fieldGroup.length; j++) {\n                        elem = getConfigItem(data[i].fieldGroup[j]);\n                        elem.className += clase;\n                        changeElement(elem, keys, model);\n                        fg.fieldGroup.push(elem);\n                    }\n                    form.push(fg);\n                }else {\n                    elem = getConfigItem(data[i]);\n                    changeElement(elem, keys, model);\n                    form.push(elem);\n                }\n            }\n\n            return form;\n        }\n        /**\n          Funcion deshabilita/habilita todos los campos de un formulario\n          @param {Array} data Array de objetos formly\n          @param {Boolean} val True/false\n        */\n        function disableForm(data, val) {\n            angular.forEach(data, function(field) {\n                if (angular.isDefined(field.fieldGroup)) {\n                    for (var i = 0; i < field.fieldGroup.length; i++) {\n                        if(field.fieldGroup[i].templateOptions)\n                            field.fieldGroup[i].templateOptions.disabled = val;\n                    }\n                }else {\n                    if(field.templateOptions)\n                        field.templateOptions.disabled = val;\n                }\n            });\n        }\n\n\n        /**\n          Funcion que modifica la estructura de un elemento, ademas tranforma de cadena a Date del modelo de la plantilla\n          @param {Template} elem template formly\n          @param {Objeto} keys Objeto que representa un arbol de tipos de formly, para ir incrementando sus keys\n          @param {Objeto} model contiene los valores para todos los keys de cada template\n        */\n        function changeElement(elem, keys, model) {\n            if(angular.isUndefined(keys[elem.type])){\n                keys[elem.type] = 1;\n                elem.key = elem.type + \"-0\";\n            } else {\n                elem.key = elem.type +\"-\"+ keys[elem.type];\n                keys[elem.type]++;\n            }\n            if(elem.type === \"radio\"){\n                elem.templateOptions.className = \"layout layout-wrap\";\n            }\n            if(elem.type === \"datepicker\" && angular.isDefined(model) && angular.isDefined(model[elem.key])){\n                model[elem.key] = new Date(model[elem.key]);\n            }\n            // if(elem.type === \"calendario\" && angular.isDefined(model) && angular.isDefined(model[elem.key])){\n            //     model[elem.key] = new Date(model[elem.key]);\n            // }\n            if(elem.type === \"textarea\"){\n                elem.templateOptions.grow = true;\n            }\n\n            if(elem.templateOptions){\n                var validation = {messages:{}};\n                if(elem.templateOptions.required){\n                    validation.messages.required = '\"Debe llenar este campo.\"';\n                }\n                if( elem.type===\"input\"){\n                    var idx = {\n                        '([a-zA-Zñáéíóú]+ ?)+': '\"El campo debe contener solo palabras separadas por un espacio.\"',\n                        '\\\\d+': '\"El campo debe contener solo números.\"',\n                        '([a-zA-Z0-9ñáéíóú]+ ?)+': '\"El campo debe contener palabras y números separadas por un espacio.\"',\n                        '^(([^<>()\\\\[\\\\]\\\\\\\\.,;:\\\\s@\"]+(\\\\.[^<>()\\\\[\\\\]\\\\\\\\.,;:\\\\s@\"]+)*)|(\".+\"))@((\\\\[[0-9]{1,3}\\\\.[0-9]{1,3}\\\\.[0-9]{1,3}\\\\.[0-9]{1,3}])|(([a-zA-Z\\\\-0-9]+\\\\.)+[a-zA-Z]{2,}))$': '\"El campo debe ser un email válido.\"',\n                        '^(0[0-9]|1[0-9]|2[0-3]):[0-5][0-9]$':'\"El campo debe ser una hora en formato hh:mm (ej. 08:47)\"'\n                    };\n                    if(elem.templateOptions.pattern) validation.messages.pattern = idx[elem.templateOptions.pattern];\n                    //le da el efecto de slider al mensaje de error\n                    validation.show = true;\n                    elem.validation = validation;\n                }\n            }\n        }\n        /**\n          Funcion que añade clases a la lista de templates para que se renderizen dividos por columnas\n          @param {Array} lista_templates Lista de objetos formato formly\n          @param {Objeto} config configuracion que tendra el formulario tiene columnas y deshabilitar\n          @return {Array} formulario Lista de objetos, que son la transformacion de la lista de templates\n        */\n        function listToForm(lista_templates, config) {\n\n            var nro_columnas = config.columnas || 1;\n\n            var clase='flex-gt-sm-' + parseInt(100/nro_columnas);\n            // console.log(lista_templates.length+\"/\"+nro_columnas+\"=\"+(parseInt( lista_templates.length / nro_columnas ) + 1 ));\n            var nro_filas = parseInt( lista_templates.length / nro_columnas ) + 1;\n\n            var formulario = [];\n            for (var i = 0; i < nro_filas; i++) {\n                formulario.push({\n                    \"elementAttributes\": {\n                        \"layout-gt-sm\": \"row\",\n                        \"layout\": \"column\",\n                        \"layout-align-gt-sm\": \"start end\"\n                    },\n                    \"fieldGroup\": []\n                });\n            }\n            i = 0;\n            var k = 0;\n            while ( i < lista_templates.length ) {\n                var j = 0;\n                while (i < lista_templates.length && j < nro_columnas ) {\n\n                    lista_templates[i].className = clase;\n\n                    // Hacemos que el key de cada elemento sea su label\n                    if(lista_templates[i].templateOptions.label === \"\" || lista_templates[i].templateOptions.label === null){\n                        lista_templates[i].key = lista_templates[i].templateOptions.placeholder;\n                    }\n                    else lista_templates[i].key = lista_templates[i].templateOptions.label;\n\n\n                    if(lista_templates[i].type === \"radio\"){\n                        lista_templates[i].templateOptions.className = \"layout layout-wrap\";\n                    }\n\n                    if(config.deshabilitar || false){\n                        lista_templates[i].templateOptions.disabled = true;\n                    }else {\n                        lista_templates[i].templateOptions.disabled = false;\n                    }\n                    if(config.todoMayuscula || false){\n                        if(lista_templates[i].type === \"input\"){\n                            var onkeyup = 'model[\"' + lista_templates[i].key + '\"] = model[\"' + lista_templates[i].key + '\"].toUpperCase()';\n                            lista_templates[i].templateOptions.onKeyup = onkeyup;\n                        }\n                    }\n\n                    if(config.validacion || false){\n                        if(lista_templates[i].type === \"input\" || lista_templates[i].type === \"datepicker\"){\n                            lista_templates[i].validation = {\n                                messages: {\n                                    required: '\"Debe llenar este campo.\"'\n                                    // required: '\"El campo \" + to.label + \" es requerido\"'\n                                }\n                            }\n                        }\n                    }\n\n                    formulario[k].fieldGroup.push(getConfigItem(lista_templates[i]));\n                    i++;\n                    j++;\n                }\n                k++;\n            }\n\n            return formulario;\n        }\n\n        /**\n        Funcion que obtiene el template limpio de un elemento\n        */\n        function getConfigItem(item){\n            if(item.type=='layout') return parse(item);            \n            var obj = {\n                type: item.type,\n                key: item.key,\n                className: parse(item.className),\n                templateOptions: parse(item.templateOptions),\n                validation: parse(item.validation),\n                expressionProperties: parse(item.expressionProperties),\n                controller: parse(item.controller)\n            }\n            return obj;\n        }\n        /**\n        Funcion que copia un objeto, pero perdiendo la referencia\n        */\n        function parse(data) {\n            return angular.fromJson(angular.toJson(data));\n        }\n\n        function load_templates() {\n            // console.log(this);\n            factory.templates = {\n                input: {\n                    template: {\n                        type: \"input\",\n                        key: \"inputText\",\n                        templateOptions: {\n                            type: \"text\",\n                            label: \"Campo de texto\",\n                            disabled: false\n                        }\n                    }\n                },\n                radio: {\n                    template: {\n                        type: \"radio\",\n                        key: \"inputRadio\",\n                        templateOptions: {\n                            label: \"Selección simple\",\n                            labelProp: \"value\",\n                            valueProp: \"id\",\n                            vertical:false,\n                            options: [\n                                {value: \"opción 1\", id: \"opcion 1\"},\n                                {value: \"opción 2\", id: \"opcion 2\"}\n                            ]\n                        }\n                    }\n                },\n                select: {\n                    template: {\n                        type: \"select\",\n                        key: \"inputSelect\",\n                        templateOptions: {\n                            label: \"Lista de selección\",\n                            multiple: false,\n                            labelProp: \"value\",\n                            valueProp: \"id\",\n                            showItem: true,\n                            options: [\n                                {value: \"opción 1\", id: \"opcion 1\"},\n                                {value: \"opción 2\", id: \"opcion 2\"}\n                            ]\n                        }\n                    }\n                },\n                select_multiple: {\n                    template: {\n                        type: \"select\",\n                        key: \"inputSelect\",\n                        templateOptions: {\n                            label: \"Lista de selección\",\n                            multiple: true,\n                            labelProp: \"value\",\n                            valueProp: \"id\",\n                            options: [\n                                { value: \"opción 1\", id: \"opcion 1\" },\n                                { value: \"opción 2\", id: \"opcion 2\" }\n                            ]\n                        }\n                    }\n                },\n                textarea: {\n                    template: {\n                        type: \"textarea\",\n                        key: \"inputTextArea\",\n                        // className: \"ap-text-left\",\n                        templateOptions: {\n                            label: \"Area de texto\",\n                            rows: 2,\n                            grow: false\n                        }\n                    }\n                },\n                checkbox: {\n                    template: {\n                        type: \"checkbox\",\n                        key: \"inputCheckBox\",\n                        templateOptions: {\n                            label: \"Casilla de verificación\",\n                            disabled: false\n                        }\n                    }\n                },\n                datepicker: {\n                    template: {\n                        type: \"datepicker\",\n                        key: \"inputDatePicker\",\n                        templateOptions: {\n                            label: \"Calendario\"\n                        }\n                    }\n                },\n                // calendario: {\n                //     template: {\n                //         type: \"calendario\",\n                //         key: \"calendario\",\n                //         templateOptions: {\n                //             label: 'Calendario',\n                //             minDate: '',\n                //             maxDate: ''\n                //         }\n                //     }\n                // },\n                slider: {\n                    template: {\n                        type: \"slider\",\n                        key: \"inputSlider\",\n                        templateOptions: {\n                            label: \"Deslizador\",\n                            min: 1,\n                            max: 5,\n                            step: 0.5,\n                            discrete: true\n                        }\n                    }\n                },\n                switch: {\n                    template: {\n                        type: \"switch\",\n                        key: \"inputSwitch\",\n                        templateOptions: {\n                            label: \"Interruptor\"\n                        }\n                    }\n                },\n                chips: {\n                    template: {\n                        type: \"chips\",\n                        key: \"inputChips\",\n                        templateOptions: {\n                            label: \"Palabras clave\",\n                            placeholder: \"+palabras\",\n                            secondaryPlaceholder: \"Añadir palabras\",\n                            deleteButtonLabel: \"Borrar\",\n                            deleteHint: \"Borrar palabra\"\n                            // onAdd: function() {\n                            //   console.log('new chip');\n                            // },\n                            // onRemove: function() {\n                            //   console.log('chip removed');\n                            // }\n                        }\n                    }\n                },\n                titulo: {\n                    template: {\n                        type: \"texto\",\n                        key: \"texto\",\n                        templateOptions: {\n                            label: \"Título\",\n                            tipo: \"h2\",\n                            className: \"ap-text-left\",\n                            mTop: true,\n                            mBot: true\n                        }\n                    }\n                },\n                subtitulo: {\n                    template: {\n                        type: \"texto\",\n                        key: \"texto\",\n                        templateOptions: {\n                            label: \"Subtítulo\",\n                            tipo: \"h3\",\n                            className: \"ap-text-left\",\n                            mTop: true,\n                            mBot: true\n                        }\n                    }\n                },\n                parrafo: {\n                    template: {\n                        type: \"texto\",\n                        key: \"parrafo\",\n                        templateOptions: {\n                            label: \"Texto del párrafo, texto del párrafo, texto del párrafo, texto del párrafo, texto del párrafo, texto del párrafo, texto del párrafo, texto del párrafo.\",\n                            tipo: \"p\",\n                            className: \"ap-text-justify\",\n                            mTop: true,\n                            mBot: true\n                        }\n                    }\n                },\n                lista: {\n                    template: {\n                        type: \"lista\",\n                        key: \"lista\",\n                        templateOptions: {\n                            label: \"Lista de elementos\",\n                            className: \"ap-text-left\",\n                            tipo: \"ol\",\n                            showItem: true,\n                            options: [\n                                \"Elemento 1\",\n                                \"Elemento 2\"\n                            ]\n                        }\n                    }\n                },\n                datosGenerales: {\n                    template: {\n                        type: \"datosGenerales\",\n                        key: \"datosGenerales\",\n                        templateOptions: {\n                            labelw: 10,\n                            labelRef: 'REF.:',\n                            showItem: true,\n                            show: {\n                                para: true,\n                                via: true,\n                                de: true,\n                                ref: true\n                            }\n                        }\n                    }\n                },\n                encabezado: {\n                  template: {\n                    type: \"encabezado\",\n                    key: \"encabezado\",\n                    templateOptions: {\n                      labelw: 10,\n                      labelRef: 'REF.:',\n                      show: {\n                        para: true,\n                        via: true,\n                        de: true,\n                        ref: true\n                      }\n                    }\n                  }\n                },\n                documentosRelacionados: {\n                    template: {\n                        type: \"documentosRelacionados\",\n                        key: \"documentosRelacionados\",\n                        templateOptions: {\n                          labelw: 10,\n                          label: \"Referencias:\"\n                        }\n                    }\n                },\n                listaContactos: {\n                    template: {\n                        type: \"listaContactos\",\n                        key: \"listaContactos\",\n                        templateOptions: {\n                            labelw: 20,\n                            label: 'Lista de contactos:'\n                        }\n                    }\n                },\n                documentosAnular: {\n                    template: {\n                        type: \"documentosAnular\",\n                        key: \"documentosAnular\",\n                        templateOptions: {\n                          labelw: 10,\n                          label: \"Referencias:\"\n                        }\n                    }\n                },\n                ccArchivo: {\n                    template: {\n                        type: \"ccArchivo\",\n                        key: \"ccArchivo\",\n                        templateOptions: {\n                            labelw: 10,\n                            label: \"CC/Archivo:\"\n                        }\n                    }\n                },\n                archivo: {\n                    template: {\n                        type: \"archivo\",\n                        key: \"archivo\",\n                        templateOptions: {\n                            label: \"Elegir PDF\"\n                        }\n                    }\n                },\n                cite: {\n                    template: {\n                        type: \"cite\",\n                        templateOptions: {\n                            labelCite: 'CITE',\n                            labelFecha: 'FECHA',\n                            tipo: 'general',\n                            numeracionPagina:'false',\n                            tipoHoja:'Letter'\n                        }\n                    }\n                },\n                inputt: {\n                    template: {\n                        type: \"inputt\",\n                        templateOptions: {\n                            labelw: 20,\n                            labelx: 'Asunto:'\n                        }\n                    }\n                },\n                editorTexto: {\n                    template: {\n                        type: \"editorTexto\",\n                        templateOptions: {\n                            label: 'jojojo'\n                        }\n                    }\n                },\n                layout: {\n                    template: {\n                        \"type\": \"layout\",\n                        \"elementAttributes\": {\n                            \"num-cols\": \"2\",\n                            \"layout-align\": \"start end\",\n                            \"layout\": \"row\"\n                        },\n                        \"fieldGroup\": []\n                    }\n                },\n                vacio: {\n                    template: {\n                        type: \"vacio\",\n                        templateOptions: {\n                            height: 1,\n                            style: {}\n                        }\n                    }\n                },\n                cajachica: {\n                    template: {\n                        type: \"cajachica\",\n                        templateOptions: {\n                            tipo: 'GESTION'\n                        }\n                    }\n                },\n                certificacionComprometido: {\n                  template: {\n                    type: \"certificacionComprometido\",\n                    templateOptions: {\n                      label: 'Certificación de presupuesto comprometido'\n                    }\n                  }\n                }\n            };\n        }\n\n    }\n})();\n\n(function() {\n    'use strict'\n\n    angular\n    .module('app')\n    .factory('Util', ['$window', '$injector', UtilFactory]);\n\n    /** @ngInject */\n    function UtilFactory($window, $injector) {\n\n        var $document = $window.document;\n\n        var tmpl_print ='<!DOCTYPE html>' +\n                        '<html lang=\"en\">' +\n                        '<head>' +\n                            '<meta charset=\"UTF-8\"/>' +\n                            '<title>Document</title>' +\n                            '<style>{css}</style>' +\n                        '</head>' +\n                        '<body>{body}' +\n                        '</body>' +\n                        '</html>';\n\n        var factory = {\n            toType: toType,\n            isJson: isJson,\n            getParams: getParams,\n            print: print,\n            fullscreen: fullscreen,\n            nano: nano,\n            popup: popup,\n            filterFields: filterFields,\n            addPropertiesFormly: addPropertiesFormly,\n            size: size,\n            getFkData: getFkData,\n            serialize: serialize,\n            serializeToJson: serializeToJson,\n            getMenuOption: getMenuOption,\n            searchField: searchField,\n            lengthOptions: lengthOptions,\n            formatDate: formatDate,\n            filterItem: filterItem,\n            getKeys: getKeys,\n            getId: getId,\n            parseSave: parseSave,\n            truncate: truncate,\n            loadCanvas: loadCanvas,\n            stripHTML: stripHTML\n        };\n\n        return factory;\n\n        function nano (template, data) {\n            return template.replace(/\\{([\\w\\.]*)\\}/g, function (str, key) {\n                var keys = key.split(\".\"), v = data[keys.shift()];\n                for (var i = 0, l = keys.length;i < l;i++)\n                    v = v[keys[i]];\n                return (typeof v !== \"undefined\" && v !== null) ? v : \"\";\n            });\n        }\n\n        function toType (obj) {\n            return ({}).toString.call(obj).match(/\\s([a-zA-Z]+)/)[1].toLowerCase();\n        }\n\n        function isJson (text) {\n            return /^[\\],:{}\\s]*$/.test(text.replace(/\\\\[\"\\\\\\/bfnrtu]/g, '@').\n                replace(/\"[^\"\\\\\\n\\r]*\"|true|false|null|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?/g, ']').\n                replace(/(?:^|:|,)(?:\\s*\\[)+/g, ''));\n        }\n\n        function truncate (text, length) {\n            return text.length > length ? (text.substring(0, Math.min(length, text.length)) + '...') : text;\n        }\n\n        function stripHTML(texto) {\n            return texto.replace(/(<([^>]+)>)/ig,\"\");\n        }\n\n        function getParams (p, args) {\n            var first = p.first.defaultValue,\n            second = p.second.defaultValue;\n\n            p.first.position = p.first.position || 0;\n            p.second.position = p.second.position || 1;\n\n            var type = toType(args[p.first.position]);\n            if (type != 'undefined') {\n                if (type == p.first.type) {\n                    first = args[p.first.position];\n                    second = toType(args[p.second.position]) == p.second.type ? args[p.second.position] : p.second.defaultValue;\n                } else {\n                    if (type == p.second.type) {\n                        first = toType(args[p.second.position]) == p.first.type ? args[p.second.position] : p.first.defaultValue;\n                        second = args[p.first.position];\n                    }\n                }\n            }\n            return {\n                first : first,\n                second : second\n            };\n        }\n\n        function print (html, css) {\n            if (typeof css == 'string') {\n                angular.element.get(css, function (response) {\n                    var popup = $window.open('', 'print');\n                    popup.document.write(nano(tmpl_print, {body : html, css : response}));\n                    popup.document.close();\n                    popup.focus();\n                    popup.print();\n                    popup.close();\n                });\n            } else {\n                var popup = $window.open('', 'print');\n                popup.document.write(nano(tmpl_print, {body : html, css : css}));\n                popup.document.close();\n                popup.focus();\n                popup.print();\n                popup.close();\n            }\n\n            return true;\n        }\n\n        function popup(url) {\n            $window.open(url, 'print');\n        }\n\n        function fullscreen () {\n            if (!$document.fullscreenElement &&    // alternative standard method\n                !$document.mozFullScreenElement && !$document.webkitFullscreenElement && !$document.msFullscreenElement ) {  // current working methods\n                if ($document.documentElement.requestFullscreen) {\n                    $document.documentElement.requestFullscreen();\n                } else if ($document.documentElement.msRequestFullscreen) {\n                    $document.documentElement.msRequestFullscreen();\n                } else if ($document.documentElement.mozRequestFullScreen) {\n                    $document.documentElement.mozRequestFullScreen();\n                } else if ($document.documentElement.webkitRequestFullscreen) {\n                    $document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);\n                }\n            } else {\n                if ($document.exitFullscreen) {\n                    $document.exitFullscreen();\n                } else if ($document.msExitFullscreen) {\n                    $document.msExitFullscreen();\n                } else if ($document.mozCancelFullScreen) {\n                    $document.mozCancelFullScreen();\n                } else if ($document.webkitExitFullscreen) {\n                    $document.webkitExitFullscreen();\n                }\n            }\n        }\n\n        function filterFields(data, fields) {\n            if (typeof fields == 'undefined' || fields.length == 0) {\n                return data;\n            }\n            var filter = [];\n            for (var i in fields) {\n                var field = searchField(data, fields[i]);\n                if (field) {\n                    filter.push(field);\n                }\n            }\n            return filter;\n        }\n\n        function searchField(fields, field) {\n            for (var i in fields) {\n                if (fields[i].key == field) {\n                    return fields[i];\n                }\n            }\n            return null;\n        }\n\n        function addPropertiesFormly(data, formly) {\n            if (typeof formly == 'undefined' || formly.length == 0) {\n                return data;\n            }\n            for (var i in data) {\n                var field = searchField(formly, data[i].key);\n                if (field) {\n                    //data[i] = angular.element.extend(true, data[i], field);\n                    data[i] = angular.element.extend(true, {}, data[i], field);\n                }\n            }\n            return data;\n        }\n\n        function size(obj) {\n            return Object.keys(obj).length;\n        }\n\n        function parseSave(data, formly) {\n            var Datetime = $injector.get('Datetime');\n            var item = {};\n            for (var i in data) {\n                if (toType(data[i]) == 'date') {\n                    item[i] = Datetime.format(data[i], 'YYYY-MM-dd');\n                } else {\n                    if (typeof data[i] == 'string' && (data[i] == 'true' || data[i] == 'false')) {\n                        item[i] = item[i] == 'true';\n                    } else {\n                        item[i] = data[i];\n                    }\n                }\n            }\n            item.id = getId(item, formly);\n            return item;\n        }\n\n        function getId(item, formly, key) {            \n            if (item) {\n                for (var i in formly) {\n                    if (formly[i].templateOptions.label && formly[i].templateOptions.label == 'ID') {\n                        if (key) {\n                            return formly[i].key;\n                        } else {\n                            return item[formly[i].key];\n                        }\n                    }\n                }\n            }\n            return null;\n        }\n\n        function getFkData(fieldsData, key, value) {\n            fieldsData.filter(function (e) {\n                if (e.key == key && e.templateOptions.options) {\n                    e.templateOptions.options.filter(function(elem) {\n                        if (elem.value == value) {\n                            value = elem.name;\n                        }\n                    })\n                }\n            });\n            return value;\n        }\n\n        // TODO: Comentado en la limpieza de errores de consola.\n        // function parseDate(date) {\n        //     return [date.getFullYear(),date.getMonth()+1,date.getDate()].join('-');\n        // }\n\n        function serialize(json) {\n            var string = [];\n            for (var i in json) {\n                string.push(i + '=' + json[i]);\n            }\n            return string.join('&');\n        }\n\n        function serializeToJson(json, limpiar) {\n            var string = [];\n            for (var i in json) {\n                if(limpiar){\n                    for (var j in json[i]) {\n                        if ( json[i][j]==null || json[i][j]==undefined || json[i][j]=='' ) {\n                            delete json[i][j];\n                        }\n                    }\n                }\n                if(Object.keys(json[i]).length > 0)\n                    string.push(i + '=' + angular.toJson(json[i]));\n            }\n            return string.join('&');\n        }\n\n        function getMenuOption(menu, url) {\n            for (var i in menu) {\n                if (typeof menu[i].submenu != 'undefined') {\n                    var pages = menu[i].submenu;\n                    for (var j in pages) {\n                        if (pages[j].url == url) {\n                            return [menu[i].label, pages[j].label];\n                        }\n                    }\n                }\n            }\n            for (var k in menu) {\n                if (menu[k].url == url) {\n                    return [menu[k].label, false];\n                }\n            }\n            return [false,false];\n        }\n\n        function lengthOptions(data, key) {\n            for (var i in data) {\n                if (data[i].key == key && data[i].templateOptions && data[i].templateOptions.options) {\n                    return data[i].templateOptions.options.length;\n                }\n            }\n            return 0;\n        }\n\n        function formatDate(date) {\n            date = date.split('-')\n            return [date[2], date[1], date[0]].join('/');\n        }\n\n        function filterItem(data) {\n            var Datetime = $injector.get('Datetime');            \n            for (var i in data) {\n                if (typeof data[i] == 'string') {\n                    if (Datetime.isDate(data[i])) {\n                      if (!(/^[0-9]\\s*$/).test(data[i]))\n                        data[i] = new Date();\n                    } else if (!/[a-zA-Z]+/g.test(data[i]) && /^(?:(?:([01]?\\d|2[0-3]):)?([0-5]?\\d):)?([0-5]?\\d)$/g.test(data[i]) && data[i].length == 8) {                        \n                        data[i] = formatTime(data[i]);\n                    }\n                }\n            }\n            return data;\n        }\n\n        function formatTime(time) {\n            time = time.split(':')\n            return [time[0], time[1]].join(':')\n        }\n\n        function getKeys(data) {\n            var types = {};\n\n            data.map(function(el) {\n                types[el.key] = el;\n            });\n\n            return types;\n        }\n        /**\n         * Funcion para cargar pdf a un canvas\n         * @param {texto o array} url data del pdf a renderizar\n         * @param {texto} idCanvasContainer selectorID del div padre\n         */\n\n         /* eslint-disable */\n        function loadCanvas(url, idCanvasContainer) {\n            PDFJS.workerSrc = $injector.get('backUrl') + 'flibs/pdfjs/pdf.worker.js';\n            var scale= 1.5;  //\"zoom\" factor for the PDF\n            function renderPage(page) {\n                var viewport = page.getViewport(scale);\n                var canvas = document.createElement('canvas');\n                var ctx = canvas.getContext('2d');\n                var renderContext = {\n                    canvasContext: ctx,\n                    viewport: viewport\n                };\n                canvas.height = viewport.height;\n                canvas.width = viewport.width;\n                canvas.style = \"width:100%; height:100%;\";\n\n                document.querySelector(idCanvasContainer).appendChild(canvas);\n                page.render(renderContext);\n            }\n\n            function renderPages(pdfDoc) {\n                for(var num = 1; num <= pdfDoc.numPages; num++)\n                    pdfDoc.getPage(num).then(renderPage);\n            }\n            PDFJS.disableWorker = true;\n            PDFJS.getDocument(url).then(renderPages);\n        }\n        /* eslint-enable */\n    }\n  })();\n\n(function() {\n    'use strict'\n\n    angular\n    .module('app')\n    .factory('Storage', ['$window', 'appName', StorageFactory]);\n\n    /** @ngInject */\n    function StorageFactory($window, appName) {\n\n        appName = appName || 'app';\n\n        var $local = $window.localStorage;\n        var $session = $window.sessionStorage;\n\n        var factory = {\n            get: get,\n            set: set,\n            remove: remove,\n            destroy: destroy,\n            exist: exist,\n            getSession: getSession,\n            setSession: setSession,\n            removeSession: removeSession,\n            destroySession: destroySession,\n            existSession: existSession,\n            setUser: setUser,\n            getUser: getUser,\n            existUser: existUser,\n            removeUser: removeUser,\n            getToken: getToken\n        };\n\n        return factory;\n\n        function setUser(user) {\n            setSession('user', user);\n        }\n\n        function getUser() {\n            return getSession('user');\n        }\n\n        function existUser() {\n            return existSession('user');\n        }\n\n        function removeUser() {\n            removeSession('user');\n        }\n\n        function getToken() {\n            return $local.getItem(appName + '_' + 'token');\n        }\n\n        // LocalStorage\n        function set(key, value) {\n            $local.setItem(appName + '_' + key, angular.toJson(value));\n        }\n\n        function get(key) {\n            return angular.fromJson($local.getItem(appName + '_' + key));\n        }\n\n        function remove(key) {\n            $local.removeItem(appName + '_' + key);\n        }\n\n        function destroy() {\n            for(var x in $local)\n                $local.removeItem(x);\n        }\n\n        function exist(key) {\n            return typeof $local.getItem(appName + '_' + key) != 'undefined' && $local.getItem(appName + '_' + key) != null && $local.getItem(appName + '_' + key) != 'undefined';\n        }\n\n        // SessionStorage\n        function setSession(key, value) {\n            $session.setItem(appName + '_' + key, angular.toJson(value));\n        }\n\n        function getSession(key) {\n            return angular.fromJson($session.getItem(appName + '_' + key));\n        }\n\n        function removeSession(key) {\n            $session.removeItem(appName + '_' + key);\n        }\n        function destroySession() {\n            for(var x in $session)\n                $session.removeItem(x);\n        }\n\n        function existSession(key) {\n            return typeof $session.getItem(appName + '_' + key) != 'undefined' && $session.getItem(appName + '_' + key) != null && $session.getItem(appName + '_' + key) != 'undefined';\n        }\n    }\n})();\n\n(function() {\n    'use strict'\n\n    angular\n    .module('app')\n    .factory('RouteValidator', ['$rootScope', 'Storage', 'Message', 'ExpirationTime', RouteValidatorFactory]);\n\n    /** @ngInject */\n    function RouteValidatorFactory($rootScope, Storage, Message, ExpirationTime) {\n\n        var factory = {\n            init: init\n        };\n\n        return factory;\n\n        function init(){\n            $rootScope.$on('$stateChangeStart', onStateChangeStart); // eslint-disable-line angular/on-watch\n        }\n\n        /**\n            Funcion que se activa cada vez que se quiere cambiar de localizacion de vista\n            @param {Objeto} ev Evento cambiar de localizacion\n            @param {Objeto} toState Objeto con datos de la url a la que se quiere ir\n            @param {Objeto} toParams Objeto con los parametros de la url a la que se quiere ir\n            @param {Objeto} fromState Objeto con datos de la url en la se encuentra actualmente\n        */\n        function onStateChangeStart(ev, toState, toParams, fromState){\n\n            if (fromState.url !== \"^\" && toState.url!==\"/login\" && toState.url!==\"/verificar\") {\n                // console.log(\"origen->\"+fromState.url);\n                // console.log(\"destino->\" +toState.url);\n\n                var user = Storage.getUser();\n                var existeUsuario = (user !== null)? true : false;\n                // console.log(user);\n\n                var menus = Storage.getSession('menu');\n                var rutaPermitida = true;\n\n                if(fromState.url===\"/login\" && toState.url!==\"/login\" && !existeUsuario){\n                    Message.error('Usted no esta autorizado para acceder a la vista.');\n                    ev.preventDefault();\n                    return;\n                }else {\n                    rutaPermitida = (toState.url === \"/\")? true : false;\n                    if(toState.url===\"/profile\") rutaPermitida = true;\n                    if(toState.url===\"/vista_pdf\") rutaPermitida = true;\n                    if(toState.url===\"/elegir\") rutaPermitida = true;\n                    // rutaPermitida = true;\n                    if(existeUsuario && !rutaPermitida){\n                        for (var i = 0; i < menus.length; i++) {\n                            for (var j = 0; j < menus[i].submenu.length; j++) {\n                                // console.log(\"submenu \"+\"/\"+menus[i].submenu[j]);\n                                if(tienePermiso(menus[i].submenu[j].url, toState.url)){\n                                    rutaPermitida = true;\n                                }\n                            }\n                        }\n                    }\n\n                    if(toState.url!=='/documento/:idDocumento') ExpirationTime.stopAutoSave();\n                    // console.log(existeUsuario +\"   \"+ rutaPermitida);\n                    if(!existeUsuario || !rutaPermitida){\n                        Message.error('Usted no esta autorizado para acceder a la vista.');\n                        ev.preventDefault();\n                        return;\n                    }\n                }\n            }\n        }\n\n        function tienePermiso(ruta, ruta_destino) {\n            // console.log(\"sm-> \" + ruta);\n            var submenu_rutas = {\n                \"plantillas\": {\n                    \"/plantillas\": true,\n                    \"/plantilla/:idPlantilla\": true\n                },\n                \"usuario\": {\n                    \"/usuario\": true,\n                    \"/elegir\": true\n                },\n                \"rol\": {\n                    \"/rol\": true\n                },\n                \"menu\": {\n                    \"/menu\": true\n                },\n                \"documentos\": {\n                    \"/documentos\": true,\n                    \"/documento/:idDocumento\": true\n                },\n                \"aprobacion\": {\n                    \"/aprobacion\": true\n                },\n                \"progreso\": {\n                    \"/progreso\": true\n                },\n                \"impresion\": {\n                    \"/impresion\": true\n                },\n                \"en_curso\": {\n                    \"/en_curso\": true\n                },\n                \"firmar\": {\n                    \"/firmar\": true\n                },\n                \"monitoreo\": {\n                    \"/monitoreo\": true\n                },\n                \"contactos\": {\n                  \"/contactos\": true\n                }\n            }\n            if(angular.isDefined(submenu_rutas[ruta])){\n                if(angular.isDefined(submenu_rutas[ruta][ruta_destino]))\n                    return submenu_rutas[ruta][ruta_destino];\n            }\n            return false;\n        }\n\n    }\n})();\n\n(function() {\n    'use strict';\n\n    angular\n    .module('app')\n    .factory('Panel', ['$mdPanel', '$document',PanelFactory]);\n\n    /** @ngInject */\n    function PanelFactory($mdPanel, $document) {\n\n        var factory = {\n            show : show\n        };\n\n        return factory;\n\n        function show(config) {\n            // console.log(config);\n\n            var position = null;\n            // delete config.event;\n            if(config.event){\n                position = $mdPanel.newPanelPosition()\n                .relativeTo(config.event.currentTarget)\n                .addPanelPosition($mdPanel.xPosition.ALIGN_END, $mdPanel.yPosition.BELOW);\n            }else {\n                position = $mdPanel.newPanelPosition().absolute().center();\n            }\n            // console.log(position);\n\n            var default_template = 'app/factories/Panel/defaultPanelTemplate.html';\n\n            var settings = {\n                    attachTo: angular.element($document[0].body),\n                    controller: config.controller || ['$scope', '$log', PanelController],\n                    templateUrl: config.templateUrl || default_template,\n                    panelClass: 'md-panel',\n                    position: position,\n                    locals: {\n                        data: config.data || ''\n                    },\n                    openFrom: config.event,\n                    clickOutsideToClose: angular.isUndefined(config.clickOutsideToClose) ? true : config.clickOutsideToClose,\n                    escapeToClose: angular.isUndefined(config.clickOutsideToClose) ? true : config.clickOutsideToClose,\n                    focusOnOpen: true\n                    // zIndex: 2\n                };\n\n            if (config.event) {\n                settings.targetEvent = config.event;\n            }\n\n            $mdPanel.open(settings);\n\n            // var settings = {\n            //     controller: config.controller || ['$scope', '$mdDialog', 'data', 'fields', 'title', 'add', 'column', 'done', DialogController],\n            //     templateUrl: config.templateUrl || '',\n            //     parent: angular.element('body'),\n            //     clickOutsideToClose:typeof config.clickOutsideToClose == 'undefined' ? true : config.clickOutsideToClose,\n            //     escapeToClose:typeof config.escapeToClose == 'undefined' ? true : config.escapeToClose,\n            //     locals: {\n            //         data: config.data || '',\n            //         fields: config.fields || '',\n            //         title: config.title || '',\n            //         add: config.add || '',\n            //         column: config.column || 1,\n            //         done: config.done || function () {}\n            //     }\n            // };\n            // if (config.event) {\n            //     settings.targetEvent = config.event;\n            // }\n            // $mdDialog.show(settings)\n            // .then(function () {}, function() {\n            //     if (config.close) {\n            //         config.close();\n            //     }\n            // });\n        }\n\n        function PanelController($scope, $log) {\n            $log.info(\"hola desde controller default, introduzca su controller\");\n        }\n\n        // BasicDemoCtrl.prototype.showMenu = function(ev) {\n        //     var position = this._mdPanel.newPanelPosition()\n        //     .relativeTo('.demo-menu-open-button')\n        //     .addPanelPosition(this._mdPanel.xPosition.ALIGN_START, this._mdPanel.yPosition.BELOW);\n        //\n        //     var config = {\n        //         attachTo: angular.element(document.body),\n        //         controller: PanelMenuCtrl,\n        //         controllerAs: 'ctrl',\n        //         template:\n        //         '<div class=\"demo-menu-example\" ' +\n        //         '     aria-label=\"Select your favorite dessert.\" ' +\n        //         '     role=\"listbox\">' +\n        //         '  <div class=\"demo-menu-item\" ' +\n        //         '       ng-class=\"{selected : dessert == ctrl.favoriteDessert}\" ' +\n        //         '       aria-selected=\"{{dessert == ctrl.favoriteDessert}}\" ' +\n        //         '       tabindex=\"-1\" ' +\n        //         '       role=\"option\" ' +\n        //         '       ng-repeat=\"dessert in ctrl.desserts\" ' +\n        //         '       ng-click=\"ctrl.selectDessert(dessert)\"' +\n        //         '       ng-keydown=\"ctrl.onKeydown($event, dessert)\">' +\n        //         '    {{ dessert }} ' +\n        //         '  </div>' +\n        //         '</div>',\n        //         panelClass: 'demo-menu-example',\n        //         position: position,\n        //         locals: {\n        //             'selected': el.selected,\n        //             'desserts': el.desserts\n        //         },\n        //         openFrom: ev,\n        //         clickOutsideToClose: true,\n        //         escapeToClose: true,\n        //         focusOnOpen: false,\n        //         zIndex: 2\n        //     };\n        // }\n    }\n})();\n\n(function() {\n    'use strict'\n\n    angular\n    .module('app')\n    .factory('MyFormlyConfig', FormlyConfigFactory);\n\n    /** @ngInject */\n    function FormlyConfigFactory() {\n\n        var factory = {\n            init: init\n        };\n\n        return factory;\n\n\n        /**\n          Funcion que inicia los elementos formly extras que se usaran en la aplicacion\n          @param {formlyConfig} ProveedorServicio Objeto el cual angular-formly provee para poder configurar nuevos elementos y wrappers\n        */\n        function init(formlyConfig){\n            // console.log(formlyConfig);\n            formlyConfig.setType({\n                name: 'texto',\n                templateUrl: 'app/components/formlyComponents/texto/texto.html'\n            });\n            formlyConfig.setType({\n              name: 'lista',\n              templateUrl: 'app/components/formlyComponents/listas/listas.html'\n            });\n            formlyConfig.setType({\n                name: 'vacio',\n                templateUrl: 'app/components/formlyComponents/vacio/vacio.html',\n                controller: 'fcVacioController'\n            });\n            formlyConfig.setType({\n                name: 'cite',\n                templateUrl: 'app/components/formlyComponents/cite/cite.html',\n                controller: 'fcCiteController'\n            });\n            formlyConfig.setType({\n                name: 'inputt',\n                templateUrl: 'app/components/formlyComponents/inputt/inputt.html'\n            });\n            formlyConfig.setType({\n                name: 'editorTexto',\n                templateUrl: 'app/components/formlyComponents/editorTexto/editorTexto.html'\n            });\n            formlyConfig.setType({\n              name: 'datosGenerales',\n              templateUrl: 'app/components/formlyComponents/datosGenerales/datosGenerales.html',\n              controller: 'fcDatosGeneralesController'\n            });\n            formlyConfig.setType({\n              name: 'encabezado',\n              templateUrl: 'app/components/formlyComponents/encabezado/encabezado.html',\n              controller: 'fcEncabezadoController'\n            });\n            formlyConfig.setType({\n              name: 'documentosRelacionados',\n              templateUrl: 'app/components/formlyComponents/documentosRelacionados/documentosRelacionados.html',\n              controller: 'fcDocumentosRelacionadosController'\n            });\n            formlyConfig.setType({\n              name: 'documentosAnular',\n              templateUrl: 'app/components/formlyComponents/documentosAnular/documentosAnular.html',\n              controller: 'fcDocumentosAnularController'\n            });\n            formlyConfig.setType({\n              name: 'ccArchivo',\n              templateUrl: 'app/components/formlyComponents/ccArchivo/ccArchivo.html',\n              controller: 'fcConCopiaArchivoController'\n            });\n            formlyConfig.setType({\n              name: 'archivo',\n              templateUrl: 'app/components/formlyComponents/archivo/archivo.html',\n              controller: 'fcArchivoController'\n            });\n            formlyConfig.setType({\n              name: 'cajachica',\n              templateUrl: 'app/components/formlyComponents/cajachica/cajachica.html',\n              controller: 'fcCajaChicaController'\n            });\n            formlyConfig.setType({\n              name: 'certificacionComprometido',\n              templateUrl: 'app/components/formlyComponents/certificacionComprometido/certificacionComprometido.html'\n            });\n            formlyConfig.setType({\n              name: 'listaContactos',\n              templateUrl: 'app/components/formlyComponents/listaContactos/listaContactos.html',\n              controller: 'fcListaContactosController'\n            });\n            // formlyConfig.setType({\n            //   name: 'calendario',\n            //   templateUrl: 'app/components/formlyComponents/calendario/calendario.html',\n            //   controller: 'fcCalendarioController'\n            // });\n        }\n\n    }\n})();\n\n(function() {\n    'use strict';\n\n    angular\n    .module('app')\n    .factory('Modal', ['$mdDialog', ModalFactory]);\n\n    /** @ngInject */\n    function ModalFactory($mdDialog) {\n\n        var factory = {\n            show : show,\n            alert : alert,\n            confirm : confirm\n        };\n\n        return factory;\n\n        function show(config) {\n            var settings = {\n                controller: config.dialogController || config.controller || ['$scope', '$mdDialog', 'data', 'fields', 'title', 'add', 'column', 'done', DialogController],\n                templateUrl: config.templateUrl || '',\n                parent: angular.element('body'),\n                clickOutsideToClose:typeof config.clickOutsideToClose == 'undefined' ? true : config.clickOutsideToClose,\n                escapeToClose:typeof config.escapeToClose == 'undefined' ? true : config.escapeToClose,\n                locals: {\n                    data: config.data || '',\n                    fields: config.fields || '',\n                    title: config.title || '',\n                    add: config.add || '',\n                    column: config.column || 1,\n                    done: config.done || function () {}\n                }\n            };\n            if (config.event) {\n                settings.targetEvent = config.event;\n            }\n            $mdDialog.show(settings)\n            .then(function () {}, function() {\n                if (config.close) {\n                    config.close();\n                }\n            });\n        }\n\n        function DialogController($scope, $mdDialog, data, fields, title, add, column, done) {\n            var vm = $scope;\n\n            vm.data = data;\n            vm.fields = fields;\n            vm.title = title;\n            vm.add = add;\n            vm.column = column;\n            vm.hide = $mdDialog.hide;\n            vm.cancel = $mdDialog.cancel;\n\n            vm.answer = function(answer) {\n                done(answer, $mdDialog);\n            }\n        }\n\n        function alert(text, event) {\n            var $alert = $mdDialog.alert()\n                .clickOutsideToClose(true)\n                .title('Alerta')\n                .htmlContent(text)\n                .ariaLabel('Alerta')\n                .ok('Aceptar');\n\n            if (event) {\n                $alert.targetEvent(event);\n            }\n            $mdDialog.show($alert);\n        }\n\n        function confirm(text, done, cancel, event) {\n            var $confirm = $mdDialog.confirm()\n                .title('Confirmar')\n                .textContent(text)\n                .ariaLabel('Confirmar')\n                .ok('Aceptar')\n                .cancel('Cancelar');\n\n            if (event) {\n                $confirm.targetEvent(event);\n            }\n\n            $mdDialog.show($confirm)\n            .then(function() {\n                if (done) {\n                    done();\n                }\n            }, function() {\n                if (cancel) {\n                    cancel();\n                }\n            });\n        }\n\n    }\n})();\n\n(function() {\n    'use strict'\n\n    angular\n    .module('app')\n    .factory('Message', ['$mdToast', MessageFactory]);\n\n    /** @ngInject */\n    function MessageFactory($mdToast) {\n\n        var factory = {\n            success : success,\n            warning : warning,\n            error : error,\n            show: show\n        };\n\n        return factory;\n\n        function show(type, msg, title, timeout) {\n            var typeIcon = {\n              'EXITO': 'check',\n              'ERROR': 'error',\n              'ADVERTENCIA': 'warning',\n              'INFORMACION': 'info'\n            }\n\n            var messageDefault = {\n              'EXITO': 'La operación se realizó correctamente.',\n              'ERROR': 'Ocurrió un error al procesar su operación.',\n              'ADVERTENCIA': 'Ocurrió algo inesperado al procesar su operación.',\n              'INFORMACION': 'La operacion se realizó correctamente, pero hay alguna infromación que no se muestra'\n            }\n\n            var titleDefault = {\n              'EXITO': 'Correcto',\n              'ERROR': 'Error',\n              'ADVERTENCIA': 'Advertencia',\n              'INFORMACION': 'Información'\n            }\n\n            var typeClass = {\n              'EXITO': 'success',\n              'ERROR': 'danger',\n              'ADVERTENCIA': 'warning',\n              'INFORMACION': 'info'\n            }\n\n            var data = {\n                icon : typeIcon[type],\n                message : msg || messageDefault[type],\n                title : title || titleDefault[type],\n                type : typeClass[type],\n                timeout: timeout\n            };\n\n            render(data);\n        }\n\n\n        function success(msg, title, timeout) {\n            var data = {\n                icon : 'check',\n                message : msg || 'La operación se realizó correctamente.',\n                title : title || 'Correcto',\n                type : 'success',\n                timeout: timeout\n            };\n\n            render(data);\n        }\n\n        function error(msg, title, timeout) {\n            var data = {\n                icon : 'error',\n                message : msg || 'Ocurrió un error al procesar su operación.',\n                title : title || 'Error',\n                type : 'danger',\n                timeout: timeout\n            };\n\n            render(data);\n        }\n\n        function warning(msg, title, timeout) {\n            var data = {\n                icon : 'warning',\n                message : msg || 'Ocurrió algo inesperado al procesar su operación.',\n                title : title || 'Advertencia',\n                type : 'warning',\n                timeout: timeout\n            };\n\n            render(data);\n        }\n\n        function render(data) {\n            $mdToast.show({\n                controller: ToastController,\n                templateUrl: 'app/factories/Messages/layout.toast.html',\n                parent : angular.element('#toast-container-main'),\n                hideDelay: typeof data.timeout != 'undefined' ? (data.timeout == 0 ? 31536000000 : data.timeout) : 5000,\n                position: 'top right',\n                locals: data\n            });\n        }\n\n        function ToastController($scope, $mdToast, icon, message, title, type) {\n            var vm = $scope;\n\n            vm.icon = icon;\n            vm.message = message;\n            vm.title = title;\n            vm.type = type;\n\n            vm.close = function() {\n                $mdToast.hide()\n            };\n        }\n    }\n})();\n\n(function() {\n    'use strict';\n\n    angular\n    .module('app')\n    .factory('Loading', ['$mdDialog', LoadingFactory]);\n\n    /** @ngInject */\n    function LoadingFactory($mdDialog) {\n\n        var factory = {\n            show : show,\n            cerrar : cerrar,\n            cambiar: cambiar\n        };\n        var tiposDic = {\n            warning: 'loader-warning',\n            error: 'loader-error',\n            success: 'loader-success',\n            info: 'loader-info'\n        };\n        var dataLocal = {\n            mensaje: 'Cargando...',\n            tipo: tiposDic.warning\n        };\n\n        return factory;\n\n        function show(config) {\n            if(config.data) dataLocal= config.data;\n            var settings = {\n                controller: config.dialogController || config.controller || ['$scope', '$mdDialog', 'data', 'fields', 'title', 'add', 'column', DialogController],\n                templateUrl: config.templateUrl || 'app/factories/Loading/Loading.html' ||'',\n                parent: angular.element('body'),\n                // clickOutsideToClose:typeof config.clickOutsideToClose == 'undefined' ? true : config.clickOutsideToClose,\n                escapeToClose: false,\n                locals: {\n                    // data: config.data || dataLocal ||'',\n                    data:  dataLocal,\n                    fields: config.fields || '',\n                    title: config.title || '',\n                    add: config.add || '',\n                    column: config.column || 1\n                    // done: config.done || function () {}\n                }\n            };\n            if (config.event) {\n                settings.targetEvent = config.event;\n            }\n            $mdDialog.show(settings)\n            .then(function () {}, function() {\n                if (config.close) {\n                    // console.log('OHHHH NO!!!!');\n                    \n                    config.close();\n                }\n            });\n        }\n        function cerrar() {\n        //   console.log('Ejecutando el cerrar');\n          $mdDialog.hide();\n        }\n\n        function cambiar(datos) {\n            // console.log('Inciando el cambio');\n            if(datos.mensaje) dataLocal.mensaje = datos.mensaje;\n            if (datos.tipo) dataLocal.tipo = tiposDic[datos.tipo];\n        }\n\n        function DialogController($scope, $mdDialog, data, fields, title, add, column) {\n            var vm = $scope;\n            vm.data = data;\n            vm.fields = fields;\n            vm.title = title;\n            vm.add = add;\n            vm.column = column;\n            vm.hide = $mdDialog.hide;\n            \n\n            \n        }\n\n        \n    }\n})();\n\n(function() {\n    'use strict'\n\n    angular\n    .module('app')\n    .factory('HttpInterceptor', ['$q', 'Storage', 'restUrl', HttpInterceptorFactory]);\n\n    /** @ngInject */\n    function HttpInterceptorFactory($q, Storage, restUrl) {\n\n        var factory = {\n            request: request\n        };\n\n        return factory;\n\n        function request(req) {\n            if(req.url.indexOf(restUrl) !== -1){\n                var validacion = {\n                    flag: true,\n                    token: Storage.getToken()\n                };\n                req.headers[\"validacion\"] = base64Encode(angular.toJson(validacion));\n            }\n            return req;\n        }\n\n        // function responseError(response) {\n        //     return $q.reject(response);\n        // }\n\n        function base64Encode(text){\n\n            if (/([^\\u0000-\\u00ff])/.test(text)){\n                throw new Error(\"Can't base64 encode non-ASCII characters.\");\n            }\n\n            var digits = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\",\n                i = 0,\n                cur, prev, byteNum,\n                result=[];\n\n            while(i < text.length){\n\n                cur = text.charCodeAt(i);\n                byteNum = i % 3;\n\n                switch(byteNum){\n                    case 0: //first byte\n                        result.push(digits.charAt(cur >> 2));\n                        break;\n\n                    case 1: //second byte\n                        result.push(digits.charAt((prev & 3) << 4 | (cur >> 4)));\n                        break;\n\n                    case 2: //third byte\n                        result.push(digits.charAt((prev & 0x0f) << 2 | (cur >> 6)));\n                        result.push(digits.charAt(cur & 0x3f));\n                        break;\n                }\n\n                prev = cur;\n                i++;\n            }\n\n            if (byteNum == 0){\n                result.push(digits.charAt((prev & 3) << 4));\n                result.push(\"==\");\n            } else if (byteNum == 1){\n                result.push(digits.charAt((prev & 0x0f) << 2));\n                result.push(\"=\");\n            }\n\n            return result.join(\"\");\n        }\n\n    }\n})();\n\n(function() {\n'use strict'\n\nangular\n.module('app')\n.factory('Documento', DocumentoFactory);\n\n/** @ngInject */\nfunction DocumentoFactory(DataService, restUrl, backUrl, Datetime, UtilFormly, Modal, $window, $location, Storage, $log) {\n\n    var factory = {\n        showPdfId: showPdfId,\n        showPdf: showPdf,\n        showPdfx: showPdfx,\n        showProgress: showProgress,\n        showProgressAll: showProgressAll,\n        generarAbreviacion: generarAbreviacion,\n        isMobile: isMobile\n\n    };\n\n    return factory;\n\n    function generarAbreviacion(cadena) {\n        cadena = cadena.replace(/[^a-zA-Z ]/g, \"\");\n        var str = cadena.toUpperCase();\n        var res = str.split(\" \");\n        var abreviacion = \"\";\n        for (var i = 0; i < res.length; i++) {\n            if(res[i] !== \"DE\" && res[i] !== \"PARA\" && res[i] !== \"Y\" && res[i] !== \"LA\") {\n                if (angular.isDefined(res[i][0])) {\n                    abreviacion = abreviacion + res[i][0];\n                }\n            }\n        }\n        return abreviacion;\n    }\n\n\n    function showPdfx(nombre) {\n        var datosEnviar = { nombre:nombre, html:'<p>Este es un documento externo, no puede transformarse en texto.</p>' };\n        var new_url =  $location.absUrl();\n        datosEnviar.esDocumentoExterno = true;\n        new_url = new_url.substring(0, new_url.indexOf('#/')+2);\n        Storage.setSession('datos_enviar', datosEnviar);\n        $window.open(new_url+'vista_pdf');\n    }\n\n\n    /**\n      Funcion que descarga un documento y lo muestra en pdf\n      @param {Integer} id_documento Id de documento\n    */\n    function showPdfId(id_documento, sw_url) {\n        DataService.get(restUrl + 'plantillasFormly/documento/'+id_documento)\n        .then(function (respuesta) {\n            showPdf(respuesta.datos.plantilla, respuesta.datos.plantilla_valor, respuesta.datos.nombre, sw_url, id_documento);\n        });\n    }\n\n\n    /**\n      Funcion que muestra pdf de documento\n      @param {String} plantilla Cadena de json que contiene la estructura de un documento\n      @param {String} plantilla_valor Valores de los campos del documento\n      @param {String} nombre Nombre del documento\n    */\n    function showPdf(plantilla, plantilla_valor, nombre, sw_url,id_documento) {\n        var abrirDialogPDF = (angular.isUndefined(sw_url))? true : sw_url;\n        var datosEnviar = {doc:{}};\n        datosEnviar.model_actual = angular.fromJson(plantilla_valor);\n        var model = datosEnviar.model_actual;\n        if( model[\"cite-0\"] && model[\"cite-0\"][\"fecha\"] )\n            model[\"cite-0\"][\"fecha\"] = Datetime.format(model[\"cite-0\"][\"fecha\"], 'dd de MMM de YYYY');\n        datosEnviar.form_actual = UtilFormly.dataToView(angular.fromJson(plantilla), model);\n        datosEnviar.doc.nombre = nombre;\n        datosEnviar.doc.plantilla = plantilla;\n        DataService.post(restUrl+ \"plantillasFormly/generarDocumento/\",datosEnviar)\n        .then(function(respuesta){\n            datosEnviar = { html: respuesta.datos.html, nombre: respuesta.datos.nombre};\n            datosEnviar.esDispositivoMovil = factory.isMobile();\n            if(abrirDialogPDF){\n                //abrimos dialogPDF\n                DataService.pdf(restUrl+'plantillasFormly/documentoPDF/',{cite: datosEnviar.nombre})\n                .then(function (respuestaPdf) {\n                  if(!respuestaPdf) return;\n                    datosEnviar.pdf = respuestaPdf.url;\n                    datosEnviar.pdf_buffer = respuestaPdf.data;\n                    if(id_documento !== null && id_documento) {\n                      $log.log(\"Obteniendo firmas\");\n                      return DataService.get(restUrl +'documento/firmado/'+id_documento);\n                    }\n\n                })\n                .then(function (firmas) {\n                  if(firmas) datosEnviar.firmas = firmas.datos || [];\n                  var config = {\n                    data: datosEnviar,\n                    templateUrl: 'app/factories/Documento/dialogPDF.html',\n                    controller: ['data', '$scope', '$mdDialog', 'Util', DialogPDFController]\n                  };\n                  Modal.show(config);\n                });\n            }else {\n                var new_url =  $location.absUrl();\n                new_url = new_url.substring(0, new_url.indexOf('#/')+2);\n                Storage.setSession('datos_enviar', datosEnviar);\n                $window.open(new_url+'vista_pdf');\n            }\n        });\n    }\n\n    function isMobile() { return angular.isDefined($window.orientation)\n        || navigator.userAgent.match(/Android/i)\n        || navigator.userAgent.match(/webOS/i)\n        || navigator.userAgent.match(/iPhone/i)\n        || navigator.userAgent.match(/iPad/i)\n        || navigator.userAgent.match(/iPod/i)\n        || navigator.userAgent.match(/BlackBerry/i)\n        || navigator.userAgent.match(/Windows Phone/i)\n    }\n\n    /**\n      Funcion que muestra pdf de documento\n      @param {Objeto} data Objeto que tiene valores que llegan de la configuracion\n      @param {Objeto} scope Scope del controlador\n      @param {Objeto} mdDialog mdDialog usado para cerrar el modal\n    */\n    function DialogPDFController(data, $scope, $mdDialog, Util){\n    //   $log.log(\"CHECK DATA \", data);\n        var vmd = $scope;\n        vmd.data={};\n        vmd.data.html=data.html;\n        vmd.data.pdf=data.pdf;\n        vmd.data.flag_html=true;\n        vmd.data.firmas=data.firmas || [];\n        vmd.data.show_pdf=!data.esDispositivoMovil;\n        if (data.esDispositivoMovil) {\n            Util.loadCanvas(data.pdf_buffer, '#canvasContainer');\n        }\n\n        //funciones\n        vmd.mostrarPdf = function (id, sw){ if(sw) showPdfx(id); else showPdfId(id, false); }\n        vmd.cerrar = function (){ $mdDialog.cancel(); }\n        vmd.verHtml = function(){ vmd.data.flag_html=true; }\n        vmd.verPdf = function(){ vmd.data.flag_html=false; }\n\n    }\n\n\n    /**\n      Funcion que muestra el historial del flujo del documento\n      @param {Evento} ev Evento que se activa al hacer click\n      @param {Integer} id_doc Id del documento\n    */\n    function showProgress(ev, id_doc){\n        DataService.get(restUrl + 'historialFlujo/'+id_doc)\n        .then(function (respuesta) {\n            if(respuesta){\n                setAttrs(respuesta.datos);\n                var config = {\n                    event: ev,\n                    data: { id: id_doc, datos: respuesta.datos },\n                    templateUrl: 'app/factories/Documento/dialog.progreso.html',\n                    controller: ['$scope','$mdDialog', 'data', DialogProgreso]\n                };\n                Modal.show(config);\n            }\n        });\n\n\n    }\n    function setAttrs(arr) {\n        arr.forEach(function (it) {\n            it.fecha_mos = Datetime.dateLiteral(it._fecha_creacion);\n            it.hora_mos = Datetime.time(it._fecha_creacion);\n            switch (it.accion) {\n                case 'ENVIADO':\n                it.acc = 'Envió';\n                it.icon = 'send';\n                it.bg_color = 'envio';\n                break;\n                case 'APROBADO':\n                it.acc = 'Aprobó';\n                it.icon = 'done_all';\n                it.bg_color = 'success';\n                break;\n                case 'RECHAZADO':\n                it.acc = 'Observó';\n                it.icon = 'error';\n                it.bg_color = 'danger';\n                it.observacion = it.observacion.substring(it.observacion.indexOf('Observaciones:'), it.observacion.length);\n                break;\n                case 'DERIVADO':\n                it.acc = 'Derivó';\n                it.icon = 'trending_down';\n                it.bg_color = 'envio';\n                break;\n                case 'CERRADO':\n                it.acc = 'Cerró';\n                it.icon = 'assignment_turned_in';\n                it.bg_color = 'warning';\n                break;\n                case 'CREADO':\n                it.acc = 'Respondió';\n                it.icon = 'undo';\n                it.bg_color = 'success';\n                break;\n                case 'ELIMINADO':\n                it.acc = 'Eliminó';\n                it.icon = 'clear';\n                it.bg_color = 'danger';\n                break;\n                case 'FIRMO':\n                it.acc = 'Firmó';\n                it.icon = 'fingerprint';\n                it.bg_color = 'firmo';\n                break;\n                case 'ANULADO':\n                it.acc = 'Anuló';\n                it.icon = 'cancel';\n                it.bg_color = 'danger';\n                break;\n                default:\n                it.acc = 'Sin respuesta';\n                it.icon = 'visibility';\n                it.bg_color = 'bold';\n            }\n        });\n    }\n\n    function showProgressAll(ev, id_doc){\n        DataService.get(restUrl + 'historialFlujo/'+id_doc+'/proceso')\n        .then(function (respuesta) {\n            if(respuesta){\n                setAttrs(respuesta.datos);\n                var config = {\n                    event: ev,\n                    data: { id: id_doc, datos: respuesta.datos },\n                    templateUrl: 'app/factories/Documento/dialog.progreso.html',\n                    controller: ['$scope','$mdDialog', 'data', DialogProgreso]\n                };\n                Modal.show(config);\n            }\n        });\n\n\n    }\n\n    function DialogProgreso( $scope, $mdDialog, data) {\n        var vmd = $scope;\n        vmd.data = data;\n\n        //funciones\n        vmd.cerrar = cerrar;\n        vmd.verDocumento = verDocumento;\n        function cerrar(){ $mdDialog.cancel(); }\n        function verDocumento(id_doc) { showPdfId(id_doc, false); }\n    }\n\n\n}\n\n})();\n\n(function() {\n    'use strict'\n\n    angular\n    .module('app')\n    .factory('ExpirationTime', ['Storage', 'Message', '$interval', '$auth', '$location', '$mdDialog', 'DataService', 'restUrl', ExpirationTimeFactory]);\n\n    /** @ngInject */\n    function ExpirationTimeFactory(Storage, Message, $interval, $auth, $location, $mdDialog, DataService, restUrl) {\n\n        /**\n            Factory que se encargara de controlar el tiempo de expiración de la sesion de usuario.\n            interval: funcion que se repite cada segundo\n            time: el tiempo que se que tiende a disminuir hasta cero si no se apreta alguna tecla o se hace un click\n            init: funcion que inicializara a la funcion interval y el tiempo time\n            stopInterval: funcion que cancela la funcion interval y la vuelve indefinida\n            refreshToken: funcion que refresca el tiempo time, esta funcion se activa al entrar a la ruta documento/:idDocumento\n            guardar: funcion que se manda desde documento/:idDocumento\n            autoSaveInterval: funcion que se repite cada 10 minutos y activa a guardar,\n            initAutoSave: iniciar el autoguardado,\n            stopAutoSave: cancelar el autoguardado,\n            getExpirationTime: obtener el tiempo de expiracion,\n            logout: funcion desloguearse del sistema\n        */\n        var factory = {\n            interval: undefined,\n            time: null,\n            init: init,\n            stopInterval: stopInterval,\n            refreshToken: refreshToken,\n            guardar: undefined,\n            autoSaveInterval: undefined,\n            initAutoSave: initAutoSave,\n            stopAutoSave: stopAutoSave,\n            getExpirationTime: getExpirationTime,\n            logout: logout\n        };\n        var fac = factory;\n        return factory;\n\n        function init(){\n            if(angular.isUndefined(fac.interval)){\n                fac.time = getExpirationTime()*60;\n                fac.interval = $interval(function () {\n                    fac.time--;\n                    if (fac.time == 10 && $location.url().indexOf('/documento/') && angular.isDefined(fac.autoSaveInterval)) fac.guardar(false, true);\n                    if (fac.time <= 0 || $location.url().indexOf('/login')==0)  logout(true);\n                }, 1000)\n            }\n        }\n\n        function getExpirationTime() {\n             return angular.isDefined($auth.getPayload())? $auth.getPayload().tiempo : 0 ;\n         }\n\n        function stopInterval() {\n            if(angular.isDefined(fac.interval)) {\n                $interval.cancel(fac.interval);\n                fac.interval = undefined;\n            }\n        }\n\n        function stopAutoSave() {\n            if(angular.isDefined(fac.autoSaveInterval)) {\n                $interval.cancel(fac.autoSaveInterval);\n                fac.autoSaveInterval = undefined;\n            }\n        }\n\n        function initAutoSave(funcionGuardar, enviado) {\n            fac.guardar = angular.isFunction(funcionGuardar)? funcionGuardar: function(x,y){};  // eslint-disable-line no-unused-vars\n            if(angular.isUndefined(fac.autoSaveInterval)){\n                // la funcion interval se activara cada 10 minutos--> 10*60 = 600, tiempo en miliseconds 600*1000=600000\n                fac.autoSaveInterval = $interval(function () {\n                    fac.guardar(false, true);\n                }, 600000); //\n            }\n            if(enviado) stopAutoSave();\n            refreshToken();\n        }\n\n        /*\n            Funcion logout que limpia la session de usuario y redirecciona a la vista login\n            se activa cuando el tiempo de expiracion es igual a 0 o menor\n        */\n        function logout (sw_inactive) {\n            fac.stopInterval();\n            if(sw_inactive) Message.warning('Su sesión ha sido cerrada automáticamente después de ' + getExpirationTime() + ' minutos, tiempo que dura la sesión.', null, 0);\n            $auth.logout()\n            .then(function() {\n                $location.path(\"login\");\n                $mdDialog.hide();\n            });\n        }\n\n        function refreshToken() {\n            if(angular.isDefined(fac.interval)){\n                DataService.get(restUrl+'refrescar')\n                .then(function (respuesta) {\n                    if(angular.isDefined(respuesta)){\n                        $auth.setToken(respuesta.token);\n                        fac.time = getExpirationTime()*60;\n                    }\n                })\n            }\n        }\n\n    }\n})();\n\n(function() {\n    'use strict'\n\n    angular\n    .module('app')\n    .factory('Datetime', ['Util', 'ArrayUtil', DatetimeFactory])\n    .factory('ArrayUtil', ArrayUtilFactory);\n\n    function ArrayUtilFactory() {\n        var factory = {\n            replace: replace,\n            insert: insert,\n            mover: mover,\n            buscarObj: buscarObj\n        };\n\n        function replace (text, find, replace) {\n            for (var i = 0, l = find.length, regex; i < l; i++) {\n                regex = new RegExp(find[i], \"g\");\n                text = text.replace(regex, replace[i]);\n            }\n            return text;\n        }\n\n        /**\n            Funcion que mueve un item de un array al mismo array o a un segundo array\n            @param {Array} arr Primer array del que se sacara el item\n            @param {Integer} fromIndex Indice del item que se sacara del primer array\n            @param {Integer} toIndex Indice del lugar en el que se pusheara en el segundo arraysi esta definido\n            @param {Array} arr2 Segundo array en el que se pusheara si esta definido\n        */\n        function mover (arr, fromIndex, toIndex, arr2) {\n            var item = arr[fromIndex];\n            arr.splice(fromIndex, 1);\n            if(angular.isDefined(arr2))\n                arr2.splice(toIndex, 0, item);\n            else\n                arr.splice(toIndex, 0, item);\n        }\n\n        /**\n            Funcion que inserta un item a un array en una posicion\n            @param {Array} arr Array en el que se pusheara el item\n            @param {Integer} toIndex Indice del lugar en el que se pusheara el item\n            @param {Generico} item ELemento que se pusheara al array\n        */\n        function insert (arr, toIndex, item) {\n            arr.splice(toIndex, 0, item);\n        }\n\n        /**\n            Funcion que busca un objeto en un array\n            @param {Array} arr Array que tiene objetos\n            @param {string} attr Atributo de un objeto del array\n            @param {string} val Valor con el que se comparara\n            @param {Boolean} sw_obj True la funcion devuelve el objeto encontrado, false|undefined la funcion devuelve true si encuentra el objeto\n        */\n        function buscarObj(arr, attrib, val, sw_obj) {\n            for (var i = 0; i < arr.length; i++)\n                if(arr[i][attrib] == val) return (sw_obj)? arr[i] : true;\n                \n            return (sw_obj)? null : false;\n        }\n\n        return factory;\n    }\n\n\n    /** @ngInject */\n    function DatetimeFactory(Util, ArrayUtil) {\n\n        var formatDate = 'dd/MM/YYYY',\n        months = [\"Enero\", \"Febrero\", \"Marzo\", \"Abril\", \"Mayo\", \"Junio\", \"Julio\", \"Agosto\", \"Septiembre\", \"Octubre\", \"Noviembre\", \"Diciembre\"],\n        days = [\"dom\", \"lun\", \"mar\", \"mié\" , \"jue\", \"vie\" , \"sáb\"],\n        dayslong = [\"Domingo\", \"Lunes\", \"Martes\", \"Miércoles\" , \"Jueves\", \"Viernes\" , \"Sábado\"];\n\n        var factory = {\n            isDate: isDate,\n            isValid: isValid,\n            isLessThan: isLessThan,\n            isLessThanDays: isLessThanDays,\n            isGreaterThan: isGreaterThan,\n            isGreaterThanDays: isGreaterThanDays,\n            addDays: addDays,\n            subtractDays: subtractDays,\n            diff: diff,\n            milliseconds: milliseconds,\n            convert: convert,\n            setFormatDate: setFormatDate,\n            now: now,\n            dateLiteral: dateLiteral,\n            time: time,\n            timeLiteral: timeLiteral,\n            datetimeLiteral: datetimeLiteral,\n            format: format,\n            getSeconds: getSeconds,\n            standar: standar,\n            replace: replace,\n            last: last,\n            secondsBetweenTwoDates: secondsBetweenTwoDates,\n            minutesBetweenTwoDates: minutesBetweenTwoDates,\n            hoursBetweenTwoDates: hoursBetweenTwoDates,\n            daysBetweenTwoDates: daysBetweenTwoDates,\n            betweenTwoDates: betweenTwoDates,\n            isYesterday: isYesterday,\n            parseDate: parseDate,\n            parseDateDjango: parseDateDjango,\n            dateMonth: dateMonth,\n            parse : parse,\n            formatDate: formatDate,\n            months: months,\n            days: days,\n            getPrevDateMonth: getPrevDateMonth,\n            date: date,\n            dayslong: dayslong\n        }\n\n        return factory;\n\n        function date(pDate, separator) {\n            var date = pDate[0].split(separator || '-');\n            // var date = pDate[i].split(separator || '-'); // TODO: verificar el indice correcto. cual es el reemplazo para \"i\"??.\n            return new Date(date[0],date[1]-1,date[2]);\n        }\n\n        function parse(date, separator) {\n            return [date.getFullYear(), date.getMonth()+1, date.getDate()].join(separator || '-');\n        }\n\n        function dateMonth() {\n            var date = new Date();\n            return new Date(date.getFullYear(), date.getMonth(), 1);\n        }\n\n        function getPrevDateMonth(data) {\n            data = data || 1;\n            var date = new Date();\n            var day = date.getDate();\n            var month = date.getMonth()\n            var year = date.getFullYear();\n\n            if (day < data) {\n                month--;\n                if (month < 0) {\n                    month = 11;\n                    year--;\n                }\n            }\n            return new Date(year, month, data);\n        }\n\n        function isDate (date) {\n            if (Util.toType(date) == 'string') {\n                date = convert(date);\n            }\n            return isValid(date);\n        }\n\n        function isValid (date) {\n            if (Util.toType(date) != 'date')\n                return false;\n            return !isNaN(date.getTime());\n        }\n\n        function isLessThan (date) {\n            return milliseconds(date) < (new Date()).getTime();\n        }\n\n        function isLessThanDays (date, data) {\n            return milliseconds(date) > subtractDays(new Date(), data);\n        }\n\n        function isGreaterThan (date) {\n            return milliseconds(date) > (new Date()).getTime();\n        }\n\n        function isGreaterThanDays (date, data) {\n            return milliseconds(date) < addDays(new Date(), data);\n        }\n\n        function addDays (date, days) {\n            return milliseconds(date) + (days || 0)*24*60*60*1000;\n        }\n\n        function subtractDays (date, days) {\n            return milliseconds(date) - (days || 0)*24*60*60*1000;\n        }\n\n        function diff (date2, date1) {\n            return milliseconds(date2) - milliseconds(date1);\n        }\n\n        function milliseconds (date) {\n            if (Util.toType(date) == 'string') {\n                date = convert(date);\n            }\n            return date.getTime();\n        }\n\n        function convert (date) {\n            date = date.split('/');\n            return formatDate == 'dd/MM/YYYY' ? new Date(date[2], date[1]-1, date[0]) :\n            formatDate == 'MM/dd/YYYY' ? new Date(date[2], date[0]-1, date[1]) :\n            new Date(date[0], date[1]-1, date[2]);\n        }\n\n        function setFormatDate (format) {\n            formatDate = format;\n        }\n\n        function now (format) {\n            return replace(new Date(), format || formatDate);\n        }\n\n        function dateLiteral (date) {\n            return format(date, 'dd de MMM del YYYY');\n        }\n\n        function time (date) {\n            return format(date, 'HH:mm');\n        }\n\n        function timeLiteral(time, txt) {\n            var text = '';\n            if (typeof time == 'number') {\n                if (time == 0) {\n                    return '';\n                }\n                if (time < 60) {\n                    text = time + 's';\n                } else if (time < 3600) {\n                    text = Math.floor(time / 60) + 'm ' + (time % 60 > 0 ? (time % 60 + 's') : '');\n                } else {\n                    text = Math.floor(time / 3600) + 'h ' + (time % 3600 > 0 ? (Math.floor(time / 60) + 'm ') : '') + (time % 60 > 0 ? (time % 60 + 's') : '');\n                }\n                return (txt || '') + text;\n            } else {\n                if (time.length == 0) {\n                    return '';\n                }\n                time = time.split(':');\n                var hours = time[0],\n                    minutes = time[1];\n\n                if (parseInt(hours) > 0) {\n                    text += parseInt(hours) + 'h ';\n                }\n                if (parseInt(minutes) > 0) {\n                    text += parseInt(minutes) + 'm ';\n                }\n                if (time.length == 3 && parseInt(time[2]) > 0) {\n                    text += parseInt(time[2]) + 's' ;\n                }\n\n                return (txt || '') + text;\n            }\n        }\n\n        function getSeconds(time) {\n            time = time.split(':');\n            var hours = time[0],\n                minutes = time[1],\n                total = 0;\n\n            if (parseInt(hours) > 0) {\n                total += parseInt(hours)*3600;\n            }\n            if (parseInt(minutes) > 0) {\n                total += parseInt(minutes)*60;\n            }\n            if (time.length == 3 && parseInt(time[2]) > 0) {\n                total += parseInt(time[2]);\n            }\n\n            return total;\n        }\n\n        function datetimeLiteral (date) {\n            return format(date, 'dddd dd de MMM del YYYY a la(s) HH:mm');\n        }\n\n        function format (date, format) {\n            var d = new Date(date);\n            if (isDate(d)) {\n                return replace(d, format || formatDate);\n            }\n            return date;\n        }\n\n        function standar (date, format) {\n            var type = Util.toType(date);\n            if (type == 'date') {\n                return date;\n            }\n            if (type == 'string') {\n                format = format || formatDate;\n                var separator = date.indexOf('/') != -1 ? '/' : '-';\n                date = date.split(separator);\n                if (format == 'dd/MM/YYYY' || format == 'dd-MM-YYYY') {\n                    date = date[1] + separator + date[0] + separator + date[2];\n                }\n                if (format == 'YYYY/dd/MM' || format == 'YYYY-dd-MM') {\n                    date = date[0] + separator + date[1] + separator + date[0];\n                }\n            }\n            return new Date(date);\n        }\n\n        function replace (date, format) {\n            format = format || formatDate;\n            date = standar(date, format);\n            var monthLiteral = format.indexOf('MMM') != -1;\n            return ArrayUtil.replace(format, [\n                \"dddd\", \"ddd\", \"dd\", monthLiteral ? 'MMM' : 'MM', 'YYYY', 'HH', 'mm', 'ss'\n            ], [\n                dayslong[date.getDay()],\n                days[date.getDay()],\n                (date.getDate() < 10 ? '0' : '') + date.getDate(),\n                monthLiteral ? months[date.getMonth()] : ((date.getMonth() + 1 < 10 ? '0' : '') + (date.getMonth() + 1)),\n                date.getFullYear(),\n                (date.getHours() < 10 ? '0' : '') + date.getHours(),\n                (date.getMinutes() < 10 ? '0' : '') + date.getMinutes(),\n                (date.getSeconds() < 10 ? '0' : '') + date.getSeconds()\n            ]);\n        }\n\n        function last (date) {\n            var now = new Date();\n            var days = daysBetweenTwoDates(date, now);\n            if (days > 31) {\n                return dateLiteral(date);\n            } else {\n                if (days > 7) {\n                    var weeks = parseInt(days / 7);\n                    return 'Hace ' + weeks + ' semana' + (weeks > 1 ? 's' : '');\n                } else {\n                    if (days >= 1) {\n                        return format(date, 'ddd a la(s) HH:mm');\n                    } else {\n                        var hours = hoursBetweenTwoDates(date, now);\n                        if (isYesterday(date, hours)) {\n                            return 'Ayer a la(s) ' + time(date);\n                        } else {\n                            if (hours >= 1) {\n                                return 'Hace ' + hours + ' hora' + (hours > 1 ? 's' : '');\n                            } else {\n                                var minutes = minutesBetweenTwoDates(date, now);\n                                if (minutes >= 1) {\n                                    return 'Hace ' + minutes + ' minuto' + (minutes > 1 ? 's' : '');\n                                } else {\n                                    var seconds = secondsBetweenTwoDates(date, now);\n                                    return 'Hace ' + seconds + ' segundo' + (seconds > 1 ? 's' : '');\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n        }\n\n        function secondsBetweenTwoDates (date1, date2, absolute) {\n            return betweenTwoDates(date1, date2, \"s\", absolute);\n        }\n\n        function minutesBetweenTwoDates (date1, date2, absolute) {\n            return betweenTwoDates(date1, date2, \"i\", absolute);\n        }\n\n        function hoursBetweenTwoDates (date1, date2, absolute) {\n            return betweenTwoDates(date1, date2, \"h\", absolute);\n        }\n\n        function daysBetweenTwoDates (date1, date2, absolute) {\n            return betweenTwoDates(date1, date2, \"d\", absolute);\n        }\n\n        function betweenTwoDates (date1, date2, type, absolute) {\n            var types = {s : 1000, i : 60*1000, h : 60*60*1000, d : 24*60*60*1000};\n            var diff = parseInt((standar(date2).getTime() - standar(date1).getTime())/types[type]);\n\n            if (typeof absolute !== 'undefined' && absolute !== false) {\n                return Math.abs(diff);\n            }\n            return diff;\n        }\n\n        function isYesterday (date, hours) {\n            if (isDate(date)) {\n                date = date.split(' ');\n                var time = date[1].split(':');\n                return hours >= parseInt(time[0]);\n            }\n            return false;\n        }\n\n        function parseDate(date) {\n            return [date.getDate(), date.getMonth() + 1, date.getFullYear()].join('/')\n        }\n\n        function parseDateDjango(date) {\n            return [date.getFullYear(),date.getMonth()+1,date.getDate()].join('-');\n        }\n\n    }\n})();\n\n\n(function() {\n    'use strict'\n\n    angular\n    .module('app')\n    .factory('AuthInterceptor', AuthInterceptor)\n    .config(function($httpProvider) {\n        $httpProvider.interceptors.push('AuthInterceptor');\n    });\n\n    /** @ngInject */\n    function AuthInterceptor($q, $location, $injector) {\n\n        var interceptor = {\n            request: function(config) {\n                angular.element('#loading-progress').show();\n                return config;\n            },\n            requestError: function(config) {\n                angular.element('#loading-progress').hide();\n                return config;\n            },\n            response: function(response){\n                angular.element('#loading-progress').hide();\n                return response || $q.when(response);\n            },\n            responseError: function(rejection) {\n                if (rejection.status === 401 || rejection.status === 403) {\n                    // en estos estados se deslogue y va a login\n                    var Storage = $injector.get('Storage');\n                    var ExpirationTime = $injector.get('ExpirationTime');\n\n                    Storage.setSession('path', $location.path());\n                    ExpirationTime.logout();\n                }\n                return $q.reject(rejection);\n            }\n        };\n\n        /*eslint-disable no-unused-vars*/\n        function exist(path) {\n          /*eslint-enable no-unused-vars*/\n            var paths = $injector.get('PageNoLogin');\n            for (var i in paths) {\n                if (path.indexOf('/' + paths[i]) != -1 || path.indexOf('/' + paths[i] + '/') != -1) {\n                    return true;\n                }\n            }\n            return false;\n        }\n\n\n        return interceptor;\n    }\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n  .module('app')\n  .service('DataService', ['$http', 'Message', 'Util', '$sce', '$log', DataService]);\n\n\n\n  /** @ngInject */\n  function DataService($http, Message, Util, $sce, $log) {\n\n    var formly = null;\n    var errorConnection = 'No se pudo establecer conexión con el servidor.';\n    var error500 = 'Se produjo un error en el servidor, inténtelo más tarde.';\n    var error404 = 'No existe el recurso solicitado.';\n    var error403 = 'No tiene los permisos necesarios.';\n    var error401 = 'No se pudo realizar la operación.';\n\n    var service = {\n      list: list,\n      all: list,\n      delete: remove,\n      save: save,\n      get: get,\n      put: put,\n      patch: patch,\n      post: post,\n      postWithFiles: postWithFiles,\n      putWithFiles: putWithFiles,\n      fields: fields,\n      option: fields,\n      pdf: pdf,\n      file: file,\n      setFormly: setFormly\n    };\n\n    return service;\n\n    function list(url, query) {\n      return $http.get(url + (query ? '?' + Util.serialize(query) : ''))\n      .then(function (response) {\n        if(response.data){\n          return response.data;\n        }else{\n          $log.warn(\"list->respuesta sin datos\");\n        }\n      }).catch(function (error) {\n        msgError(error);\n      });\n    }\n\n    function save(url, data) {\n      return $http[data.id ? 'put' : 'post'](url + (data.id ? data.id + '/': ''), data)\n      .then(function (response) {\n        if(response.data){\n          return response.data;\n        } else {\n          $log.warn(\"save->respuesta sin datos\");\n        }\n      }).catch(function (error) {\n        msgError(error);\n      });\n    }\n\n    function put(url, data) {\n      return $http.put(url + (data.id ? data.id + '/': ''), data)\n      .then(function (response) {\n        if(response.data){\n          return response.data;\n        }else{\n          $log.warn(\"put->respuesta sin datos\");\n        }\n      }).catch(function (error) {\n        msgError(error);\n      });\n    }\n\n    function putWithFiles(url, data) {\n      var config = {\n        headers: {\n          'Content-Type': undefined\n        }\n      };\n      return $http.put(url, data, config)\n      .then(function (response) {\n        if(response.data){\n          return response.data;\n        }else{\n          $log.warn(\"putWithFiles->respuesta sin datos\");\n        }\n      }).catch(function (error) {\n        msgError(error);\n      });\n    }\n\n    function patch(url, data) {\n      return $http.patch(url + (data.id ? data.id + '/': ''), data)\n      .then(function (response) {\n        if(response.data){\n          return response.data;\n        }else{\n          $log.warn(\"patch->respuesta sin datos\");\n        }\n      }).catch(function (error) {\n        msgError(error);\n      });\n    }\n\n    function post(url, data) {\n      return $http.post(url, data)\n      .then(function (response) {\n        if(response.data){\n          return response.data;\n        }else{\n          $log.warn(\"post->respuesta sin datos\");\n        }\n      }).catch(function (error) {\n        msgError(error);\n      });\n    }\n\n    function postWithFiles(url, data) {\n      var config = {\n        headers: {\n          'Content-Type': undefined\n        }\n      };\n      return $http.post(url, data, config)\n      .then(function (response) {\n        if(response.data){\n          return response.data;\n        }else{\n          $log.warn(\"postWithFiles->respuesta sin datos\");\n        }\n      }).catch(function (error) {\n        msgError(error);\n      });\n    }\n\n    function remove(url, id) {\n      return $http.delete(url + id + '/')\n      .then(function (response) {\n        if(response.data){\n          return response.data;\n        }else{\n          $log.warn(\"remove->respuesta sin datos\");\n        }\n      }).catch(function (error) {\n        msgError(error);\n      });\n    }\n\n    function get(url, id) {\n      return $http.get(url + (id ? id + '/' : ''))\n      .then(function (response) {\n        if(response.data){\n          return response.data;\n        }else{\n          $log.warn(\"get->respuesta sin datos\");\n        }\n      }).catch(function (error) {\n        msgError(error);\n      });\n    }\n\n    function fields(url) {\n      return $http({method: 'OPTIONS', url: url})\n      .then(function (response) {\n        if(response.data){\n          return response.data;\n        }else{\n          $log.warn(\"fields->respuesta sin datos\");\n        }\n      }).catch(function (error) {\n        msgError(error);\n      });\n    }\n\n    function pdf(url, data) {\n      return $http.post(url, data || {}, {responseType:'arraybuffer'})\n      .then(function (response) {\n        if (response.data) {\n          var file = new Blob([response.data], {type: 'application/pdf'});\n          var fileURL = URL.createObjectURL(file);\n          return { data: response.data, url: $sce.trustAsResourceUrl(fileURL) };\n        }\n        return null;\n      }).catch(function (error) {\n        if(url.indexOf('/documento/firmar')==-1){\n          msgError(error);\n        }\n      });\n    }\n\n    function file(url, data, type) {\n      // return $http.get(url, data || {}, {responseType:'arraybuffer'})\n      return $http.get(url, data || {})\n      .then(function (response) {\n        if (response.data) {\n          // var blob = new Blob([response.data], { type: type || 'text/plain' }),\n          //     url = $window.URL || $window.webkitURL;\n          var blob = new Blob([response.data], { type: (type || 'text/plain') }, false);\n          blob = blob; // TODO: esta linea es innecesaria\n          // saveAs(blob, filename || 'file.txt');\n\n          // return url.createObjectURL(blob);\n        }\n        return true;\n      }).catch(function (error) {\n        msgError(error);\n      });\n    }\n\n    function setFormly(data) {\n      formly = data;\n    }\n\n    function parseError(error) {\n      var message = [];\n      if (error) {\n        if (error.detail || error.error || error.non_field_errors) {\n          return error.detail || error.error || error.non_field_errors;\n        }\n        for (var i in error) {\n          var label = i;\n          if (formly) {\n            formly.filter(function (el) {\n              if (el.key == i) {\n                label = el.templateOptions.label;\n              }\n            });\n          }\n          message.push('<strong>' + label + ':</strong> ' + (Util.toType(error[i]) == 'array' ? error[i].join(', ') : error[i]));\n        }\n        return message.join('<br>');\n      }\n      return null;\n    }\n\n    function msgError(error) {\n      if (error.status === 500) {\n        if(error.data.indexOf(\"SequelizeUniqueConstraintError:\") !== -1){\n          var xcad = error.data.substring(error.data.indexOf(\"«\"), error.data.indexOf(\"»\"));\n          var campo = xcad.substring(1,xcad.lastIndexOf(\"_\"));\n          Message.error(\"El campo \"+campo+\" ya existe, y no debe duplicarse.\");\n        }\n        else if(error.data.indexOf(\"SequelizeValidationError:\") !== -1){\n          var mensajeError=((error.data.split(\" \")).splice(3)).join(' ');\n          var indice=mensajeError.indexOf(\"<br>\");\n          mensajeError=mensajeError.substring(0,indice);\n          Message.error(mensajeError);\n        }\n        else\n        Message.error(error500);\n      } else if (error.status === 404) {\n        Message.error(error404);\n      } else if (error.status === 403) {\n        Message.error(error403);\n      } else if (error.status === 401) {\n        Message.error(error401);\n      } else if (error.status === 412) {\n        Message.show((error.data.tipoMensaje || 'ERROR'), (error.data.mensaje || 'No se pudo obtener una respuesta'));\n      } else {\n        Message.error(parseError(error.data) || errorConnection);\n      }\n    }\n\n  }\n\n})();\n\n(function() {\n    'use strict';\n\n    angular\n    .module('app')\n    .filter('datetime', ['Datetime', function(Datetime) {\n\n        return function(date, format) {\n\n            if (format) {\n                if (format == 'literal') {\n                    return Datetime.dateLiteral(date);\n                }\n                if (format == 'year') {\n                    return Datetime.now('YYYY');\n                }\n                if (format == 'timeLiteral') {\n                    return Datetime.timeLiteral(date);\n                }\n                if (format == 'HH:mm') {\n                    date = date.split(':');\n                    return [date[0], date[1]].join(':')\n                }\n            }\n\n            return date;\n        }\n    }]);\n})();\n(function() {\n  'use strict';\n\n  angular\n    .module('app')\n    .config(ThemeConfig);\n\n    /** @ngInject */\n    function ThemeConfig($mdThemingProvider) {\n        \n        $mdThemingProvider.theme('default')\n                .primaryPalette('teal') // red, pink, purple, deep-purple, indigo, blue, light-blue, cyan, teal, green, light-green, lime, yellow, amber, orange, deep-orange, brown, grey, blue-grey\n                .accentPalette('orange')\n               \n    }\n\n})();\n\n\n(function() {\n  'use strict';\n\n  angular\n    .module('app')\n    .run(runBlock);\n\n  /** @ngInject */\n    function runBlock(Storage, $location, $log, PageNoLogin, $window, Datetime, $mdDialog, RouteValidator, formlyConfig, MyFormlyConfig, ExpirationTime) {\n        RouteValidator.init();\n        MyFormlyConfig.init(formlyConfig);\n        var $container = angular.element('#container-main');\n        var $document = $window.document;\n\n        // Collapsed Panel\n        $container.on('click', '.btn-collapsed', function () {\n            var $el = angular.element(this)\n            $el.parent().parent().next().slideToggle()\n            $el.toggleClass('rotate')\n        })\n\n        var $toasts = angular.element('#toast-container-main')\n        $toasts.on('click', '.md-toast-close', function () {\n            angular.element(this).parent().parent().parent().fadeOut()\n        });\n\n        // Redirect\n        if (!Storage.existUser()) {\n            var path = $location.path();\n            // $log.log('Revisando el path', path);\n            if (!exist(path)) {\n                if (path.length) Storage.setSession('path', path.replace('/', ''));                \n                if (Storage.getSession('path') !== 'verificar') $location.path('login');\n            }\n        } else {\n            ExpirationTime.init();\n        }\n\n        function exist(path) {\n            var paths = PageNoLogin;\n            for (var i in paths) {\n                if (path.indexOf('/' + paths[i]) == 0 || path.indexOf('/' + paths[i] + '/') == 0) {\n                    return true;\n                }\n            }\n            return false;\n        }\n\n        //Fullscreen\n        function exitFullScreen () {\n            angular.element('body').removeClass('fullscreen');\n        }\n\n        angular.element($window.document).on('keyup', function(e) {\n            if (e.keyCode == 27) {\n                exitFullScreen();\n            }\n        });\n\n        $document.addEventListener(\"mozfullscreenchange\", function () {\n            if (!$document.mozFullScreen) {\n                exitFullScreen();\n            }\n        }, false);\n\n    }\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('app')\n    .config(routerConfig);\n\n  /** @ngInject */\n  function routerConfig($stateProvider, $urlRouterProvider) {\n    $stateProvider\n      .state('home', {\n        url: '/',\n        templateUrl: 'app/modules/dashboard/main.html',\n        controller: 'MainController',\n        controllerAs: 'main'\n      })\n      .state('usuario', {\n        url: '/usuario',\n        templateUrl: 'app/modules/admin/usuarios/modules.admin.usuarios.html',\n        controller: 'UsuariosController',\n        controllerAs: 'usuarios'\n      })\n      .state('menu', {\n        url: '/menu',\n        templateUrl: 'app/modules/seguridad/menu/modules.seguridad.menu.html',\n        controller: 'MenuController',\n        controllerAs: 'menu'\n      })\n      .state('rol', {\n        url: '/rol',\n        templateUrl: 'app/modules/seguridad/rol/modules.seguridad.rol.html',\n        controller: 'RolController',\n        controllerAs: 'rol'\n      })\n      .state('login', {\n        url: '/login',\n        templateUrl: 'app/modules/admin/login/modules.admin.login.html',\n        controller: 'LoginController',\n        controllerAs: 'login'\n      })\n      .state('elegir', {\n        url: '/elegir',\n        templateUrl: 'app/modules/admin/virtual/virtual.html',\n        controller: 'VirtualController',\n        controllerAs: 'virtual'\n      })\n      .state('verificar', {\n        url: '/verificar',\n        templateUrl: 'app/modules/verificacion/modules.verificar.html',\n        controller: 'VerificarController',\n        controllerAs: 'verificar'\n      })\n      .state('profile', {\n        url: '/profile',\n        templateUrl: 'app/modules/admin/profile/modules.admin.profile.html',\n        controller: 'ProfileController',\n        controllerAs: 'profile'\n      })\n      .state('contactos', {\n        url: '/contactos',\n        templateUrl: 'app/modules/plantillasFormly/contactos/modules.plantillasFormly.contactos.html',\n        controller: 'ContactosController',\n        controllerAs: 'contactos'\n      })\n      .state('plantillas', {\n        url: '/plantillas',\n        templateUrl: 'app/modules/plantillasFormly/plantillas/modules.plantillasFormly.plantillas.html',\n        controller: 'PlantillasController',\n        controllerAs: 'plantillas'\n      })\n      .state('plantilla', {\n        url: '/plantilla/:idPlantilla',\n        templateUrl: 'app/modules/plantillasFormly/plantillas/plantilla/modules.plantillasFormly.plantillas.plantilla.html',\n        controller: 'PlantillaController',\n        controllerAs: 'plantilla'\n      })\n      .state('documentos', {\n        url: '/documentos',\n        templateUrl: 'app/modules/plantillasFormly/documentos/modules.plantillasFormly.documentos.html',\n        controller: 'DocumentosController',\n        controllerAs: 'documentos'\n      })\n      .state('documento', {\n        url: '/documento/:idDocumento',\n        templateUrl: 'app/modules/plantillasFormly/documentos/documento/modules.plantillasFormly.documentos.documento.html',\n        controller: 'DocumentoController',\n        controllerAs: 'documento'\n      })\n      .state('aprobacion', {\n        url: '/aprobacion',\n        templateUrl: 'app/modules/plantillasFormly/aprobacion/modules.plantillasFormly.aprobacion.html',\n        controller: 'AprobacionController',\n        controllerAs: 'aprobacion'\n      })\n      .state('impresion', {\n        url: '/impresion',\n        templateUrl: 'app/modules/plantillasFormly/impresion/modules.plantillasFormly.impresion.html',\n        controller: 'ImpresionController',\n        controllerAs: 'impresion'\n      })\n      .state('progreso', {\n        url: '/progreso',\n        templateUrl: 'app/modules/plantillasFormly/progreso/modules.plantillasFormly.progreso.html',\n        controller: 'ProgresoController',\n        controllerAs: 'progreso'\n      })\n      .state('enCurso', {\n        url: '/en_curso',\n        templateUrl: 'app/modules/plantillasFormly/enCurso/modules.plantillasFormly.enCurso.html',\n        controller: 'EnCursoController',\n        controllerAs: 'enCurso'\n      })\n      .state('firmar', {\n        url: '/firmar',\n        templateUrl: 'app/modules/plantillasFormly/firmar/modules.plantillasFormly.firmar.html',\n        controller: 'FirmarController',\n        controllerAs: 'firmar'\n      })\n      .state('vistaPdf', {\n        url: '/vista_pdf',\n        templateUrl: 'app/modules/plantillasFormly/vistaPdf/modules.plantillasFormly.vistaPdf.html',\n        controller: 'VistaPdfController',\n        controllerAs: 'vistaPdf'\n      })\n      .state('monitoreo', {\n        url: '/monitoreo',\n        templateUrl: 'app/modules/plantillasFormly/monitoreo/modules.plantillasFormly.monitoreo.html',\n        controller: 'MonitoreoController',\n        controllerAs: 'monitoreo'\n      })\n    $urlRouterProvider.otherwise('/');\n  }\n\n})();\n\n/* global moment:false */\n(function() {\n  'use strict';\n\n  angular\n    .module('app')\n    .constant('moment', moment)\n    .constant('appName', 'app')\n    .constant('PageNoLogin', ['login'])\n    .constant('authUrl', 'https://intranet.agetic.gob.bo/plantillas/ws/autenticar') // Auth\n    .constant('restUrl', 'https://intranet.agetic.gob.bo/plantillas/ws/api/v1/' ) // Rest Api Backend\n    .constant('backUrl', 'https://intranet.agetic.gob.bo/plantillas/ws/') // Backend\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('app')\n    .config(config);\n\n  /** @ngInject */\n    function config($logProvider, $authProvider, restUrl, authUrl, appName, $mdDateLocaleProvider, moment, $httpProvider, $mdAriaProvider) {\n        // Enable log\n        $logProvider.debugEnabled(true);\n        // Globally disables all ARIA warnings.\n        $mdAriaProvider.disableWarnings();\n\n        // Config auth\n        $authProvider.loginUrl = authUrl;\n        // $authProvider.signupUrl = \"http://api.com/auth/signup\";\n        $authProvider.tokenName = \"token\";\n        $authProvider.tokenPrefix = appName;\n        $authProvider.storageType = 'sessionStorage';\n        // $authProvider.authToken = 'Bearer';\n\n        $mdDateLocaleProvider.formatDate = function(date) {\n            if (date) {\n                return moment(date).format('DD/MM/YYYY');\n            }\n            return null;\n        };\n\n        $mdDateLocaleProvider.parseDate = function(dateString) {\n            var m = moment(dateString, 'DD/MM/YYYY', true);\n            return m.isValid() ? m.toDate() : new Date(NaN);\n        };\n\n        $httpProvider.interceptors.push('HttpInterceptor');\n\n\n        //initialize get if not there\n        if (!$httpProvider.defaults.headers.get) {\n            $httpProvider.defaults.headers.get = {};\n        }\n        $httpProvider.defaults.headers.get['Cache-Control'] = 'private, no-cache, no-store, must-revalidate';\n        $httpProvider.defaults.headers.get['Pragma'] = 'no-cache';\n\n        //disable IE ajax request caching\n        $httpProvider.defaults.headers.get['If-Modified-Since'] = 'Mon, 26 Jul 1997 05:00:00 GMT';\n        // extra\n\n    }\n\n})();\n\nangular.module(\"app\").run([\"$templateCache\", function($templateCache) {$templateCache.put(\"app/components/breadcrumb/breadcrumb.html\",\"<ol class=breadcrumb><li ng-if=$ctrl.getParent()>{{$ctrl.getParent()}}</li><li class=active ng-if=$ctrl.getCurrent()>{{$ctrl.getCurrent()}}</li></ol>\");\n$templateCache.put(\"app/components/cargadorArchivos/cargadorArchivos.html\",\"<div layout=row layout-wrap><div flex><div ng-click=vm.clickUp() ng-show=vm.uploader.isHTML5 ng-if=\\\"vm.maxArchivosPermitidos > vm.uploader.queue.length\\\"><div class=caja-up nv-file-drop=\\\"\\\" nv-file-over=\\\"\\\" nv-file-select=\\\"\\\" uploader=vm.uploader><div layout=row layout-wrap layout-align=\\\"center center\\\"><div flex=30 style=text-align:right><md-icon class=md-display-1>attach_file</md-icon></div><div flex=70 class=md-body-1>Suelte los archivos aquí o haga click para añadir archivos<br>Solo se permiten archivos en formato: {{vm.formatos}}</div></div></div></div><input id=input_seleccionar type=file nv-file-select=\\\"\\\" uploader=vm.uploader multiple ng-show=!vm.uploader.isHTML5><table ng-if=!vm.soloImagenes><tbody><!-- TODO: Habilitar para los archivos antiguos (edicion y eliminacion)\\n    <tr ng-show=\\'item.mostrar\\' ng-repeat=\\\"item in vm.noticia_adjuntos\\\">\\n                    <td><a ng-href=\\'{{item.link}}\\'> {{item.nombre_publico}}</a></td>\\n                    <td>\\n                        <md-button class=\\\"md-icon-button md-accent md-very-small\\\" aria-label=\\\"Eliminar\\\" ng-click=\\\"vm.eliminarAdjuntos(item)\\\">\\n                            <md-icon class=\\\"md-very-small\\\">delete</md-icon>\\n                        </md-button>\\n                    </td>\\n                </tr>--><tr ng-repeat=\\\"item in vm.uploader.queue\\\"><td>{{item.file.name}}</td><td><md-button class=\\\"md-icon-button md-accent md-very-small\\\" aria-label=Eliminar ng-click=item.remove()><md-icon class=md-very-small>delete</md-icon></md-button></td></tr></tbody></table><span ng-repeat=\\\"item in vm.uploader.queue\\\" class=imagen ng-if=vm.soloImagenes>{{item.file.name}}<div ng-show=\\\"vm.uploader.isHTML5 && vm.esImagen(item.file)\\\" ng-thumb=\\\"{ file: item._file, height: vm.altoMiniatura, width: vm.anchoMiniatura }\\\"></div><md-button class=\\\"md-icon-button md-accent md-very-small\\\" aria-label=Eliminar ng-click=item.remove()><md-icon class=md-very-small>delete</md-icon></md-button></span><span ng-repeat=\\\"item in vm.mostrar\\\" class=imagen>{{item.nombre_publico}}<div ng-mostrar-thumb=\\\"{ ruta:\\'{{vm.restUrl}}{{item.ruta}}\\',height: vm.altoMiniatura, width: vm.anchoMiniatura }\\\"></div><md-button class=\\\"md-icon-button md-accent md-very-small\\\" aria-label=Eliminar ng-click=vm.eliminar(item)><md-icon class=md-very-small>delete</md-icon></md-button></span><md-progress-linear md-mode=determinate value={{vm.uploader.progress}}></md-progress-linear></div></div>\");\n$templateCache.put(\"app/components/crudTable/crudTable.html\",\"<md-card><md-toolbar class=\\\"md-table-toolbar md-default\\\" ng-show=vm.filter.show><div class=md-toolbar-tools><md-icon>search</md-icon><form flex name=vm.filter.form ng-class=\\\"{\\'flex-xs-70\\': vm.searchPro, \\'flex-sm-70\\': vm.searchPro}\\\"><div layout=column layout-gt-sm=row ng-class=\\\"{\\'crud-table-searchpro\\': vm.searchPro}\\\"><input type=text ng-class=\\\"{\\'crud-table-filter\\': !vm.searchPro, \\'flex\\': vm.searchPro}\\\" id=crud-table-input ng-model=vm.query.filter ng-model-options=vm.filter.options placeholder=\\\"Escriba su búsqueda aquí...\\\" ng-if=\\\"!vm.searchPro || vm.tipo_busqueda==\\'campo\\' || vm.tipo_busqueda==\\'todos\\' || vm.tipo_busqueda==\\'documento\\' || vm.tipo_busqueda==\\'flujo\\'\\\"><divider></divider><div class=date-pick ng-if=vm.check_fechas><md-datepicker ng-change=vm.getItems() ng-model=vm.fecha_inicio></md-datepicker><md-tooltip>Fecha inicio</md-tooltip></div><div class=date-pick ng-if=vm.check_fechas><md-datepicker ng-change=vm.getItems() ng-model=vm.fecha_final></md-datepicker><md-tooltip>Fecha fin</md-tooltip></div><div ng-if=vm.searchPro><md-checkbox ng-model=vm.check_fechas ng-change=vm.getItems() aria-label=check_fechas></md-checkbox><md-tooltip>Fechas</md-tooltip></div><divider></divider><label for=select-tipo ng-if=vm.searchPro>Tipo de búsqueda:</label><md-input-container flex class=\\\"select-tipo flex-gt-sm-10\\\" ng-if=vm.searchPro><md-select ng-model=vm.tipo_busqueda ng-change=\\\"vm.query.filter=\\'\\'; vm.getItems();\\\"><md-option class=opt-select-tipo ng-value=\\\"\\'todos\\'\\\">Todos</md-option><md-option class=opt-select-tipo ng-value=\\\"\\'campo\\'\\\">Campo</md-option><md-option class=opt-select-tipo ng-value=\\\"\\'documento\\'\\\">En documento</md-option><md-option class=opt-select-tipo ng-value=\\\"\\'flujo\\'\\\">Por flujo</md-option></md-select></md-input-container><md-input-container flex class=\\\"select-tipo flex-gt-sm-10\\\" ng-if=\\\"vm.tipo_busqueda==\\'campo\\'\\\" ng-init=\\\"vm.campo_seleccionado=vm.headers[1]\\\"><md-select ng-model=vm.campo_seleccionado ng-change=vm.getItems()><md-option class=opt-select-tipo ng-value=h ng-repeat=\\\"h in vm.headers\\\" ng-if=\\\"h.title!=\\'ID\\'\\\">{{(h.title==\\'Nombre\\')? h.title+\\'(CITE)\\': h.title }}</md-option></md-select><md-tooltip>{{vm.campo_seleccionado.title}}</md-tooltip></md-input-container></div></form><md-button class=md-icon-button ng-click=vm.removeFilter()><md-icon>close</md-icon></md-button></div></md-toolbar><md-toolbar class=md-table-toolbar ng-show=!vm.filter.show><div class=md-toolbar-tools><md-icon>grid_on</md-icon><span>{{vm.titleTable}}</span><div flex></div><md-button class=md-icon-button ng-click=vm.showFilter() ng-if=vm.permissions.filter><md-tooltip>Filtrar registros</md-tooltip><md-icon>filter_list</md-icon></md-button><md-button class=md-icon-button ng-click=vm.saveAll() ng-if=vm.editable><md-tooltip>Guardar todo</md-tooltip><md-icon>playlist_add_check</md-icon></md-button><md-button class=md-icon-button ng-click=vm.getItems() id=btn-refresh-crudtable><md-tooltip>Actualizar</md-tooltip><md-icon>refresh</md-icon></md-button><md-button class=\\\"md-icon-button btn-collapsed\\\"><md-tooltip>Ocultar/Ver</md-tooltip><md-icon>keyboard_arrow_down</md-icon></md-button></div></md-toolbar><md-card-content ng-class=\\\"{\\'crud-table-content\\': vm.searchPro && vm.filter.show}\\\"><div class=btn-container ng-if=vm.permissions.create><md-button class=\\\"md-fab md-primary\\\" ng-click=vm.add($event) aria-label=Add><md-tooltip>Agregar nuevo registro</md-tooltip><md-icon>add</md-icon></md-button></div><div class=btn-container ng-if=\\\"!vm.permissions.create && vm.buttonAgregar\\\"><md-button class=\\\"md-fab md-primary\\\" ng-click=vm.buttonAgregar.onclick($event) aria-label=Add><md-tooltip>{{ vm.buttonAgregar.tooltip || \\'Agregar nuevo registro\\' }}</md-tooltip><md-icon>{{vm.buttonAgregar.icon}}</md-icon></md-button></div><md-table-container><table md-table ng-model=selected md-progress=promise ng-if=vm.permissions.read><thead md-head md-order=vm.query.order md-on-reorder=vm.getItems><tr md-row><th md-cell ng-if=vm.habilitarSeleccion><md-checkbox class=md-primary ng-model=vm.seleccionar ng-click=vm.seleccionarTodos()></md-checkbox></th><th md-column ng-if=\\\"vm.permissions.update || vm.permissions.update || vm.permissions.print || vm.buttons.length > 0 || vm.permissions.delete\\\">Acciones</th><th ng-repeat=\\\"header in vm.headers\\\" md-column ng-if=\\\"$index > 0 && !vm.idShow[header.name]\\\" md-order-by=\\\"{{header.order ? header.name : \\'\\'}}\\\"><span ng-if=!vm.estadoChecks>{{header.title}}</span> <span ng-if=vm.estadoChecks><span ng-if=\\\"header.name==\\'estado\\'\\\"><md-input-container class=\\\"select-sin-mb select-crud-estado\\\" ng-click=vm.prevent($event)><label>{{header.title}}</label><md-select ng-model=vm.busqueda_estado multiple ng-change=vm.getItems()><md-option ng-value=op.v ng-repeat=\\\"op in vm.estadoOpciones\\\">{{op.t}}</md-option></md-select></md-input-container></span><span ng-if=\\\"header.name!=\\'estado\\'\\\">{{header.title}}</span></span></th><th md-column ng-if=vm.informacionBienes>Bienes</th></tr></thead><tbody md-body class=\\\"{{vm.editable ? \\'formly-table-editable\\' : \\'\\'}}\\\"><tr md-row md-select=item ng-repeat=\\\"item in vm.items.data\\\" class=seleccionado><td md-cell ng-if=vm.habilitarSeleccion><md-checkbox class=md-primary ng-model=item.selected ng-click=vm.seleccionando(item)></md-checkbox></td><td md-cell class=\\\"text-center md-table-options\\\" ng-if=\\\"vm.permissions.update || vm.permissions.update || vm.permissions.print || vm.buttons.length > 0 || vm.permissions.delete\\\"><md-button class=\\\"md-icon-button boton-extra\\\" aria-label=Editar ng-click=\\\"vm.edit($event, item)\\\" ng-if=\\\"vm.permissions.update && !vm.editable\\\"><md-tooltip>Editar</md-tooltip><md-icon>mode_edit</md-icon></md-button><md-button class=\\\"md-icon-button boton-extra\\\" aria-label=Editar ng-click=vm.save(item) ng-if=\\\"vm.permissions.update && vm.editable\\\"><md-tooltip>Guardar registro</md-tooltip><md-icon>check</md-icon></md-button><md-button class=\\\"md-icon-button boton-extra\\\" aria-label=Editar ng-click=\\\"vm.print($event, item)\\\" ng-if=vm.permissions.print><md-tooltip>Imprimir</md-tooltip><md-icon>print</md-icon></md-button><span ng-repeat=\\\"button in vm.buttons\\\"><span ng-if=button.multiple><span ng-if=button.opcion[item[button.key_item]]><md-button class=md-icon-button ng-class=\\\"button.opcion[item[button.key_item]].xclass || \\'boton-extra\\'\\\" aria-label=button.opcion[item[button.key_item]].tooltip ng-click=\\\"vm.buttonEvent($event, item, button.opcion[item[button.key_item]].onclick)\\\"><md-tooltip>{{button.opcion[item[button.key_item]].tooltip}}</md-tooltip><md-icon>{{button.opcion[item[button.key_item]].icon}}</md-icon></md-button></span><span ng-if=\\\"button.opcion[\\'DEFAULT\\'] && !button.opcion[item[button.key_item]]\\\"><md-button class=md-icon-button ng-class=\\\"button.opcion[item[button.key_item]].xclass || \\'boton-extra\\'\\\" aria-label=\\\"button.opcion[\\'DEFAULT\\'].tooltip\\\" ng-click=\\\"vm.buttonEvent($event, item, button.opcion[\\'DEFAULT\\'].onclick)\\\"><md-tooltip ng-if=\\\"button.opcion[\\'DEFAULT\\'].tooltip\\\">{{button.opcion[\\'DEFAULT\\'].tooltip}}</md-tooltip><md-icon>{{button.opcion[\\'DEFAULT\\'].icon}}</md-icon></md-button></span></span><md-button class=\\\"md-icon-button boton-extra\\\" aria-label=button.tooltip ng-click=\\\"vm.buttonEvent($event, item, button.onclick)\\\" ng-if=\\\"!button.multiple && !button.tipo\\\"><md-tooltip>{{button.tooltip}}</md-tooltip><md-icon>{{button.icon}}</md-icon></md-button><md-button class=\\\"md-icon-button (item[button.campo]==true?\\'icono-activo\\':\\'\\')\\\" aria-label=button.tooltip ng-click=\\\"vm.buttonEvent($event, item, button.onclick)\\\" ng-if=\\\"!button.multiple && button.tipo==\\'icon\\'\\\"><md-icon>{{button.icon}}</md-icon></md-button>{{item[button.campo]}}</span><md-button class=\\\"md-icon-button boton-eliminar\\\" aria-label=Eliminar ng-click=\\\"vm.delete($event, item)\\\" ng-if=\\\"vm.permissions.delete && !item.id_documento\\\"><md-tooltip>Eliminar</md-tooltip><md-icon>delete</md-icon></md-button><md-button class=\\\"md-icon-button boton-eliminar\\\" aria-label=Eliminar ng-click=\\\"vm.delete($event, item)\\\" ng-if=\\\"vm.permissions.delete && item.id_documento && (item.estado==\\'NUEVO\\' || item.estado==\\'RECHAZADO\\')\\\"><md-tooltip>Eliminar</md-tooltip><md-icon>delete</md-icon></md-button><md-button class=md-icon-button aria-label=\\\"\\\" ng-if=\\\"vm.permissions.delete && item.id_documento && (item.estado!=\\'NUEVO\\' && item.estado!=\\'RECHAZADO\\')\\\"><md-icon></md-icon></md-button></td><td md-cell ng-repeat=\\\"(key, value) in item\\\" ng-if=\\\"$index > 0 && !vm.idShow[key] && key !== \\'selected\\' \\\"><div ng-if=vm.editable><div ng-switch on=vm.types[key].type><div ng-switch-when=input><md-input-container><label>{{vm.types[key].templateOptions.label}}</label><input ng-model=vm.dataGrid[value]></md-input-container></div><div ng-switch-when=textarea><md-input-container><label>{{vm.types[key].templateOptions.label}}</label><textarea ng-model=vm.dataGrid[value]></textarea></md-input-container></div><div ng-switch-when=select><md-input-container><md-select ng-model=vm.dataGrid[value]><label>{{vm.types[key].templateOptions.label}}</label><md-option ng-repeat=\\\"option in vm.types[key].templateOptions.options\\\" value={{option.value}}>{{option.name}}</md-option></md-select></md-input-container></div><div ng-switch-when=checkbox><md-checkbox ng-model=vm.dataGrid[value] aria-label={{vm.types[key].templateOptions.label}}></md-checkbox></div><div ng-switch-when=datepicker><md-datepicker ng-model=vm.dataGrid[value] md-placeholder={{vm.types[key].templateOptions.label}}></md-datepicker></div><div ng-switch-default>{{value}}</div></div></div><div ng-if=!vm.editable><div ng-switch on=value><div ng-switch-when=check_circle_success><md-icon class=bg-success>check_circle</md-icon></div><div ng-switch-when=check_circle_gray><md-icon class=bg-gray>check_circle</md-icon></div><div ng-switch-default><div ng-if=\\\"key.indexOf(\\'fecha\\') != -1\\\">{{value|date:\\'dd/MM/yyyy\\'}}</div><div ng-if=\\\"key.indexOf(\\'fid_\\') == 0\\\">{{vm.fieldsData[vm.fields.indexOf(key)].templateOptions.fkeys[value] || value}}</div><div ng-if=\\\"key.indexOf(\\'fecha\\') == -1 && key.indexOf(\\'fid_\\') != 0\\\"><div ng-if=\\\"!vm.estadoSw || (vm.estadoSw && key!=\\'estado\\' && key!=\\'impreso\\' )\\\"><span ng-if=\\\"vm.sw_cite && key==\\'nombre\\'\\\">{{value}}<tooltip doc=item></tooltip></span><div ng-if=\\\"!vm.sw_cite || key!=\\'nombre\\'\\\">{{value}}</div></div><div ng-if=\\\"vm.estadoSw && key==\\'estado\\'\\\"><md-switch ng-true-value=\\\"\\'ACTIVO\\'\\\" ng-false-value=\\\"\\'INACTIVO\\'\\\" ng-model=item.estado aria-label=estado ng-change=vm.estadoModificado(item)></md-switch></div><div ng-if=\\\"vm.estadoSw && key==\\'impreso\\'\\\"><md-switch ng-true-value=\\\"\\'SI\\'\\\" ng-false-value=\\\"\\'NO\\'\\\" ng-model=item.impreso aria-label=impreso ng-change=vm.estadoModificado(item)></md-switch></div></div></div></div></div></td></tr></tbody></table></md-table-container><md-table-pagination md-label=\\\"{page: \\'Página:\\', rowsPerPage: \\'Filas por página:\\', of: \\'de\\'}\\\" md-limit=vm.query.limit md-limit-options=vm.limitOptions md-page=vm.query.page md-total={{vm.items.count}} md-page-select=vm.options.pageSelect md-boundary-links=vm.options.boundaryLinks md-on-paginate=vm.getItems></md-table-pagination></md-card-content></md-card>\");\n$templateCache.put(\"app/components/crudTable/dialog.crudTable.html\",\"<md-dialog aria-label=Agregar/Editar ng-cloak class=\\\"formly-dialog formly-column-{{column}}\\\"><form ng-submit=\\\"answer(\\'save\\')\\\" id=data-form name=form novalidate><md-toolbar><div class=md-toolbar-tools><h2>{{title}}</h2><span flex></span><md-button class=\\\"md-icon-button md-toast-button-close\\\" ng-click=cancel()><md-icon aria-label=\\\"Close dialog\\\">close</md-icon></md-button></div></md-toolbar><md-dialog-content><div class=md-dialog-content><md-content layout-gt-sm=column layout-padding class=formly><formly-form model=data fields=fields options=options form=form></formly-form></md-content></div></md-dialog-content><md-dialog-actions layout=row><span flex></span><md-button class=md-raised ng-click=cancel()><md-icon>cancel</md-icon>Cancelar</md-button><md-button type=submit class=\\\"md-raised md-primary\\\" ng-disabled=form.$invalid><md-icon>check</md-icon>Guardar</md-button></md-dialog-actions></form></md-dialog>\");\n$templateCache.put(\"app/components/crudTable/dialog.pdf.html\",\"<md-dialog aria-label=Imprimir ng-cloak class=\\\"formly-dialog formly-column-{{column}}\\\" style=\\\"width: 960px\\\"><md-toolbar><div class=md-toolbar-tools><h2>{{title}}</h2><span flex></span><md-button class=\\\"md-icon-button md-toast-button-close\\\" ng-click=cancel()><md-icon aria-label=\\\"Close dialog\\\">close</md-icon></md-button></div></md-toolbar><md-dialog-content><iframe src={{data}} style=\\\"width:100%; height:600px; border: none\\\" id=iframe-pdf-crud></iframe></md-dialog-content></md-dialog>\");\n$templateCache.put(\"app/components/documentoIdentidad/documentoIdentidad.html\",\"<div class=doc-identidad><md-input-container class=doc-identidad-tipo ng-if=\\\"vm.onlyCi === undefined || !vm.onlyCi\\\"><label>Tipo de documento</label><md-select ng-model=vm.tipo_documento required ng-disabled=vm.ngDisabled><md-option ng-repeat=\\\"option in vm.tipos\\\" value={{option.value}}>{{option.name}}</md-option></md-select></md-input-container><div class=\\\"alert alert-info doc-identidad-cedula-info\\\" ng-class=\\\"{display: vm.onlyCi}\\\" ng-if=\\\"vm.tipo_documento == \\'CI\\' && !vm.ngDisabled\\\"><md-icon>info_outline</md-icon>Ingrese número de documento, complemento y fecha de nacimiento para su búsqueda.</div><div layout=row class=form-horizontal><md-input-container><label>Número de documento</label><input ng-model=vm.nro_documento required ng-disabled=vm.ngDisabled></md-input-container><md-input-container ng-if=\\\"vm.tipo_documento == \\'CI\\'\\\"><label>Complemento</label><input ng-model=vm.complemento ng-disabled=vm.ngDisabled></md-input-container><md-select-date ng-model=vm.fecha_nacimiento ng-label=\\\"Fecha de nacimiento:\\\" ng-disabled=vm.ngDisabled ng-required=true></md-select-date><md-button class=\\\"md-raised md-primary doc-identidad-button\\\" ng-click=vm.search() ng-disabled=vm.isDisabled() ng-if=\\\"!vm.ngDisabled && vm.tipo_documento == \\'CI\\'\\\"><md-icon>search</md-icon>Buscar</md-button></div></div>\");\n$templateCache.put(\"app/components/menuCard/menuCard.html\",\"<md-card><md-toolbar class=md-table-toolbar ng-show=true><div class=md-toolbar-tools><md-icon>grid_on</md-icon><span>{{vm.titleTable}}</span><div flex></div><md-button class=\\\"md-icon-button btn-collapsed\\\"><md-tooltip>Ocultar/Ver</md-tooltip><md-icon>keyboard_arrow_down</md-icon></md-button></div></md-toolbar><md-card-content><div class=menuCard-list ng-repeat=\\\"item in vm.items\\\"><h4 class=menuCard-titulo ng-click=\\\"item.show=!item.show\\\">{{item.name}}</h4><div class=menuCard-animated-hide ng-if=!item.show layout=row layout-padding layout-fill layout-wrap ng-cloak><a class=menuCard-link ng-repeat=\\\"xitem in item.data\\\" ng-href=#/{{xitem.url}}><md-whiteframe md-whiteframe={{height}} layout layout-align=\\\"center center\\\" ng-init=\\\"height = 1\\\" ng-mouseenter=\\\"height = 3\\\" ng-mouseleave=\\\"height = 1\\\"><div layout=column layout-align=\\\"center center\\\"><md-icon class=md-display-3>{{xitem.icono || \\'details\\'}}</md-icon><span class=text-center>{{xitem.name}}</span></div></md-whiteframe></a></div></div></md-card-content></md-card>\");\n$templateCache.put(\"app/components/navbar/navbar.html\",\"<md-toolbar><div class=md-toolbar-tools><md-button class=md-icon-button ng-click=vm.toggle() aria-label=\\\"Menu collapse\\\" show-gt-md><md-tooltip>Mostrar/ocultar menú</md-tooltip><i class=md-icon>menu</i></md-button><!-- <span class=\\\"navbar-user-name\\\" flex>{{vm.getFirstName()}}</span> --> <span flex></span><md-button class=\\\"margin-0 md-icon-button btn-fullscreen\\\" ng-click=vm.fullscreen() aria-label=Fullscreen show-gt-md id=btn-fullscreen><md-icon>fullscreen</md-icon><md-icon>fullscreen_exit</md-icon><md-tooltip class=tooltip-fullscreen><span class=exit>Salir </span>Pantalla completa</md-tooltip></md-button><md-menu><!-- <md-button aria-label=\\\"interactions menu\\\" class=\\\"md-icon-button navbar-user-icon bg-{{vm.getColor()}}-user\\\" ng-click=\\\"vm.openMenu($mdOpenMenu, $event)\\\">\\n                {{vm.getInitial()}}\\n            </md-button> --><md-button class=\\\"margin-0 md-icon-button\\\" aria-label=Más ng-click=\\\"vm.openMenu($mdOpenMenu, $event)\\\"><md-tooltip>Más opciones</md-tooltip><md-icon>more_vert</md-icon></md-button><md-menu-content class=navbar-options><md-menu-item><md-button ng-click=vm.profile()><i class=md-icon>account_circle</i> Mi cuenta</md-button></md-menu-item><md-menu-item><md-button ng-click=vm.cambiarUsuario()><i class=md-icon>refresh</i> Cambio de usuario</md-button></md-menu-item><!-- <md-menu-divider></md-menu-divider> --><md-menu-item style=\\\"width: 200px\\\"><md-button ng-click=vm.logout()><i class=md-icon>power_setting_new</i> Salir</md-button></md-menu-item></md-menu-content></md-menu><md-button class=md-icon-button aria-label=More style=\\\"display: none\\\"><i class=md-icon>more_vert</i></md-button></div></md-toolbar>\");\n$templateCache.put(\"app/components/paletteFormly/paletteFormly.html\",\"<div class=component-palette-formly md-autofocus><div class=md-accordion ng-repeat=\\\"data in vm.elementos\\\"><div class=header-accordion ng-click=\\\"data.expanded = !data.expanded\\\"><div layout layout-align=\\\"center center\\\"><span class=titulo>{{ data.titulo }}</span> <span flex=\\\"\\\"></span> <span ng-class=\\\"{expandCollapse:true, active: data.expanded}\\\"></span><!-- <md-icon ng-class=\\\"{expandCollapse2:true, active: data.expanded}\\\">keyboard_arrow_down</md-icon> --></div></div><div class=body-accordion ng-class=\\\"{dataContent:true, activeContent:data.expanded}\\\"><md-list-item class=submenu ng-repeat=\\\"item in data.submenu\\\"><div class=md-list-item-text layout=column flex dnd-draggable=item.tipo dnd-effect-allowed=move><div>{{ item.name }}</div></div><md-button class=\\\"md-fab md-primary md-mini button-mini\\\" ng-click=vm.addItem(item.tipo)><md-tooltip>Añadir {{ item.name }}</md-tooltip><md-icon>add</md-icon></md-button></md-list-item></div></div></div>\");\n$templateCache.put(\"app/components/selectDate/selectDate.html\",\"<div layout=row class=select-date><label>{{vm.ngLabel}}:</label><md-input-container><label>Día</label><md-select ng-model=vm.day ng-required=vm.ngRequired ng-disabled=vm.ngDisabled><md-option ng-repeat=\\\"option in vm.days\\\" value={{option.value}}>{{option.name}}</md-option></md-select></md-input-container><md-input-container><label>Mes</label><md-select ng-model=vm.month ng-required=vm.ngRequired ng-disabled=vm.ngDisabled><md-option ng-repeat=\\\"option in vm.months\\\" value={{option.value}}>{{option.name}}</md-option></md-select></md-input-container><md-input-container><label>Año</label><md-select ng-model=vm.year ng-required=vm.ngRequired ng-disabled=vm.ngDisabled><md-option ng-repeat=\\\"option in vm.years\\\" value={{option.value}}>{{option.name}}</md-option></md-select></md-input-container></div>\");\n$templateCache.put(\"app/components/sidenav/sidenav.html\",\"<md-sidenav class=md-sidenav-left md-component-id=left md-is-locked-open=\\\"$mdMedia(\\'gt-sm\\')\\\" id=sidenav><md-toolbar class=sidenav-title><h1 class=md-toolbar-tools><i class=\\\"md-icon sidenav-title-icon\\\">description</i> <span class=sidenav-title-text>PLANTILLAS</span></h1></md-toolbar><div class=sidenav-user><figure><img class=sidenav-user-photo src=\\\"\\\" alt=\\\"Image User\\\" hidden><div class=\\\"sidenav-user-default bg-{{vm.getColor()}}-user\\\"><!-- <i class=\\\"md-icon\\\">account_circle</i> --> {{vm.getInitial()}}</div></figure><h2 class=sidenav-user-name>{{vm.getName()}}<md-tooltip md-direction=bottom>{{vm.getName()}}</md-tooltip></h2><div class=sidenav-user-item>{{vm.getEmail()}}</div></div><ul class=sidenav-list><li ng-repeat=\\\"opcion in vm.getMenu()\\\"><md-button type=button class=\\\"md-button-toggle md-button md-button md-ink-ripple\\\" ng-click=\\\"vm.send(opcion.url, opcion.submenu.length)\\\"><i class=\\\"md-icon md-icon-option\\\">{{opcion.icon}}</i> <span class=md-icon-text>{{opcion.label}}</span> <i class=\\\"md-icon md-icon-arrow-down\\\" ng-if=opcion.submenu.length>keyboard_arrow_down</i></md-button><ul class=sidenav-sublist ng-if=opcion.submenu.length><li ng-repeat=\\\"sub in opcion.submenu\\\"><md-button type=button class=\\\"md-button md-button md-ink-ripple md-button-href {{vm.active == sub.url ? \\'active\\' : \\'\\'}}\\\" data-url={{sub.url}} ng-click=vm.send(sub.url)><span class=md-icon-text>{{sub.label}}</span></md-button></li></ul></li></ul></md-sidenav><md-button ng-click=vm.toggleLeft() class=md-icon-button hide-gt-md><i class=md-icon>menu</i></md-button>\");\n$templateCache.put(\"app/components/visorImagenes/visorImagenes.dialog.html\",\"<md-dialog aria-label=Ver/Editar ng-cloak class=\\\"formly-dialog formly-column-{{column}}\\\"><md-dialog-content class=md-dialog-content><div flex layout=row><img ng-src={{data}}></div></md-dialog-content></md-dialog>\");\n$templateCache.put(\"app/components/visorImagenes/visorImagenes.html\",\"<div layout=row layout-wrap ng-if=\\\"vm.imagenes.length > 0\\\"><div flex><h4>{{vm.titulo}}</h4><span ng-repeat=\\\"item in vm.imagenes\\\"><div class=contenedor-miniatura><img src={{vm.restUrl}}{{item.ruta}} alt={{item.nombre_publico}} class=miniatura style=\\\"width:{{vm.ancho}}px; height:{{vm.alto}}px\\\" ng-click=\\\"vm.mostrarImagen(vm.restUrl + item.ruta)\\\"><br><md-button class=\\\"md-icon-button md-accent md-very-small\\\" aria-label=Eliminar ng-click=vm.eliminarImagen(item) ng-if=vm.eliminar><md-icon class=md-very-small>delete</md-icon></md-button></div></span></div></div>\");\n$templateCache.put(\"app/factories/Documento/dialog.progreso.html\",\"<md-dialog aria-label=\\\"Ver progreso\\\" class=\\\"formly-dialog formly-column-{{column}} dialog-progreso\\\" style=\\\"max-width: 800px; width: 100%\\\"><md-toolbar><div class=md-toolbar-tools><h2><md-icon>dashboard</md-icon>Progreso del documento</h2><span flex></span><md-button class=md-icon-button aria-label=Cerrar ng-click=cerrar()><md-tooltip>Cerrar</md-tooltip><md-icon aria-label=\\\"Close dialog\\\">close</md-icon></md-button></div></md-toolbar><md-dialog-content class=md-dialog-content><timeline><timeline-event ng-repeat=\\\"it in data.datos\\\"><timeline-badge class=bg-{{it.bg_color}}><md-icon aria-label=description>{{it.icon}}</md-icon><md-tooltip>{{it.acc}}</md-tooltip></timeline-badge><timeline-panel ng-if=\\\"it.accion !== \\'ANULADO\\'\\\"><timeline-heading><h3>{{it.nombres}}</h3></timeline-heading><p><span class=ap-text-{{it.bg_color}}>{{it.acc}} {{it.acc==\\'Sin respuesta\\'? \\'desde \\': \\'\\'}} </span>el {{it.fecha_mos}} a las {{it.hora_mos}}</p><p ng-if=\\\"it.accion==\\'DERIVADO\\' && it.derivado\\\">A: <strong>{{it.derivado.nombres}}</strong></p><p ng-if=it.tipo_doc>Documento: {{it.tipo_doc}}</p><p ng-if=it.cite>CITE: <span class=ap-cursor-pointer ng-click=verDocumento(it.id_documento)>{{it.cite}}</span></p><p ng-if=\\\"it.accion==\\'RECHAZADO\\'\\\">{{it.observacion}}</p><p ng-if=\\\"it.accion==\\'DERIVADO\\'\\\">Proveído: {{it.observacion}}</p></timeline-panel><timeline-panel ng-if=\\\"it.accion==\\'ANULADO\\'\\\"><timeline-heading><h3>Anulación</h3></timeline-heading><p><strong>Del documento: </strong><span class=\\\"ap-text-{{it.bg_color}} ap-cursor-pointer\\\" ng-click=verDocumento(it.id_documento)>{{it.cite}}.</span><br><strong>Mediante: </strong><span class=ap-cursor-pointer ng-click=verDocumento(it.id_documento)>{{it.observacion}}.</span><br>El cual fue solicitado por <strong>{{it.nombres}}</strong> y aprobado por <strong>{{it.aprobado.nombres}}</strong> el {{it.fecha_mos}} a las {{it.hora_mos}}</p></timeline-panel></timeline-event></timeline></md-dialog-content><md-dialog-actions><div flex></div><md-button class=md-raised ng-click=cerrar()><md-icon>check</md-icon><span>Cerrar</span></md-button></md-dialog-actions></md-dialog>\");\n$templateCache.put(\"app/factories/Documento/dialogPDF.html\",\"<md-dialog aria-label=\\\"Documento PDF\\\" class=\\\"formly-dialog formly-column-{{column}} dialog-pdf\\\" style=\\\"max-width: 800px; width: 100%\\\"><md-toolbar><div class=md-toolbar-tools><h2><md-icon>picture_as_pdf</md-icon>Vista previa</h2><span flex></span><md-button class=md-icon-button aria-label=\\\"Ver pdf\\\" ng-click=verPdf() ng-show=data.flag_html><md-tooltip>Ver PDF</md-tooltip><md-icon aria-label=\\\"Close dialog\\\">picture_as_pdf</md-icon></md-button><md-button class=md-icon-button aria-label=\\\"Ver html\\\" ng-click=verHtml() ng-show=!data.flag_html><md-tooltip>Ver html</md-tooltip><md-icon aria-label=\\\"Close dialog\\\">code</md-icon></md-button><md-button class=md-icon-button aria-label=Cerrar ng-click=cerrar()><md-tooltip>Cerrar</md-tooltip><md-icon aria-label=\\\"Close dialog\\\">close</md-icon></md-button></div></md-toolbar><div class=dialog-firmas><div ng-repeat=\\\"(indice, item) in data.firmas\\\" class=\\\"{{(item.firmo===true?\\'firmado\\':\\'sin-firma\\')}}\\\">{{item.firmante}}<md-tooltip>{{item.firmante}}</md-tooltip></div></div><md-dialog-content class=md-dialog-content><div ng-show=data.flag_html bind-html-compile=data.html></div><iframe class=iframe-pdf src={{data.pdf}} style=\\\"width:100%; height:600px; border: none\\\" ng-if=\\\"data.show_pdf && !data.flag_html\\\" allowfullscreen></iframe><div id=canvasContainer ng-show=!data.flag_html></div></md-dialog-content><md-dialog-actions><span flex></span><md-button class=md-raised ng-click=cerrar()><md-icon>cancel</md-icon>Cancelar</md-button></md-dialog-actions></md-dialog>\");\n$templateCache.put(\"app/factories/Loading/Loading.html\",\"<md-dialog class=\\\"{{data.tipo || \\'loader-info\\' }} loader-padre\\\"><md-dialog-content><center><div class=loader-contenendor><div class=loader></div></div><p></p><h2>{{data.mensaje}}</h2><p></p></center></md-dialog-content></md-dialog>\");\n$templateCache.put(\"app/factories/Messages/layout.toast.html\",\"<md-toast class=md-toast-{{type}}><div class=md-toast-title><md-icon class=md-toast-icon>{{icon}}</md-icon>{{title}}<md-button class=\\\"md-toast-close md-icon-button\\\" aria-label=Close><md-icon class=md-icon>close</md-icon></md-button></div><div class=md-toast-message ng-bind-html=message></div></md-toast>\");\n$templateCache.put(\"app/factories/Panel/defaultPanelTemplate.html\",\"<md-card><md-content>Usando panel factory, introduzca su template</md-content></md-card>\");\n$templateCache.put(\"app/modules/dashboard/main.html\",\"<div class=container>Mi dashboard</div>\");\n$templateCache.put(\"app/modules/firmador/modules.firmador.html\",\"<md-dialog aria-label=\\\"Firmar Digitalmente\\\" class=\\\"formly-dialog formly-column-{{column}}\\\" style=\\\"max-width: 700px; width: 100%\\\"><md-toolbar><div class=md-toolbar-tools><h2><md-icon>done_all</md-icon>Firmar documentos</h2><span flex></span></div></md-toolbar><md-dialog-content class=md-dialog-content><div ng-if=\\\"iniciado === false\\\">Iniciando...</div><div ng-if=\\\"iniciado === true\\\"><div ng-if=!demofi_ejecutandose class=\\\"alert alert-warning\\\" ng-if=\\\"data.certificado === null\\\"><i class=\\\"fa fa-warning\\\"></i> <span>Demofi no se está ejecutando en su equipo o no tiene agregado el certificado de seguridad en su navegador.</span><br><ul><li><span>Visite el siguiente enlace para su instalación y/o configuración. Presione <a target=_blank href=http://test.local.agetic.gob.bo/firmador/#>aquí</a>.<help message=helpMessage.demofi_no_instalado></help></span></li><li><span>Para verificar que el certificado de seguridad de Demofi se encuentra instalado. Presione <a href=# ng-click=verificarServidor()>aquí</a>.</span></li></ul></div></div><div layout=row ng-if=demofi_ejecutandose><div flex layout-align=\\\"center center\\\"><img class=img-certificado src=assets/images/certificate.png></div><div flex=66><br><div ng-if=demofi_ejecutandose><span style=\\\"font-weight: bold\\\">TOKEN: </span><span ng-if=\\\"tokens.length == 0\\\">Conecte su token </span><span ng-repeat=\\\"tokenName in tokens\\\"><span>{{tokenName}}</span></span></div><br><div flex-gt-xs><md-input-container><label>PIN:</label><md-icon>vpn_key</md-icon><input name=pin type=password class=form-control ng-model=formData.pin ng-disabled=!token_conectado required></md-input-container><md-button class=\\\"md-raised md-primary\\\" ng-click=autenticar() ng-disabled=\\\"!token_conectado || autenticado \\\"><md-icon>verified_user</md-icon>Autenticar</md-button></div><md-input-container><label>CERTIFICADO DIGITAL:</label><md-icon>content_copy</md-icon><md-select ng-model=formData.certificado_seleccionado required ng-disabled=!autenticado><md-option ng-repeat=\\\"(index, cer) in certificados\\\" value={{cer}} ng-select=\\\"index == 1 && formData.uniqueValue\\\">{{cer.nombreComunSubject}}</md-option></md-select></md-input-container></div></div><h4 ng-if=\\\"documentosParaFirmar.length > 0\\\">Se firmarán los siguientes documentos:</h4><h4 ng-if=\\\"documentosParaFirmar.length == 0\\\">No se seleccionaron documentos para firmar</h4><span class=\\\"chip {{yaFirmo ? doc.class : \\'enCola\\'}}\\\" ng-repeat=\\\"doc in documentosParaFirmar\\\">{{doc.nombre}}</span><h4 ng-if=\\\"yaFirmo ==true\\\">Se firmaron <strong>{{firmados}}</strong> documentos de <strong>{{documentosParaFirmar.length}}</strong>.</h4></md-dialog-content><md-dialog-actions><div flex></div><md-button class=\\\"md-raised md-secondary\\\" ng-click=cancelar()><md-icon>cancel</md-icon><span>{{yaFirmo==true? \\'Listo\\': \\'Cancelar\\'}}</span></md-button><md-button class=\\\"md-raised md-primary\\\" ng-click=firmar() ng-disabled=\\\"(documentosParaFirmar.length == 0) || !token_conectado|| !autenticado || yaFirmo\\\"><md-icon>check</md-icon><span>Firmar</span></md-button></md-dialog-actions></md-dialog>\");\n$templateCache.put(\"app/modules/verificacion/modules.verificar.html\",\"<div class=container><div class=logo-agetic><img src=assets/images/logo.png class=text-button alt=AGETIC ng-click=verificar.irInicio()></div><md-card><md-tabs class=\\\"md-accent verificar-contenedor {{(verificar.datosDocumento?\\'ampliar\\':\\'\\')}}\\\" md-align-tabs=top md-selected=verificar.data.selectedIndex><md-tab name=verificar><md-tab-label><strong>Verificar</strong></md-tab-label><md-tab-body><md-button class=\\\"md-fab md-mini md-icon-button md-primary\\\" aria-label=home ng-click=verificar.irInicio()><md-icon>home</md-icon><md-tooltip>Volver al inicio</md-tooltip></md-button><form name=form ng-submit=verificar.buscar()><div class=md-padding layout layout-xs=column layout-align=center><md-input-container><label>Cite</label><input ng-model=verificar.datos.cite required></md-input-container><md-input-container><label>Codigo</label><input ng-model=verificar.datos.codigo required></md-input-container><center><md-button type=submit class=\\\"md-raised md-primary\\\" ng-disabled=form.$invalid>Verificar documento</md-button></center></div></form><div ng-if=verificar.datosDocumento layout layout-sm=column layout-xs=column class=visor-verificado flex-direction-sm=column><md-card flex-sm=50 flex-gt-sm=100 flex-gt-md=30 layout=row layout-sm layout-xs=4 layout-align=\\\"center center\\\"><section style=\\\"width:100%; height:100%\\\" ng-if=verificar.datosDocumento><md-toolbar class=\\\"md-hue-2 titulo-seccion-verificar\\\" layout-align=\\\"center center\\\"><div layout=row class=md-headline><h2 class=md-toolbar-tools><span md-colors=\\\"background: primary\\\">Firmantes del documento</span></h2></div></md-toolbar><md-list layout-padding class=lista-firmantes><md-list-item class=md-2-line ng-repeat=\\\"usuario in verificar.datosDocumento.firmantes\\\"><md-icon class=\\\"md-48 md-primary\\\">fingerprint</md-icon><div class=md-list-item-text><h3>{{usuario.firmante}}</h3><!-- <p>{{usuario.fechaFirma || \\'Fecha y hora no disponible\\'}}</p> --></div><md-divider md-inset hide-sm></md-divider><md-divider hide-gt-sm></md-divider></md-list-item></md-list></section></md-card><md-card flex-sm=50 flex-gt-sm=100 flex-gt-md=70 layout layout-align=\\\"center center\\\" layout-xs=4><section style=\\\"width:100%; height:100%\\\"><md-toolbar class=\\\"md-hue-2 titulo-seccion-verificar\\\" layout-align=\\\"center center\\\"><div layout=row class=md-headline><h2 class=md-toolbar-tools><span class=titulo-card-verificar>Documento firmado digitalmente {{verificar.esMovil}}</span></h2></div></md-toolbar><iframe ng-if=\\\"verificar.pdf && (verificar.esMovil==false || !verificar.esMovil)\\\" class=iframe-verificado-pdf src={{verificar.pdf}} allowfullscreen></iframe><div ng-if=\\\"verificar.pdf && verificar.esMovil==true\\\" id=canvasContainerVerificado></div></section></md-card></div></md-tab-body></md-tab><!-- <md-tab name=\\\"historial\\\">\\n        <md-tab-label>\\n          Historial\\n        </md-tab-label>\\n        <md-tab-body>\\n          historial de mis verificaciones\\n        </md-tab-body>\\n      </md-tab> --></md-tabs></md-card></div>\");\n$templateCache.put(\"app/components/formlyComponents/archivo/archivo.html\",\"<div ng-if=!to.multiple><md-button class=\\\"md-raised md-warn\\\" ng-click=vm.elegirPdf($event) ng-if=!model[options.key]>{{to.label}}</md-button><input ng-show=false type=file ng-model=model[options.key] base-sixty-four-input accept=.pdf on-after-validate=vm.onLoadModel><div ng-if=model[options.key]>Documento: {{ model[options.key].filename}} Peso: {{ vm.redondear(model[options.key].filesize/1024, 2)}} kb<md-icon ng-click=vm.showPdf(model[options.key].url) class=ap-cursor-pointer ng-if=model[options.key].url>picture_as_pdf<md-tooltip>Ver pdf</md-tooltip></md-icon><md-icon class=\\\"ap-text-warning ap-cursor-pointer\\\" ng-click=vm.limpiarPdf() ng-if=!to.disabled>delete<md-tooltip>Eliminar</md-tooltip></md-icon><br></div></div><div ng-if=to.multiple><md-button class=\\\"md-raised md-warn\\\" ng-click=vm.elegirPdf($event)>{{to.label}}</md-button><input ng-show=false type=file ng-model=model[options.key] base-sixty-four-input accept=.pdf on-after-validate=vm.onLoadModel multiple><div ng-repeat=\\\"pdf in model[options.key]\\\">Documento: {{ pdf.filename}} Peso: {{ vm.redondear(pdf.filesize/1024, 2)}} kb<md-icon ng-click=vm.showPdf(pdf.url) class=ap-cursor-pointer ng-if=pdf.url>picture_as_pdf<md-tooltip>Ver pdf</md-tooltip></md-icon><md-icon class=\\\"ap-text-warning ap-cursor-pointer\\\" ng-click=vm.limpiarPdf($index) ng-if=!to.disabled>delete</md-icon></div></div>\");\n$templateCache.put(\"app/components/formlyComponents/cajachica/cajachica.html\",\"<ng-form name=cajaChicaForm><div layout layout-align=\\\"start center\\\"><md-button class=\\\"md-fab md-mini md-icon-button md-primary\\\" aria-label=add ng-click=vm.addRow(model[options.key].tipo,1) ng-if=\\\"!to.disabled && model[options.key].tipo!=\\'PAGADO\\'\\\"><md-icon>add</md-icon><md-tooltip>Agregar fila</md-tooltip></md-button><md-autocomplete ng-if=\\\"!to.disabled && model[options.key].tipo==\\'PAGADO\\'\\\" flex=40 md-no-cache=true md-selected-item=vm.buscar.doc_seleccionado md-search-text=vm.buscar.doc md-items=\\\"item in vm.buscarDocumentos(vm.buscar.doc)\\\" md-selected-item-change=vm.cargarPartidas(item.nombre) md-item-text=item.nombre md-min-length=0 placeholder=\\\"Seleccione un cite para añadir\\\"><md-item-template><span>{{item.nombre}}</span></md-item-template><md-not-found>Escriba un cite válido.</md-not-found></md-autocomplete><md-autocomplete ng-if=\\\"(model[options.key].tipo==\\'COMPROMETIDO\\' || model[options.key].tipo==\\'MODIFICADO\\') && !to.disabled\\\" flex=40 md-no-cache=true md-selected-item=vm.buscar.par_seleccionado md-search-text=vm.buscar.par md-items=\\\"item in vm.buscarPartidas(vm.buscar.par)\\\" md-selected-item-change=vm.addRow(model[options.key].tipo) md-item-text=item.num_des md-min-length=0 ng-disabled=to.disabled placeholder=\\\"Partida ...\\\"><md-item-template><span>{{item.num_des}}</span></md-item-template><md-not-found>No se encontraron coincidencias para \\\"{{vm.buscar.par}}\\\".</md-not-found></md-autocomplete><span flex></span><md-input-container md-no-float flex=25><input type=text placeholder=\\\"Buscar... \\\" ng-model=vm.filter ng-disabled=false></md-input-container><md-input-container ng-if=\\\"to.tipo==\\'GESTION\\'\\\" flex=10><md-select ng-model=model[options.key].tipo ng-change=\\\"model[options.key].rows=[]\\\"><md-option value=INICIAL>INICIAR PARTIDAS</md-option><md-option value=MODIFICADO>MODIFICAR PARTIDAS</md-option></md-select></md-input-container></div><div layout layout-align=\\\"start center\\\" class=alert ng-class=\\\"\\'alert-\\'+vm.alert.tipo\\\" ng-show=vm.alert.show><md-icon>{{vm.alert.icono}}</md-icon><div flex>{{vm.alert.mensaje}}</div><md-icon class=ap-cursor-pointer ng-click=\\\"vm.alert.show=false\\\" ng-if=\\\"vm.alert.time==0\\\">close</md-icon></div><table class=\\\"table table-hover table-striped\\\"><thead><tr><th ng-if=!to.disabled></th><th ng-if=\\\"to.tipo==\\'PAGADO\\'\\\">Cite</th><th>Partida</th><th>{{to.tipo==\\'COMPROMETIDO\\' || to.tipo==\\'PAGADO\\'? \\'Detalle\\':\\'Descripción\\'}}</th><th ng-if=\\\"to.tipo==\\'PAGADO\\'\\\">Comprometido</th><th>{{to.tipo==\\'PAGADO\\'? \\'Pagado\\':\\'Monto\\'}}</th></tr></thead><tbody><tr ng-repeat=\\\"row in model[options.key].rows | filter: vm.filter\\\"><td class=buttons ng-if=!to.disabled layout-gt-sm><span ng-if=\\\"to.tipo==\\'COMPROMETIDO\\'\\\"><md-checkbox ng-model=row.pago_multiple></md-checkbox><md-tooltip>Pagado múltiple</md-tooltip></span><md-button class=md-icon-button aria-label=getSaldo ng-click=vm.deleteRow($index)><md-icon>delete</md-icon><md-tooltip>Eliminar fila</md-tooltip></md-button><md-button class=md-icon-button aria-label=delete ng-click=vm.obtenerSaldo(row.id_comprometido) ng-if=\\\"to.tipo==\\'PAGADO\\' && row.pago_multiple\\\"><md-icon>attach_money</md-icon><md-tooltip>Obtener saldo actual</md-tooltip></md-button></td><td ng-if=\\\"to.tipo==\\'PAGADO\\'\\\"><md-input-container><textarea ng-model=row.cite.nombre disabled></textarea></md-input-container></td><td><md-input-container ng-if=\\\"model[options.key].tipo==\\'INICIAL\\'\\\"><textarea ng-model=row.partida></textarea></md-input-container><md-input-container ng-if=\\\"model[options.key].tipo!=\\'INICIAL\\'\\\"><textarea ng-model=row.partida.num_des disabled></textarea></md-input-container></td><td><md-input-container><textarea ng-model=row.descripcion ng-disabled=\\\"to.tipo==\\'PAGADO\\' || to.disabled\\\"></textarea></md-input-container></td><td ng-if=\\\"to.tipo==\\'PAGADO\\'\\\"><md-input-container><input type=text ng-model=row.comprometido disabled></md-input-container><!-- <div class=\\\"saldo\\\" ng-if=\\\"row.saldo\\\"> Saldo={{row.saldo}} </div> --></td><td><md-input-container><input type=text ng-model=row.monto ng-blur=vm.calcularTotal(row)></md-input-container></td></tr></tbody><tfoot><tr><td ng-if=!to.disabled></td><td ng-if=\\\"to.tipo==\\'PAGADO\\'\\\"></td><td></td><td ng-if=\\\"to.tipo==\\'PAGADO\\'\\\"></td><td>Total</td><td><md-input-container><input type=text ng-model=model[options.key].monto_total disabled></md-input-container></td></tr></tfoot></table></ng-form>\");\n$templateCache.put(\"app/components/formlyComponents/calendario/calendario.html\",\"<div layout layout-align=\\\"start start\\\" class=calendario><div><label flex layout layout-align=\\\"start start\\\">{{to.label}}</label><div><md-input-container flex><md-datepicker ng-model=model[options.key] md-min-date=to.minDate md-max-date=to.maxDate ng-required=to.required md-no-asterisk ng-disabled=to.disabled></md-datepicker><div ng-messages=fc.$error><div ng-message=required>Debe llenar este campo</div><div ng-message=mindate>La fecha no se encuentra en el rango</div><div ng-message=maxdate>La fecha no se encuentra en el rango</div></div></md-input-container></div></div></div>\");\n$templateCache.put(\"app/components/formlyComponents/ccArchivo/ccArchivo.html\",\"<md-input-container class=md-block><textarea ng-model=model[options.key] style=\\\"font-size: 10px; line-height: 11px\\\" rows=1></textarea></md-input-container>\");\n$templateCache.put(\"app/components/formlyComponents/certificacionComprometido/certificacionComprometido.html\",\"<ng-form name=certificacionComprometido><div class=\\\"ap-text-warning ap-text-center\\\" ng-if=!to.showItem>Esta sección no se mostrará en el PDF hasta que se apruebe y se le asigne un \\\"CITE\\\".</div><div class=certificacion-comprometido><h3>{{to.label}}</h3><table class=\\\"table table-hover table-striped\\\"><thead><tr><th>Partida</th><th>Saldo inicial</th><th>Monto comprometido</th><th>Saldo final</th></tr></thead><tbody><tr ng-repeat=\\\"row in model[options.key].rows\\\"><td></td><td></td><td></td><td></td></tr></tbody></table></div></ng-form>\");\n$templateCache.put(\"app/components/formlyComponents/cite/cite.html\",\"<div layout ng-if=\\\"!to.tipoMembrete || to.tipoMembrete==\\'sin membrete\\'\\\"><div flex layout layout-align=\\\"start end\\\" ng-if=\\\"(model[options.key] && model[options.key][\\'cite\\'])\\\">{{ model[options.key][\\'cite\\'] }}</div><div class=placeholder flex layout layout-align=\\\"start end\\\" ng-if=\\\"!(model[options.key] && model[options.key][\\'cite\\'])\\\">{{ to.labelCite }}</div><div flex layout layout-align=\\\"end end\\\" ng-if=\\\"(model[options.key] && model[options.key][\\'fecha\\'])\\\">{{ model[options.key][\\'fecha\\'] }}</div><div class=placeholder flex layout layout-align=\\\"end end\\\" ng-if=\\\"!(model[options.key] && model[options.key][\\'fecha\\'])\\\">{{ to.labelFecha }}</div></div><div ng-if=\\\"to.tipoMembrete==\\'externo\\'\\\"><div flex ng-if=\\\"(model[options.key] && model[options.key][\\'fecha\\'])\\\">{{ model[options.key][\\'fecha\\'] }}</div><div class=placeholder flex ng-if=\\\"!(model[options.key] && model[options.key][\\'fecha\\'])\\\">{{ to.labelFecha }}</div><div flex ng-if=\\\"(model[options.key] && model[options.key][\\'cite\\'])\\\">{{ model[options.key][\\'cite\\'] }}</div><div class=placeholder flex ng-if=\\\"!(model[options.key] && model[options.key][\\'cite\\'])\\\">{{ to.labelCite }}</div></div><br>\");\n$templateCache.put(\"app/components/formlyComponents/documentosAnular/documentosAnular.html\",\"<ng-form name=docsAnular><div layout><div ng-class=\\\"\\'flex-\\'+to.labelw\\\" layout=column><div class=label flex layout layout-align=\\\"start start\\\"><span class=ap-cursor-pointer ng-click=\\\"vm.openSelect($event, \\'doc\\')\\\">{{to.label}} </span>&nbsp;&nbsp;&nbsp;</div><md-input-container class=input-search ng-show=vm.show_doc><label>Documentos</label><md-select ng-model=model[options.key] name=select_anular md-on-close=vm.closeSelectDoc() data-md-container-class=select-search multiple required><md-select-header class=select-header><input ng-model=vm.buscar_doc placeholder=\\\"Buscar ...\\\" class=\\\"header-searchbox md-text\\\"></md-select-header><md-optgroup label=documentos><md-option ng-value=d ng-repeat=\\\"d in vm.documentos\\\">{{d.nombre}}</md-option></md-optgroup></md-select></md-input-container><div flex></div></div><div class=docs flex><div layout layout-wrap><div ng-repeat=\\\"d in model[options.key]\\\"><md-icon class=\\\"ap-cursor-pointer md-mini\\\" ng-click=vm.mostrarPdf(d.id_documento)>description</md-icon><span class=ap-cursor-pointer ng-click=vm.mostrarPdf(d.id_documento)>{{ d.nombre }} {{ ( $index != (model[options.key].length-1) )? \\', \\' : \\'\\' }}</span></div></div><div class=ap-ng-msg ng-messages=docsAnular.select_anular.$error ng-show=\\\"docsAnular.$submitted || docsAnular.select_anular.$touched\\\"><div ng-message=required>Debe escojer al menos un documento para anular</div></div></div></div></ng-form>\");\n$templateCache.put(\"app/components/formlyComponents/datosGenerales/datosGenerales.html\",\"<ng-form name=datosGeneralesForm><div class=\\\"ap-text-warning ap-text-center\\\" ng-if=!to.showItem>Esta sección no se mostrará al imprimir en PDF.</div><div ng-class=\\\"{\\'border-div\\': !to.showItem}\\\"><div layout ng-if=to.show.para><div ng-class=\\\"\\'flex-\\'+to.labelw\\\" layout=column><div class=label flex layout layout-align=\\\"start start\\\"><span class=ap-cursor-pointer ng-click=\\\"vm.openSelect($event, \\'para\\')\\\"><span>PARA:</span></span></div><md-input-container class=input-search ng-show=vm.show_para><label>Usuarios</label><md-select ng-model=\\\"model[options.key][\\'para\\']\\\" name=select_para required md-on-close=\\\"vm.buscar_para=\\'\\'; vm.show_para=false;\\\" data-md-container-class=select-search><md-select-header class=select-header><input ng-model=vm.buscar_para placeholder=\\\"Buscar destinatario ..\\\" class=\\\"header-searchbox md-text\\\"></md-select-header><md-optgroup label=usuarios><md-option ng-value=u ng-repeat=\\\"u in vm.usuarios_jefes | filter:vm.buscar_para\\\">{{ u.nombres+\\' \\'+u.apellidos }}</md-option></md-optgroup></md-select></md-input-container><div flex></div></div><div flex><div>{{ model[options.key][\\'para\\'].nombres+\\' \\'+model[options.key][\\'para\\'].apellidos }}<md-icon class=ap-text-success ng-if=\\\"vm.usuarios_check[model[options.key][\\'para\\'].id_usuario]\\\">check<md-tooltip>Aprobó</md-tooltip></md-icon></div><span>{{ model[options.key][\\'para\\'].cargo }}</span><div class=ap-ng-msg ng-messages=datosGeneralesForm.select_para.$error ng-show=\\\"datosGeneralesForm.$submitted || datosGeneralesForm.select_para.$touched\\\"><div ng-message=required>Debe elegir una opción haciendo click en PARA:</div></div></div></div><div layout ng-if=to.show.via><div ng-class=\\\"\\'flex-\\'+to.labelw\\\" layout=column><div class=label flex layout layout-align=\\\"start start\\\"><span class=ap-cursor-pointer ng-click=\\\"vm.openSelect($event, \\'via\\')\\\"><span>VÍA:</span></span></div><md-input-container class=input-search ng-show=vm.show_via><label>Usuarios</label><md-select ng-model=\\\"model[options.key][\\'via\\']\\\" name=select_via md-on-close=\\\"vm.buscar_via=\\'\\'; vm.show_via=false;\\\" data-md-container-class=select-search multiple><md-select-header class=select-header><input ng-model=vm.buscar_via type=search placeholder=\\\"Buscar ..\\\" class=\\\"header-searchbox md-text\\\"></md-select-header><md-optgroup label=usuarios><md-option ng-value=u ng-repeat=\\\"u in vm.usuarios_jefes | filter:vm.buscar_via\\\">{{ u.nombres+\\' \\'+u.apellidos }}</md-option></md-optgroup></md-select></md-input-container><div flex></div></div><div flex><div ng-repeat=\\\"p in model[options.key][\\'via\\']\\\"><div>{{ p.nombres+\\' \\'+p.apellidos }}<md-icon class=ap-text-success ng-if=vm.usuarios_check[p.id_usuario]>check<md-tooltip>Aprobó</md-tooltip></md-icon></div><span>{{ p.cargo }}<md-icon class=ap-cursor-pointer ng-click=\\\"vm.moverUsuario($index,\\'down\\')\\\" ng-if=\\\" $index!=(model[options.key][\\'via\\'].length-1) && !to.disabled \\\">arrow_downward<md-tooltip>Bajar</md-tooltip></md-icon><md-icon class=ap-cursor-pointer ng-click=\\\"vm.moverUsuario($index,\\'up\\')\\\" ng-if=\\\" $index!=0 && !to.disabled \\\">arrow_upward<md-tooltip>Subir</md-tooltip></md-icon></span></div><div class=ap-ng-msg ng-messages=datosGeneralesForm.select_via.$error ng-show=\\\"datosGeneralesForm.$submitted || datosGeneralesForm.select_via.$touched\\\"><div ng-message=required>Debe elegir una opción haciendo click en VÍA:</div></div></div></div><div layout ng-if=to.show.de><div ng-class=\\\"\\'flex-\\'+to.labelw\\\" layout=column><div class=label flex layout layout-align=\\\"start start\\\"><span class=ap-cursor-pointer ng-click=\\\"vm.openSelect($event, \\'de\\')\\\"><span>DE:</span></span></div><md-input-container class=input-search ng-show=vm.show_de><label>Usuarios</label><md-select ng-model=\\\"model[options.key][\\'de\\']\\\" name=select_de md-on-close=\\\"vm.buscar_de=\\'\\'; vm.show_de=false;\\\" data-md-container-class=select-search multiple required><md-select-header class=select-header><input ng-model=vm.buscar_de type=search placeholder=\\\"Buscar ..\\\" class=\\\"header-searchbox md-text\\\"></md-select-header><md-optgroup label=usuarios><md-option ng-value=u ng-repeat=\\\"u in vm.usuarios | filter:vm.buscar_de\\\">{{ u.nombres+\\' \\'+u.apellidos }}</md-option></md-optgroup></md-select></md-input-container><div flex></div></div><div flex><div ng-repeat=\\\"p in model[options.key][\\'de\\']\\\"><div>{{ p.nombres+\\' \\'+p.apellidos }}</div><span>{{ p.cargo }}</span></div><div class=ap-ng-msg ng-messages=datosGeneralesForm.select_de.$error ng-show=\\\"datosGeneralesForm.$submitted || datosGeneralesForm.select_de.$touched\\\"><div ng-message=required>Debe elegir una opción haciendo click en De:</div></div></div></div><div layout ng-if=to.show.ref><div ng-class=\\\"\\'flex-\\'+to.labelw\\\" layout=column><div class=label flex layout layout-align=\\\"start end\\\"><span>{{to.labelRef}}</span></div><div flex></div></div><div flex><md-input-container style=\\\"width: 100%\\\"><input name=ref ng-model=\\\"model[options.key][\\'ref\\']\\\" required md-no-asterisk><div ng-messages=datosGeneralesForm.ref.$error><div ng-message=required>Debe llenar este campo</div></div></md-input-container></div></div></div><div class=separador></div></ng-form>\");\n$templateCache.put(\"app/components/formlyComponents/documentosRelacionados/documentosRelacionados.html\",\"<ng-form name=docsRelForm><div layout><div ng-class=\\\"\\'flex-\\'+to.labelw\\\" layout=column><div class=label flex layout layout-align=\\\"start start\\\"><span class=ap-cursor-pointer ng-click=\\\"vm.openSelect($event, \\'doc\\')\\\">{{to.label}} </span>&nbsp;&nbsp;&nbsp;</div><md-input-container class=input-search ng-show=vm.show_doc><label>Documentos</label><md-select ng-model=model[options.key] name=select_doc md-on-close=vm.closeSelectDoc() data-md-container-class=select-search multiple><md-select-header class=select-header><input ng-model=vm.buscar_doc placeholder=\\\"Buscar ...\\\" class=\\\"header-searchbox md-text\\\"></md-select-header><md-optgroup label=documentos><md-option ng-value=d ng-repeat=\\\"d in vm.documentos\\\">{{d.nombre}}</md-option></md-optgroup></md-select></md-input-container><div flex></div></div><div class=docs flex><div layout layout-wrap><div ng-repeat=\\\"d in model[options.key]\\\"><md-icon class=\\\"ap-cursor-pointer md-mini\\\" ng-click=vm.mostrarPdf(d.id_documento)>description</md-icon><span class=ap-cursor-pointer ng-click=vm.mostrarPdf(d.id_documento)>{{ d.nombre }} {{ ( $index != (model[options.key].length-1) )? \\', \\' : \\'\\' }}</span></div></div><div class=ap-ng-msg ng-messages=docsRelForm.select_doc.$error ng-show=\\\"docsRelForm.$submitted || docsRelForm.select_doc.$touched\\\"><div ng-message=required>Debe escojer una opción haciendo click en Documentos adjuntos:</div></div></div></div></ng-form>\");\n$templateCache.put(\"app/components/formlyComponents/editorTexto/editorTexto.html\",\"<ng-simditor content=model[options.key] disabled></ng-simditor>\");\n$templateCache.put(\"app/components/formlyComponents/encabezado/encabezado.html\",\"<ng-form name=cabeceraForm><div layout ng-if=to.show.para><div ng-class=\\\"\\'flex-\\'+to.labelw\\\" layout=column><div class=label flex layout layout-align=\\\"start start\\\"><span class=ap-cursor-pointer ng-click=\\\"vm.openSelect($event, \\'para\\')\\\"><span>PARA:</span></span></div><md-input-container class=input-search ng-show=vm.show_para><label>Usuarios</label><md-select ng-model=\\\"model[options.key][\\'para\\']\\\" name=select_para md-on-close=\\\"vm.buscar_para=\\'\\'; vm.show_para=false;\\\" data-md-container-class=select-search multiple><md-select-header class=select-header><input ng-model=vm.buscar_para placeholder=\\\"Buscar destinatario ..\\\" class=\\\"header-searchbox md-text\\\"></md-select-header><md-optgroup label=usuarios><md-option ng-value=u ng-repeat=\\\"u in vm.usuarios_jefes | filter:vm.buscar_para\\\">{{ u.nombres+\\' \\'+u.apellidos }}</md-option></md-optgroup></md-select></md-input-container><div flex></div></div><div flex><div ng-repeat=\\\"p in model[options.key][\\'para\\']\\\" ng-init=\\\"p.mostrar_cargo= (p.mostrar_cargo==undefined)? true : p.mostrar_cargo\\\"><div>{{ p.nombres+\\' \\'+p.apellidos }} <span ng-if=!to.disabled><md-checkbox class=cargo ng-model=p.mostrar_cargo aria-label=cargo></md-checkbox><md-tooltip>{{(p.mostrar_cargo)? \\'Ocultar \\': \\'Mostrar \\'}}cargo</md-tooltip></span><md-icon class=ap-cursor-pointer ng-click=\\\"vm.moverUsuario($index,\\'down\\',\\'para\\')\\\" ng-if=\\\" $index!=(model[options.key][\\'para\\'].length-1) && !to.disabled \\\">arrow_downward<md-tooltip>Bajar</md-tooltip></md-icon><md-icon class=ap-cursor-pointer ng-click=\\\"vm.moverUsuario($index,\\'up\\',\\'para\\')\\\" ng-if=\\\" $index!=0 && !to.disabled \\\">arrow_upward<md-tooltip>Subir</md-tooltip></md-icon></div><span ng-if=p.mostrar_cargo>{{ p.cargo }}</span></div></div></div><div layout ng-if=to.show.via><div ng-class=\\\"\\'flex-\\'+to.labelw\\\" layout=column><div class=label flex layout layout-align=\\\"start start\\\"><span class=ap-cursor-pointer ng-click=\\\"vm.openSelect($event, \\'via\\')\\\"><span>VÍA:</span></span></div><md-input-container class=input-search ng-show=vm.show_via><label>Usuarios</label><md-select ng-model=\\\"model[options.key][\\'via\\']\\\" name=select_via md-on-close=\\\"vm.buscar_via=\\'\\'; vm.show_via=false;\\\" data-md-container-class=select-search multiple><md-select-header class=select-header><input ng-model=vm.buscar_via type=search placeholder=\\\"Buscar ..\\\" class=\\\"header-searchbox md-text\\\"></md-select-header><md-optgroup label=usuarios><md-option ng-value=u ng-repeat=\\\"u in vm.usuarios_jefes | filter:vm.buscar_via\\\">{{ u.nombres+\\' \\'+u.apellidos }}</md-option></md-optgroup></md-select></md-input-container><div flex></div></div><div flex><div ng-repeat=\\\"p in model[options.key][\\'via\\']\\\" ng-init=\\\"p.mostrar_cargo= (p.mostrar_cargo==undefined)? true : p.mostrar_cargo\\\"><div>{{ p.nombres+\\' \\'+p.apellidos }} <span ng-if=!to.disabled><md-checkbox class=cargo ng-model=p.mostrar_cargo aria-label=cargo></md-checkbox><md-tooltip>{{(p.mostrar_cargo)? \\'Ocultar \\': \\'Mostrar \\'}}cargo</md-tooltip></span><md-icon class=ap-cursor-pointer ng-click=\\\"vm.moverUsuario($index,\\'down\\',\\'via\\')\\\" ng-if=\\\" $index!=(model[options.key][\\'via\\'].length-1) && !to.disabled \\\">arrow_downward<md-tooltip>Bajar</md-tooltip></md-icon><md-icon class=ap-cursor-pointer ng-click=\\\"vm.moverUsuario($index,\\'up\\',\\'via\\')\\\" ng-if=\\\" $index!=0 && !to.disabled \\\">arrow_upward<md-tooltip>Subir</md-tooltip></md-icon></div><span ng-if=p.mostrar_cargo>{{ p.cargo }}</span></div></div></div><div layout ng-if=to.show.de><div ng-class=\\\"\\'flex-\\'+to.labelw\\\" layout=column><div class=label flex layout layout-align=\\\"start start\\\"><span class=ap-cursor-pointer ng-click=\\\"vm.openSelect($event, \\'de\\')\\\"><span>DE:</span></span></div><md-input-container class=input-search ng-show=vm.show_de><label>Usuarios</label><md-select ng-model=\\\"model[options.key][\\'de\\']\\\" name=select_de md-on-close=\\\"vm.buscar_de=\\'\\'; vm.show_de=false;\\\" data-md-container-class=select-search multiple><md-select-header class=select-header><input ng-model=vm.buscar_de type=search placeholder=\\\"Buscar ..\\\" class=\\\"header-searchbox md-text\\\"></md-select-header><md-optgroup label=usuarios><md-option ng-value=u ng-repeat=\\\"u in vm.usuarios | filter:vm.buscar_de\\\">{{ u.nombres+\\' \\'+u.apellidos }}</md-option></md-optgroup></md-select></md-input-container><div flex></div></div><div flex><div ng-repeat=\\\"p in model[options.key][\\'de\\']\\\" ng-init=\\\"p.mostrar_cargo= (p.mostrar_cargo==undefined)? true : p.mostrar_cargo\\\"><div>{{ p.nombres+\\' \\'+p.apellidos }} <span ng-if=!to.disabled><md-checkbox class=cargo ng-model=p.mostrar_cargo aria-label=cargo></md-checkbox><md-tooltip>{{(p.mostrar_cargo)? \\'Ocultar \\': \\'Mostrar \\'}}cargo</md-tooltip></span><md-icon class=ap-cursor-pointer ng-click=\\\"vm.moverUsuario($index,\\'down\\',\\'de\\')\\\" ng-if=\\\" $index!=(model[options.key][\\'de\\'].length-1) && !to.disabled \\\">arrow_downward<md-tooltip>Bajar</md-tooltip></md-icon><md-icon class=ap-cursor-pointer ng-click=\\\"vm.moverUsuario($index,\\'up\\',\\'de\\')\\\" ng-if=\\\" $index!=0 && !to.disabled \\\">arrow_upward<md-tooltip>Subir</md-tooltip></md-icon></div><span ng-if=p.mostrar_cargo>{{ p.cargo }}</span></div></div></div><div layout ng-if=to.show.ref><div ng-class=\\\"\\'flex-\\'+to.labelw\\\" layout=column><div class=label flex layout layout-align=\\\"start end\\\"><span>{{to.labelRef}}</span></div><div flex></div></div><div flex><md-input-container style=\\\"width: 100%\\\"><input name=ref ng-model=\\\"model[options.key][\\'ref\\']\\\" required md-no-asterisk><div ng-messages=cabeceraForm.ref.$error><div ng-message=required>Debe llenar este campo</div></div></md-input-container></div></div><div class=separador></div></ng-form>\");\n$templateCache.put(\"app/components/formlyComponents/inputt/inputt.html\",\"<div layout layout-align=\\\"start start\\\"><div class=label ng-class=\\\"[to.alineacion||\\'ap-text-right\\',\\'flex-\\'+to.labelw]\\\" ng-if=\\\"to.labelw>0\\\">{{to.labelx}}</div><div class=label ng-class=\\\"[to.alineacion||\\'ap-text-right\\']\\\" ng-if=\\\"to.labelw==0\\\">{{to.labelx}}</div><md-input-container flex><textarea ng-model=model[options.key] ng-required=to.required md-no-asterisk ng-disabled=to.disabled> </textarea><div ng-messages=fc.$error><div ng-message=required>Debe llenar este campo</div></div></md-input-container></div>\");\n$templateCache.put(\"app/components/formlyComponents/listaContactos/listaContactos.html\",\"<ng-form name=listaContactosForm><div layout><div ng-class=\\\"\\'flex-\\'+to.labelw\\\" layout=column><div class=label flex layout layout-align=\\\"start start\\\"><span class=ap-cursor-pointer ng-click=\\\"vm.abrirSelector($event, \\'contacto\\')\\\">{{to.label}} </span>&nbsp;&nbsp;&nbsp;</div><md-input-container class=input-search ng-show=vm.mostrarContacto><label>Contactos</label><md-select ng-model=model[options.key].lista name=seleccionarContacto md-on-close=vm.cerrarSelector() data-md-container-class=select-search multiple required><md-select-header class=select-header><input ng-model=vm.buscarContacto placeholder=Buscar... class=\\\"header-searchbox md-text\\\"></md-select-header><md-optgroup label=contactos><md-option ng-value=d ng-repeat=\\\"d in vm.contactos\\\"><div>{{d.grado}} {{d.nombres}} {{d.apellidos}}</div><div ng-if=d.cargo>{{d.cargo}} - {{d.sigla}}</div><div ng-if=\\\"!d.cargo || d.cargo === undefined\\\">{{d.sigla}}</div></md-option></md-optgroup></md-select></md-input-container><div flex></div></div><div class=docs flex><div layout=column layout-wrap><div ng-repeat=\\\"d in model[options.key].lista\\\" class=\\\"{{$index%2==0? \\'par\\':\\'impar\\'}}\\\"><div>{{ d.nombres }} {{ d.apellidos }}</div><div>{{d.cargo}}</div><div>{{d.sigla}}</div></div></div><div class=ap-ng-msg ng-messages=listaContactosForm.seleccionarContacto.$error ng-show=\\\"listaContactosForm.$submitted || listaContactosForm.select_doc.$touched\\\"><div ng-message=required>Debe escojer al menos un contacto</div></div></div></div></ng-form>\");\n$templateCache.put(\"app/components/formlyComponents/listas/listas.html\",\"<div layout><div flex ng-if=\\\"to.className==\\'ap-text-right\\' || to.className==\\'ap-text-center\\'\\\"></div><div><span>{{to.label}}</span><ul ng-if=\\\"to.tipo==\\'ul\\'\\\"><li ng-repeat=\\\"i in to.options\\\">{{i}}</li></ul><ol ng-if=\\\"to.tipo==\\'ol\\'\\\"><li ng-repeat=\\\"i in to.options\\\">{{i}}</li></ol></div><div flex ng-if=\\\"to.className==\\'ap-text-center\\'\\\"></div></div>\");\n$templateCache.put(\"app/components/formlyComponents/texto/texto.html\",\"<h1 ng-if=\\\"to.tipo==\\'h1\\'\\\" ng-class=\\\"[to.className,{\\'no-margin-top\\': !to.mTop },{ \\'no-margin-bot\\': !to.mBot }]\\\">{{to.label}}</h1><h2 ng-if=\\\"to.tipo==\\'h2\\'\\\" ng-class=\\\"[to.className,{\\'no-margin-top\\': !to.mTop },{ \\'no-margin-bot\\': !to.mBot }]\\\">{{to.label}}</h2><h3 ng-if=\\\"to.tipo==\\'h3\\'\\\" ng-class=\\\"[to.className,{\\'no-margin-top\\': !to.mTop },{ \\'no-margin-bot\\': !to.mBot }]\\\">{{to.label}}</h3><h4 ng-if=\\\"to.tipo==\\'h4\\'\\\" ng-class=\\\"[to.className,{\\'no-margin-top\\': !to.mTop },{ \\'no-margin-bot\\': !to.mBot }]\\\">{{to.label}}</h4><h5 ng-if=\\\"to.tipo==\\'h5\\'\\\" ng-class=\\\"[to.className,{\\'no-margin-top\\': !to.mTop },{ \\'no-margin-bot\\': !to.mBot }]\\\">{{to.label}}</h5><h6 ng-if=\\\"to.tipo==\\'h6\\'\\\" ng-class=\\\"[to.className,{\\'no-margin-top\\': !to.mTop },{ \\'no-margin-bot\\': !to.mBot }]\\\">{{to.label}}</h6><p ng-if=\\\"to.tipo==\\'p\\'\\\" ng-class=\\\"[to.className,{\\'no-margin-top\\': !to.mTop },{ \\'no-margin-bot\\': !to.mBot }]\\\">{{to.label}}</p>\");\n$templateCache.put(\"app/components/formlyComponents/vacio/vacio.html\",\"<div flex ng-style=to.style style=\\\"outline: 1px dashed #ddd\\\"></div>\");\n$templateCache.put(\"app/modules/admin/login/login.dialog.html\",\"<md-dialog aria-label=Agregar/Editar ng-cloak class=login-dialog><form id=data-form name=form ng-submit=\\\"answer(\\'login\\')\\\"><md-toolbar><div class=md-toolbar-tools><h2><md-icon>lock_outline</md-icon>Iniciar su sesión</h2><span flex></span></div></md-toolbar><md-dialog-content><div class=md-dialog-content><p class=\\\"bg-warning-user alert\\\">Su sesión ha expirado, debe iniciarla de nuevo.</p><md-content layout-gt-sm=column layout-padding style=\\\"overflow: initial\\\"><md-input-container><label>Nombre de usuario</label><md-icon>person</md-icon><input ng-model=data.username required></md-input-container><md-input-container><label>Contraseña</label><md-icon>lock</md-icon><input ng-model=data.password type=password required></md-input-container><md-button type=submit class=\\\"md-raised md-primary\\\" ng-disabled=form.$invalid>Iniciar sesión</md-button></md-content></div></md-dialog-content></form></md-dialog>\");\n$templateCache.put(\"app/modules/admin/login/modules.admin.login.html\",\"<md-toolbar style=\\\"display: none\\\"><div class=logo><img src=assets/images/logo.png></div></md-toolbar><div class=container><div class=logo-agetic><img src=assets/images/logo.png></div><md-card class=\\\"login-panel md-whiteframe-3dp\\\"><md-card-content><br><div layout=row layout-align=\\\"center center\\\"><img class=icon-image src=assets/images/icon_doc.png></div><br><div layout=row layout-align=\\\"center center\\\" class=md-headline>Inicio de sesión con:</div><br><form name=form ng-submit=login.login()><md-input-container><label>Nombre de usuario</label><md-icon>person</md-icon><input ng-model=login.username required></md-input-container><md-input-container><label>Contraseña</label><md-icon>lock</md-icon><input ng-model=login.password type=password required></md-input-container><md-button type=submit class=\\\"md-raised md-primary\\\" ng-disabled=form.$invalid>Iniciar con LDAP</md-button></form><!-- <br>\\r\\n            <div class=\\\"recuperar-pwd\\\" >\\r\\n              <span ng-click=\\\"login.abrirDialog()\\\">Recuperar contraseña</span>\\r\\n            </div> --><br></md-card-content></md-card></div>\");\n$templateCache.put(\"app/modules/admin/login/recuperar.dialog.html\",\"<md-dialog aria-label=Recuperar ng-cloak class=\\\"formly-dialog formly-column-{{column}}\\\" style=\\\"max-width: 800px; width: 100%\\\"><form ng-submit=recuperar() name=recuperarForm><md-toolbar><div class=md-toolbar-tools><h2><md-icon>autorenew</md-icon>Recuperar contraseña</h2><span flex></span> <span flex></span><md-button class=md-icon-button aria-label=Cerrar ng-click=cerrar($event)><md-tooltip>Cerrar</md-tooltip><md-icon aria-label=\\\"Close dialog\\\">close</md-icon></md-button></div></md-toolbar><md-dialog-content class=md-dialog-content><div class=md-dialog-content><md-input-container class=md-block flex-gt-sm><label>Usuario</label><input name=usuario ng-model=usuario type=text required><div ng-messages=recuperarForm.usuario.$error><div ng-message=required>Debe llenar este campo</div></div></md-input-container><md-input-container class=md-block flex-gt-sm><label>Correo electronico</label><input name=email ng-model=email type=email required><div ng-messages=recuperarForm.email.$error><div ng-message=required>Debe llenar este campo</div></div></md-input-container><md-input-container class=md-block flex-gt-sm><label>Número de documento de identidad</label><input name=numero_documento ng-model=numero_documento type=text required><div ng-messages=recuperarForm.numero_documento.$error><div ng-message=required>Debe llenar este campo</div></div></md-input-container><div class=informacion-recuperar><strong>Usuario:</strong> <span>Es el usuario con el que fue registrado en el sistema.</span><br><strong>Correo electronico:</strong> <span>El mismo con el que fue registrado</span><br><strong>Numero de documento de indentidad:</strong> <span>Escriba solo el número</span></div></div></md-dialog-content><md-dialog-actions><span flex></span><md-button type=submit class=\\\"md-raised md-primary\\\" ng-disabled=recuperarForm.$invalid><md-icon>check</md-icon><span>Recuperar</span></md-button><md-button class=md-raised ng-click=cerrar()><md-icon>cancel</md-icon>Cancelar</md-button></md-dialog-actions></form></md-dialog>\");\n$templateCache.put(\"app/modules/admin/profile/modules.admin.profile.html\",\"<div class=profile><div class=profile-user-bg><div class=\\\"profile-user-photo bg-{{profile.getColor()}}-user\\\"><img src=\\\"\\\" alt=\\\"\\\" hidden><!-- <i class=\\\"md-icon\\\">account_circle</i> --> {{profile.getInitial()}}</div><div class=profile-data><h2 class=profile-user-name>{{profile.getName()}}</h2><h3 class=profile-user-item>{{profile.getEmail()}}</h3><!-- <ul class=\\\"profile-user-data\\\">\\r\\n\t\t\t\t<li>\\r\\n\t\t\t\t\t<span class=\\\"profile-data-number\\\">10</span>\\r\\n\t\t\t\t\t<span class=\\\"profile-data-details\\\">Dato 1</span>\\r\\n\t\t\t\t</li>\\r\\n\t\t\t\t<li>\\r\\n\t\t\t\t\t<span class=\\\"profile-data-number\\\">20</span>\\r\\n\t\t\t\t\t<span class=\\\"profile-data-details\\\">Dato 2</span>\\r\\n\t\t\t\t</li>\\r\\n\t\t\t\t<li>\\r\\n\t\t\t\t\t<span class=\\\"profile-data-number\\\">30</span>\\r\\n\t\t\t\t\t<span class=\\\"profile-data-details\\\">Dato 3</span>\\r\\n\t\t\t\t</li>\\r\\n\t\t\t</ul> --></div></div><div class=profile-statistics layout=row><div class=\\\"profile-char text-left\\\" flex ng-show=!profile.swEditarCuenta><div layout><md-button class=md-raised ng-click=\\\"profile.abrirEditar(\\'editar_notificaciones\\')\\\"><md-icon>edit</md-icon>Editar notificaciones</md-button><!-- <md-button class=\\\"md-raised\\\" ng-click=\\\"profile.abrirEditar(\\'editar_cuenta\\')\\\">\\r\\n\t\t\t\t\t\t<md-icon>edit</md-icon>\\r\\n\t\t\t\t\t\tEditar cuenta\\r\\n\t\t\t\t</md-button>\\r\\n\t\t\t\t<md-button class=\\\"md-raised\\\" ng-click=\\\"profile.abrirEditar(\\'editar_contrasena\\')\\\">\\r\\n\t\t\t\t\t\t<md-icon>edit</md-icon>\\r\\n\t\t\t\t\t\tEditar Contraseña\\r\\n\t\t\t\t</md-button> --><div flex></div></div><p><strong>Nombre de usuario: </strong>{{profile.getData(\\'username\\')}}</p><p><strong>Número de documento: </strong>{{profile.getData(\\'doc\\')}}</p><p><strong>Nombre(s): </strong>{{profile.getData(\\'first_name\\')}}</p><p><strong>Apellido(s): </strong>{{profile.getData(\\'last_name\\')}}</p><p><strong>Correo electrónico: </strong>{{profile.getData(\\'email\\')}}</p><!-- <p><strong>Último login: </strong>{{profile.getData(\\'last_login\\')}}</p> --><p><strong>Activo desde: </strong>{{profile.getData(\\'date_joined\\')}}</p></div><div class=profile-char-edit flex ng-show=\\\"profile.swEditarCuenta==\\'editar_notificaciones\\'\\\"><p>Recibir notificaciones vía:</p><md-radio-group layout ng-model=profile.ca.canal><md-radio-button value=SMS>SMS</md-radio-button><md-radio-button value=CORREO>CORREO ELECTRÓNICO</md-radio-button><md-radio-button value=SMS_CORREO>SMS Y CORREO ELECTRÓNICO</md-radio-button></md-radio-group><br><md-input-container ng-if=\\\"profile.ca.canal==\\'SMS\\' || profile.ca.canal==\\'SMS_CORREO\\'\\\"><label>Nro. de celular</label><input ng-model=profile.ca.celular></md-input-container><md-input-container ng-if=\\\"profile.ca.canal==\\'CORREO\\' || profile.ca.canal==\\'SMS_CORREO\\'\\\"><label>Correo electrónico</label><input ng-model=profile.ca.email disabled></md-input-container><p>De documentos que me:</p><div layout><md-checkbox ng-model=profile.ca.enviado ng-if=profile.getEsJefe()>envien</md-checkbox><md-checkbox ng-model=profile.ca.observado disabled>observen</md-checkbox><md-checkbox ng-model=profile.ca.aprobado>aprueben</md-checkbox><md-checkbox ng-model=profile.ca.derivado>deriven</md-checkbox></div><div layout><!-- <div flex></div> --><md-button class=\\\"md-raised md-primary\\\" ng-click=profile.editarConfiguracion()><md-icon>check</md-icon>Guardar</md-button><md-button class=md-raised ng-click=profile.cancelarEditar()><md-icon>cancel</md-icon>Cancelar</md-button><div flex></div></div></div><div class=profile-char-edit flex ng-show=\\\"profile.swEditarCuenta==\\'editar_cuenta\\'\\\"><form name=cuentaForm><div layout-gt-sm=row layout-align=\\\"center center\\\"><h3>Modificar cuenta de usuario</h3></div><div layout-gt-sm=row><md-input-container flex-gt-sm><label>Número de documento</label><input name=numero_documento ng-model=profile.numero_documento required><div ng-messages=cuentaForm.numero_documento.$error><div ng-message=required>Debe llenar este campo</div></div></md-input-container><md-input-container flex-gt-sm><label>Nombre de usuario</label><input name=nombre_usuario ng-model=profile.nombre_usuario required><div ng-messages=cuentaForm.nombre_usuario.$error><div ng-message=required>Debe llenar este campo</div></div></md-input-container><md-input-container flex-gt-sm><label>Correo eletrónico</label><input name=email ng-model=profile.email required type=email><div ng-messages=cuentaForm.email.$error><div ng-message=required>Debe llenar este campo</div></div></md-input-container></div><div layout-gt-sm=row><md-input-container flex-gt-sm=50><label>Nombre(s)</label><input name=nombres ng-model=profile.nombres required><div ng-messages=cuentaForm.nombres.$error><div ng-message=required>Debe llenar este campo</div></div></md-input-container><md-input-container flex-gt-sm><label>Apellidos</label><input name=apellidos ng-model=profile.apellidos required><div ng-messages=cuentaForm.apellidos.$error><div ng-message=required>Debe llenar este campo</div></div></md-input-container></div><div layout><div flex></div><md-button class=\\\"md-raised md-primary\\\" ng-click=profile.editarCuenta()><md-icon>check</md-icon>Guardar</md-button><md-button class=md-raised ng-click=profile.cancelarEditar()><md-icon>cancel</md-icon>Cancelar</md-button></div></form></div><div class=profile-char-edit flex ng-show=\\\"profile.swEditarCuenta==\\'editar_contrasena\\'\\\"><form name=cuentaPassForm><div layout><div flex=0 flex-gt-sm=30></div><div flex-gt-sm=40 layout=column layout-align=\\\"center stretch\\\"><h3>Modificar contraseña de usuario</h3><md-input-container flex><label>Contraseña actual</label><input name=contrasena ng-model=profile.contrasena required type=password><div ng-messages=cuentaPassForm.contrasena.$error><div ng-message=required>Debe llenar este campo</div></div></md-input-container><md-input-container flex><label>Contraseña nueva</label><input name=contrasena_nueva ng-model=profile.contrasena_nueva required type=password><div ng-messages=cuentaPassForm.contrasena_nueva.$error><div ng-message=required>Debe llenar este campo</div></div></md-input-container><md-input-container flex><label>Confirmar contraseña nueva</label><input name=contrasena_confirm ng-model=profile.contrasena_confirm required type=password><div ng-messages=cuentaPassForm.contrasena_confirm.$error><div ng-message=required>Debe llenar este campo</div></div></md-input-container><div layout><div flex></div><md-button class=\\\"md-raised md-primary\\\" ng-click=profile.editarCuenta()><md-icon>check</md-icon>Guardar</md-button><md-button class=md-raised ng-click=profile.cancelarEditar()><md-icon>cancel</md-icon>Cancelar</md-button></div></div></div></form></div></div></div>\");\n$templateCache.put(\"app/modules/admin/usuarios/dialog.usuario.html\",\"<md-dialog ng-cloak class=\\\"formly-dialog formly-column-{{column}}\\\" style=\\\"max-width: 800px; width: 100%\\\"><form ng-submit=registrarUsuario() name=usuarioForm><md-toolbar><div class=md-toolbar-tools><h2><md-icon>business</md-icon>{{data.id_usuario == null ? \\\"Nuevo usuario\\\" : \\\"Editar usuario\\\"}}</h2><span flex></span> <span flex></span><md-button class=md-icon-button aria-label=Cerrar ng-click=cerrar($event)><md-tooltip>Cerrar</md-tooltip><md-icon>close</md-icon></md-button></div></md-toolbar><md-dialog-content class=md-dialog-content><div layout=row><md-card style=width:50%><md-card-header><md-card-header-text><span class=md-title>Datos personales</span></md-card-header-text></md-card-header><md-card-content><md-input-container class=md-block flex-gt-sm><label>Nro documento de identidad</label><input ng-model=data.numero_documento type=text required></md-input-container><md-input-container class=md-block flex-gt-sm><label>Nombre(s)</label><input ng-model=data.nombres type=text required></md-input-container><md-input-container class=md-block flex-gt-sm><label>Apellidos</label><input ng-model=data.apellidos type=text required></md-input-container><md-input-container class=md-block flex-gt-sm><label>Cargo</label><input ng-model=data.cargo type=text required></md-input-container><md-input-container class=md-block flex-gt-sm><label>Correo electronico</label><input ng-model=data.email type=email required></md-input-container><!-- TODO: probando a usar chips --><h3>Usuarios virtuales</h3><md-input-container class=md-block flex-gt-sm ng-show=virtual ng-repeat=\\\"virtual in data.virtuales\\\"><md-checkbox ng-model=virtual.valor aria-label={{virtual.cargo}} ng-if=\\\"virtual.libre === true\\\">{{virtual.cargo}}</md-checkbox><md-checkbox ng-model=virtual.fake aria-label={{virtual.cargo}} ng-disabled={{!virtual.libre}} ng-if=\\\"virtual.libre === false\\\">{{virtual.cargo}}<md-icon class=info-icono>info</md-icon><md-tooltip class=info-virtual>{{virtual.titular.nombres}} {{virtual.titular.apellidos}}</md-tooltip></md-checkbox></md-input-container></md-card-content></md-card><md-card style=width:50%><md-card-header><md-card-header-text><span class=md-title>Datos de usuario</span></md-card-header-text></md-card-header><md-card-content><md-input-container class=md-block flex-gt-sm><label>Nombre de usuario</label><input ng-model=data.usuario type=text required></md-input-container><md-input-container class=md-block flex-gt-sm><label>Estado</label><md-select ng-model=data.estado name=estado required><md-option ng-value=\\\"\\'ACTIVO\\'\\\">ACTIVO</md-option><md-option ng-value=\\\"\\'INACTIVO\\'\\\">INACTIVO</md-option></md-select><div ng-messages=usuarioForm.estado.$error ng-show=usuarioForm.estado.$dirty><div ng-message=required>Debe seleccionar un estado</div></div></md-input-container><md-input-container class=md-block flex-gt-sm><label>Unidad</label><md-select ng-model=data.fid_unidad name=unidad><md-option ng-value=u.id_unidad ng-repeat=\\\"u in data.unidades\\\">{{u.abreviacion+\\' - \\'+u.nombre}}</md-option></md-select></md-input-container><h3>Roles</h3><md-input-container class=md-block flex-gt-sm ng-show=rol ng-repeat=\\\"rol in data.roles\\\"><md-checkbox ng-model=rol.valor aria-label={{rol.nombre}}>{{rol.nombre}}</md-checkbox></md-input-container></md-card-content></md-card></div></md-dialog-content><md-dialog-actions layout=row><span flex></span><md-button type=submit class=\\\"md-raised md-primary\\\" ng-disabled=usuarioForm.$invalid><md-icon>check</md-icon>Guardar</md-button><md-button class=md-raised ng-click=cerrar()><md-icon>cancel</md-icon>Cancelar</md-button></md-dialog-actions></form></md-dialog>\");\n$templateCache.put(\"app/modules/admin/usuarios/edit.dialog.html\",\"<md-dialog aria-label=Agregar/Editar ng-cloak><form id=data-form name=form ng-submit=\\\"answer(\\'save\\')\\\"><md-toolbar><div class=md-toolbar-tools><h2>{{title}}</h2><span flex></span><md-button class=md-icon-button ng-click=cancel()><md-icon aria-label=\\\"Close dialog\\\">close</md-icon></md-button></div></md-toolbar><md-dialog-content><div class=md-dialog-content><md-content layout-gt-sm=column layout-padding style=\\\"overflow: initial\\\"><md-input-container><label>Nombre de usuario</label><input ng-model=data.username required></md-input-container><md-input-container ng-if=add><label>Contraseñssssa</label><input ng-model=data.password type=password required></md-input-container><md-input-container><label>Email</label><input ng-model=data.email type=email></md-input-container><md-input-container class=md-block flex-gt-sm><label>Nombre(s)</label><input ng-model=data.first_name></md-input-container><md-input-container class=md-block flex-gt-sm><label>Apellido(s)</label><input ng-model=data.last_name></md-input-container><input ng-model=data.id type=hidden> <input ng-model=data.is_active type=hidden></md-content></div></md-dialog-content><md-dialog-actions layout=row><span flex></span><md-button class=md-raised ng-click=\\\"answer(\\'cancel\\')\\\"><md-icon>cancel</md-icon>Cancelar</md-button><md-button type=submit class=\\\"md-raised md-primary\\\" ng-disabled=form.$invalid><md-icon>check</md-icon>Guardar</md-button></md-dialog-actions></form></md-dialog>\");\n$templateCache.put(\"app/modules/admin/usuarios/modules.admin.usuarios.html\",\"<div class=container><crud-table url=usuarios.url title-table=usuarios.title fields=usuarios.fields usuario=usuarios.usuario template=usuarios.template dialog-controller=usuarios.dialogController permission=usuarios.permission></crud-table></div>\");\n$templateCache.put(\"app/modules/admin/virtual/virtual.html\",\"<div class=container><md-card-content><div layout layout-xs=column layout-sm=column layout-align=\\\"center center\\\"><div class=contenedor-virtual ng-repeat=\\\"item in virtual.usuariosVirtuales\\\"><center><div class=\\\"virtual-icon {{(!item.activo || item.activo ==false ? \\'boton-circular\\':\\'desactivar\\')}}\\\" layout-xs=row><md-tooltip md-direction=top>{{item.cargo}}</md-tooltip><img class=icon-circular-imagen src=assets/images/robo{{$index}}.png ng-click=virtual.seleccionar(item) ng-if=!item.activo> <img class=icon-circular-imagen src=assets/images/robo{{$index}}.png ng-if=\\\"item.activo && item.activo== true\\\"></div><div><md-icon class=\\\"{{(!item.activo || item.activo ==false ? \\'inactivo\\':\\'activo\\')}}\\\">check</md-icon><div><strong>{{item.nombres}}</strong></div></div></center></div></div></md-card-content></div>\");\n$templateCache.put(\"app/modules/plantillasFormly/aprobacion/dialogPDF.html\",\"<md-dialog aria-label=Agregar/Editar ng-cloak class=\\\"formly-dialog formly-column-{{column}} dialog-aprobacion\\\" style=\\\"max-width: 800px; width: 100%\\\"><form name=obsForm><md-toolbar><div class=md-toolbar-tools><h2><md-icon>picture_as_pdf</md-icon>Documento creado por {{data.nombres +\\' \\'+ data.apellidos}}</h2><span flex></span><md-button class=md-icon-button aria-label=\\\"Ver pdf\\\" ng-click=verPdf() ng-show=data.flag_html><md-tooltip>Ver PDF</md-tooltip><md-icon aria-label=\\\"Close dialog\\\">picture_as_pdf</md-icon></md-button><md-button class=md-icon-button aria-label=\\\"Ver html\\\" ng-click=verHtml() ng-show=!data.flag_html><md-tooltip>Ver html</md-tooltip><md-icon aria-label=\\\"Close dialog\\\">code</md-icon></md-button><md-button class=md-icon-button aria-label=Cerrar ng-click=cerrar()><md-tooltip>Cerrar</md-tooltip><md-icon aria-label=\\\"Close dialog\\\">close</md-icon></md-button></div></md-toolbar><md-dialog-content class=md-dialog-content><div layout=column ng-if=\\\"!data.es_para && !data.es_derivar\\\"><md-input-container style=\\\"width=100%\\\"><label>{{ (data.accion==\\'derivar\\')? \\'Proveído\\': \\'Observaciones\\'}}</label><textarea name=obs ng-model=data.observaciones md-maxlength=250 rows=2 required></textarea></md-input-container></div><div layout=column ng-if=\\\"!data.es_derivar && data.es_para\\\"><md-tabs md-dynamic-height md-border-bottom md-selected=4 md-stretch-tabs=always md-pagination-wrapper><md-tab label=\\\"Aprobar y crear\\\" md-on-select=\\\"data.accion=\\'crear\\'\\\"><md-content class=md-padding></md-content></md-tab><md-tab label=\\\"Aprobar y derivar\\\" md-on-select=\\\"data.accion=\\'derivar\\'\\\"><md-content layout=column class=md-padding><md-input-container><label>Usuario</label><md-select name=user ng-model=data._usuario_seleccionado required><md-option ng-repeat=\\\"us in data.usuarios\\\" ng-value=us.id_usuario>{{us.nombres+\\' \\'+us.apellidos}}<br>-{{us.cargo}}-</md-option></md-select></md-input-container><md-input-container style=\\\"width=100%\\\"><label>Proveído</label><textarea name=obs ng-model=data.observaciones md-maxlength=250 rows=2 required></textarea></md-input-container></md-content></md-tab><md-tab label=\\\"Aprobar y cerrar\\\" md-on-select=\\\"data.accion=\\'cerrar\\'\\\"><md-content class=md-padding></md-content></md-tab><md-tab label=Observar md-on-select=\\\"data.accion=\\'observar\\'\\\"><md-content layout=column class=md-padding><md-input-container style=\\\"width=100%\\\"><label>Observaciones</label><textarea name=obs ng-model=data.observaciones md-maxlength=250 rows=2 required></textarea></md-input-container></md-content></md-tab></md-tabs></div><div layout=column ng-if=data.es_derivar><div>Proveído de {{ data.usuario_proveido}}<br>{{data.dc.observaciones}}<div><br></div></div><md-input-container><label>Usuario</label><md-select name=user ng-model=data._usuario_seleccionado required><md-option ng-repeat=\\\"us in data.usuarios\\\" ng-value=us.id_usuario>{{us.nombres+\\' \\'+us.apellidos}}<br>-{{us.cargo}}-</md-option></md-select></md-input-container><md-input-container style=\\\"width=100%\\\"><label>Proveído</label><textarea name=obs ng-model=data.observaciones md-maxlength=250 rows=2 required></textarea></md-input-container></div><div ng-if=data.sw_es_respuesta><div class=\\\"ap-text-center ap-text-warning\\\">Referencias:</div><div class=\\\"ap-text-center ap-text-warning\\\" ng-repeat=\\\"dg in data.docs_grupo\\\" ng-if=\\\"dg.id_documento!=data.dc.id_documento\\\">* {{dg.nombre_plantilla}} -- <span class=ap-cursor-pointer ng-click=verDocumento(dg.id_documento)>{{dg.nombre}}</span></div></div><div ng-show=data.flag_html bind-html-compile=data.html></div><iframe class=iframe-pdf src={{data.pdf}} style=\\\"width:100%; height:600px; border: none\\\" ng-if=\\\"data.show_pdf && !data.flag_html\\\" allowfullscreen></iframe><div id=canvasContainer ng-show=\\\"!data.show_pdf && !data.flag_html\\\"></div></md-dialog-content><md-dialog-actions><span flex></span><div ng-if=data.es_derivar><md-button class=\\\"ap md-raised bt-bg-warning\\\" ng-click=derivar() ng-disabled=\\\"obsForm.user.$invalid || obsForm.obs.$invalid\\\"><md-icon>check</md-icon>Derivar</md-button><md-button class=\\\"ap md-raised bt-bg-success\\\" ng-click=openSelect($event)><md-icon>error</md-icon>Crear documento</md-button><md-input-container style=\\\"transform: scale(0.01)\\\" ng-show=data.show_select><md-select name=plantilla ng-model=data._plantilla_seleccionada required ng-change=crear() md-on-close=\\\"data.show_select=false;\\\"><md-option ng-repeat=\\\"pla in data.plantillas_disponibles\\\" ng-value=pla>{{pla.nombre}} ({{pla.abreviacion}})</md-option></md-select></md-input-container></div><div ng-if=!data.es_derivar><md-button class=\\\"ap md-raised\\\" ng-class=\\\"{\\'bt-bg-success\\': data.es_para}\\\" ng-click=openSelect($event) ng-if=\\\"data.es_para && data.accion==\\'crear\\'\\\"><md-icon>error</md-icon>Crear documento</md-button><md-input-container style=\\\"transform: scale(0.01)\\\" ng-show=data.show_select><md-select name=plantilla ng-model=data._plantilla_seleccionada required ng-change=crear(true) md-on-close=\\\"data.show_select=false;\\\"><md-option ng-repeat=\\\"pla in data.plantillas_disponibles\\\" ng-value=pla>{{pla.nombre}} ({{pla.abreviacion}})</md-option></md-select></md-input-container><md-button class=\\\"ap md-raised\\\" ng-class=\\\"{\\'bt-bg-warning\\': data.es_para}\\\" ng-click=\\\"aprobar(\\'derivar\\')\\\" ng-disabled=obsForm.user.$invalid ng-if=\\\"data.es_para && data.accion==\\'derivar\\'\\\"><md-icon>check</md-icon>Derivar</md-button><md-button class=\\\"ap md-raised\\\" ng-class=\\\"{\\'bt-bg-info\\': data.es_para, \\'bt-bg-success\\': !data.es_para}\\\" ng-click=\\\"aprobar(\\'aprobar\\')\\\" ng-if=\\\"!data.es_para || data.accion==\\'cerrar\\'\\\"><md-icon>check</md-icon>Aprobar</md-button><md-button class=\\\"ap md-raised bt-bg-danger\\\" ng-click=observar() ng-disabled=obsForm.obs.$invalid ng-if=\\\"!data.es_para || data.accion==\\'observar\\'\\\"><md-icon>error</md-icon>Observar</md-button></div><md-button class=md-raised ng-click=cerrar()><md-icon>cancel</md-icon>Cancelar</md-button></md-dialog-actions></form></md-dialog>\");\n$templateCache.put(\"app/modules/plantillasFormly/aprobacion/modules.plantillasFormly.aprobacion.html\",\"<div class=container><crud-table url=aprobacion.url title-table=aprobacion.titulo fields=aprobacion.fields usuario=aprobacion.usuario permission=aprobacion.permission buttons=aprobacion.buttons query-extra=aprobacion.queryExtra only-fields=true estado-checks=true estado-opciones=aprobacion.estadoOpciones></crud-table><br><br></div>\");\n$templateCache.put(\"app/modules/plantillasFormly/contactos/dialog.contactos.html\",\"<md-dialog ng-cloak class=\\\"formly-dialog formly-column-{{column}}\\\" style=\\\"max-width: 800px; width: 100%\\\"><form ng-submit=registrarContacto() name=contactoForm novalidate><md-toolbar><div class=md-toolbar-tools><h2><md-icon>business</md-icon>{{titulo}}</h2><span flex></span><md-button class=md-icon-button aria-label=Cerrar ng-click=cerrar()><md-tooltip>Cerrar</md-tooltip><md-icon>close</md-icon></md-button></div></md-toolbar><md-dialog-content><div layout><md-card flex><md-card-header><md-card-header-text><span class=md-title>Datos del contacto</span></md-card-header-text></md-card-header><md-card-content><md-input-container class=md-block><label>Grado</label><input ng-model=data.grado type=text><div ng-messages=contactoForm.grado.$error ng-show=contactoForm.grado.$dirty><div ng-message=required>Debe llenar este campo</div></div></md-input-container><md-input-container class=md-block><label>Nombres</label><input ng-model=data.nombres type=text required><div ng-messages=contactoForm.nombres.$error ng-show=contactoForm.nombres.$dirty><div ng-message=required>Debe llenar este campo</div></div></md-input-container><md-input-container class=md-block><label>Apellidos</label><input ng-model=data.apellidos type=text required><div ng-messages=contactoForm.apellidos.$error ng-show=contactoForm.apellidos.$dirty><div ng-message=required>Debe llenar este campo</div></div></md-input-container><md-input-container class=md-block><label>Cargo</label><input ng-model=data.cargo type=text><div ng-messages=contactoForm.cargo.$error ng-show=contactoForm.cargo.$dirty><div ng-message=required>Debe llenar este campo</div></div></md-input-container><md-input-container class=md-block><label>Teléfono/Celular</label><input ng-model=data.telefono type=text><div ng-messages=contactoForm.telefono.$error ng-show=contactoForm.telefono.$dirty><div ng-message=required>Debe llenar este campo</div></div></md-input-container><md-input-container class=md-block><label for=estado>Estado</label><md-select name=estado ng-model=data.estado placeholder=Estado required><md-option ng-value=item.id ng-repeat=\\\"item in estados\\\">{{ item.name }}</md-option></md-select><div ng-messages=contactoForm.estado.$error ng-show=contactoForm.estado.$dirty><div ng-message=required>Debe seleccionar una opción</div></div></md-input-container></md-card-content></md-card><md-card flex><md-card-header><md-card-header-text><span class=md-title>Datos de la entidad</span></md-card-header-text></md-card-header><md-card-content><md-input-container class=md-block><label>Entidad</label><input ng-model=data.entidad type=text required><div ng-messages=contactoForm.entidad.$error ng-show=contactoForm.entidad.$dirty><div ng-message=required>Debe llenar este campo</div></div></md-input-container><md-input-container class=md-block><label for=tipo_entidad>Tipo de entidad</label><md-select name=tipo_entidad ng-model=data.tipo_entidad placeholder=\\\"Tipo de entidad\\\" required><md-option ng-value=item.tipo_entidad ng-repeat=\\\"item in tiposEntidad\\\" ng-click=habilitarOtro(item)>{{ item.tipo_entidad }}</md-option></md-select><div ng-messages=contactoForm.tipo_entidad.$error ng-show=contactoForm.tipo_entidad.$dirty><div ng-message=required>Debe seleccionar una opción</div></div></md-input-container><md-input-container class=md-block ng-if=\\\"otroEditar==true\\\"><label>Tipo de entidad</label><input ng-model=data.otro_tipo type=text required><div ng-messages=contactoForm.otro_tipo.$error ng-show=contactoForm.otro_tipo.$dirty><div ng-message=required>Debe llenar este campo</div></div></md-input-container><md-input-container class=md-block><label>Sigla</label><input ng-model=data.sigla type=text><div ng-messages=contactoForm.sigla.$error ng-show=contactoForm.sigla.$dirty><div ng-message=required>Debe llenar este campo</div></div></md-input-container><md-input-container class=md-block><label>Dirección</label><input ng-model=data.direccion type=text required><div ng-messages=contactoForm.direccion.$error ng-show=contactoForm.direccion.$dirty><div ng-message=required>Debe llenar este campo</div></div></md-input-container><md-input-container class=md-block><label for=departamento>Departamento</label><md-select name=departamento ng-model=data.departamento placeholder=Departamento required><md-option ng-value=item.id ng-repeat=\\\"item in departamentos\\\">{{ item.name }}</md-option></md-select><div ng-messages=contactoForm.departamento.$error ng-show=contactoForm.departamento.$dirty><div ng-message=required>Debe seleccionar una opción</div></div></md-input-container></md-card-content></md-card></div></md-dialog-content><md-dialog-actions layout layout-padding><span flex></span><md-button type=submit class=\\\"md-raised md-primary\\\" ng-disabled=contactoForm.$invalid><md-icon>check</md-icon>Guardar</md-button><md-button type=button class=md-raised ng-click=cerrar()><md-icon>cancel</md-icon>Cancelar</md-button></md-dialog-actions></form></md-dialog>\");\n$templateCache.put(\"app/modules/plantillasFormly/contactos/modules.plantillasFormly.contactos.html\",\"<div class=container><crud-table url=contactos.url title-table=contactos.titulo fields=contactos.fields usuario=contactos.usuario dialog-controller=contactos.dialogController permission=contactos.permission order=contactos.order template=contactos.template></crud-table></div>\");\n$templateCache.put(\"app/modules/plantillasFormly/documentos/documento.dialog.html\",\"<md-dialog aria-label=\\\"Elegir plantilla\\\" class=\\\"formly-dialog formly-column-{{column}}\\\" style=\\\"max-width: 600px; width: 100%\\\"><md-toolbar><div class=md-toolbar-tools><h2><md-icon>dashboard</md-icon>Elegir documento</h2><span flex></span></div></md-toolbar><p style=margin-left:10px>Seleccione un documento y haga click en aceptar:</p><md-input-container style=\\\"margin-left:10px !important\\\"><input ng-model=p.buscarPlantilla></md-input-container><md-dialog-content class=md-dialog-content><div flex layout><div flex></div><md-radio-group ng-model=plantilla_seleccionada><md-radio-button ng-repeat=\\\"p in plantillas_disponibles| filter:p.buscarPlantilla\\\" ng-value=p.id_plantilla_formly class=md-primary>{{p.nombre}} ({{p.abreviacion}})</md-radio-button></md-radio-group><div flex></div></div></md-dialog-content><md-dialog-actions><div flex></div><md-button class=\\\"md-raised md-primary\\\" ng-click=elegir()><md-icon>check</md-icon><span>Aceptar</span></md-button></md-dialog-actions></md-dialog>\");\n$templateCache.put(\"app/modules/plantillasFormly/documentos/modules.plantillasFormly.documentos.html\",\"<div class=container><crud-table url=documentos.url title-table=documentos.titulo fields=documentos.fields usuario=documentos.usuario permission=documentos.permission buttons=documentos.buttons button-agregar=documentos.buttonAgregar only-fields=true estado-checks=true estado-opciones=documentos.estadoOpciones></crud-table><br><br></div>\");\n$templateCache.put(\"app/modules/plantillasFormly/enCurso/modules.plantillasFormly.enCurso.html\",\"<div class=container><crud-table url=enCurso.url title-table=enCurso.titulo fields=enCurso.fields usuario=enCurso.usuario permission=enCurso.permission buttons=enCurso.buttons only-fields=true></crud-table><br><br></div>\");\n$templateCache.put(\"app/modules/plantillasFormly/firmar/modules.plantillasFormly.firmar.html\",\"<div class=container><crud-table url=firmar.url title-table=firmar.titulo fields=firmar.fields usuario=firmar.usuario permission=firmar.permission buttons=firmar.buttons only-fields=true items=firmar.items seleccionados=firmar.obtenerSeleccionados habilitar-seleccion=firmar.habilitarSeleccion></crud-table><md-button class=\\\"md-raised md-primary\\\" ng-click=firmar.firmarDocumentos() ng-disabled=!firmar.habilitarBotonFirma><md-icon>done_all</md-icon><md-tooltip md-direction=right>Firmar Digitalmente</md-tooltip>Firmar</md-button><br></div>\");\n$templateCache.put(\"app/modules/plantillasFormly/impresion/modules.plantillasFormly.impresion.html\",\"<div class=container><crud-table url=impresion.url title-table=impresion.titulo fields=impresion.fields usuario=impresion.usuario permission=impresion.permission buttons=impresion.buttons button-agregar=impresion.multiple query-extra=impresion.queryExtra estado-sw=true only-fields=true search-pro=true></crud-table><br><br></div>\");\n$templateCache.put(\"app/modules/plantillasFormly/impresion/multiple.dialog.html\",\"<md-dialog aria-label=\\\"Impresion multiple\\\" class=\\\"formly-dialog formly-column-{{column}}\\\" style=\\\"max-width: 600px; width: 100%\\\"><md-toolbar><div class=md-toolbar-tools><h2><md-icon>print</md-icon>Impresion multiple</h2><span flex></span><md-button class=\\\"md-icon-button md-toast-button-close\\\" ng-click=cancel()><md-icon aria-label=\\\"Close dialog\\\">close</md-icon></md-button></div></md-toolbar><md-dialog-content class=md-dialog-content><form name=multipleForm ng-submit=obtenerDocumento()><div flex layout><md-input-container class=md-block flex-gt-sm><label>Escríba el cite de un documento multiple</label><input ng-model=cite type=text required></md-input-container><md-button class=\\\"md-fab md-mini md-primary\\\" type=submit ng-disabled=multipleForm.$invalid><md-icon>search</md-icon></md-button><!-- <md-button class=\\\"md-fab md-mini md-primary\\\" ng-click=\\\"obtenerDocumento()\\\">\\n          <md-icon>search</md-icon>\\n        </md-button> --></div></form><iframe class=iframe-pdf src={{documentoAImprimir.url}} style=\\\"width:100%; height:600px; border: none\\\" ng-if=documentoAImprimir.url allowfullscreen></iframe></md-dialog-content></md-dialog>\");\n$templateCache.put(\"app/modules/plantillasFormly/monitoreo/dialogPresupuestoPDF.html\",\"<md-dialog aria-label=\\\"Documento PDF\\\" class=\\\"formly-dialog formly-column-{{column}} dialog-pdf\\\" style=\\\"max-width: 800px; width: 100%\\\"><md-toolbar><div class=md-toolbar-tools><h2><md-icon>picture_as_pdf</md-icon>Vista previa</h2><span flex></span><md-button class=md-icon-button aria-label=\\\"Ver pdf\\\" ng-click=verPdf() ng-show=data.flag_html><md-tooltip>Ver PDF</md-tooltip><md-icon aria-label=\\\"Close dialog\\\">picture_as_pdf</md-icon></md-button><md-button class=md-icon-button aria-label=\\\"Ver html\\\" ng-click=verHtml() ng-show=!data.flag_html><md-tooltip>Ver html</md-tooltip><md-icon aria-label=\\\"Close dialog\\\">code</md-icon></md-button><md-button class=md-icon-button aria-label=Cerrar ng-click=cerrar()><md-tooltip>Cerrar</md-tooltip><md-icon aria-label=\\\"Close dialog\\\">close</md-icon></md-button></div></md-toolbar><md-dialog-content class=md-dialog-content><iframe class=iframe-pdf src={{data.pdf}} style=\\\"width:100%; height:600px; border: none\\\" ng-if=\\\"data.show_pdf && !data.flag_html\\\" allowfullscreen></iframe><div id=canvasContainer ng-show=\\\"!data.show_pdf && !data.flag_html\\\"></div><div ng-if=false><p>Tu navegador web no puede visualizar archivos PDF. Pero tu puedes hacer <a ng-href={{data.pdf}} target=_blank>click aqui para descargar el PDF</a></p></div></md-dialog-content><md-dialog-actions><span flex></span><md-button class=md-raised ng-click=cerrar()><md-icon>cancel</md-icon>Cancelar</md-button></md-dialog-actions></md-dialog>\");\n$templateCache.put(\"app/modules/plantillasFormly/monitoreo/modules.plantillasFormly.monitoreo.html\",\"<div class=\\\"container container-monitoreo\\\"><md-card><md-toolbar class=md-table-toolbar><div class=md-toolbar-tools><md-icon>grid_on</md-icon><span>Monitoreo</span><div flex></div><md-button class=md-icon-button ng-click=monitoreo.refrescarChart()><md-tooltip>Actualizar</md-tooltip><md-icon>refresh</md-icon></md-button><md-button class=\\\"md-icon-button btn-collapsed\\\"><md-tooltip>Ocultar/Ver</md-tooltip><md-icon>keyboard_arrow_down</md-icon></md-button></div></md-toolbar><md-card-content><div layout=column layout-gt-sm style=\\\"margin-top: 15px\\\"><div><md-input-container><label>Gráfico</label><md-select ng-model=monitoreo.grafico placeholder=\\\"Selecciona que grafico ver\\\" ng-change=monitoreo.reiniciarChart()><md-option ng-value=g ng-repeat=\\\"g in monitoreo.graficos\\\">{{g.nombre}}</md-option></md-select></md-input-container><md-input-container ng-if=\\\"monitoreo.grafico.cod==4 || monitoreo.grafico.cod==7 || monitoreo.grafico.cod==8\\\"><label>Gestión</label><md-select ng-model=monitoreo.gestion ng-change=monitoreo.refrescarChart()><md-option ng-value=$index ng-repeat=\\\"a in monitoreo.gestiones\\\">{{a.gestion}}</md-option></md-select></md-input-container><md-input-container ng-if=\\\"[4, 5, 6, 7, 8, 9].indexOf(monitoreo.grafico.cod) == -1\\\"><label>Año</label><md-select ng-model=monitoreo.anio ng-change=monitoreo.refrescarChart()><md-option ng-value=$index ng-repeat=\\\"a in monitoreo.anios\\\">{{a}}</md-option></md-select></md-input-container><md-input-container ng-if=\\\"monitoreo.grafico.cod === 9\\\"><label>Año</label><md-select ng-model=monitoreo.anioContable ng-change=monitoreo.refrescarChart()><md-option ng-value=$index ng-repeat=\\\"a in monitoreo.aniosContables\\\">{{a}}</md-option></md-select></md-input-container><md-input-container ng-if=\\\"monitoreo.grafico.cod!==4 && monitoreo.grafico.cod!=5 && monitoreo.grafico.cod!=6 && monitoreo.grafico.cod!=7 && monitoreo.grafico.cod!=8 && monitoreo.grafico.cod!=9\\\"><label>Mes</label><md-select ng-model=monitoreo.mes ng-change=monitoreo.refrescarChart()><md-option ng-value=$index ng-repeat=\\\"m in monitoreo.meses\\\">{{m}}</md-option></md-select></md-input-container><md-input-container ng-if=\\\"monitoreo.grafico.cod===9\\\"><label>Tipo documento</label><md-select ng-model=monitoreo.tipoInformePago ng-change=monitoreo.refrescarChart()><md-option ng-value=$index ng-repeat=\\\"m in monitoreo.docsContables\\\">{{m}}</md-option></md-select></md-input-container><md-input-container class=input-search ng-if=\\\"monitoreo.grafico.cod==3\\\"><label>Usuarios</label><md-select ng-model=monitoreo.usuario ng-change=monitoreo.refrescarChart()><md-option ng-value=u.id_usuario ng-repeat=\\\"u in monitoreo.usuarios | filter:monitoreo.usuario_buscar\\\">{{u.usuario}}</md-option></md-select></md-input-container><md-input-container class=input-search ng-if=\\\"monitoreo.grafico.cod==3\\\"><label>Nombres</label><md-select ng-model=monitoreo.usuario ng-change=monitoreo.refrescarChart()><md-option ng-value=u.id_usuario ng-repeat=\\\"u in monitoreo.usuarios | filter:monitoreo.usuario_buscar\\\">{{u.nombres}} {{u.apellidos}}</md-option></md-select></md-input-container><div class=paginador ng-if=\\\"[0, 4, 5, 6, 7, 8, 9].indexOf(monitoreo.grafico.cod) == -1 \\\"><!-- <div class=\\\"paginador\\\" ng-if=\\\"monitoreo.grafico.cod!=0 && monitoreo.grafico.cod!=4 && monitoreo.grafico.cod!=5 && monitoreo.grafico.cod!=6 && monitoreo.grafico.cod!=7 && monitoreo.grafico.cod!=8\\\"> --><md-button ng-click=\\\"monitoreo.paginar(\\'aa\\')\\\" ng-disabled=\\\"monitoreo.page<=1\\\"><md-icon>first_page</md-icon></md-button><md-button ng-click=\\\"monitoreo.paginar(\\'a\\')\\\" ng-disabled=\\\"monitoreo.page<=1\\\"><md-icon>chevron_left</md-icon></md-button><md-input-container><label>Intervalo</label><input ng-model=monitoreo.page_text size=7 disabled></md-input-container><md-button ng-click=\\\"monitoreo.paginar(\\'s\\')\\\" ng-disabled=\\\"monitoreo.page*20>=monitoreo.page_tot\\\"><md-icon>chevron_right</md-icon></md-button><md-button ng-click=\\\"monitoreo.paginar(\\'ss\\')\\\" ng-disabled=\\\"monitoreo.page*20>=monitoreo.page_tot\\\"><md-icon>last_page</md-icon></md-button></div><md-input-container ng-if=\\\"monitoreo.grafico.cod==5\\\"><label>Fecha Inicial</label><md-datepicker ng-model=monitoreo.fechaInicial md-placeholder=\\\"Fecha Inicial\\\" ng-change=monitoreo.reiniciarChart()></md-datepicker></md-input-container><md-input-container ng-if=\\\"monitoreo.grafico.cod==5\\\"><label>Fecha Final</label><md-datepicker ng-model=monitoreo.fechaFinal md-placeholder=\\\"Fecha Final\\\" ng-change=monitoreo.reiniciarChart()></md-datepicker></md-input-container></div><div flex></div><div style=float:right ng-if=\\\"monitoreo.grafico.cod==4 \\\"><md-button class=\\\"md-fab md-primary\\\" ng-csv=monitoreo.filasPresupuesto() field-separator=| csv-header=monitoreo.cabeceraPresupuesto() filename=Presupuesto.csv><md-icon>library_books</md-icon><md-tooltip md-direction=left>Exportar a CSV</md-tooltip></md-button><md-button class=\\\"md-fab md-primary\\\" ng-click=monitoreo.generarPDF()><md-icon>picture_as_pdf</md-icon><md-tooltip md-direction=left>Exportar a PDF</md-tooltip></md-button></div><div style=float:right ng-if=\\\"monitoreo.grafico.cod===9 \\\"><md-button class=\\\"md-fab md-primary\\\" ng-csv=monitoreo.filasPresupuesto() field-separator=| csv-header=monitoreo.cabeceraPresupuesto() filename=\\\"{{monitoreo.generarNombre(\\'ABC\\')}}.csv\\\"><md-icon>library_books</md-icon><md-tooltip md-direction=left>Exportar a CSV</md-tooltip></md-button></div></div><div layout layout-align=\\\"center start\\\" ng-if=\\\"[4, 5, 6, 7, 8, 9].indexOf(monitoreo.grafico.cod) == -1\\\"><chart-graph ancho=1000 alto=500 tipo=monitoreo.chart.tipo datos=monitoreo.chart.datos actualizar=monitoreo.chart.actualizar reiniciar=monitoreo.chart.reiniciar></chart-graph></div><!--Presupuesto--><div ng-if=\\\"monitoreo.grafico.cod==4\\\"><div flex style=float:right><md-checkbox ng-repeat=\\\"header in monitoreo.headers\\\" ng-model=header.mostrar aria-label=Mostrar/Ocultar ng-if=!header.mostrar>{{header.title}}</md-checkbox></div><md-table-container><table md-table ng-model=selected md-progress=promise><thead md-head><tr md-row><th ng-repeat=\\\"header in monitoreo.headers\\\" md-column ng-if=header.mostrar><span><md-checkbox ng-model=header.mostrar aria-label=Mostrar/Ocultar></md-checkbox><md-tooltip md-direction=bottom>Ocultar esta columna</md-tooltip><md-button ng-click=\\\"monitoreo.ordenarPor = header.name;  monitoreo.ordenInverso = !monitoreo.ordenInverso\\\">{{header.title}}<md-icon ng-show=\\\"monitoreo.ordenarPor == header.name && !monitoreo.ordenInverso\\\">keyboard_arrow_down</md-icon><md-icon ng-show=\\\"monitoreo.ordenarPor == header.name && monitoreo.ordenInverso\\\">keyboard_arrow_up</md-icon></md-button></span><md-input-container class=md-block flex-gt-sm ng-show=\\\"header.name === \\'numero\\'\\\"><input ng-model=monitoreo.busqueda.numero></md-input-container><md-input-container class=md-block flex-gt-sm ng-show=\\\"header.name === \\'descripcion\\'\\\"><input ng-model=monitoreo.busqueda.descripcion></md-input-container><div style=\\\"height: 65px; width: 20px; border: 0px solid red\\\" ng-show=\\\"header.name !== \\'descripcion\\' && header.name !== \\'numero\\'\\\"></div></th></tr></thead><tbody md-body><tr md-row md-select=item ng-repeat=\\\"item in monitoreo.items | orderBy:monitoreo.ordenarPor:monitoreo.ordenInverso | filter:monitoreo.busqueda\\\"><td md-cell ng-if=\\\"monitoreo.mostrarOcultar(\\'numero\\')\\\" style=\\\"text-align: right\\\">{{item.numero.replace(\\',00\\', \\'\\') }}</td><td md-cell ng-if=\\\"monitoreo.mostrarOcultar(\\'descripcion\\')\\\">{{item.descripcion}}</td><td md-cell ng-if=\\\"monitoreo.mostrarOcultar(\\'inicial\\')\\\" style=\\\"text-align: right\\\">{{item.inicial}}</td><td md-cell ng-if=\\\"monitoreo.mostrarOcultar(\\'comprometido\\')\\\" style=\\\"text-align: right\\\">{{item.comprometido}}</td><td md-cell ng-if=\\\"monitoreo.mostrarOcultar(\\'pagado\\')\\\" style=\\\"text-align: right\\\">{{item.pagado}}</td><td md-cell ng-if=\\\"monitoreo.mostrarOcultar(\\'modificado\\')\\\" style=\\\"text-align: right\\\">{{item.modificado}}</td><td md-cell ng-if=\\\"monitoreo.mostrarOcultar(\\'vigente\\')\\\" style=\\\"text-align: right\\\">{{item.vigente}}</td><td md-cell ng-if=\\\"monitoreo.mostrarOcultar(\\'saldo\\')\\\" style=\\\"text-align: right\\\">{{item.saldo}}</td></tr></tbody></table></md-table-container></div><!--Documentos por estado y usuario--><div ng-if=\\\"monitoreo.grafico.cod==5\\\"><md-table-container><table md-table ng-model=selected md-progress=promise><thead md-head><tr md-row><th md-column><md-button ng-click=\\\"monitoreo.ordenarPor = \\'nombres\\'; monitoreo.ordenInverso = !monitoreo.ordenInverso\\\">Usuario<md-icon ng-show=\\\"monitoreo.ordenarPor == \\'nombres\\' && !monitoreo.ordenInverso\\\">keyboard_arrow_down</md-icon><md-icon ng-show=\\\"monitoreo.ordenarPor == \\'nombres\\' && monitoreo.ordenInverso\\\">keyboard_arrow_up</md-icon></md-button></th><th md-column><md-button ng-click=\\\"monitoreo.ordenarPor = \\'CREADO\\'; monitoreo.ordenInverso = !monitoreo.ordenInverso\\\">Creados<md-icon ng-show=\\\"monitoreo.ordenarPor == \\'CREADO\\' && !monitoreo.ordenInverso\\\">keyboard_arrow_down</md-icon><md-icon ng-show=\\\"monitoreo.ordenarPor == \\'CREADO\\' && monitoreo.ordenInverso\\\">keyboard_arrow_up</md-icon></md-button></th><th md-column><md-button ng-click=\\\"monitoreo.ordenarPor=\\'ENVIADO\\'; monitoreo.ordenInverso = !monitoreo.ordenInverso\\\">Enviados<md-icon ng-show=\\\"monitoreo.ordenarPor == \\'ENVIADO\\' && !monitoreo.ordenInverso\\\">keyboard_arrow_down</md-icon><md-icon ng-show=\\\"monitoreo.ordenarPor == \\'ENVIADO\\' && monitoreo.ordenInverso\\\">keyboard_arrow_up</md-icon></md-button></th><th md-column><md-button ng-click=\\\"monitoreo.ordenarPor=\\'DERIVADO\\'; monitoreo.ordenInverso = !monitoreo.ordenInverso\\\">Derivados<md-icon ng-show=\\\"monitoreo.ordenarPor == \\'DERIVADO\\' && !monitoreo.ordenInverso\\\">keyboard_arrow_down</md-icon><md-icon ng-show=\\\"monitoreo.ordenarPor == \\'DERIVADO\\' && monitoreo.ordenInverso\\\">keyboard_arrow_up</md-icon></md-button></th><th md-column><md-button ng-click=\\\"monitoreo.ordenarPor=\\'APROBADO\\'; monitoreo.ordenInverso = !monitoreo.ordenInverso\\\">Aprobados<md-icon ng-show=\\\"monitoreo.ordenarPor == \\'APROBADO\\' && !monitoreo.ordenInverso\\\">keyboard_arrow_down</md-icon><md-icon ng-show=\\\"monitoreo.ordenarPor == \\'APROBADO\\' && monitoreo.ordenInverso\\\">keyboard_arrow_up</md-icon></md-button></th><th md-column><md-button ng-click=\\\"monitoreo.ordenarPor=\\'RECHAZADO\\'; monitoreo.ordenInverso = !monitoreo.ordenInverso\\\">Rechazados<md-icon ng-show=\\\"monitoreo.ordenarPor == \\'RECHAZADO\\' && !monitoreo.ordenInverso\\\">keyboard_arrow_down</md-icon><md-icon ng-show=\\\"monitoreo.ordenarPor == \\'RECHAZADO\\' && monitoreo.ordenInverso\\\">keyboard_arrow_up</md-icon></md-button></th><th md-column><md-button ng-click=\\\"monitoreo.ordenarPor=\\'CERRADO\\'; monitoreo.ordenInverso = !monitoreo.ordenInverso\\\">Cerrados<md-icon ng-show=\\\"monitoreo.ordenarPor == \\'CERRADO\\' && !monitoreo.ordenInverso\\\">keyboard_arrow_down</md-icon><md-icon ng-show=\\\"monitoreo.ordenarPor == \\'CERRADO\\' && monitoreo.ordenInverso\\\">keyboard_arrow_up</md-icon></md-button></th><th md-column><md-button ng-click=\\\"monitoreo.ordenarPor=\\'ELIMINADO\\'; monitoreo.ordenInverso = !monitoreo.ordenInverso\\\">Eliminados<md-icon ng-show=\\\"monitoreo.ordenarPor == \\'ELIMINADO\\' && !monitoreo.ordenInverso\\\">keyboard_arrow_down</md-icon><md-icon ng-show=\\\"monitoreo.ordenarPor == \\'ELIMINADO\\' && monitoreo.ordenInverso\\\">keyboard_arrow_up</md-icon></md-button></th></tr></thead><tbody md-body><tr md-row md-select=item ng-repeat=\\\"item in monitoreo.estados | orderBy:monitoreo.ordenarPor:monitoreo.ordenInverso \\\"><td md-cell>{{item.nombres}} {{item.apellidos}}</td><td md-cell style=\\\"text-align: left; padding-left:20px; background-color: rgb({{255-item.CREADO}}, 255 ,{{255+item.CREADO}})\\\">{{item.CREADO}}</td><td md-cell style=\\\"text-align: left; padding-left:20px; background-color: rgb({{255-item.ENVIADO}}, 255 , {{255+item.ENVIADO}})\\\">{{item.ENVIADO}}</td><td md-cell style=\\\"text-align: left; padding-left:20px; background-color: rgb({{255-item.DERIVADO}}, 255 ,{{255+item.DERIVADO}})\\\">{{item.DERIVADO}}</td><td md-cell style=\\\"text-align: left; padding-left:20px; background-color: rgb({{255-item.APROBADO}}, 255 ,{{255+item.APROBADO}})\\\">{{item.APROBADO}}</td><td md-cell style=\\\"text-align: left; padding-left:20px; background-color: rgb({{255-item.RECHAZADO}}, 255 ,{{255+item.RECHAZADO}})\\\">{{item.RECHAZADO}}</td><td md-cell style=\\\"text-align: left; padding-left:20px; background-color: rgb({{255-item.CERRADO}}, 255 ,{{255+item.CERRADO}})\\\">{{item.CERRADO}}</td><td md-cell style=\\\"text-align: left; padding-left:20px; background-color: rgb({{255-item.ELIMINADO}}, 255 ,{{255+item.ELIMINADO}})\\\">{{item.ELIMINADO}}</td></tr></tbody></table></md-table-container></div><!--Documentos pendientes por usuario--><div ng-if=\\\"monitoreo.grafico.cod==6\\\"><md-table-container><table md-table ng-model=selected md-progress=promise><thead md-head><tr md-row><th md-column><md-button ng-click=\\\"monitoreo.ordenarPor=\\'nombres\\'; monitoreo.ordenInverso = !monitoreo.ordenInverso\\\">Usuario<md-icon ng-show=\\\"monitoreo.ordenarPor == \\'nombres\\' && !monitoreo.ordenInverso\\\">keyboard_arrow_down</md-icon><md-icon ng-show=\\\"monitoreo.ordenarPor == \\'nombres\\' && monitoreo.ordenInverso\\\">keyboard_arrow_up</md-icon></md-button></th><th md-column><md-button ng-click=\\\"monitoreo.ordenarPor=\\'ENVIADO\\'; monitoreo.ordenInverso = !monitoreo.ordenInverso\\\">Enviados<md-icon ng-show=\\\"monitoreo.ordenarPor == \\'ENVIADO\\' && !monitoreo.ordenInverso\\\">keyboard_arrow_down</md-icon><md-icon ng-show=\\\"monitoreo.ordenarPor == \\'ENVIADO\\' && monitoreo.ordenInverso\\\">keyboard_arrow_up</md-icon></md-button></th><th md-column><md-button ng-click=\\\"monitoreo.ordenarPor=\\'RECHAZADO\\'; monitoreo.ordenInverso = !monitoreo.ordenInverso\\\">Rechazados<md-icon ng-show=\\\"monitoreo.ordenarPor == \\'RECHAZADO\\' && !monitoreo.ordenInverso\\\">keyboard_arrow_down</md-icon><md-icon ng-show=\\\"monitoreo.ordenarPor == \\'RECHAZADO\\' && monitoreo.ordenInverso\\\">keyboard_arrow_up</md-icon></md-button></th><th md-column><md-button ng-click=\\\"monitoreo.ordenarPor=\\'DERIVADO\\'; monitoreo.ordenInverso = !monitoreo.ordenInverso\\\">Derivados<md-icon ng-show=\\\"monitoreo.ordenarPor == \\'DERIVADO\\' && !monitoreo.ordenInverso\\\">keyboard_arrow_down</md-icon><md-icon ng-show=\\\"monitoreo.ordenarPor == \\'DERIVADO\\' && monitoreo.ordenInverso\\\">keyboard_arrow_up</md-icon></md-button></th><th md-column><md-button ng-click=\\\"monitoreo.ordenarPor=\\'total\\'; monitoreo.ordenInverso = !monitoreo.ordenInverso\\\">Total pendientes<md-icon ng-show=\\\"monitoreo.ordenarPor == \\'total\\' && !monitoreo.ordenInverso\\\">keyboard_arrow_down</md-icon><md-icon ng-show=\\\"monitoreo.ordenarPor == \\'total\\' && monitoreo.ordenInverso\\\">keyboard_arrow_up</md-icon></md-button></th></tr></thead><tbody md-body><tr md-row md-select=item ng-repeat=\\\"item in monitoreo.pendientes | orderBy:monitoreo.ordenarPor:monitoreo.ordenInverso \\\"><td md-cell>{{item.nombres}} {{item.apellidos}}</td><td md-cell>{{item.ENVIADO}}</td><td md-cell>{{item.RECHAZADO}}</td><td md-cell>{{item.DERIVADO}}</td><td md-cell>{{item.total}}</td></tr></tbody></table></md-table-container></div><!--Comprometido--><div ng-if=\\\"monitoreo.grafico.cod==7\\\"><md-table-container><table md-table ng-model=selected md-progress=promise><thead md-head><tr md-row><th md-column><md-button ng-click=\\\"monitoreo.ordenarPor=\\'numero\\'; monitoreo.ordenInverso = !monitoreo.ordenInverso\\\">Número<md-icon ng-show=\\\"monitoreo.ordenarPor == \\'numero\\' && !monitoreo.ordenInverso\\\">keyboard_arrow_down</md-icon><md-icon ng-show=\\\"monitoreo.ordenarPor == \\'numero\\' && monitoreo.ordenInverso\\\">keyboard_arrow_up</md-icon></md-button><md-input-container class=md-block flex-gt-sm><input ng-model=monitoreo.busqueda.numero></md-input-container></th><th md-column><md-button ng-click=\\\"monitoreo.ordenarPor=\\'descripcion\\'; monitoreo.ordenInverso = !monitoreo.ordenInverso\\\">Descripción<md-icon ng-show=\\\"monitoreo.ordenarPor == \\'descripcion\\' && !monitoreo.ordenInverso\\\">keyboard_arrow_down</md-icon><md-icon ng-show=\\\"monitoreo.ordenarPor == \\'descripcion\\' && monitoreo.ordenInverso\\\">keyboard_arrow_up</md-icon></md-button><md-input-container class=md-block flex-gt-sm><input ng-model=monitoreo.busqueda.descripcion></md-input-container></th><th md-column><md-button ng-click=\\\"monitoreo.ordenarPor=\\'monto\\'; monitoreo.ordenInverso = !monitoreo.ordenInverso\\\">Monto<md-icon ng-show=\\\"monitoreo.ordenarPor == \\'monto\\' && !monitoreo.ordenInverso\\\">keyboard_arrow_down</md-icon><md-icon ng-show=\\\"monitoreo.ordenarPor == \\'monto\\' && monitoreo.ordenInverso\\\">keyboard_arrow_up</md-icon></md-button><div style=\\\"height: 65px; width: 20px; border: 0px solid red\\\"></div></th><th md-column><md-button ng-click=\\\"monitoreo.ordenarPor=\\'cite\\'; monitoreo.ordenInverso = !monitoreo.ordenInverso\\\">Documento relacionado<md-icon ng-show=\\\"monitoreo.ordenarPor == \\'cite\\' && !monitoreo.ordenInverso\\\">keyboard_arrow_down</md-icon><md-icon ng-show=\\\"monitoreo.ordenarPor == \\'cite\\' && monitoreo.ordenInverso\\\">keyboard_arrow_up</md-icon></md-button><div style=\\\"height: 65px; width: 20px; border: 0px solid red\\\"></div></th><th md-column><md-button ng-click=\\\"monitoreo.ordenarPor=\\'_fecha_creacion\\'; monitoreo.ordenInverso = !monitoreo.ordenInverso\\\">Fecha del comprometido<md-icon ng-show=\\\"monitoreo.ordenarPor == \\'_fecha_creacion\\' && !monitoreo.ordenInverso\\\">keyboard_arrow_down</md-icon><md-icon ng-show=\\\"monitoreo.ordenarPor == \\'_fecha_creacion\\' && monitoreo.ordenInverso\\\">keyboard_arrow_up</md-icon></md-button><md-input-container class=md-block flex-gt-sm><input ng-model=monitoreo.busqueda._fecha_creacion></md-input-container></th></tr></thead><tbody md-body><tr md-row md-select=item ng-repeat=\\\"item in monitoreo.comprometido | orderBy:monitoreo.ordenarPor:monitoreo.ordenInverso | filter:monitoreo.busqueda\\\"><td md-cell style=\\\"text-align: right\\\">{{item.numero}}</td><td md-cell>{{item.descripcion}}</td><td md-cell style=\\\"text-align: right\\\">{{item.monto}}</td><td md-cell><md-button ng-click=monitoreo.vistaPrevia(item.id_documento)>{{item.cite}}</md-button></td><td md-cell>{{item._fecha_creacion |date:\\'dd/MM/yyyy\\'}}</td></tr></tbody></table></md-table-container></div><!--Pagado--><div ng-if=\\\"monitoreo.grafico.cod==8\\\"><md-table-container><table md-table ng-model=selected md-progress=promise><thead md-head><tr md-row><th md-column><md-button ng-click=\\\"monitoreo.ordenarPor=\\'numero\\'; monitoreo.ordenInverso = !monitoreo.ordenInverso\\\">Número<md-icon ng-show=\\\"monitoreo.ordenarPor == \\'numero\\' && !monitoreo.ordenInverso\\\">keyboard_arrow_down</md-icon><md-icon ng-show=\\\"monitoreo.ordenarPor == \\'numero\\' && monitoreo.ordenInverso\\\">keyboard_arrow_up</md-icon></md-button><md-input-container class=md-block flex-gt-sm><input ng-model=monitoreo.busqueda.numero></md-input-container></th><th md-column><md-button ng-click=\\\"monitoreo.ordenarPor=\\'descripcion\\'; monitoreo.ordenInverso = !monitoreo.ordenInverso\\\">Descripción<md-icon ng-show=\\\"monitoreo.ordenarPor == \\'descripcion\\' && !monitoreo.ordenInverso\\\">keyboard_arrow_down</md-icon><md-icon ng-show=\\\"monitoreo.ordenarPor == \\'descripcion\\' && monitoreo.ordenInverso\\\">keyboard_arrow_up</md-icon></md-button><md-input-container class=md-block flex-gt-sm><input ng-model=monitoreo.busqueda.descripcion></md-input-container></th><th md-column><md-button ng-click=\\\"monitoreo.ordenarPor=\\'monto\\'; monitoreo.ordenInverso = !monitoreo.ordenInverso\\\">Monto<md-icon ng-show=\\\"monitoreo.ordenarPor == \\'monto\\' && !monitoreo.ordenInverso\\\">keyboard_arrow_down</md-icon><md-icon ng-show=\\\"monitoreo.ordenarPor == \\'monto\\' && monitoreo.ordenInverso\\\">keyboard_arrow_up</md-icon></md-button><div style=\\\"height: 65px; width: 20px; border: 0px solid red\\\"></div></th><th md-column><md-button ng-click=\\\"monitoreo.ordenarPor=\\'cite_ref\\'; monitoreo.ordenInverso = !monitoreo.ordenInverso\\\">Documento relacionado<md-icon ng-show=\\\"monitoreo.ordenarPor == \\'cite_ref\\' && !monitoreo.ordenInverso\\\">keyboard_arrow_down</md-icon><md-icon ng-show=\\\"monitoreo.ordenarPor == \\'cite_ref\\' && monitoreo.ordenInverso\\\">keyboard_arrow_up</md-icon></md-button><div style=\\\"height: 65px; width: 20px; border: 0px solid red\\\"></div></th><th md-column><md-button ng-click=\\\"monitoreo.ordenarPor=\\'_fecha_creacion\\'; monitoreo.ordenInverso = !monitoreo.ordenInverso\\\">Fecha del comprometido<md-icon ng-show=\\\"monitoreo.ordenarPor == \\'_fecha_creacion\\' && !monitoreo.ordenInverso\\\">keyboard_arrow_down</md-icon><md-icon ng-show=\\\"monitoreo.ordenarPor == \\'_fecha_creacion\\' && monitoreo.ordenInverso\\\">keyboard_arrow_up</md-icon></md-button><md-input-container class=md-block flex-gt-sm><input ng-model=monitoreo.busqueda._fecha_creacion></md-input-container></th></tr></thead><tbody md-body><tr md-row md-select=item ng-repeat=\\\"item in monitoreo.pagado | orderBy:monitoreo.ordenarPor:monitoreo.ordenInverso | filter:monitoreo.busqueda\\\"><td md-cell style=\\\"text-align: right\\\">{{item.numero}}</td><td md-cell>{{item.descripcion}}</td><td md-cell style=\\\"text-align: right\\\">{{item.monto}}</td><td md-cell><md-button ng-click=monitoreo.vistaPrevia(item.id_documento)>{{item.cite_ref}}</md-button></td><td md-cell>{{item._fecha_creacion |date:\\'dd/MM/yyyy\\'}}</td></tr></tbody></table></md-table-container></div><div ng-if=\\\"monitoreo.grafico.cod===9\\\"><div class=infoContable><div><strong>IPV</strong>: Informe de pago de viáticos</div><div><strong>IPBS</strong>: Informe de pago de bienes y servicios</div><div><strong>IPSPCL-A</strong>: Informe de pago de servicios personales y consultorias de linea</div></div><div flex style=float:right><md-checkbox ng-repeat=\\\"header in monitoreo.headers\\\" ng-model=header.mostrar aria-label=Mostrar/Ocultar ng-if=!header.mostrar>{{header.title}}</md-checkbox></div><md-table-container><table md-table ng-model=selected md-progress=promise><thead md-head><tr md-row><th ng-repeat=\\\"header in monitoreo.headers\\\" md-column ng-if=header.mostrar><span><md-checkbox ng-model=header.mostrar aria-label=Mostrar/Ocultar></md-checkbox><md-tooltip md-direction=bottom>Ocultar esta columna</md-tooltip><md-button ng-click=\\\"monitoreo.ordenarPor = header.name;  monitoreo.ordenInverso = !monitoreo.ordenInverso\\\">{{header.title}}<md-icon ng-show=\\\"monitoreo.ordenarPor == header.name && !monitoreo.ordenInverso\\\">keyboard_arrow_down</md-icon><md-icon ng-show=\\\"monitoreo.ordenarPor == header.name && monitoreo.ordenInverso\\\">keyboard_arrow_up</md-icon></md-button></span><md-input-container class=md-block flex-gt-sm ng-show=\\\"header.name === \\'cite\\'\\\"><input ng-model=monitoreo.busqueda.cite></md-input-container><md-input-container class=md-block flex-gt-sm ng-show=\\\"header.name === \\'detalle\\'\\\"><input ng-model=monitoreo.busqueda.detalle></md-input-container><div style=\\\"height: 65px; width: 20px; border: 0px solid red\\\" ng-show=\\\"header.name !== \\'detalle\\' && header.name !== \\'cite\\'\\\"></div></th></tr></thead><tbody md-body><tr md-row md-select=item ng-repeat=\\\"item in monitoreo.items | orderBy:monitoreo.ordenarPor:monitoreo.ordenInverso | filter:monitoreo.busqueda\\\"><td md-cell ng-if=\\\"monitoreo.mostrarOcultar(\\'cite\\')\\\" style=\\\"text-align: right\\\">{{item.cite}}</td><td md-cell ng-if=\\\"monitoreo.mostrarOcultar(\\'detalle\\')\\\">{{item.detalle}}</td><td md-cell ng-if=\\\"monitoreo.mostrarOcultar(\\'c31\\')\\\" style=\\\"text-align: right\\\">{{item.c31}}</td><td md-cell ng-if=\\\"monitoreo.mostrarOcultar(\\'importe\\')\\\" style=\\\"text-align: right\\\">{{item.importe}}</td></tr></tbody></table></md-table-container></div><br><br></md-card-content></md-card></div>\");\n$templateCache.put(\"app/modules/plantillasFormly/plantillas/modules.plantillasFormly.plantillas.html\",\"<div class=container><crud-table url=plantillas.url title-table=plantillas.titulo fields=plantillas.fields usuario=plantillas.usuario permission=plantillas.permission buttons=plantillas.buttons query-extra=plantillas.queryExtra button-agregar=plantillas.buttonAgregar estado-sw=plantillas.estadoSw only-fields=true></crud-table></div>\");\n$templateCache.put(\"app/modules/plantillasFormly/vistaPdf/modules.plantillasFormly.vistaPdf.html\",\"<div class=container><div layout layout-align=\\\"center start\\\"><md-card flex-gt-sm=50 flex><md-toolbar><div class=md-toolbar-tools><h2><md-icon>picture_as_pdf</md-icon>Vista previa</h2><span flex></span><md-button class=md-icon-button aria-label=\\\"Ver pdf\\\" ng-click=vistaPdf.verPdf() ng-show=vistaPdf.flag_html><md-tooltip>Ver PDF</md-tooltip><md-icon aria-label=\\\"Close dialog\\\">picture_as_pdf</md-icon></md-button><md-button class=md-icon-button aria-label=\\\"Ver html\\\" ng-click=vistaPdf.verHtml() ng-show=!vistaPdf.flag_html><md-tooltip>Ver html</md-tooltip><md-icon aria-label=\\\"Close dialog\\\">code</md-icon></md-button></div></md-toolbar><md-card-content><div ng-show=vistaPdf.flag_html bind-html-compile=vistaPdf.html></div><iframe class=iframe-pdf src={{vistaPdf.pdf}} style=\\\"width:100%; height:600px; border: none\\\" ng-if=\\\"vistaPdf.show_pdf && !vistaPdf.flag_html\\\" allowfullscreen></iframe><div id=canvasContainer ng-show=\\\"!vistaPdf.show_pdf && !vistaPdf.flag_html\\\"></div></md-card-content></md-card></div></div>\");\n$templateCache.put(\"app/modules/seguridad/menu/modules.seguridad.menu.html\",\"<div class=container><crud-table url=menu.url title-table=menu.titulo fields=menu.fields usuario=menu.usuario></crud-table></div>\");\n$templateCache.put(\"app/modules/seguridad/rol/dialog.rol.html\",\"<md-dialog ng-cloak class=\\\"formly-dialog formly-column-{{column}}\\\" style=\\\"max-width: 800px; width: 100%\\\"><form ng-submit=registrarRol() name=rolForm novalidate><md-toolbar><div class=md-toolbar-tools><h2><md-icon>business</md-icon>{{data.id_rol == null ? \\\"Agregar\\\" : \\\"Editar\\\"}}</h2><span flex></span><md-button class=md-icon-button aria-label=Cerrar ng-click=cerrar()><md-tooltip>Cerrar</md-tooltip><md-icon>close</md-icon></md-button></div></md-toolbar><md-dialog-content><div layout><md-card flex><md-card-header><md-card-header-text><span class=md-title>Datos del rol</span></md-card-header-text></md-card-header><md-card-content><md-input-container class=md-block><label>Nombre</label><input ng-model=data.nombre type=text required><div ng-messages=rolForm.nombre.$error ng-show=rolForm.nombre.$dirty><div ng-message=required>Debe llenar este campo</div></div></md-input-container><md-input-container class=md-block><label>Descripcion</label><input ng-model=data.descripcion type=text required><div ng-messages=rolForm.descripcion.$error ng-show=rolForm.descripcion.$dirty><div ng-message=required>Debe llenar este campo</div></div></md-input-container><md-input-container class=md-block><label>Peso</label><input ng-model=data.peso type=text required><div ng-messages=rolForm.peso.$error ng-show=rolForm.peso.$dirty><div ng-message=required>Debe llenar este campo</div></div></md-input-container><md-input-container class=md-block><label for=estado>Estado</label><md-select name=estado ng-model=data.estado placeholder=Estado required><md-option ng-value=item.id ng-repeat=\\\"item in estados\\\">{{ item.name }}</md-option></md-select><div ng-messages=rolForm.estado.$error ng-show=rolForm.estado.$dirty><div ng-message=required>Debe seleccionar una opción</div></div></md-input-container><md-input-container class=md-block><label for=fecha_creacion>Fecha de creación</label><md-datepicker ng-model=data._fecha_creacion disabled></md-datepicker></md-input-container><md-input-container class=md-block><label for=fecha_creacion>Fecha de modificación</label><md-datepicker ng-model=data._fecha_modificacion disabled></md-datepicker></md-input-container></md-card-content></md-card><md-card flex><md-card-header><md-card-header-text><span class=md-title>Menus del rol</span></md-card-header-text></md-card-header><md-card-content><div ng-repeat=\\\"m in menus\\\"><h3 ng-if=\\\"m.fid_menu_padre===null\\\">{{m.nombre}}</h3><md-input-container class=md-block ng-if=\\\"m.fid_menu_padre!==null\\\"><md-checkbox ng-model=m.checked aria-label={{m.nombre}}>{{m.nombre}}</md-checkbox></md-input-container></div></md-card-content></md-card></div></md-dialog-content><md-dialog-actions layout layout-padding><span flex></span><md-button type=submit class=\\\"md-raised md-primary\\\" ng-disabled=rolForm.$invalid><md-icon>check</md-icon>Guardar</md-button><md-button type=button class=md-raised ng-click=cerrar()><md-icon>cancel</md-icon>Cancelar</md-button></md-dialog-actions></form></md-dialog>\");\n$templateCache.put(\"app/modules/seguridad/rol/modules.seguridad.rol.html\",\"<div class=container><crud-table url=rol.url title-table=rol.titulo fields=rol.fields usuario=rol.usuario id-show=rol.idShow dialog-controller=rol.dialogController template=rol.template></crud-table></div>\");\n$templateCache.put(\"app/modules/plantillasFormly/documentos/documento/dialogError.html\",\"<md-dialog aria-label=Error class=formly-dialog-error style=\\\"max-width: 800px; width: 100%\\\"><md-toolbar><div class=md-toolbar-tools><h2><md-icon>error</md-icon>Error</h2><span flex></span> <span flex></span><md-button class=md-icon-button aria-label=Cerrar ng-click=cerrar()><md-tooltip>Cerrar</md-tooltip><md-icon aria-label=\\\"Close dialog\\\">close</md-icon></md-button></div></md-toolbar><md-dialog-content class=md-dialog-content><div ng-if=\\\"data.tipo==\\'formu\\'\\\">Debe completar los datos de todos los campos requeridos del documento para poder enviarlo.<br><br>Los campos requeridos tienen un (*) y se muestran con una linea roja.</div><div ng-if=\\\"data.tipo==\\'timeZone\\'\\\">Esta plantilla tiene fechas para llenar y la zona horaria de su ordenador no es la correcta.<br><br>Por favor configure la zona horaria a UTC-4, La Paz - Bolivia, para evitar futuros errores de impresión.<br><br>Si usted no sabe configurar la zona horaria, puede pedir ayuda al personal de soporte técnico.</div><br></md-dialog-content><md-dialog-actions><span flex></span><md-button class=md-raised ng-click=cerrar()><md-icon>check</md-icon>Aceptar</md-button></md-dialog-actions></md-dialog>\");\n$templateCache.put(\"app/modules/plantillasFormly/documentos/documento/modules.plantillasFormly.documentos.documento.html\",\"<div class=container-plantilla><section layout><md-content flex><div class=\\\"header botones\\\" layout layout-align=\\\"start center\\\"><md-button class=\\\"md-fab md-primary\\\" ng-click=documento.guardarDocumento() ng-if=!documento.sw_enviado><md-icon>save</md-icon><md-tooltip md-direction=right>Guardar documento</md-tooltip></md-button><md-button class=\\\"md-fab md-primary\\\" ng-click=documento.volverAtras() ng-if=documento.sw_enviado><md-icon>reply</md-icon><md-tooltip md-direction=right>Volver atras</md-tooltip></md-button><md-button class=\\\"md-fab md-primary\\\" ng-click=documento.vistaPrevia()><md-icon>remove_red_eye</md-icon><md-tooltip md-direction=right>Vista previa</md-tooltip></md-button><!-- <md-button class=\\\"md-fab md-primary\\\" ng-click=\\\"documento.firmar()\\\" >\\r\\n                    <md-icon>done_all</md-icon>\\r\\n                    <md-tooltip md-direction=\\\"right\\\"> Firmar Digitalmente</md-tooltip>\\r\\n                </md-button> --><md-button class=\\\"md-fab md-primary\\\" ng-click=documento.copearDocumento() ng-if=\\\"documento.id_documento!=0\\\"><md-icon>content_copy</md-icon><md-tooltip md-direction=right>Duplicar documento sin cite</md-tooltip></md-button><!-- <p>\\r\\n                  {{documento.enviarEjecutandose}} <br>\\r\\n                  bbb\\r\\n                  {{!documento.enviarEjecutandose}} <br>\\r\\n                  aaa\\r\\n                </p> --><md-button class=\\\"md-fab md-primary\\\" ng-click=documento.guardarDocumento(true) ng-if=!documento.sw_enviado ng-disabled=\\\"documento.enviarEjecutandose ==1? true:false\\\"><md-icon>send</md-icon><md-tooltip md-direction=right>{{ (documento.id_documento==0)? \\'Guardar y enviar documento\\' : \\'Enviar documento\\' }}</md-tooltip></md-button><div flex></div><md-input-container><label for=documento-nombre>Nombre del documento</label><input ng-model=documento.doc.nombre size=50 maxlength=250 ng-disabled=documento.sw_enviado required></md-input-container><div flex><md-button class=\\\"md-fab md-warning\\\" ng-click=documento.verObservaciones($event) ng-if=documento.sw_rechazado><md-icon>find_in_page</md-icon><md-tooltip md-direction=right>Ver observaciones</md-tooltip></md-button></div><div flex ng-if=!documento.sw_enviado></div></div><div class=documento-edit><div class=\\\"header header-doc\\\" ng-if=\\\"documento.sw_grupo && documento.docs_grupo.length > 0\\\"><div class=\\\"ap-text-center ap-text-warning\\\">Referencias:</div><div class=\\\"ap-text-center ap-text-warning\\\" ng-repeat=\\\"dg in documento.docs_grupo\\\" ng-if=\\\"dg.id_documento!=documento.id_documento\\\">* {{dg.nombre_plantilla}} -- <span class=ap-cursor-pointer ng-click=documento.verDocumento(dg.id_documento)>{{dg.nombre}}</span></div></div><div class=pagina ng-if=documento.load><form name=documento.formu novalidate><img class=img-membrete ng-src={{documento.url_img}} ng-if=documento.url_img><formly-form class=view-formly-form model=documento.model_actual fields=documento.form_actual></formly-form></form></div></div></md-content></section></div>\");\n$templateCache.put(\"app/modules/plantillasFormly/documentos/documento/observacion.panel.html\",\"<md-card style=\\\"max-width: 400px\\\"><md-card-title><md-card-title-text><span class=md-headline>Observaciones</span><!-- <span class=\\\"md-subhead\\\">Extra Large</span> --></md-card-title-text></md-card-title><md-card-content>{{ observacion }}</md-card-content><md-card-actions layout=row layout-align=\\\"end center\\\"><md-button ng-click=closePanel()>Aceptar</md-button></md-card-actions></md-card>\");\n$templateCache.put(\"app/modules/plantillasFormly/plantillas/plantilla/item.panel.html\",\"<md-card class=animated style=\\\"max-width: 400px; min-width: 300px\\\"><md-card-title><md-card-title-text><span class=md-headline>{{titulos[item.val.element[0].type] || item.val.element[0].type}}</span><!-- <span class=\\\"md-subhead\\\">Extra Large</span> --></md-card-title-text></md-card-title><md-card-content ng-switch on=item.val.element[0].type style=\\\"max-height: 280px; overflow-y: auto; padding-top: 10px\\\"><div class=\\\"container container-elementos\\\"><div ng-switch-when=input layout=column><md-input-container><label>Nombre</label><input type=text ng-model=item.val.element[0].templateOptions.label></md-input-container><md-checkbox ng-model=item.val.element[0].templateOptions.required aria-label=Requerido>Requerido ?</md-checkbox><label>Validación</label><md-select ng-model=item.val.element[0].templateOptions.pattern><md-option ng-value=v.pattern ng-repeat=\\\"v in validaciones\\\">{{ v.name }}</md-option></md-select></div><div ng-switch-when=radio layout=column><md-input-container><label>Nombre</label><input type=text ng-model=item.val.element[0].templateOptions.label></md-input-container><md-checkbox ng-model=item.val.element[0].templateOptions.required aria-label=Requerido>Requerido ?</md-checkbox><md-checkbox ng-model=item.val.element[0].templateOptions.vertical aria-label=vertical>Orientacion vertical ?</md-checkbox><label>Opciones</label><md-chips ng-model=item.val.element[0].opciones></md-chips></div><div ng-switch-when=select layout=column><md-input-container><label>Nombre</label><input type=text ng-model=item.val.element[0].templateOptions.label></md-input-container><md-checkbox ng-model=item.val.element[0].templateOptions.required aria-label=Requerido>Requerido ?</md-checkbox><md-checkbox ng-model=item.val.element[0].templateOptions.showItem>Mostrar en PDF</md-checkbox><label>Opciones</label><md-chips ng-model=item.val.element[0].opciones></md-chips></div><div ng-switch-when=textarea layout=column><md-input-container><label>Nombre</label><input type=text ng-model=item.val.element[0].templateOptions.label></md-input-container><md-input-container><label>Altura</label><input type=number ng-model=item.val.element[0].templateOptions.rows></md-input-container><md-checkbox ng-model=item.val.element[0].templateOptions.required aria-label=Requerido>Requerido ?</md-checkbox><md-checkbox ng-model=item.val.element[0].templateOptions.interlineado aria-label=Interlineado-de-parrafos>Quitar interlineado de parrafos ?</md-checkbox><!-- <label>Alineación</label>\\n                <md-radio-group layout layout-wrap class=\\\"radio-parrafo\\\" ng-model=\\\"item.val.element[0].className\\\">\\n                    <md-radio-button ng-value=\\\"\\'ap-text-left\\'\\\"> <md-icon>format_align_left</md-icon> </md-radio-button>\\n                    <md-radio-button ng-value=\\\"\\'ap-text-center\\'\\\"> <md-icon>format_align_center</md-icon> </md-radio-button>\\n                    <md-radio-button ng-value=\\\"\\'ap-text-right\\'\\\"> <md-icon>format_align_right</md-icon> </md-radio-button>\\n                    <md-radio-button ng-value=\\\"\\'ap-text-justify\\'\\\"> <md-icon>format_align_justify</md-icon> </md-radio-button>\\n                </md-radio-group> --></div><div ng-switch-when=checkbox layout=column><md-input-container><label>Nombre</label><input type=text ng-model=item.val.element[0].templateOptions.label></md-input-container></div><div ng-switch-when=switch layout=column><md-input-container><label>Nombre</label><input type=text ng-model=item.val.element[0].templateOptions.label></md-input-container></div><div ng-switch-when=datepicker layout=column><md-input-container><label>Nombre</label><input type=text ng-model=item.val.element[0].templateOptions.label></md-input-container><md-checkbox ng-model=item.val.element[0].templateOptions.required aria-label=Requerido>Requerido ?</md-checkbox></div><div ng-switch-when=calendario layout=column><md-input-container><label>Nombre</label><input type=text ng-model=item.val.element[0].templateOptions.label></md-input-container><md-checkbox ng-model=item.val.element[0].templateOptions.required aria-label=Requerido>Requerido ?</md-checkbox><md-input-container><label>Días antes</label><input type=number ng-model=item.val.element[0].templateOptions.diasAntes></md-input-container><md-input-container><label>Días Despues</label><input type=number ng-model=item.val.element[0].templateOptions.diasDespues></md-input-container></div><div ng-switch-when=slider layout=column><md-input-container><label>Nombre</label><input type=text ng-model=item.val.element[0].templateOptions.label></md-input-container><md-input-container><label>Step</label><input type=text ng-model=item.val.element[0].templateOptions.step></md-input-container><md-input-container><label>Min</label><input type=number ng-model=item.val.element[0].templateOptions.min></md-input-container><md-input-container><label>Max</label><input type=number ng-model=item.val.element[0].templateOptions.max></md-input-container><md-checkbox ng-model=item.val.element[0].templateOptions.discrete aria-label=Discreto>Discreto ?</md-checkbox></div><div ng-switch-when=chips layout=column><md-input-container><label>Nombre</label><input type=text ng-model=item.val.element[0].templateOptions.label></md-input-container><md-input-container><label>Placeholder</label><input type=text ng-model=item.val.element[0].templateOptions.placeholder></md-input-container><md-input-container><label>2do Placeholder</label><input type=text ng-model=item.val.element[0].templateOptions.secondaryPlaceholder></md-input-container><md-checkbox ng-model=item.val.element[0].templateOptions.required aria-label=Requerido>Requerido ?</md-checkbox></div><div ng-switch-when=texto layout=column><!-- <label ng-if=\\\"item.val.element[0].templateOptions.tipo!==\\'p\\'\\\">Tipo</label>\\n                <md-radio-group layout layout-wrap class=\\\"radio-parrafo\\\" ng-model=\\\"item.val.element[0].templateOptions.tipo\\\" ng-if=\\\"item.val.element[0].templateOptions.tipo!==\\'p\\'\\\">\\n                    <md-radio-button ng-value=\\\"\\'h1\\'\\\"> h1 </md-radio-button>\\n                    <md-radio-button ng-value=\\\"\\'h2\\'\\\"> h2 </md-radio-button>\\n                    <md-radio-button ng-value=\\\"\\'h3\\'\\\"> h3 </md-radio-button>\\n                    <md-radio-button ng-value=\\\"\\'h4\\'\\\"> h4 </md-radio-button>\\n                    <md-radio-button ng-value=\\\"\\'h5\\'\\\"> h5 </md-radio-button>\\n                    <md-radio-button ng-value=\\\"\\'h6\\'\\\"> h6 </md-radio-button>\\n                </md-radio-group> --><label>Alineación</label><md-radio-group layout layout-wrap class=radio-parrafo ng-model=item.val.element[0].templateOptions.className><md-radio-button ng-value=\\\"\\'ap-text-left\\'\\\"><md-icon>format_align_left</md-icon></md-radio-button><md-radio-button ng-value=\\\"\\'ap-text-center\\'\\\"><md-icon>format_align_center</md-icon></md-radio-button><md-radio-button ng-value=\\\"\\'ap-text-right\\'\\\"><md-icon>format_align_right</md-icon></md-radio-button><md-radio-button ng-value=\\\"\\'ap-text-justify\\'\\\" ng-if=\\\"item.val.element[0].templateOptions.tipo===\\'p\\'\\\"><md-icon>format_align_justify</md-icon></md-radio-button></md-radio-group><label>Espacios</label><div layout layout-wrap class=radio-parrafo><md-checkbox ng-model=item.val.element[0].templateOptions.mTop>Espacio superior</md-checkbox><md-checkbox ng-model=item.val.element[0].templateOptions.mBot>Espacio inferior</md-checkbox></div><md-input-container ng-if=\\\"item.val.element[0].templateOptions.tipo!==\\'p\\'\\\"><label>Texto</label><input ng-model=item.val.element[0].templateOptions.label></md-input-container><md-input-container ng-if=\\\"item.val.element[0].templateOptions.tipo===\\'p\\'\\\"><label>Texto</label><textarea ng-model=item.val.element[0].templateOptions.label rows=3 md-no-resize=true max-rows=3>\\n                    </textarea></md-input-container></div><div ng-switch-when=lista layout=column><md-input-container class=ap-input-ns><label>Texto</label><input ng-model=item.val.element[0].templateOptions.label></md-input-container><label>Tipo de lista</label><md-radio-group layout layout-wrap class=radio-parrafo ng-model=item.val.element[0].templateOptions.tipo><md-radio-button ng-value=\\\"\\'ol\\'\\\">Lista ordenada</md-radio-button><md-radio-button ng-value=\\\"\\'ul\\'\\\">Lista no ordenada</md-radio-button></md-radio-group><label>Alineación</label><md-radio-group layout layout-wrap class=radio-parrafo ng-model=item.val.element[0].templateOptions.className><md-radio-button ng-value=\\\"\\'ap-text-left\\'\\\"><md-icon>format_align_left</md-icon></md-radio-button><md-radio-button ng-value=\\\"\\'ap-text-center\\'\\\"><md-icon>format_align_center</md-icon></md-radio-button><md-radio-button ng-value=\\\"\\'ap-text-right\\'\\\"><md-icon>format_align_right</md-icon></md-radio-button></md-radio-group><label>Elementos</label><md-chips ng-model=item.val.element[0].opciones></md-chips><br></div><div ng-switch-when=inputt layout=column><md-input-container class=ap-input-ns><label>Texto</label><input ng-model=item.val.element[0].templateOptions.labelx></md-input-container><md-checkbox ng-model=item.val.element[0].templateOptions.required aria-label=Requerido>Requerido ?</md-checkbox><label>Alineación</label><md-radio-group layout layout-wrap class=radio-parrafo ng-model=item.val.element[0].templateOptions.alineacion><md-radio-button ng-value=\\\"\\'ap-text-left\\'\\\"><md-icon>format_align_left</md-icon></md-radio-button><md-radio-button ng-value=\\\"\\'ap-text-center\\'\\\"><md-icon>format_align_center</md-icon></md-radio-button><md-radio-button ng-value=\\\"\\'ap-text-right\\'\\\"><md-icon>format_align_right</md-icon></md-radio-button></md-radio-group><label>Espacio de texto = {{item.val.element[0].templateOptions.labelw}}</label><md-slider flex min=0 max=80 ng-model=item.val.element[0].templateOptions.labelw step=5 aria-label=remdes-width></md-slider><br></div><div ng-switch-when=cite layout=column><!-- <md-input-container class=\\\"ap-input-ns\\\">\\n                    <label>Texto cite</label>\\n                    <input ng-model=\\\"item.val.element[0].templateOptions.labelCite\\\">\\n                </md-input-container>\\n                <md-input-container class=\\\"ap-input-ns\\\">\\n                    <label>Texto fecha</label>\\n                    <input ng-model=\\\"item.val.element[0].templateOptions.labelFecha\\\">\\n                </md-input-container> --><md-input-container><label>Tipo de membrete</label><md-select ng-model=item.val.element[0].templateOptions.tipoMembrete><md-option ng-value=\\\"\\'sin membrete\\'\\\">Sin membrete</md-option><md-option ng-value=\\\"\\'externo\\'\\\">Membrete externo</md-option><md-option ng-value=\\\"\\'legal\\'\\\">Membrete legal</md-option></md-select></md-input-container><br><md-input-container><label>Tipo de hoja</label><md-select ng-model=item.val.element[0].templateOptions.tipoHoja ng-click=controlTipoHoja><md-option ng-value=\\\"\\'Letter\\'\\\">Carta</md-option><md-option ng-value=\\\"\\'Oficio\\'\\\">Oficio</md-option><md-option ng-value=\\\"\\'A4\\'\\\">A4</md-option><md-option ng-value=\\\"\\'Externo\\'\\\">Nota Externa</md-option><md-option ng-value=\\\"\\'Legal\\'\\\">Nota Legal</md-option></md-select></md-input-container><!-- <br> --><!-- <label>Tipo de membrete</label>\\n                <md-radio-group layout layout-wrap class=\\\"radio-parrafo\\\" ng-model=\\\"item.val.element[0].templateOptions.tipoMembrete\\\">\\n                    <md-radio-button ng-value=\\\"\\'sin membrete\\'\\\"> Sin membrete </md-radio-button>\\n                    <md-radio-button ng-value=\\\"\\'externo\\'\\\"> membrete externo </md-radio-button>\\n                </md-radio-group> --><!-- <md-checkbox ng-model=\\\"item.val.element[0].templateOptions.tipoMembrete\\\" aria-label=\\\"Vertical\\\"> Vertical </md-checkbox> --><label>Tipo de cite</label><md-radio-group layout layout-wrap ng-model=item.val.element[0].templateOptions.tipo><md-radio-button flex value=general>General</md-radio-button><md-radio-button flex value=unidad>Unidad</md-radio-button></md-radio-group><label>Numeración de pagina</label><md-radio-group layout layout-wrap ng-model=item.val.element[0].templateOptions.numeracionPagina><md-radio-button flex value=true>Si</md-radio-button><md-radio-button flex value=false>No</md-radio-button></md-radio-group><!-- <label>¿Se puede generar de manera multiple?</label>\\n                <md-radio-group layout layout-wrap ng-model=\\\"item.val.element[0].templateOptions.generacionMultiple\\\">\\n                  <md-radio-button flex value=\\\"true\\\"> Si </md-radio-button>\\n                  <md-radio-button flex value=\\\"false\\\"> No </md-radio-button>\\n                </md-radio-group> --></div><div ng-switch-when=layout layout=column><label>Número de elementos</label><md-radio-group layout layout-wrap class=radio-parrafo ng-model=\\\"item.val.element[0].elementAttributes[\\'num-cols\\']\\\"><md-radio-button ng-value=\\\"\\'2\\'\\\">2</md-radio-button><md-radio-button ng-value=\\\"\\'3\\'\\\">3</md-radio-button><md-radio-button ng-value=\\\"\\'4\\'\\\">4</md-radio-button></md-radio-group></div><div ng-switch-when=vacio layout=column><md-input-container class=ap-input-ns><label>Altura en cm (0, 30)</label><input ng-model=item.val.element[0].templateOptions.height></md-input-container></div><div ng-switch-when=datosGenerales layout=column><md-checkbox ng-model=item.val.element[0].templateOptions.aprobarPorDireccion>Aprobar por dirección</md-checkbox><div layout layout-wrap class=radio-parrafo><md-checkbox ng-model=item.val.element[0].templateOptions.show.via>Via</md-checkbox><md-checkbox ng-model=item.val.element[0].templateOptions.show.ref>Ref</md-checkbox><md-checkbox ng-model=item.val.element[0].templateOptions.showItem>Mostrar en PDF</md-checkbox></div><md-input-container class=ap-input-ns><label>Texto referencia</label><input ng-model=item.val.element[0].templateOptions.labelRef></md-input-container></div><div ng-switch-when=encabezado layout=column><div layout layout-wrap class=radio-parrafo><md-checkbox ng-model=item.val.element[0].templateOptions.show.via>Via</md-checkbox><md-checkbox ng-model=item.val.element[0].templateOptions.show.ref>Ref</md-checkbox></div><md-input-container class=ap-input-ns><label>Texto referencia</label><input ng-model=item.val.element[0].templateOptions.labelRef></md-input-container></div><div ng-switch-when=documentosRelacionados layout=column><md-input-container class=ap-input-ns><label>Texto</label><input ng-model=item.val.element[0].templateOptions.label></md-input-container><!-- <label>Espacio de texto = {{item.val.element[0].templateOptions.labelw-5}}</label>\\n                    <md-slider flex min=\\\"5\\\" max=\\\"80\\\" ng-model=\\\"item.val.element[0].templateOptions.labelw\\\" step=\\\"5\\\" aria-label=\\\"remdes-width\\\">\\n                </md-slider> --></div><div ng-switch-when=documentosAnular layout=column><md-input-container class=ap-input-ns><label>Texto</label><input ng-model=item.val.element[0].templateOptions.label></md-input-container></div><div ng-switch-when=archivo layout=column><md-input-container class=ap-input-ns><label>Texto</label><input ng-model=item.val.element[0].templateOptions.label></md-input-container><md-checkbox ng-model=item.val.element[0].templateOptions.multiple>Multiple ?</md-checkbox></div><div ng-switch-when=cajachica layout=column><md-input-container><label>Acción</label><md-select ng-model=item.val.element[0].templateOptions.tipo><md-option value=GESTION>GESTION PARTIDAS</md-option><md-option value=COMPROMETIDO>COMPROMETIDO</md-option><md-option value=PAGADO>PAGADO</md-option></md-select></md-input-container><!-- <md-checkbox ng-model=\\\"item.val.element[0].templateOptions.show.cite\\\"> Cite ?  </md-checkbox>\\n                <md-checkbox ng-model=\\\"item.val.element[0].templateOptions.show.pagado\\\"> Pagado ?  </md-checkbox>\\n\\n                <label>Partidas</label>\\n                <md-chips ng-model=\\\"item.val.element[0].templateOptions.partidas\\\"></md-chips>\\n                <label>Acciones</label>\\n                <md-chips ng-model=\\\"item.val.element[0].templateOptions.acciones\\\"></md-chips> --><!-- <md-input-container class=\\\"ap-input-ns\\\">\\n                    <label>Texto</label>\\n                    <input ng-model=\\\"item.val.element[0].templateOptions.label\\\">\\n                </md-input-container> --><!-- <md-checkbox ng-model=\\\"item.val.element[0].templateOptions.multiple\\\"> Multiple ?  </md-checkbox> --></div><div ng-switch-when=certificacionComprometido layout=column><md-input-container class=ap-input-ns><label>Titulo</label><input ng-model=item.val.element[0].templateOptions.label></md-input-container></div><div ng-switch-when=listaContactos layout=column><md-input-container class=ap-input-ns><label>Título</label><input ng-model=item.val.element[0].templateOptions.label></md-input-container></div><div ng-switch-default layout=column>Falta codigo para este</div></div></md-card-content><md-card-actions layout=row layout-align=\\\"end center\\\"><md-button class=md-primary ng-click=xeditItem()>Aceptar</md-button><!-- <md-button ng-click=\\\"xremoveItem()\\\"> Eliminar </md-button> --><md-button ng-click=xcancelEditItem()>Cancelar</md-button></md-card-actions></md-card>\");\n$templateCache.put(\"app/modules/plantillasFormly/plantillas/plantilla/modules.plantillasFormly.plantillas.plantilla.html\",\"<div class=container-plantilla><section layout><md-content flex class=documento><div class=header-plantillas layout layout-align=\\\"start center\\\"><md-button class=\\\"md-fab md-primary\\\" ng-click=plantilla.guardarPlantilla()><md-icon>save</md-icon><md-tooltip md-direction=right>{{ (plantilla.id_plantilla==0)? \\'Guardar plantilla\\' : \\'Modificar plantilla\\' }}</md-tooltip></md-button><md-menu><md-button aria-label=\\\"open menu\\\" class=\\\"md-fab md-primary\\\" md-menu-origin ng-click=$mdOpenMenu($event)><md-icon>location_searching</md-icon><md-tooltip md-direction=right>Ver json de estructura</md-tooltip></md-button><md-menu-content class=menu-content-json width=4 style=\\\"max-width: 400px\\\"><h3>Cuerpo json del formulario</h3><pre>{{plantilla.data | json}}</pre></md-menu-content></md-menu><md-button class=\\\"md-fab md-primary\\\" ng-click=plantilla.vistaPrevia() ng-if=!plantilla.vista_previa><md-icon>visibility</md-icon><md-tooltip md-direction=right>Vista previa</md-tooltip></md-button><md-button class=\\\"md-fab md-primary\\\" ng-click=\\\"plantilla.vista_previa=false\\\" ng-if=plantilla.vista_previa><md-icon>visibility_off</md-icon><md-tooltip md-direction=right>Cancelar vista previa</md-tooltip></md-button><md-menu ng-if=plantilla.vista_previa><md-button aria-label=\\\"open menu\\\" class=\\\"md-fab md-primary\\\" md-menu-origin ng-click=$mdOpenMenu($event)><md-icon>location_searching</md-icon><md-tooltip md-direction=right>Ver json de valores</md-tooltip></md-button><md-menu-content class=menu-content-json width=4 style=\\\"max-width: 400px\\\"><h3>Cuerpo json de valores</h3><pre>{{plantilla.form_model | json}}</pre></md-menu-content></md-menu><md-button class=\\\"md-fab md-primary\\\" ng-click=plantilla.verPdf() ng-if=plantilla.vista_previa><md-icon>picture_as_pdf</md-icon><md-tooltip md-direction=right>Ver pdf</md-tooltip></md-button><div flex=10 ng-if=!plantilla.vista_previa></div><md-input-container><label for=plantilla-nombre>Nombre de la plantilla</label><input ng-model=plantilla.nombre size=50 ng-disabled=plantilla.existe_documento required></md-input-container><!-- <md-input-container>\\n                    <label for=\\\"plantilla-abreviacion\\\">Abreviación</label>\\n                    <input ng-model=\\\"plantilla.abreviacion\\\" required ng-disabled=\\\"plantilla.existe_documento\\\" ng-keyup=\\\"plantilla.abreviacion=plantilla.abreviacion.toUpperCase()\\\">\\n                </md-input-container> --><div flex><!-- <md-button class=\\\"md-fab md-primary\\\" ng-click=\\\"plantilla.togglePalette($event)\\\" >\\n                        <md-icon>\\n                            reorder\\n                        </md-icon>\\n                        <md-tooltip>\\n                            Abrir paleta\\n                        </md-tooltip>\\n                    </md-button> --></div></div><div class=pagina ng-if=plantilla.vista_previa><form name=plantilla.formu_prueba novalidate><img class=img-membrete ng-src={{plantilla.url_img}} ng-if=plantilla.url_img><formly-form class=view-formly-form model=plantilla.form_model fields=plantilla.form_previo></formly-form></form></div><div class=pagina ng-if=!plantilla.vista_previa><img class=img-membrete ng-src={{plantilla.url_img}} ng-if=plantilla.url_img><md-card-content class=lista dnd-list=plantilla.items dnd-drop=\\\"plantilla.dropCallback(index, item)\\\"><p class=content-drop ng-if=\\\"plantilla.items.length == 0\\\">Arrastre alg&uacute;n elemento en esta secci&oacute;n o haga clic en el bot&oacute;n \\'+\\' de alg&uacute;n elemento</p><div class=div-{{item.val.element[0].type}} ng-repeat=\\\"item in plantilla.items\\\" ng-show=!item.notvisualize><div class=column layout layout-align=\\\"center center\\\" ng-switch on=item.val.element[0].type><div flex ng-switch-when=layout><div ng-class=\\\"\\'sublista-\\'+item.val.element[0].elementAttributes[\\'num-cols\\']\\\" dnd-list=item.val.element[0].fieldGroup dnd-drop=\\\"plantilla.dropLayoutCallback(index, item, $index)\\\"><div ng-class=\\\"\\'div-li-\\'+item.val.element[0].elementAttributes[\\'num-cols\\']\\\" ng-if=\\\"item.val.element[0].fieldGroup.length==0\\\" class=layout-drop>&nbsp;&nbsp;&nbsp;Puede arrastrar alg&uacute;n elemento en esta secci&oacute;n</div><div ng-class=\\\"\\'div-li-\\'+item.val.element[0].elementAttributes[\\'num-cols\\']\\\" ng-repeat=\\\"subitem in item.val.element[0].fieldGroup\\\" ng-mouseover=\\\"layoutIndex=$parent.$index\\\"><div layout layout-align=\\\"center center\\\" ng-switch on=subitem.val.element[0].type ng-show=!subitem.notvisualize><!-- <pre>{{subitem | json}}</pre> --><div flex ng-switch-when=layout>No puede añadir contenedores dentro de contenedores</div><div flex ng-switch-default><formly-form class=view-formly-form model=subitem.val.model fields=subitem.val.element></formly-form></div><div layout=column><md-icon class=\\\"ap-text-success ap-cursor-pointer\\\" dnd-draggable=subitem.val.element[0] dnd-effect-allowed=move dnd-dragstart=\\\"plantilla.startLayoutCallback($index, subitem, layoutIndex)\\\" dnd-dragend=plantilla.endLayoutCallback(layoutIndex) ng-click=\\\"plantilla.openMenu(subitem, $event, $index, layoutIndex)\\\"><md-tooltip>Click para editar o puede arrastrar</md-tooltip>blur_on</md-icon><md-icon class=\\\"ap-cursor-pointer ap-text-error\\\" ng-click=\\\"plantilla.removeItem(item, $index, layoutIndex)\\\"><md-tooltip>Eliminar</md-tooltip>delete</md-icon></div></div></div></div></div><div flex ng-switch-default><formly-form class=view-formly-form model=item.val.model fields=item.val.element></formly-form></div><div layout=column><md-icon class=ap-cursor-pointer dnd-draggable=item.val.element[0] dnd-effect-allowed=move dnd-dragstart=\\\"plantilla.startCallback($index, item)\\\" dnd-dragend=plantilla.endCallback() ng-click=\\\"plantilla.openMenu(item, $event, $index)\\\"><md-tooltip>Click para editar o puede arrastrar</md-tooltip>blur_on</md-icon><md-icon class=\\\"ap-cursor-pointer ap-text-error\\\" ng-click=\\\"plantilla.removeItem(item, $index)\\\" ng-if=\\\"item.val.element[0].type!=\\'cite\\'\\\"><md-tooltip>Eliminar</md-tooltip>delete</md-icon></div></div></div></md-card-content></div><div flex></div><br><br><br><br><br><br><br><br><br><br><br></md-content><md-sidenav class=\\\"md-sidenav-right ap-sidenav-right md-whiteframe-1dp\\\" md-component-id=right md-disable-backdrop md-is-locked-open=\\\"$mdMedia(\\'gt-sm\\')\\\"><md-content><!-- <md-card-title-text>\\n                    <span class=\\\"md-headline\\\">Paleta</span>\\n                </md-card-title-text> --><palette-formly funcion-agregar=plantilla.funcionAgregar></palette-formly></md-content></md-sidenav></section></div>\");}]);"]}